/* >>> file start: js/jquery/jquery.lj.repostbutton.js */
LJ.UI.registerTemplate('templates-CleanHtml-PaidRepost', "<span class=\" b-flatrepost repost-button {{if $data.reposted}} b-flatrepost-reposted {{/if}} {{if $data.count}} b-flatrepost-counted {{/if}} {{if $data.budget || $data.cost}} b-flatrepost-gained {{/if}} {{if $data.owner}} b-flatrepost-disabled {{/if}} {{if $data.login}} b-flatrepost-disabled {{/if}} \" ><a href=\"javascript:void(0);\" data-href=\"{{html $data.url}}\" class=\"b-flatrepost-name\" title=\"{{if $data.reposted}}{{html LJ.mltext(\'entry.reference.label.title\')}}{{else}}{{if $data.login}}{{html LJ.mltext(\'repost.button.title.login\')}}{{else}}{{if $data.owner}}{{html LJ.mltext(\'repost.button.title.myown\')}}{{else}}{{html LJ.mltext(\'repost.button.title\')}}{{/if}}{{/if}}{{/if}}\" ><span class=\"b-flatrepost-gain\" title=\"{{html $data.budget}}{{html LJ.mltext(\'paidrepost.button.title.curr\')}}\" >{{if !$data.owner}}+{{html $data.cost}}{{else $data.budget}}{{html $data.budget}}{{/if}}</span></a><span class=\"b-flatrepost-counter\" title=\"{{html LJ.mltext(\'repost.button.counter\')}}\" >{{html $data.count}}</span></span> ", 'JQuery.stat');
LJ.UI.registerTemplate('templates-CleanHtml-Repost', "<span class=\" b-flatrepost repost-button {{if $data.reposted}} b-flatrepost-reposted {{/if}} {{if $data.count}} b-flatrepost-counted {{/if}} {{if $data.budget}} b-flatrepost-gained {{/if}} {{if $data.owner}} b-flatrepost-disabled {{/if}} {{if $data.login}} b-flatrepost-disabled {{/if}} \" ><a href=\"javascript:void(0);\" data-href=\"{{html $data.url}}\" class=\"b-flatrepost-name\" title=\"{{if $data.reposted}}{{html LJ.mltext(\'entry.reference.label.title\')}}{{else}}{{if $data.login}}{{html LJ.mltext(\'repost.button.title.login\')}}{{else}}{{if $data.owner}}{{html LJ.mltext(\'repost.button.title.myown\')}}{{else}}{{html LJ.mltext(\'repost.button.title\')}}{{/if}}{{/if}}{{/if}}\" ><span class=\"b-flatrepost-gain\" title=\"{{html $data.budget}}{{html LJ.mltext(\'paidrepost.button.title.curr\')}}\" >{{if !$data.owner}}+{{html $data.cost}}{{else $data.budget}}{{html $data.budget}}{{/if}}</span></a><span class=\"b-flatrepost-counter\" title=\"{{html LJ.mltext(\'repost.button.counter\')}}\" >{{html $data.count}}</span></span> ", 'JQuery.stat');
LJ.UI.registerTemplate('templates-CleanHtml-reposted', "{{if $data.content}} {{each ($value.users || $data.users)}}{{if !((!$index) && !($value.dropComma || $data.dropComma))}}, {{/if}}<a href=\"{{html ($value.url || $data.url)}}\">{{html ($value.user || $data.user)}}</a>{{/each}} {{else}} <div class=\"b-reposted-popup\"> <div class=\"b-reposted-popup-header\">{{html LJ.mltext(\'repost.popup.head\')}}</div> <div class=\"b-reposted-popup-content b-reposted-popup-load\"></div> <div class=\"b-reposted-popup-footer\"><a href=\"javascript:void(0);\">{{html LJ.mltext(\'repost.popup.footer\')}}</a></div> </div> {{/if}} ", 'JQuery.stat');
!function(t){return t}(),function(t){"use strict";t.widget("lj.repostbutton",t.lj.basicWidget,{options:{classNames:{active:"repost-button-active",inactive:"repost-button-inactive",popupLoad:"b-reposted-popup-load",popupNomore:"b-reposted-popup-footer-hide",repostError:"repost-error"},selectors:{counterParent:".lj-button-c",button:".lj-button-b",counter:".lj-like-item-count",buttonLink:".lj-button-link",popupContent:".b-reposted-popup-content",popupFooter:".b-reposted-popup-footer",popupMore:".b-reposted-popup-footer > a"},templates:{popup:"templates-CleanHtml-reposted"},url:"",reposted:!1,cost:0,budget:0,paid:!1},_create:function(){this.options.classNames={active:"b-flatrepost-reposted",inactive:"b-flatrepost-disabled",popupLoad:"b-reposted-popup-load",popupNomore:"b-reposted-popup-footer-hide",repostError:"repost-error"},this.options.selectors={counterParent:".b-flatrepost-counter",button:".b-flatrepost-name",counter:".b-flatrepost-counter",buttonLink:".b-flatrepost-name",popupContent:".b-reposted-popup-content",popupFooter:".b-reposted-popup-footer",popupMore:".b-reposted-popup-footer > a"},t.lj.basicWidget.prototype._create.apply(this),this.options.url||console.warn(this.widgetName,": no url in options, initialization won't continue"),this._journal=LJ.get("currentJournal"),this._count=null,this._remote=LJ.get("remoteUser"),this._reposted=this.options.reposted,this._el("buttonLink"),this._href=this.element.find(this._s("button")).data("href"),this._href=LJ.Util.Journal.parseLink(this._href)||{},this._canRepost()||(this.element.addClass(this._cl("inactive")),this._buttonLink.removeAttr("title"),this._lock()),this._popup=null,this._popupContent=null,this._popupLocked=!1,this._lastUser=null,this._el("counterParent"),this._el("counter"),Number(this._counter.html())||this._hideCounter(),this._bindControls()},_hideCounter:function(){this._counterParent.addClass("empty")},_showCounter:function(){this._counterParent.removeClass("empty")},_bindControls:function(){var e=this;this.element.on("click",this._s("button"),this._onUpdateButton.bind(this)),this._counterParent.one("click",function(){Number(e._counter.html())&&(e._popup=e._tmpl("popup"),e._el("popupFooter",e._popup),e._popupContent=e._popup.find(e._s("popupContent")),e._popup.bubble({showOn:"click",align:"side",alwaysShowUnderTarget:!0,target:e._counterParent}).on("bubblehide",function(){e._lastUser=null,e._popupContent.empty(),e._popupFooter.removeClass(e._cl("popupNomore"))}).on("bubbleshow",function(){e._loadRepostedList()}).on("click",e._s("popupMore"),e._loadRepostedList.bind(e)),Function.defer(function(){e._popup.bubble("show")}))}),t.lj.basicWidget.prototype._bindControls.apply(e)},_loadRepostedList:function(t){var e=this;t&&t.preventDefault(),this._popupLocked||(this._popupLocked=!0,this._popupContent.addClass(this._cl("popupLoad")),LJ.Api.call("repost.get_list",{url:this.options.url,last:this._lastUser},function(t){e._popupContent.removeClass(e._cl("popupLoad")),e._popupLocked=!1,t.error?e._handleAnswer(t):(e._render(t.users,t.nomore,t.count),e._lastUser=t.last)}))},_render:function(t,e,o){var s=this;t.length>0&&s._tmpl("popup",{content:!0,dropComma:!!s._lastUser,users:t}).appendTo(s._popupContent),this._updateCounter(o),e&&s._popupFooter.addClass(s._cl("popupNomore"))},_onUpdateButton:function(t){this.locked()||this.toggleRepost(),t.preventDefault()},_handleAnswer:function(t){if(t.hasOwnProperty("delete")&&(t.message&&this._showMessage(t.message),this.paid!==Boolean(t.paid)||this.paid&&this.cost!==t.cost))return void this.element.replaceWith(LJ.Social.renderRepostButton(this.options.url,t));if(t.error){if(t.error.message&&this._showMessage(t.error.message),t.error.data)return void this.element.replaceWith(LJ.Social.renderRepostButton(this.options.url,t.error.data))}else this._updateButton(!this._reposted);!t.hasOwnProperty("count")&&t.hasOwnProperty("delete")&&(t.count=this._count-1),this._updateCounter(t.count),this._unlock()},_showMessage:function(e){var o=t("<div />",{"class":this._cl("repostError"),text:e}).bubble({target:this.element,align:"center",hide:function(){o.remove()}}).bubble("show")},_updateButton:function(t){this._reposted=t,this.element.toggleClass(this._cl("active"),this._reposted)},_updateCounter:function(t){"undefined"!=typeof t&&(this._count=Number(t),this._counter.html(this._count)),Number(this._counter.html())?this._showCounter():this._hideCounter()},_canRepost:function(){return LJ.get("preview")?!1:this._remote?LJ.get("remote_is_identity")?!1:this._remote!==this._href.journal:!1},toggleRepost:function(){var t=this,e={url:this.options.url};this._canRepost()&&(null===this._count&&(this._count=parseInt(this._el("counter").html(),10)||0),this._lock(),this._reposted?LJ.Api.call("repost.delete",e,function(e){e.error||e.reposted||t._journal!==t._remote||location.href.match(/\/(friends|times|feed)\b/)?t._handleAnswer(e):location.reload()}):(e.timezone=LJ.Util.Date.timezone(),this.options.paid&&(e.cost=this.options.cost),LJ.Api.call("repost.create",e,this._handleAnswer.bind(this))))}})}(jQuery);
/* <<< file end: js/jquery/jquery.lj.repostbutton.js */

//# map link was there [jquery.lj.repostbutton.js.map]
/* >>> file start: js/threeposts.js */
!function(t){return t}(),function(t){"use strict";t(function(){function e(){var t=3,e={7:4,8:4,9:3};return t=e[v]>0?e[v]:v}function i(){var t=1;if(M>H)return t=1;if(v>=2){t=Math.floor(H/M),t>v&&(t=v);var e=v%t;if(e>0)if(v%(t-1)===0)t--;else if(v%(t+1)===0)t++;else if(1===e){var i=H/(t+1);i>=E&&t++}}return t}function n(){H=u.width(),b=O>H?i():e(),s(H/b)}function s(t){var e=[150,300,330,400,500,600,800],i=["xxs","xs","s","m","l","xl","xxl"];e.forEach(function(n){t>n&&(F=i[e.indexOf(n)])})}function r(){u.find("."+w).removeClass(w),"xs"===F&&z.each(function(){var e=t(this).find("."+_),i=e.get(0).getClientRects().length;2>i&&t(this).addClass(w)})}function o(t){return p.get(t).scrollHeight}function a(){if(0===C&&g.height()>0){p.height("auto");var t=p.map(o),e=Math.max.apply(Math,t);p.height(e)}}function h(){H=u.width();var t=[400,600,800,1e3,1200,1400],e=["xs","s","m","l","xl","xxl"];t.forEach(function(i){H>i&&(j=e[t.indexOf(i)])}),n(),f()}function f(){var t=c+"--size-"+j,e=c+"--items-in-row-"+b,i=c+"--item-size-"+F,n=l+"\n"+t+"\n"+e+"\n"+i;u.attr("class",n),u.attr("data-item-layout",F),x.hide(),d.show(),a(),r()}var c="threeposts",u=t("."+c),l=u.attr("class"),x=t(".placeholder-threeposts"),d=t(".threeposts__items"),m="threeposts__item",p=t("."+m),g=t(p.get(0)),v=p.length,_="threeposts__title-inner",w="threeposts__item--short-title",y="threeposts__item--pic",z=t("."+y),C=z.length,M=235,E=200,O=1200,b=3,j="xxs",F="xxs",H=u.width();h(),t(window).resize(LJ.Function.debounce(h,50))})}(jQuery);
/* <<< file end: js/threeposts.js */

//# map link was there [threeposts.js.map]
/* >>> file start: js/recommended-entries.js */
!function(t){return t}(),function(t){"use strict";t(function(){function e(){return a=t("."+c),0==a.length?void setTimeout(e,1e3):(u=a.attr("class"),M=a.width(),d=t(".recommended-entries__list"),x=t("."+l),f=t(x.get(0)),m=x.length,void o())}function n(){var t=1;return _>M?t:(m>=2&&(t=Math.floor(M/_),6>t&&(t=Math.floor(M/v)),t>2&&6>t&&(t=3)),t)}function i(){M=a.width(),y>M&&(z=n()),g=M/z,r(g)}function r(){var t=[150,250,330,400,500,600,800],e=["xxs","xs","s","m","l","xl","xxl"];t.forEach(function(n){g>n&&(E=e[t.indexOf(n)])})}function o(){M=a.width();var t=[280,300,400,800,1e3,1200,1400],e=["xxs","xs","s","m","l","xl","xxl"];t.forEach(function(n){M>n&&(p=e[t.indexOf(n)])}),i(),s()}function s(){var t=c+"--size-"+p,e=c+"--items-in-row-"+z,n=c+"--item-size-"+E,i=u+"\n"+t+"\n"+e+"\n"+n;a.attr("class",i),a.attr("data-layout",M+"/"+p+"|"+z),a.attr("data-item-layout",g+"/"+E),d.show()}var c="recommended-entries",a=t("."+c),u=a.attr("class"),d=t(".recommended-entries__list"),l="recommended-entries__item",x=t("."+l),f=t(x.get(0)),m=x.length,h="threeposts__item--pic",w=t("."+h),_=(w.length,220),v=155,g=0,y=1044,z=6,p="xxs",E="xxs",M=a.width();e(),t(window).resize(LJ.Function.debounce(o,50))})}(jQuery);
/* <<< file end: js/recommended-entries.js */

//# map link was there [recommended-entries.js.map]
/* >>> file start: js/jquery/jquery.lj.ljcut.js */
!function(t){return t}(),function(t){"use strict";var e=[];t.widget("lj.ljcut",t.lj.basicWidget,{options:{journalid:null,ditemid:null,cutid:null,placeholders:0,sticky:!1,selectors:{expand:".ljcut-link-expand",collapse:".ljcut-link-collapse",collapseLink:".ljcut-pseudolink-collapse",stickyLink:".b-sticky-cut-link"},classNames:{preloader:"ljcut-link-expanding",expanded:"ljcut-expanded","sticky-cut-visible":"b-sticky-cut-visible",cut:".b-sticky-cut"}},_create:function(){t.lj.basicWidget.prototype._create.apply(this),this._window=t(window),this.cut=t(this._cl("cut")),this._stickyCollapseHandler=this._collapse.bind(this),this.content=null,this._isMac=/Mac/.test(navigator.userAgent),this._isOpera=/Opera/.test(navigator.userAgent),this._collapseNode=t('<span class="ljcut-pseudolink"><span class="ljcut-decor"><span class="ljcut-pseudolink-collapse">{close}</span></span></span>'.supplant({close:this._ml("collapse")})),this._bindControls(),this._id=e.length,e[this._id]=!1},_bindControls:function(){var e=!1,i=[this._s("expand"),this._s("collapse")].join(", ");t.lj.basicWidget.prototype._bindControls.apply(this),this.element.on("click",this._s("expand"),this._expand.bind(this)),this.element.on("click",this._s("collapse"),this._collapse.bind(this)),this.element.on("touchstart",i,function(){e=!0}),this.element.on("touchmove",i,function(){e=!1}),this.element.on("touchend",i,function(i){e&&(t(i.target).trigger("click"),i.preventDefault())}),t(document).on("keydown",this._shortcuts.bind(this)),this._window.on("scroll",this._scrolling.bind(this))},_shortcuts:function(t){var e=this._isMac&&this._isOpera?t.metaKey:t.ctrlKey,i=t.altKey;if(e&&i){switch(t.which){case 61:case 187:this.expand();break;case 173:case 31:case 109:case 189:this.collapse()}t.preventDefault()}},_togglePreloader:function(t){this.element.toggleClass(this._cl("preloader"),t)},_toggleContent:function(e,i){var s,n=this;!this.locked()&&this.content&&(this._lock(),"function"!=typeof i&&(i=t.noop),this.element.toggleClass(n._cl("expanded"),e),e?this._showContent(i):(s=this.element.offset().top-30,this.element.is(":screenable")?this._hideContent(i):t("body,html").animate({scrollTop:s},300,function(){setTimeout(n._hideContent.bind(n,i),50)})))},_showContent:function(t){var e=this;this.content.show(50,function(){e._trigger("show",null,e),t(),e._unlock()})},_hideContent:function(t){var e=this;this.content.slideUp(50,function(){e._trigger("hide",null,e),t(),e._unlock()})},_requestContent:function(e){var i=this;this._lock(),this._togglePreloader(!0),LJ.Api.call("event.get_lj_cut",e,function(e){i.content=t("<div />",{html:e.text}).hide(),i.content.find("a:not([target])").attr("target","_self"),i.element.after(i.content),setTimeout(function(){LJ.Event.trigger("ljcut:appendContent",{$content:i.content})},0),i._unlock(),i._togglePreloader(!1),i._toggleContent(!0,i._addHandlers.bind(i)),e.counter_image_url&&LJ.Stat.addCounter(e.counter_image_url)})},_addHandlers:function(){this.content.ljLikes(),LJ.Event.trigger("social:widgets:parse"),LJ.Event.trigger("social:newinsta:parse")},expand:function(){this.locked()||(this.content?this._toggleContent(!0):this._requestContent({journalid:this.options.journalid,ditemid:this.options.ditemid,cutid:this.options.cutid,placeholders:this.options.placeholders}))},collapse:function(){this.locked()||(this._toggleContent(!1),this._toggleStickyClass(!1))},_expand:function(t){return t.metaKey||t.ctrlKey?!0:(t.preventDefault(),void this.expand())},_collapse:function(t){return t.metaKey||t.ctrlKey?!0:(t.preventDefault(),e[this._id]=!1,void this.collapse())},_scrolling:function(){this._updateStickyCutState()},_updateStickyCutState:function(){var i,s,n,o,l,c,a;this._isExpanded()&&this.options.sticky&&this.content&&(i=this._window.height(),s=t(document).scrollTop(),n=this.content.height(),o=this.content.offset().top,l=o+n,a=this.element.find(this._s("collapse")),c=s>o&&l-i>s,e[this._id]=c,this._toggleStickyClass(c))},_toggleStickyClass:function(i){this.cut.toggleClass(this._cl("sticky-cut-visible"),e.indexOf(!0)>-1),i?t(document).on("click",this._s("stickyLink"),this._stickyCollapseHandler):t(document).off("click",this._s("stickyLink"),this._stickyCollapseHandler)},_addBottomCollapser:function(){return!this._bottomCloser&&this.options.sticky&&(this._bottomCloser=this._collapseNode.appendTo(this.content),this._bottomCloser.find(this._s("collapseLink")).on("click",this._bottomCloserClickHandler.bind(this))),this._bottomCloser},_bottomCloserClickHandler:function(){event.preventDefault(),this.collapse()},_isExpanded:function(){return this.element.hasClass(this._cl("expanded"))},_isCollapsed:function(){return!this._isExpanded()}})}(jQuery);
/* <<< file end: js/jquery/jquery.lj.ljcut.js */

//# map link was there [jquery.lj.ljcut.js.map]
/* >>> file start: js/core/string.js */
!function(t){return t}(),function(){"use strict";LJ.define("LJ.String"),LJ.String.pad=function(t,n,r){if(t=t.toString(),"undefined"==typeof n)throw new Error("You should provide padding string length");if("undefined"==typeof r)throw new Error("You should provide padding symbol");if(t.length>=n)return t;for(;t.length<n;)t=r+t;return t.length===n?t:t.slice(-n)},LJ.String.capitalize=function(t){var n;if("string"!=typeof t)throw new Error("You should provide string as argument");return n=t.length,0===n?t:1===n?t.toUpperCase():t.charAt(0).toUpperCase()+t.slice(1).toLowerCase()},LJ.String.linkify=function(t){var n=new RegExp("^(?:([a-zA-Z]+):)?//"),r=/^[a-zA-Z]+:/,e=/^:\/\//,i=r.test(t)?"":"https://";return n.test(t)?t:i+(e.test(t)?t.replace("://",""):t)},LJ.String.smartSplit=function(t,n){return"undefined"==typeof n&&(n=","),t.split(n).map(function(t){return t.trim()}).filter(Boolean)},LJ.String.encodeHTML=function(t){var n={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"};return t.replace(/([<>&\"\'])/g,function(t,r){return n[r]?n[r]:r})}}();
/* <<< file end: js/core/string.js */

//# map link was there [string.js.map]
/* >>> file start: js/core/angular/activity.js */
!function(){"use strict";function t(t,n){function c(){return u}function e(t){u=t}function i(){n.cancel(o),e(!0),o=n(e.bind(this,!1),9e5)}var u,o;return i(),t.on("click touchstart touchend keydown mousemove mousewheel",LJ.Function.debounce(i,100,!0)),{isActive:c}}angular.module("LJ.Activity",[]),angular.module("LJ.Activity").factory("Activity",t),t.$inject=["$document","$timeout"]}();
/* <<< file end: js/core/angular/activity.js */

//# map link was there [activity.js.map]
/* >>> file start: js/core/angular/api.js */
//!= require js/core/angular/messages.js
//= require js/core/angular/activity.js
!function(){"use strict";function e(e,n,t,r,a,c){function i(e,n){return"undefined"==typeof n?e:e+angular.toJson(s(n))}function s(e){var n;return angular.isObject(e)?(n={},Object.keys(e).sort().forEach(function(t){n[t]=s(e[t])}),n):e}function o(e,n){f.remove(i(e,n))}function u(n,s,o,u){var g,l,p=r.defer(),d={cache:!1,silent:!1,meta:!1},m=!1;return c.isActive()?(angular.isObject(s)&&null!==s||(s={}),angular.isObject(o)&&(u=o,o=null),u=angular.extend(d,u||{}),l=i(n,s),u.cache&&(g=f.get(l),g&&(m=!0)),m||(g=p.promise,LJ.Api.call(n,s,function(n){e(function(){n.error?p.reject(n.error):p.resolve(n),t.$apply()},0)}),u.cache&&f.put(l,g)),LJ.Event.trigger("api:request:change",n,!0),g.then(function(){LJ.Event.trigger("api:request:change",n,!1)}),u.silent||g.then(function(e){var n={};"undefined"!=typeof e.message&&(angular.isString(e.message)?(n.body=e.message,n.type="success"):(n.body=e.message.content,n.type="success"),a.add(n))},function(e){"undefined"!=typeof e.message&&1!==e.code&&a.error({body:e.message})}),u.meta&&(g=g.then(function(e){return{response:e,fromCache:m}})),angular.isFunction(o)&&g.then(o),g):(p.reject(),p.promise)}var g={call:u,invalidate:o},f=n("LJApiPromises");return g}angular.module("LJ.Api",["LJ.Messages","LJ.Activity"]).factory("Api",e),e.$inject=["$timeout","$cacheFactory","$rootScope","$q","Messages","Activity"]}();
/* <<< file end: js/core/angular/api.js */

//# map link was there [api.js.map]
/* >>> file start: js/lib/jquery-ui/jquery.ui.position.min.js */
!function(t,o){t.ui=t.ui||{};var e=/left|center|right/,i=/top|center|bottom/,n="center",s={},f=t.fn.position,l=t.fn.offset;t.fn.position=function(o){if(!o||!o.of)return f.apply(this,arguments);o=t.extend({},o);var l,r,h,a=t(o.of),c=a[0],p=(o.collision||"flip").split(" "),u=o.offset?o.offset.split(" "):[0,0];return 9===c.nodeType?(l=a.width(),r=a.height(),h={top:0,left:0}):c.setTimeout?(l=a.width(),r=a.height(),h={top:a.scrollTop(),left:a.scrollLeft()}):c.preventDefault?(o.at="left top",l=r=0,h={top:o.of.pageY,left:o.of.pageX}):(l=a.outerWidth(),r=a.outerHeight(),h=a.offset()),t.each(["my","at"],function(){var t=(o[this]||"").split(" ");1===t.length&&(t=e.test(t[0])?t.concat([n]):i.test(t[0])?[n].concat(t):[n,n]),t[0]=e.test(t[0])?t[0]:n,t[1]=i.test(t[1])?t[1]:n,o[this]=t}),1===p.length&&(p[1]=p[0]),u[0]=parseInt(u[0],10)||0,1===u.length&&(u[1]=u[0]),u[1]=parseInt(u[1],10)||0,"right"===o.at[0]?h.left+=l:o.at[0]===n&&(h.left+=l/2),"bottom"===o.at[1]?h.top+=r:o.at[1]===n&&(h.top+=r/2),h.left+=u[0],h.top+=u[1],this.each(function(){var e,i=t(this),f=i.outerWidth(),a=i.outerHeight(),c=parseInt(t.curCSS(this,"marginLeft",!0))||0,g=parseInt(t.curCSS(this,"marginTop",!0))||0,d=f+c+(parseInt(t.curCSS(this,"marginRight",!0))||0),m=a+g+(parseInt(t.curCSS(this,"marginBottom",!0))||0),y=t.extend({},h);"right"===o.my[0]?y.left-=f:o.my[0]===n&&(y.left-=f/2),"bottom"===o.my[1]?y.top-=a:o.my[1]===n&&(y.top-=a/2),s.fractions||(y.left=Math.round(y.left),y.top=Math.round(y.top)),e={left:y.left-c,top:y.top-g},t.each(["left","top"],function(i,n){t.ui.position[p[i]]&&t.ui.position[p[i]][n](y,{targetWidth:l,targetHeight:r,elemWidth:f,elemHeight:a,collisionPosition:e,collisionWidth:d,collisionHeight:m,offset:u,my:o.my,at:o.at})}),t.fn.bgiframe&&i.bgiframe(),i.offset(t.extend(y,{using:o.using}))})},t.ui.position={fit:{left:function(o,e){var i=t(window),n=e.collisionPosition.left+e.collisionWidth-i.width()-i.scrollLeft();o.left=n>0?o.left-n:Math.max(o.left-e.collisionPosition.left,o.left)},top:function(o,e){var i=t(window),n=e.collisionPosition.top+e.collisionHeight-i.height()-i.scrollTop();o.top=n>0?o.top-n:Math.max(o.top-e.collisionPosition.top,o.top)}},flip:{left:function(o,e){if(e.at[0]!==n){var i=t(window),s=e.collisionPosition.left+e.collisionWidth-i.width()-i.scrollLeft(),f="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,l="left"===e.at[0]?e.targetWidth:-e.targetWidth,r=-2*e.offset[0];o.left+=e.collisionPosition.left<0?f+l+r:s>0?f+l+r:0}},top:function(o,e){if(e.at[1]!==n){var i=t(window),s=e.collisionPosition.top+e.collisionHeight-i.height()-i.scrollTop(),f="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,l="top"===e.at[1]?e.targetHeight:-e.targetHeight,r=-2*e.offset[1];o.top+=e.collisionPosition.top<0?f+l+r:s>0?f+l+r:0}}}},t.offset.setOffset||(t.offset.setOffset=function(o,e){/static/.test(t.curCSS(o,"position"))&&(o.style.position="relative");var i=t(o),n=i.offset(),s=parseInt(t.curCSS(o,"top",!0),10)||0,f=parseInt(t.curCSS(o,"left",!0),10)||0,l={top:e.top-n.top+s,left:e.left-n.left+f};"using"in e?e.using.call(o,l):i.css(l)},t.fn.offset=function(o){var e=this[0];return e&&e.ownerDocument?o?t.isFunction(o)?this.each(function(e){t(this).offset(o.call(this,e,t(this).offset()))}):this.each(function(){t.offset.setOffset(this,o)}):l.call(this):null}),t.curCSS||(t.curCSS=t.css),function(){var o,e,i,n,f,l=document.getElementsByTagName("body")[0],r=document.createElement("div");o=document.createElement(l?"div":"body"),i={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},l&&t.extend(i,{position:"absolute",left:"-1000px",top:"-1000px"});for(var h in i)o.style[h]=i[h];o.appendChild(r),e=l||document.documentElement,e.insertBefore(o,e.firstChild),r.style.cssText="position: absolute; left: 10.7432222px; top: 10.432325px; height: 30px; width: 201px;",n=t(r).offset(function(t,o){return o}).offset(),o.innerHTML="",e.removeChild(o),f=n.top+n.left+(l?2e3:0),s.fractions=f>21&&22>f}()}(jQuery);
/* <<< file end: js/lib/jquery-ui/jquery.ui.position.min.js */

//# map link was there [jquery.ui.position.min.js.map]
/* >>> file start: js/lib/jquery-ui/jquery.ui.autocomplete.min.js */
!function(e,t){var i=0;e.widget("ui.autocomplete",{options:{appendTo:"body",autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null},pending:0,_create:function(){var t,i=this,n=this.element[0].ownerDocument;this.isMultiLine=this.element.is("textarea"),this.element.addClass("ui-autocomplete-input").attr("autocomplete","off").attr({role:"textbox","aria-autocomplete":"list","aria-haspopup":"true"}).bind("keydown.autocomplete",function(n){if(!i.options.disabled&&!i.element.propAttr("readOnly")){t=!1;var s=e.ui.keyCode;switch(n.keyCode){case s.PAGE_UP:i._move("previousPage",n);break;case s.PAGE_DOWN:i._move("nextPage",n);break;case s.UP:i._keyEvent("previous",n);break;case s.DOWN:i._keyEvent("next",n);break;case s.ENTER:case s.NUMPAD_ENTER:i.menu.active&&(t=!0,n.preventDefault());case s.TAB:if(!i.menu.active)return;i.menu.select(n);break;case s.ESCAPE:i.element.val(i.term),i.close(n);break;default:clearTimeout(i.searching),i.searching=setTimeout(function(){i.term!=i.element.val()&&(i.selectedItem=null,i.search(null,n))},i.options.delay)}}}).bind("keypress.autocomplete",function(e){t&&(t=!1,e.preventDefault())}).bind("focus.autocomplete",function(){i.options.disabled||(i.selectedItem=null,i.previous=i.element.val())}).bind("blur.autocomplete",function(e){i.options.disabled||(clearTimeout(i.searching),i.closing=setTimeout(function(){i.close(e),i._change(e)},150))}),this._initSource(),this.menu=e("<ul></ul>").addClass("ui-autocomplete").appendTo(e(this.options.appendTo||"body",n)[0]).mousedown(function(t){var n=i.menu.element[0];e(t.target).closest(".ui-menu-item").length||setTimeout(function(){e(document).one("mousedown",function(t){t.target!==i.element[0]&&t.target!==n&&!e.ui.contains(n,t.target)&&i.close()})},1),setTimeout(function(){clearTimeout(i.closing)},13)}).menu({focus:function(e,t){var n=t.item.data("item.autocomplete");!1!==i._trigger("focus",e,{item:n})&&/^key/.test(e.originalEvent.type)&&i.element.val(n.value)},selected:function(e,t){var s=t.item.data("item.autocomplete"),o=i.previous;i.element[0]!==n.activeElement&&(i.element.focus(),i.previous=o,setTimeout(function(){i.previous=o,i.selectedItem=s},1)),!1!==i._trigger("select",e,{item:s})&&i.element.val(s.value),i.term=i.element.val(),i.close(e),i.selectedItem=s},blur:function(e,t){i.menu.element.is(":visible")&&i.element.val()!==i.term&&i.element.val(i.term)}}).zIndex(this.element.zIndex()+1).css({top:0,left:0}).hide().data("menu"),e.fn.bgiframe&&this.menu.element.bgiframe(),i.beforeunloadHandler=function(){i.element.removeAttr("autocomplete")},e(window).bind("beforeunload",i.beforeunloadHandler)},destroy:function(){this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"),this.menu.element.remove(),e(window).unbind("beforeunload",this.beforeunloadHandler),e.Widget.prototype.destroy.call(this)},_setOption:function(t,i){e.Widget.prototype._setOption.apply(this,arguments),"source"===t&&this._initSource(),"appendTo"===t&&this.menu.element.appendTo(e(i||"body",this.element[0].ownerDocument)[0]),"disabled"===t&&i&&this.xhr&&this.xhr.abort()},_initSource:function(){var t,i,n=this;e.isArray(this.options.source)?(t=this.options.source,this.source=function(i,n){n(e.ui.autocomplete.filter(t,i.term))}):"string"==typeof this.options.source?(i=this.options.source,this.source=function(t,s){n.xhr&&n.xhr.abort(),n.xhr=e.ajax({url:i,data:t,dataType:"json",success:function(e,t){s(e)},error:function(){s([])}})}):this.source=this.options.source},search:function(e,t){return e=null!=e?e:this.element.val(),this.term=this.element.val(),e.length<this.options.minLength?this.close(t):(clearTimeout(this.closing),this._trigger("search",t)!==!1?this._search(e):void 0)},_search:function(e){this.pending++,this.element.addClass("ui-autocomplete-loading"),this.source({term:e},this._response())},_response:function(){var e=this,t=++i;return function(n){t===i&&e.__response(n),e.pending--,e.pending||e.element.removeClass("ui-autocomplete-loading")}},__response:function(e){!this.options.disabled&&e&&e.length?(e=this._normalize(e),this._suggest(e),this._trigger("open")):this.close()},close:function(e){clearTimeout(this.closing),this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.deactivate(),this._trigger("close",e))},_change:function(e){this.previous!==this.element.val()&&this._trigger("change",e,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:e.map(t,function(t){return"string"==typeof t?{label:t,value:t}:e.extend({label:t.label||t.value,value:t.value||t.label},t)})},_suggest:function(t){var i=this.menu.element.empty().zIndex(this.element.zIndex()+1);this._renderMenu(i,t),this.menu.deactivate(),this.menu.refresh(),i.show(),this._resizeMenu(),i.position(e.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(new e.Event("mouseover"))},_resizeMenu:function(){var e=this.menu.element;e.outerWidth(Math.max(e.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(t,i){var n=this;e.each(i,function(e,i){n._renderItem(t,i)})},_renderItem:function(t,i){return e("<li></li>").data("item.autocomplete",i).append(e("<a></a>").text(i.label)).appendTo(t)},_move:function(e,t){return this.menu.element.is(":visible")?this.menu.first()&&/^previous/.test(e)||this.menu.last()&&/^next/.test(e)?(this.element.val(this.term),void this.menu.deactivate()):void this.menu[e](t):void this.search(null,t)},widget:function(){return this.menu.element},_keyEvent:function(e,t){this.isMultiLine&&!this.menu.element.is(":visible")||(this._move(e,t),t.preventDefault())}}),e.extend(e.ui.autocomplete,{escapeRegex:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},filter:function(t,i){var n=new RegExp(e.ui.autocomplete.escapeRegex(i),"i");return e.grep(t,function(e){return n.test(e.label||e.value||e)})}})}(jQuery),function(e){e.widget("ui.menu",{_create:function(){var t=this;this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role:"listbox","aria-activedescendant":"ui-active-menuitem"}).click(function(i){e(i.target).closest(".ui-menu-item a").length&&(i.preventDefault(),t.select(i))}),this.refresh()},refresh:function(){var t=this,i=this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","menuitem");i.children("a").addClass("ui-corner-all").attr("tabindex",-1).mouseenter(function(i){t.activate(i,e(this).parent())}).mouseleave(function(){t.deactivate()})},activate:function(e,t){if(this.deactivate(),this.hasScroll()){var i=t.offset().top-this.element.offset().top,n=this.element.scrollTop(),s=this.element.height();0>i?this.element.scrollTop(n+i):i>=s&&this.element.scrollTop(n+i-s+t.height())}this.active=t.eq(0).children("a").addClass("ui-state-hover").attr("id","ui-active-menuitem").end(),this._trigger("focus",e,{item:t})},deactivate:function(){this.active&&(this.active.children("a").removeClass("ui-state-hover").removeAttr("id"),this._trigger("blur"),this.active=null)},next:function(e){this.move("next",".ui-menu-item:first",e)},previous:function(e){this.move("prev",".ui-menu-item:last",e)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},move:function(e,t,i){if(!this.active)return void this.activate(i,this.element.children(t));var n=this.active[e+"All"](".ui-menu-item").eq(0);n.length?this.activate(i,n):this.activate(i,this.element.children(t))},nextPage:function(t){if(this.hasScroll()){if(!this.active||this.last())return void this.activate(t,this.element.children(".ui-menu-item:first"));var i=this.active.offset().top,n=this.element.height(),s=this.element.children(".ui-menu-item").filter(function(){var t=e(this).offset().top-i-n+e(this).height();return 10>t&&t>-10});s.length||(s=this.element.children(".ui-menu-item:last")),this.activate(t,s)}else this.activate(t,this.element.children(".ui-menu-item").filter(!this.active||this.last()?":first":":last"))},previousPage:function(t){if(this.hasScroll()){if(!this.active||this.first())return void this.activate(t,this.element.children(".ui-menu-item:last"));var i=this.active.offset().top,n=this.element.height(),s=this.element.children(".ui-menu-item").filter(function(){var t=e(this).offset().top-i+n-e(this).height();return 10>t&&t>-10});s.length||(s=this.element.children(".ui-menu-item:first")),this.activate(t,s)}else this.activate(t,this.element.children(".ui-menu-item").filter(!this.active||this.first()?":last":":first"))},hasScroll:function(){return this.element.height()<this.element[e.fn.prop?"prop":"attr"]("scrollHeight")},select:function(e){this._trigger("selected",e,{item:this.active})}})}(jQuery);
/* <<< file end: js/lib/jquery-ui/jquery.ui.autocomplete.min.js */

//# map link was there [jquery.ui.autocomplete.min.js.map]
/* >>> file start: js/core/angular/autocomplete.js */
//= require js/lib/jquery-ui/jquery.ui.position.min.js
//= require js/lib/jquery-ui/jquery.ui.autocomplete.min.js
angular.module("LJ.Autocomplete",[]).directive("ljAutocomplete",["$parse","$window",function(e,t){return{restrict:"A",link:function(o,l,n){function u(e,t){var o,u,c,r,a,d=e.term,v=LJ.DOM.getSelection(l).start,A=d.slice(0,v),j=d.slice(v);return j.length&&","!==j.charAt(0)?void t():(A=A.trim(),u=A.lastIndexOf(","),-1===u?(r=A,p=[]):(r=A.slice(u+1).trim(),p=A.slice(0,u).split(/\,\s*/)),j.length?(j=j.slice(1).trim(),m=j.split(/\,\s*/),""===m[m.length-1]&&m.pop()):m=[],o=p.concat(m),r.length<f.minLength?void t():void(n.ljAutocompleteAdditionalFiltering?(r=r.toLowerCase(),a=r.split(/\s/g),a.forEach(function(e){c=c&&0!==c.length?c.filter(function(t){return-1!==t.toLowerCase().indexOf(e)}):i(s,o,e)}),t($?c.slice(0,$-1):c)):(r=r.toLowerCase(),c=i(s,o,r),t($?c.slice(0,$-1):c))))}function i(e,t,o){var l,n;return n=e.filter(function(e){return-1!==e.toLowerCase().indexOf(o)}),l=t.map(function(e){return e.toLowerCase()}),n=n.filter(function(e){return-1===l.indexOf(e.toLowerCase())})}function c(e,t){return n.ljAutocompleteWatchFocus&&o.$emit("focus",t.item),!1}function r(e,t){e.preventDefault(),v?(p.push(t.item.value),l.val(p.concat(m).join(", ")+", "),l.trigger("input"),0===m.length?LJ.DOM.setCursor(l,"end"):LJ.DOM.setCursor(l,p.join(", ").length)):(l.val(t.item.value),l.trigger("input")),o.$emit("select",t.item.value)}var a,s,p,m,f,d,v,A,j,h,$=null,g=LJ.Function.throttle(function(){return l.autocomplete("close")},500);if(o.$on("$destroy",function(){n.ljAutocompleteCloseOnResize&&t.removeEventListener("resize",g),l.autocomplete("destroy")}),a={delay:50,minLength:1,focus:c,select:r,source:u},n.ljAutocompleteOptions&&(f=o.$eval(n.ljAutocompleteOptions)),n.ljAutocompleteLimit&&($=o.$eval(n.ljAutocompleteLimit)),f=angular.extend(a,f||{}),v=n.hasOwnProperty("ljAutocompleteMultiple"),n.ljAutocompleteCustomItemRender?l.autocomplete(f).data("autocomplete")._renderItem=o.$eval(n.ljAutocompleteCustomItemRender):l.autocomplete(f),n.ljAutocompleteCloseOnResize&&t.addEventListener("resize",g),v||(A=function(e){44===e.which&&e.preventDefault()},l.on("keypress",A)),n.ljAutocompleteSubmit&&(h=e(n.ljAutocompleteSubmit),j=function(e){13!==e.which||e.isDefaultPrevented()||(e.preventDefault(),o.$apply(function(){h(o,{$value:l.val()})}))},l.on("keydown",j),o.$on("$destroy",function(){l.off("keydown",j),l.off("keypress",A)})),n.ljAutocompleteDisabled&&o.$watch(function(){return o.$eval(n.ljAutocompleteDisabled)},function(e){d=Boolean(e),l.autocomplete("option","disabled",d),d&&l.autocomplete("close")}),n.ljAutocompleteSelect&&!v){var L=e(n.ljAutocompleteSelect);o.$on("select",function(){o.$apply(function(){L(o,{$value:l.val()})})})}if(n.ljAutocompleteWatchFocus){var w=e(n.ljAutocompleteWatchFocus);o.$on("focus",function(e,t){o.$apply(function(){w(o,{$value:t})})})}o.$watch(function(){return d?void 0:o.$eval(n.ljAutocomplete)},function(e){!d&&e&&(s=n.ljAutocompleteProp?e.map(LJ.Function.get(n.ljAutocompleteProp)):e,l.is(":focus")&&l.autocomplete("search"))},!0)}}}]);
/* <<< file end: js/core/angular/autocomplete.js */

//# map link was there [autocomplete.js.map]
/* >>> file start: js/core/angular/ref.js */
!function(e){return e}(),function(){"use strict";angular.module("LJ.Ref",[]).factory("Ref",function(){function e(e,n){return f[e]?void console.error("Ref element with id `%s` has been registered before.",e):void(f[e]=n)}function n(e){f[e]&&delete f[e]}function o(e){var n=f[e];return n||console.error("Ref `%s` not found.",e),n}function r(e,n){"undefined"==typeof n&&(n={});var r=o(e),f=angular.element("html, body");if(!r)return void console.error("Could not scroll to the ref `%s` that has not been already defined.",e);var l=r.offset().top;n.onlyUp&&angular.element(window).scrollTop()<=l||n.onlyOutOfScreen&&!t(r)||(n.toParent&&(f=r.parent(),l=0),f.animate({scrollTop:l}))}function t(e){var n=angular.element(window),o=n.scrollTop(),r=o+n.height(),t=e.offset().top;return t>r-100||o>t}var f={};return{add:e,remove:n,get:o,scrollTo:r}}).directive("ljRef",["Ref",function(e){return{restrict:"A",scope:!0,link:function(n,o,r){var t=r.ljRef;e.add(t,o),n.$on("$destroy",function(){e.remove(t)})}}}])}();
/* <<< file end: js/core/angular/ref.js */

//# map link was there [ref.js.map]
/* >>> file start: js/core/angular/bubble.js */
//= require js/core/angular/ref.js
Site.page.template['Widgets/ljBubble.tmpl'] = '<div\n    class=\"\n        b-popup\n        bubble-node\n        b-popup-withclosecontrol\n        b-bubble-{{bubble.name}}\n        \"\n    ng-show=\"show\"\n    lj-switch-off=\"show\"\n    lj-switch-off-action=\"bubble.close()\"\n    lj-switch-off-ignore-sticky=true\n    ng-style=\"{ left: position.x, top: position.y, visibility: visibility }\"\n    ng-class=\"{\n        \'b-popup-noclosecontrol\': !bubble.options.closeControl\n    }\"\n    lj-switch-off-skip>\n    <div class=\"b-popup-outer\">\n        <div class=\"b-popup-inner\">\n            <i class=\"i-popup-arr\" ng-class=\"arrowClass()\">\n                <i class=\"i-popup-arr-brdr-outer\">\n                    <i class=\"i-popup-arr-brdr-inner\">\n                        <i class=\"i-popup-arr-bg\"></i>\n                    </i>\n                </i>\n            </i>\n            <div ng-include src=\"template\"></div>\n            <i class=\"i-popup-close\" ng-click=\"bubble.close()\"></i>\n        </div>\n    </div>\n</div>\n';
Site.page.template['angular/confirm.bubble.ng.tmpl'] = '<div class=\"b-popup-content b-popup-options-centered\">\n  <div class=\"b-popup-content-header\">\n    <span>{{ bubble.options.header }}</span>\n  </div>\n  <div class=\"b-popup-content-confirm\" ng-bind-html=\"bubble.options.text\"></div>\n  <div class=\"b-popup-submit-options\">\n    <button class=\"b-popup-btn b-flatbutton b-flatbutton-simple\" ng-click=\"bubble.options.confirm()\">{{ bubble.options.yes }}</button>\n    <button class=\"b-popup-cancel b-flatbutton b-flatbutton-simple b-flatbutton-neutral\" ng-click=\"bubble.close()\">{{ bubble.options.no }}</button>\n  </div>\n</div>\n';
//= require_ml confirm.bubble.yes
//= require_ml confirm.bubble.no
!function(){"use strict";function e(e,o,t,n,r){return{scope:!0,link:function(i,l,a){function u(){var e=i.arrow.vertical,o=i.arrow.horizontal,t=L.aside,r=O.innerWidth<=650;i.visibility="hidden",L.keepInitialWidth&&!L.widthSaved&&(L.widthSaved=!0,j.width(j.width())),d(),p()&&!r&&(i.arrow.vertical="b"===e?f("alwaysTop")?"b":"t":f("alwaysBottom")?"t":"b",d(),h()&&!f("alwaysTop")&&(i.arrow.vertical="t",d())),v()&&!r&&(i.arrow.horizontal="l"===o?f("alwaysRight")||m()?"l":"r":f("alwaysLeft")||w()?"r":"l"),!r&&v()&&i.arrow.horizontal===o&&s()&&(L.aside=!0),r||i.arrow.horizontal===o&&i.arrow.vertical===e&&L.aside===t?i.visibility="visible":n(c)}function c(){return d(),v()&&s()?(L.aside=!0,i.$apply(),void c()):v()&&!f("aside")&&i.arrow.horizontal?(i.arrow.horizontal="",void c()):void(i.visibility="visible")}function s(){return!f("aside")&&f("tryAsideIfNoHorizSpace")}function f(e){return i.bubble.options[e]||L[e]}function d(){var o=e.node||l,t=o.offset().left+Math.floor(o.outerWidth()/2),n=i.bubble.options.forceX||0,r=i.bubble.options.forceY||0;f("aside")?(i.position.x="r"===i.arrow.horizontal?o.offset().left-j.outerWidth()-H.outerWidth()+n:o.offset().left+o.outerWidth()+H.outerWidth()+n,i.position.y=o.offset().top-H.position().top+(o.outerHeight()-H.outerHeight())/2+r):(i.position.x=i.arrow.horizontal?t-H.position().left-Math.floor(H.outerWidth()/2)-2+n:t-j.outerWidth()/2-Math.floor(H.outerWidth()/4)-2+n,i.position.y="t"===i.arrow.vertical?o.offset().top+o.outerHeight()+H.outerHeight()+r:o.offset().top-H.outerHeight()-j.outerHeight()+r)}function b(){i.position.x=-9999}function p(){return h()?!0:i.position.y+j.outerHeight()>O.scrollTop()+O.outerHeight()}function h(){return i.position.y<O.scrollTop()}function v(){return m()||w()}function m(){return i.position.x<O.scrollLeft()}function w(){return i.position.x+j.outerWidth()>O.scrollLeft()+O.outerWidth()}function y(o){o.preventDefault(),e.current!==L.name&&n(function(){e.open(L.name)})}function g(){$(),J&&(C=n(e.close,J))}function $(){n.cancel(C)}function z(){var o=L.name,t=e.current;o===t&&($(),e.close(),i.$apply())}function W(){i.show&&n(x)}var C,L=o(a.ljBubble)(i),B=L.name,j=t(r.get("ljBubble.tmpl"))(i),x=LJ.Function.throttle(u,50),H=j.find(".i-popup-arr"),O=angular.element(window),S=L.eventType||"click",J=Number(L.autoClose||0);i.show=!1,e._register(B,L),i.template=L.template||B+".html",i.bubble={name:B,close:e.close,options:e.options(B)},i.clear=function(){i.arrow={vertical:L.arrowInitialVertical||"t",horizontal:L.arrowInitialHorizontal||"l"}},i.position={x:-9999,y:-9999},i.visibility="hidden",i.arrowClass=function(){var e=i.bubble.options,o=i.arrow.vertical,t=i.arrow.horizontal;return e.aside||L.aside?"i-popup-arr"+t+o:"i-popup-arr"+o+t},i.$watch(function(){return e.current},function(e){b(),n(function(){i.show=e===B,e&&i.show&&(i.clear(),n(x))})},!0),L.disableClick||l.on(S,y),L.disableResizeListener||O.on("resize",W),L.recalculateOnOrientationChange&&O.on("orientationchange",function(){W(),O.on("resize",W),n(function(){O.off("resize",W)},1e3)}),L.recalculateOnScroll&&O.on("scroll",W),L.closeOnScroll&&O.on("scroll",z),angular.element("body").append(j),l.on("mouseleave",g),j.on("mouseenter",$),j.on("mouseleave",g),i.clear(),i.$on("$destroy",function(){l.off(S,y),O.off("resize",W),O.off("scroll",W),O.off("scroll",e.close),l.off("mouseleave",g),j.off("mouseenter",$),j.off("mouseleave",g),e._unregister(B),j.remove()})}}}function o(e,o,n,r,i,l){var a={},u={};return a.current=null,a.node=null,a.register=function(){function t(t,i){var a,u,c;return t&&t.name&&t.template?(a=t.name,t.disableClick=!0,r[a]?(r[a].count+=1,n.bind(null,a)):(u=angular.element("<div />").attr("lj-bubble",angular.toJson(t)),c="undefined"==typeof i,c&&(i=e.$new(!0)),u.appendTo("body"),o(u)(i),r[a]={count:1,node:u,scope:i,isScopeCreated:c},n.bind(null,a))):void l.error("Incorrect bubble options. You should provide name and template.",t)}function n(e){var o=r[e];o&&(o.count-=1,0===o.count&&(o.isScopeCreated||o.scope.$destroy(),o.node.remove(),delete r[e]))}var r={};return t}(),a.exists=function(e){return u.hasOwnProperty(e)},a._register=function(e,o){var t;if(u.hasOwnProperty(e))throw"Warning: bubble with name "+e+" has been registered before!";t=angular.isDefined(o)?angular.copy(o):{},t=angular.extend({closeControl:!0},t),u[e]=Object.create(t)},a._unregister=function(e){delete u[e],a.current===e&&(a.current=null)},a.confirm=function(e){function o(){i.scrollBy(0,1),i.scrollBy(0,-1)}var t=LJ.ml("confirm.bubble.yes"),n=LJ.ml("confirm.bubble.no"),l={closeControl:!1,confirm:e.confirm,header:e.header,text:e.text,yes:e.yes||t,no:e.no||n};a.open(e.id,l),r(o),r(o,100),r(o,200),r(o,300)},a.open=function(o,r,i){return u.hasOwnProperty(o)?(r instanceof jQuery&&(i=r,r={}),angular.isString(r)&&(i=n.get(r),r={}),angular.isObject(r)&&a.options(o,r),i instanceof jQuery&&(a.node=i),angular.isString(i)&&(a.node=n.get(i)),a.current=o,e.$broadcast("bubble:open",o,r,i),e.$broadcast("bubble:open:"+o,o,r,i),void angular.element("body").addClass(t)):void l.error("Bubble `"+o+"` can't be opened, it has not been registered yet.")},a.close=function(){var o,n=a.current,r=u[n];e.$broadcast("bubble:close",n,r,a.node),e.$broadcast("bubble:close:"+n,n,r,a.node);for(o in r)r.hasOwnProperty(o)&&delete r[o];a.current=null,a.node=null,angular.element("body").removeClass(t)},a.options=function(e,o){return"undefined"==typeof o||o===u[e]?u[e]:void angular.copy(o,u[e])},a}angular.module("LJ.Bubble",["LJ.Templates","LJ.Directives","LJ.Ref"]),angular.module("LJ.Bubble").factory("Bubble",o).directive("ljBubble",e);var t="p-openpopup";e.$inject=["Bubble","$parse","$compile","$timeout","$templateCache"],o.$inject=["$rootScope","$compile","Ref","$timeout","$window","$log"]}();
/* <<< file end: js/core/angular/bubble.js */

//# map link was there [bubble.js.map]
/* >>> file start: js/core/angular/options.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};angular.module("LJ.Options",[]).factory("Options",[function(){return{create:function(t){function n(n,o){"undefined"==typeof o?angular.extend(t,n):t[n]=o}function o(n){return t[n]}function e(){return t}if("undefined"==typeof t&&(t={}),"object"!==("undefined"==typeof t?"undefined":_typeof(t)))throw new TypeError("Options should be an object.");return{set:n,get:o,raw:e}}}}]);
/* <<< file end: js/core/angular/options.js */

//# map link was there [options.js.map]
/* >>> file start: js/core/angular/users.js */
//= require js/core/angular/api.js
//= require js/core/angular/options.js
!function(e){return e}(),function(){"use strict";angular.module("Users",["LJ.Api","LJ.Options"]).factory("Relations",["$q","$timeout","UsersCache",function(e,n,r){function t(t,i,u){var a=e.defer(),s={addFriend:{is_invite_sent:!0},removeFriend:{is_friend:!1},subscribe:{is_subscribedon:!0},unsubscribe:{is_subscribedon:!1},join:{is_invite_sent:!0},leave:{is_member:!1},setBan:{is_banned:!0},setUnban:{is_banned:!1}},o={addFriend:{is_invite_sent:!1},removeFriend:{is_friend:!0},subscribe:{is_subscribedon:!1},unsubscribe:{is_subscribedon:!0},join:{is_invite_sent:!1},leave:{is_member:!0},setBan:{is_banned:!1},setUnban:{is_banned:!0}},c=angular.copy(r.get(t)||{});return angular.isUndefined(u)&&(u={}),u.wait||r.update(t,s[i]||{}),LJ.Event.trigger("relations.change",{username:t,action:i,callback:function(e){n(function(){if(e.error)return u.wait||r.update(t,angular.extend(o[i],c)),void a.reject(e.error.message);var n=LJ.Object.pick(e,"is_banned","is_friend","is_member","is_subscriber","is_subscribedon","is_friend_of","is_invite_sent");r.update(t,n),a.resolve(e)})}}),a.promise}function i(e,n,i){var u=t(e,n?"subscribe":"unsubscribe",i);return n||u.then(function(){r.update(e,{filtermask:0})}),u}function u(e,n,r){return t(e,n?"addFriend":"removeFriend",r)}function a(e,n,r){return t(e,n?"join":"leave",r)}function s(e,n,r){return t(e,n?"setBan":"setUnban",r)}function o(e,n,r){return t(e,n?"banEverywhere":"unbanEverywhere",r)}return{toggleFriend:u,toggleSubscription:i,toggleMember:a,toggleBan:s,toggleBanEverywhere:o}}]).factory("Mask",function(){function e(e){return e>>>0}var n={};return n.change=function(n,r){var t=r.add,i=r.remove;return angular.isDefined(t)&&(angular.isArray(t)||(t=[t]),n=t.reduce(function(n,r){return e(n|Math.pow(2,r))},n)),angular.isDefined(i)&&(angular.isArray(i)||(i=[i]),n=i.reduce(function(n,r){var t=Math.pow(2,32)-1-Math.pow(2,r);return e(n&t)},n)),n},n.check=function(e,n){var r=Math.pow(2,n);return Boolean(e&r)},n}).factory("UsersCache",["$q","$cacheFactory","Options",function(e,n,r){function t(e){if(!angular.isUndefined(e)){var n=l.get(f.get("journal"))||{},r=e;return angular.isArray(e)||(e=[e]),e.forEach(function(e){if(e&&angular.isObject(e)&&!angular.isUndefined(e.username)){var r=e.display_username||e.username,t=n[r];n[r]=t?angular.extend(t,e):e}}),l.put(f.get("journal"),n),r}}function i(e){var n=l.get(f.get("journal"));return Boolean(n[e])}function u(e){var n;if(angular.isString(e))return n=l.get(f.get("journal")),n&&n[e]?n[e]:null;if(angular.isFunction(e))return s(e);if(angular.isUndefined(e))return s();throw new TypeError("Incorrect argument passed.")}function a(e){var n=l.get(f.get("journal"));return n||angular.isObject(n)?Object.keys(n).reduce(function(r,t){return String(n[t].id)===String(e)?n[t]:r},null):null}function s(e){var n,r=l.get(f.get("journal")),t=[];for(n in r)if(r.hasOwnProperty(n)){if(e&&!e(r[n]))continue;t.push(r[n])}return t}function o(e,n){var r=u(e)||{username:e};return angular.extend(r,n),t(r),r}var c,l=n("users"),f=r.create({journal:LJ.get("remoteUser")});return c={add:t,update:o,set:f.set,get:u,getById:a,exists:i}}]).factory("Users",["$q","$timeout","Api","Mask","UsersCache","Options",function(e,n,r,t,i,u){function a(e){return k[C.get("type")][e]}function s(e){return"subscriptions"===C.get("type")?Boolean(e.is_subscribedon):!0}function o(e,n){return angular.isUndefined(n)?e[c()]||1:void(e[c()]=n)}function c(){return"subscriptions"===C.get("type")?"filtermask":"groupmask"}function l(e,n,t){return r.call("user.get",{target:e,fields:n},t).then(function(e){var n=e.user;return i.add(n),n})}function f(e,n,t){return r.call("user.get",{targetid:e,fields:n},t).then(function(e){var n=e.user;return i.add(n),n})}function d(e,n){return r.call("relations.list_friends",{journal:C.get("journal"),fields:e},n).then(_("is_friend"))}function g(e){return r.call("groups.list_users",{journal:C.get("journal"),fields:e}).then(function(e){return i.add(e.users),e})}function p(e){return r.call("relations.list_subscriptions",{journal:C.get("journal"),fields:e}).then(_("is_subscribedon"))}function b(e){return r.call("relations.list_banned",{journal:C.get("journal"),fields:e}).then(_("is_banned"))}function _(e){return function(n){var r=n.users;return r.forEach(LJ.Function.set(e,!0)),i.add(r),r}}function v(e){return r.call("relations."+e+"_count").then(function(e){return e.count})}function h(n){return angular.isArray(n)||(n=[n]),0===n.length?e.reject("You should provide users to sync."):r.call(a("update"),{users:n,journal:C.get("journal")}).then(function(e){return i.add(e.users),e})}function m(e,n){var r=i.get(e);return r?t.check(o(r),n):!1}function j(e){return e.filter(i.exists).map(i.get).filter(s)}function y(e){var n=(e.filter||"").toLowerCase(),r=i.get(function(r){return s(r)&&t.check(o(r),e.id)?!n||-1!==r.display_username.toLowerCase().indexOf(n):!1});return e.limit&&(r=r.slice(0,e.limit)),r}function U(e){var n=(e.filter||"").toLowerCase(),r=i.get(function(r){return s(r)?t.check(o(r),e.id)?!1:!n||-1!==r.display_username.toLowerCase().indexOf(n):!1});return e.limit&&(r=r.slice(0,e.limit)),r}function w(e,n){angular.isArray(n)||(n=[n]);var r;return r="subscriptions"===C.get("type")?j(n):n.map(function(e){return i.get(e)||{username:e}}),r.forEach(function(n){o(n,t.change(o(n),{add:e}))}),h(r)}function L(e,n,r){angular.isArray(n)||(n=[n]);var i=j(n);return i.forEach(function(n){o(n,t.change(o(n),{remove:e}))}),r&&r.silent?void 0:h(i)}function E(e,n){return i.update(e,{alias:n}),r.call("user.alias_set",{target:e,alias:n})}function F(e){return function(n,r){return n[e].toLowerCase().localeCompare(r[e].toLowerCase())}}function O(){var e,n=C.get("journal");C.set.apply(null,arguments),e=C.get("journal"),e!==n&&i.set("journal",e)}var k={friends:{read:"relations.list_friends",readOne:"relations.get_friend",update:"groups.update_users"},subscriptions:{read:"relations.list_subscriptions",readOne:"relations.get_subscription",update:"filters.update_users"}},C=u.create({type:"friends",journal:LJ.get("remoteUser")});return{USERHEAD_FIELDS:{alias:1,journal_url:1,profile_url:1,userhead_url:1,is_invisible:1,journaltype:1},set:O,get:C.get,Cache:i,fetchUser:l,fetchUserById:f,fetchBanned:b,fetchFriends:d,fetchGroupUsers:g,fetchSubscriptions:p,fetchCount:v,sync:h,alias:E,isUserInGroup:m,getExisting:j,fromGroup:y,outOfGroup:U,addToGroup:w,removeFromGroup:L,comparator:F}}])}();
/* <<< file end: js/core/angular/users.js */

//# map link was there [users.js.map]
/* >>> file start: js/lib/textinputs_jquery.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e){function t(e,t){var n=_typeof(e[t]);return"function"===n||!("object"!=n||!e[t])||"unknown"==n}function n(e,t){return _typeof(e[t])!=g}function o(e,t){return!("object"!=_typeof(e[t])||!e[t])}function r(e){window.console&&window.console.log&&window.console.log("RangyInputs not supported in your browser. Reason: "+e)}function a(e,t,n){return 0>t&&(t+=e.value.length),("undefined"==typeof n?"undefined":_typeof(n))==g&&(n=t),0>n&&(n+=e.value.length),{start:t,end:n}}function c(e,t,n){return{start:t,end:n,length:n-t,text:e.value.slice(t,n)}}function l(){return o(document,"body")?document.body:document.getElementsByTagName("body")[0]}var i,s,u,d,f,p,v,y,m,g="undefined";e(document).ready(function(){function h(e,t){return function(){var n=this.jquery?this[0]:this,o=n.nodeName.toLowerCase();if(1==n.nodeType&&("textarea"==o||"input"==o&&"text"==n.type)){var r=[n].concat(Array.prototype.slice.call(arguments)),a=e.apply(this,r);if(!t)return a}return t?this:void 0}}var x=document.createElement("textarea");if(l().appendChild(x),n(x,"selectionStart")&&n(x,"selectionEnd"))i=function T(e){var t=e.selectionStart,T=e.selectionEnd;return c(e,t,T)},s=function b(e,t,n){var b=a(e,t,n);e.selectionStart=b.start,e.selectionEnd=b.end},m=function(e,t){t?e.selectionEnd=e.selectionStart:e.selectionStart=e.selectionEnd};else{if(!(t(x,"createTextRange")&&o(document,"selection")&&t(document.selection,"createRange")))return l().removeChild(x),void r("No means of finding text input caret position");i=function w(e){var t,n,o,r,a=0,w=0,l=document.selection.createRange();return l&&l.parentElement()==e&&(o=e.value.length,t=e.value.replace(/\r\n/g,"\n"),n=e.createTextRange(),n.moveToBookmark(l.getBookmark()),r=e.createTextRange(),r.collapse(!1),n.compareEndPoints("StartToEnd",r)>-1?a=w=o:(a=-n.moveStart("character",-o),a+=t.slice(0,a).split("\n").length-1,n.compareEndPoints("EndToEnd",r)>-1?w=o:(w=-n.moveEnd("character",-o),w+=t.slice(0,w).split("\n").length-1))),c(e,a,w)};var S=function(e,t){return t-(e.value.slice(0,t).split("\r\n").length-1)};s=function R(e,t,n){var R=a(e,t,n),o=e.createTextRange(),r=S(e,R.start);o.collapse(!0),R.start==R.end?o.move("character",r):(o.moveEnd("character",S(e,R.end)),o.moveStart("character",r)),o.select()},m=function(e,t){var n=document.selection.createRange();n.collapse(t),n.select()}}l().removeChild(x),d=function k(e,t,n,o){var k;t!=n&&(k=e.value,e.value=k.slice(0,t)+k.slice(n)),o&&s(e,t,t)},u=function(e){var t=i(e);d(e,t.start,t.end,!0)},y=function(e){var t,n=i(e);return n.start!=n.end&&(t=e.value,e.value=t.slice(0,n.start)+t.slice(n.end)),s(e,n.start,n.start),n.text};var E=function(e,t,n,o){var r=t+n.length;switch(o="string"==typeof o?o.toLowerCase():""){case"collapsetostart":s(e,t,t);break;case"collapsetoend":s(e,r,r);break;case"select":s(e,t,r)}};f=function(e,t,n,o){var r=e.value;e.value=r.slice(0,n)+t+r.slice(n),"boolean"==typeof o&&(o=o?"collapseToEnd":""),E(e,n,t,o)},p=function(e,t,n){var o=i(e),r=e.value;e.value=r.slice(0,o.start)+t+r.slice(o.end),E(e,o.start,t,n||"collapseToEnd")},v=function _(e,t,n,o){("undefined"==typeof n?"undefined":_typeof(n))==g&&(n=t);var r=i(e),a=e.value;e.value=a.slice(0,r.start)+t+r.text+n+a.slice(r.end);var _=r.start+t.length;E(e,_,r.text,o||"select")},e.fn.extend({getSelection:h(i,!1),setSelection:h(s,!0),collapseSelection:h(m,!0),deleteSelectedText:h(u,!0),deleteText:h(d,!0),extractSelectedText:h(y,!1),insertText:h(f,!0),replaceSelectedText:h(p,!0),surroundSelectedText:h(v,!0)})})}(jQuery);
/* <<< file end: js/lib/textinputs_jquery.js */

//# map link was there [textinputs_jquery.js.map]
/* >>> file start: js/core/angular/ljTour.js */
//= require js/core/angular/bubble.js
//= require js/core/angular/api.js
//= require js/core/angular/ref.js
Site.page.template['angular/bubbletour.ng.tmpl'] = '<div class=\"b-helptour\">\n    <header class=\"b-helptour-header\" ng-hide=\"current.length < 2\">\n        <span class=\"b-helptour-stage\">\n            <span class=\"b-helptour-stage-prev\" ng-bind=\"index\"></span>\n            <span class=\"b-helptour-stage-hr\">/</span>\n            <span class=\"b-helptour-stage-next\" ng-bind=\"current.length\"></span>\n        </span>\n    </header>\n    <div class=\"b-helptour-content b-text\">\n        <span lj-ml=\"{{step.tourText}}\" lj-ml-dynamic=\"index\"></span>\n    </div>\n    <footer class=\"b-helptour-footer\">\n        <ul class=\"b-helptour-controls b-helptour-state\">\n            <li class=\"b-helptour-control b-helptour-control-skip\"\n                ng-hide=\"step.tourNoSkip || index === current.length\">\n                <a class=\"b-helptour-skip-link b-helptour-link\" href=\"javascript:void(0)\" lj-ml=\"tour.steps.skip\"\n                   ng-click=\"end()\"></a>\n            </li>\n        </ul>\n        <ul class=\"b-helptour-controls b-helptour-step\">\n            <li class=\"b-helptour-control b-helptour-control-prev\"\n                ng-hide=\"step.tourNoBack || index === 1\">\n                <a class=\"b-helptour-prev-link b-helptour-link\" href=\"javascript:void(0)\" lj-ml=\"tour.steps.prev\"\n                   ng-click=\"prev()\"></a>\n            </li>\n            <li class=\"b-helptour-control b-helptour-control-next\"\n                ng-hide=\"step.tourNoNext || index === current.length\">\n                <a class=\"b-helptour-next-link b-helptour-link\" href=\"javascript:void(0)\" lj-ml=\"tour.steps.next\"\n                   ng-click=\"next()\"></a>\n            </li>\n            <li class=\"b-helptour-control b-helptour-control-done\"\n                ng-hide=\"index !== current.length\">\n                <a class=\"b-helptour-done-link b-helptour-link\" href=\"javascript:void(0)\" lj-ml=\"tour.steps.done\"\n                   ng-click=\"end()\"></a>\n            </li>\n        </ul>\n    </footer>\n</div>\n';
LJ.injectStyle('/* >>> file start: stc/tour/ljtour.css */\n.b-bubble-tour{z-index:5001}.b-bubble-tour .b-popup-inner{padding:0}.b-helptour{width:350px}.b-helptour-header{margin:0 0 .3em;padding:10px 16px 0}.b-helptour-footer:after,.b-helptour-header:after{display:table;width:100%;clear:both;content:\"\"}.b-helptour-stage-title{margin-right:10px}.b-helptour P:first-child{margin:0 0 .3em}.b-helptour-content{margin:10px 0 .6em;padding:0 16px}.b-helptour-content P{margin:.3em 0}.b-helptour-content LI,.b-helptour-content UL{margin:0;padding:0;list-style:none}.b-helptour-footer{padding:6px 15px;border-radius:0 0 5px 5px;background-color:#DAE3E6}.b-helptour-controls{margin:0;padding:0}.b-helptour-state{float:left}.b-helptour-step{float:right}.b-helptour-control{display:inline;margin-right:4px;cursor:pointer}.b-helptour-control-done:after{display:inline-block;content:\"\";width:14px;height:12px;background-image:url(/img/icons/unit_v3.png?v=42878);background-repeat:no-repeat;background-position:0 -223px}.b-helptour-control-done A{padding-left:8px}.b-helptour-control-done A:link,.b-helptour-control-done A:visited,.b-helptour-control-next A:link,.b-helptour-control-prev A:link{color:#00A3D9}.b-helptour-control-skip A:link,.b-helptour-control-skip A:visited{color:#7A9199}.b-helptour-control A{font-size:13px}.b-helptour-control A:active,.b-helptour-control A:focus,.b-helptour-control A:hover{color:#0086b3}.p-ljtour .b-lenta .l-flatslide-container{position:static}.p-ljtour .l-flatslide-menu-controls{position:absolute;top:auto!important}.p-ljtour.p-openpopup .w-cs{overflow:visible}@media all and (max-width:650px){.p-ljtour.p-openpopup .b-fader{display:none!important}.b-bubble-tour{display:none}}\n/* <<< file end: stc/tour/ljtour.css */\n\n/*# sourceMappingURL=ljtour.css.map */\n');
//= require_ml tour.steps.prev
//= require_ml tour.steps.next
//= require_ml tour.steps.skip
//= require_ml tour.steps.done
!function(e){return e}(),function(e){"use strict";angular.module("LJ.Tour",["LJ.Bubble","LJ.Templates","LJ.Directives","LJ.Api"]).factory("Tour",["Api",function(e){var t={};return t.queue={},t.checkAvailable=function(){var n=Object.keys(t.queue);return e.call("tour.is_available",{tours:n}).then(function(e){n.forEach(function(n){0===e.states[n]&&delete t.queue[n]})})},t.setDone=function(t){return e.call("tour.set_done",{tour:t})},t}]).directive("ljTour",["$timeout","$document","Bubble","Ref","Tour",function(t,n,r,u,o){return{scope:!0,link:function(i){function c(){e("body").find("[data-tour]").each(function(){var t=e(this),n=angular.extend({element:t},t.data());Array.isArray(L[n.tour])||(L[n.tour]=[]),n.tourStepDiscardDuplicates&&L[n.tour].some(function(e){return e.tourStep===n.tourStep})||L[n.tour].push(n)})}function a(){var e=Object.keys(L)[0],t=L[e];i.current=t.filter(function(e){return b(e)&&v(e)}).sort(function(e,t){return e.tourStep>t.tourStep?1:e.tourStep<t.tourStep?-1:0}),i.current.forEach(function(e){u.add(e.tour+e.tourStep,e.element)}),delete L[e],g(i.current[0])?f():l()}function l(){Object.keys(L).length&&a()}function s(){r.close(),O.fadeOut(),angular.element("body").removeClass("p-ljtour").off("ljsale-load",y),o.setDone(i.step.tour),O.off("click",s),i.current=null,i.step=null,l()}function f(){return angular.element("body").addClass("p-ljtour").on("ljsale-load",function(e){e.originalEvent.data.slot&&y()}),O.is(":visible")?void t(f,300):(p(),O.on("click",s).fadeIn(),void(i.current=i.current.filter(function(e){return m(e.element)})))}function p(){var e=i.current.indexOf(i.step);e<i.current.length-1?(i.step=i.current[++e],i.index=++e,h()):s()}function d(){var e=i.current.indexOf(i.step);e>0&&(i.step=i.current[--e],i.index=++e,h())}function b(e){return e.hasOwnProperty("tourOwner")?LJ.get("remote.username")===LJ.get("journal.username"):!0}function v(e){return e.hasOwnProperty("tourSkipIf")?e.tourSkipIf.split(",").every(function(e){return e=e.trim(),"!"===e.charAt(0)?LJ.get(e.slice(1)):!LJ.get(e)}):!0}function m(e){return e.is(":visible")&&0!==e.css("opacity")&&"hidden"!==e.css("visibility")}function g(e){return e?e.hasOwnProperty("tourStartPage")?new RegExp(e.tourStartPage,"i").test(location.pathname):1===e.tourStep:!1}function y(){angular.element(window).trigger("resize"),S()}function h(){if(i.step){if(!i.step.element.is(":visible"))return p();r.current&&r.close(),t(function(){var e=r.options("tour")||{};r.open("tour",angular.extend(e,i.step.tourBubble),i.step.element),S()}),LJ.Event.once("visual_editor_ready",function(){t(y)})}}function S(){u.scrollTo(i.step.tour+i.step.tourStep,{onlyOutOfScreen:!0})}function k(e){if(i.current&&i.current.length){switch(e.which){case 27:s();break;case 37:d();break;case 39:p()}i.$apply()}}var J,L=o.queue,O=angular.element(document.querySelector(".b-fader")),w=!1;J=r.register({name:"tour",template:"bubbletour.ng.tmpl",closeControl:!1},i),!LJ.Flags.isEnabled("friendsfeed_tour")||LJ.Support.isMobile()||w||(w=!0,t(function(){c(),o.checkAvailable().then(l)})),i.next=p,i.prev=d,i.end=s,n.on("keydown",k),i.$on("$destroy",function(){n.off("keydown",k),J()})}}}])}(jQuery);
/* <<< file end: js/core/angular/ljTour.js */

//# map link was there [ljTour.js.map]
/* >>> file start: js/editor/editor.js */
//= require js/lib/textinputs_jquery.js
//= require js/core/angular/ljTour.js
!function(e){"use strict";angular.module("Editor",["LJ.Tour"]).factory("Editor",function(){var t={};return t.getSelectedText=function(){var t=e("#body");return t.getSelection().text},t.htmlMode=function(){return e("#body").is(":visible")},t.insertContent=function(r,n,o,i){var l,c=e("#body");if(LJ.Event.trigger("contentInsert"),t.htmlMode()){var u=n.split("{caret}");c.surroundSelectedText(u[0],u.length>1?u[u.length-1]||"":"").trigger("input"),l=c.getSelection(),3===u.length&&0===l.length&&c.replaceSelectedText(u[1],"collapseToEnd").setSelection(l.start+u[1].length+u[u.length-1].length),LJ.Event.trigger(r+"_htmlMode_response",n,o,i),c.focus()}else{if("color"===r)return LJ.Event.trigger("selectedColor",o);LJ.Event.trigger(r+"_response",o||n,i)}},t}).controller("EditorCtrl",["$scope","Editor","Bubble","$timeout",function(e,t,r,n){var o={bold:"<b>{caret}</b>",italic:"<i>{caret}</i>",underline:"<u>{caret}</u>",strikethrough:"<s>{caret}</s>"};e.formattingAction=function(e,r){e.preventDefault(),o[r]&&t.insertContent(r,o[r])},e.userClick=function(e,o){var i=t.getSelectedText(),l=/^[A-Za-z0-9_\-]+$/;e.preventDefault(),l.test(i)?t.insertContent(o,'<lj user="{caret}" />'):n(function(){r.open("user")})}}])}(jQuery);
/* <<< file end: js/editor/editor.js */

//# map link was there [editor.js.map]
/* >>> file start: js/editor/media.js */
var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e};
//= require_ml media.ramblerkassa.title
LJ.define("LJ.Media"),LJ.Media.parse=function(e){"use strict";function t(t,r){this.provider=t,e.extend(this,r),this._cache={}}function r(e,t){var r,i;for(r in o)if(o.hasOwnProperty(r)&&(i=o[r].parse(e,t)))return i;return null}function i(t,i){i=e.extend({thumbnail:!0},i||{});try{var n,o=e(t).first();if(o&&"iframe"===o.prop("tagName").toLowerCase()){if(n=o&&o.attr("src"),n&&n.match(a()))return r(t,i);if(n)return r(n,i)}if(o&&"div"===o.prop("tagName").toLowerCase())return r(t,_extends({},i,{tagName:"div"}));if(o&&"script"===o.prop("tagName").toLowerCase())return r(t,_extends({},i,{tagName:"script"}));if(o&&"blockquote"===o.prop("tagName").toLowerCase())return r(t,_extends({},i,{tagName:"blockquote"}))}catch(s){return r(t,i)}}function a(e){var t=LJ.get("siteroot").split(/https?:\/\/www\./)[1].replace(/\./g,"\\."),r="(?:(?:https?:)?//)?[-\\w]{1,15}\\."+t+"/\\d+.html.*?[&?]embed\\b";return e?new RegExp('<iframe.*src="'+r+'".*></iframe>'):new RegExp("^"+r)}t.prototype.parse=function(t,r){var i,a=this,n=this.params(t,r);if(n)return i=[],i.push("string"==typeof this.embed?this.toPromise(this.embed.supplant(n)):this.embed(n)),r.thumbnail&&this.thumbnail&&i.push("string"==typeof this.thumbnail?this.toPromise(this.thumbnail.supplant(n)):this.thumbnail(n)),e.when.apply(e,i).then(function(e,t){var r="";return"function"==typeof a.link?r=a.link(n):"string"==typeof a.link&&(r=a.link.supplant(n)),{link:r,embed:e,thumb:t,site:a.provider}})},t.prototype.cache=function(e,t){return"undefined"==typeof t?this._cache[e]:void(this._cache[e]=t)},t.prototype.toPromise=function(t){var r=e.Deferred();return r.resolve(t),r.promise()};var n=t.prototype.toPromise,o={ljVideo:new t("ljVideo",{link:"https://vc.videos.livejournal.com/index/player?player=new&record_id={storageid}",embed:function(e){return'<iframe data-link="{link}" data-thumb="{thumbnail}" frameBorder="0" height="315" src="{link}" width="560" allowfullscreen="allowfullscreen"></iframe>'.supplant(e)},thumbnail:function(e){return e.screenshot||this.cache(e.storageid)},params:function(t,r){var i=/.*livejournal\.com\/.*\?[\w=&]*record_id=(\d+).*$/,a=("string"==typeof t?t:r.url).match(i);return r.screenshot&&this.cache(r.storageid,r.screenshot),a&&e.extend(r,{storageid:a[1]})}}),coub:new t("coub",{link:"//coub.com/embed/{id}?muted=false&autostart=false&originalSize=false",embed:'<iframe src="//coub.com/embed/{id}?muted=false&autostart=false&originalSize=false&hideTopBar=false&startWithHD=false" allowfullscreen="true" frameborder="0" width="640" height="272"></iframe> ',thumbnail:function(e){var t=this.cache(e.id);return t?this.toPromise(t):this.toPromise(null)},params:function(e){var t=/\/\/[w\.]*coub\.com\/embed\/(\w+)/,r=e.match(t);return r&&{id:r[1]}}}),youtube:new t("youtube",{link:"https://youtube.com/watch?v={id}",thumbnail:"https://img.youtube.com/vi/{id}/0.jpg",embed:'<iframe src="https://www.youtube.com/embed/{id}" width="560" height="315" frameborder="0" allowfullscreen data-link="https://youtube.com/watch?v={id}"></iframe>',params:function(e){var t=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\??v?=?))([^#\&\?]*).*/,r=e.match(t);return r&&-1===r[0].indexOf("youtu")?null:r&&{id:r[7]}}}),vimeo:new t("vimeo",{link:"https://vimeo.com/{id}",embed:'<iframe src="https://player.vimeo.com/video/{id}" width="560" height="315" frameborder="0" allowfullscreen data-link="https://vimeo.com/{id}"></iframe>',params:function(e){var t=/^(https?:\/\/)?(www\.)?(player\.)?vimeo.com\/(video\/|channels\/\w+\/)?(\d+)*/,r=e.match(t);return r&&{id:r[5]}},thumbnail:function(t){var r=this,i=this.cache(t.id);return i?this.toPromise(i):e.ajax({url:"https://vimeo.com/api/v2/video/"+t.id+".json",dataType:"jsonp"}).then(function(e){if(e&&e[0]){var i=e[0].thumbnail_large;if(i)return r.cache(t.id,i),i}else console.error("Data error",e)})}}),vine:new t("vine",{link:"https://vine.co/v/{id}",embed:'<iframe src="https://vine.co/v/{id}/card" width="380" height="380" frameborder="0" data-link="https://vine.co/v/{id}"></iframe>',params:function(e){var t=/vine.co\/v\/([^\/]*)/,r=e.match(t);return r&&{id:r[1]}}}),gist:new t("gist",{link:"https://gist.github.com/{id}",embed:'<div class="gh-gist" data-gist-id="{id}"><a href="https://gist.github.com/{id}">gist.github.com/{id}</a></div>',params:function(e){var t=/.*(?:gist\.github\.com\/)([^\/]+\/{1}[^\/]+)\/{0,1}$/,r=e.match(t);return r&&{id:r[1]}}}),rutube:new t("rutube",{link:"https://rutube.ru/video/{id}/",embed:'<iframe src="https://rutube.ru/video/embed/{id}" width="560" height="315" frameborder="0" allowfullscreen data-link="https://rutube.ru/video/{id}/"></iframe>',params:function(e){var t=/^.*rutube.ru\/video(\/embed\/|\/private\/|\/)(\w{32}).*/,r=e.match(t);return r&&{id:r[2]}},thumbnail:function(t){var r=this,i=this.cache(t.id);return i?this.toPromise(i):e.ajax({url:"https://rutube.ru/api/video/"+t.id+"/?format=jsonp",dataType:"jsonp"}).done(function(e){if(e&&e.thumbnail_url){var i=e.thumbnail_url;if(i)return r.cache(t.id,i),i}else console.error("Data error",e)})}}),ramblerKassa:new t("ramblerKassa",{link:"https://kassa.rambler.ru/movie/{id}",embed:'<lj-rkassa id="{id}" title="'+LJ.ml("media.ramblerkassa.title")+'" />',params:function(e){var t=/kassa\.rambler\.ru\/movie\/(\d+)$/,r=e.match(t);return r&&{id:r[1]}}}),ljEmbed:new t("ljEmbed",{link:"{link}",embed:function(e){return e.embedCode?e.embedCode:'<iframe style="max-width: 100%" src="'+e.link+'?embed" width="502" frameborder="0"></iframe>'},params:function(e){var t=a(!0),r=e.match(t),i=LJ.Util.parseStringForLJPostLinks(e),n="";try{n=i[0].link}catch(o){}if(!n)return null;var s=n.replace(/#.*$/,"").replace(/\?.*$/,"");if(r)return{embedCode:r[0],link:s};var u=/^\s*$/.test(e.replace(n,""));return u?{link:s}:null}}),playbuzz:new t("playbuzz",{link:"https://www.playbuzz.com/",embed:"{embed}",params:function(e){var t=void 0,r=void 0;try{var i=(new DOMParser).parseFromString(e,"text/html");r=i.querySelector(".playbuzz"),t=r.attributes["data-id"].value,r.innerHTML="[Playbuzz Embed]"}catch(a){}return t?{id:t,embed:r.outerHTML}:null}})},s={facebook:{config:{link:function(e){return e.link},params:function(e){var t=/(^.*facebook.com\/.*)/,r=e.match(t);if(!r)return null;var i={link:r[1]},a=e.match(/post.php\?href=([^&]*)/);return a&&a[1]&&(i.postLink=decodeURIComponent(a[1])),i},embed:function(t){var r=this,i=/(^.*facebook.com\/)(\d*)(\/.*)/,a=t.link.match(i),o=t.link.match(/video\.php/),s=e.Deferred(),u=a&&a[2],c=this.cache(t.link),m=void 0,l=function(e){var t=e.link,r=e.postLink;if(o)return"<iframe "+('src="'+t+'" ')+'width="560" height="315" style="border:none;overflow:hidden" scrolling="no" frameborder="0" allowTransparency="true" allowFullScreen="true"></iframe>';var i=r||t;return'<div class="fb-post" data-href="'+i+'" data-width="500">'+('<div class="fb-xfbml-parse-ignore"><a href="'+i+'">Facebook post</a></div>')+"</div>"};return c?(n||this.toPromise)(c):(u?LJ.Social.load("facebook").then(function(){FB.api(u,function(e){t.link.replace(i,"$1"+e.username+"$3");m=l(t),r.cache(t.link,m),s.resolve(m)})}):(m=l(t),this.cache(t.link,m),s.resolve(m)),s.promise())}}},twitter:{config:{link:function(e){return"https://twitter.com/"+e.username+"/status/"+e.id},params:function(e){var t=/^.*twitter.com\/(\w*)\/status\/(\w*).*/,r=e.match(t);return r&&{id:r[2],username:r[1]}},embed:function(t){var r=this,i=this.cache(t.id);return i?(n||this.toPromise)(i):e.ajax({url:"https://api.twitter.com/1/statuses/oembed.json?id="+t.id,dataType:"jsonp"}).then(function(e){var i=e.html.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").trim();return r.cache(t.id,i),i})}}},telegram:{config:{link:function(e){var t=e.id;return"//t.me/"+t},embed:function(e){var t=e.id;return"<blockquote class='telegram-post' data-telegram-post='"+t+"' data-width=560><a href='//t.me/"+t+"'>https://t.me/"+t+"</a></blockquote>"},params:function(e){var t=/t.me\/([^\/]+\/[0-9]+)/;e.indexOf("script")>-1&&(t=/data-telegram-post=["']([^"']*)["']/);var r=e.match(t);return r&&r[1]&&-1!==r[1].indexOf("/")?{id:r[1]}:null}}},instagram:{config:{link:function(e){return"https://instagram.com/p/"+e.id+"/"},embed:function(e){var t=e.id;return('<blockquote\n              lj-screenable="social:newinsta:parse"\n              class="instagram-media"\n              data-instgrm-captioned="data-instgrm-captioned"\n              data-instgrm-version="7"\n            >\n              <a href="https://instagram.com/p/'+t+'" target="_blank" rel="nofollow">https://instagram.com/p/'+t+"</a>\n            </blockquote>").replace(/\n/g,"").replace(/\s+/g," ")},params:function(e){var t=/.*(?:instagram\.\w*|instagr\.am)\/p\/([^\/<>]+).*/,r=e.match(t);return r&&{id:r[1]}}}}};return Object.keys(s).forEach(function(e){o[e]=new t(e,s[e].config)}),LJ.Media.providerRecipes=s,i}(jQuery);
/* <<< file end: js/editor/media.js */

//# map link was there [media.js.map]
/* >>> file start: js/core/angular/pills.js */
!function(i){return i}(),function(){"use strict";angular.module("LJ.Pills",[]).factory("Pills",function(){var i={};return{group:function(n,t){return"undefined"==typeof t?i[n]:void(i[n]=t)}}}).directive("ljPillsGroup",["Pills",function(i){return{restrict:"A",link:function(n,t,l){var r=l.ljPillsGroupActive||"b-menu-item-active";n.$watch(function(){return i.group(l.ljPillsGroup)},function(i){t.find("[data-pill]").removeClass(r).filter('[data-pill="'+i+'"]').addClass(r)})}}}])}();
/* <<< file end: js/core/angular/pills.js */

//# map link was there [pills.js.map]
/* >>> file start: js/core/angular/authHelper.js */
!function(e){return e}(),function(){"use strict";angular.module("LJ.AuthHelper",[]).factory("AuthHelper",["$q","$interval",function(e,n){function t(t){var u,i=window.open(t,"Auth helper","height=450,width=650"),l=0;return o=e.defer(),u=n(function(){var e;l++,i.closed&&(e=LJ.Cookie.get("_Auth_token"),"undefined"!=typeof e?o.resolve(e):o.reject(),LJ.Cookie.setGlobal("_Auth_token",null),n.cancel(u)),l>r&&n.cancel(u)},200),o.promise}var o,r=1500;return{open:t}}])}();
/* <<< file end: js/core/angular/authHelper.js */

//# map link was there [authHelper.js.map]
/* >>> file start: js/core/angular/adult.js */
Site.page.template['angular/adult.ng.tmpl'] = '<label class=\"flatpopup-label\" lj-ml=\"flatmedia.adult.content\"></label>\n<select class=\"sharp-select\" ng-model=\"model\" ng-options=\"item.value as item.title for item in adult.categories\"></select>\n';
//= require_ml flatmedia.adult.content
//= require_ml flatmedia.adult.content.default
//= require_ml flatmedia.adult.content.explicit
//= require_ml flatmedia.adult.content.none
!function(t){return t}(),function(){"use strict";angular.module("LJ.Adult",[]).directive("ljAdult",[function(){return{scope:{model:"=ljAdult"},templateUrl:"adult.ng.tmpl",controllerAs:"adult",controller:["$scope","$element","$attrs",function(t,l,e){this.categories=[{title:LJ.ml("flatmedia.adult.content.none"),value:!1},{title:LJ.ml("flatmedia.adult.content.explicit"),value:!0}],e.hasOwnProperty("ljAdultNotStrict")&&this.categories.unshift({title:LJ.ml("flatmedia.adult.content.default"),value:""})}]}}])}();
/* <<< file end: js/core/angular/adult.js */

//# map link was there [adult.js.map]
/* >>> file start: js/lib/plupload/plupload-2.1.2.full.min.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"use strict";function n(e,t){for(var n,i=[],o=0;o<e.length;++o){if(n=a[e[o]]||r(e[o]),!n)throw"module definition dependecy not found: "+e[o];i.push(n)}t.apply(null,i)}function i(e,i,r){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(i===t)throw"invalid module definition, dependencies must be specified";if(r===t)throw"invalid module definition, definition function must be specified";n(i,function(){a[e]=r.apply(null,arguments)})}function r(t){for(var n=e,i=t.split(/[.\/]/),r=0;r<i.length;++r){if(!n[i[r]])return;n=n[i[r]]}return n}function o(n){for(var i=0;i<n.length;i++){for(var r=e,o=n[i],s=o.split(/[.\/]/),u=0;u<s.length-1;++u)r[s[u]]===t&&(r[s[u]]={}),r=r[s[u]];r[s[s.length-1]]=a[o]}}var a={},s="moxie/core/utils/Basic",u="moxie/core/I18n",c="moxie/core/utils/Mime",l="moxie/core/utils/Env",d="moxie/core/utils/Dom",f="moxie/core/Exceptions",p="moxie/core/EventTarget",h="moxie/core/utils/Encode",g="moxie/runtime/Runtime",m="moxie/runtime/RuntimeClient",v="moxie/file/Blob",_="moxie/file/File",y="moxie/file/FileInput",w="moxie/file/FileDrop",E="moxie/runtime/RuntimeTarget",b="moxie/file/FileReader",R="moxie/core/utils/Url",x="moxie/file/FileReaderSync",S="moxie/xhr/FormData",T="moxie/xhr/XMLHttpRequest",A="moxie/runtime/Transporter",O="moxie/image/Image",I="moxie/runtime/html5/Runtime",D="moxie/runtime/html5/file/Blob",N="moxie/core/utils/Events",L="moxie/runtime/html5/file/FileInput",M="moxie/runtime/html5/file/FileDrop",C="moxie/runtime/html5/file/FileReader",F="moxie/runtime/html5/xhr/XMLHttpRequest",P="moxie/runtime/html5/utils/BinaryReader",z="moxie/runtime/html5/image/JPEGHeaders",H="moxie/runtime/html5/image/ExifParser",U="moxie/runtime/html5/image/JPEG",k="moxie/runtime/html5/image/PNG",q="moxie/runtime/html5/image/ImageInfo",B="moxie/runtime/html5/image/MegaPixel",G="moxie/runtime/html5/image/Image",j="moxie/runtime/flash/Runtime",X="moxie/runtime/flash/file/Blob",V="moxie/runtime/flash/file/FileInput",W="moxie/runtime/flash/file/FileReader",Y="moxie/runtime/flash/file/FileReaderSync",$="moxie/runtime/flash/xhr/XMLHttpRequest",J="moxie/runtime/flash/runtime/Transporter",Z="moxie/runtime/flash/image/Image",Q="moxie/runtime/silverlight/Runtime",K="moxie/runtime/silverlight/file/Blob",ee="moxie/runtime/silverlight/file/FileInput",te="moxie/runtime/silverlight/file/FileDrop",ne="moxie/runtime/silverlight/file/FileReader",ie="moxie/runtime/silverlight/file/FileReaderSync",re="moxie/runtime/silverlight/xhr/XMLHttpRequest",oe="moxie/runtime/silverlight/runtime/Transporter",ae="moxie/runtime/silverlight/image/Image",se="moxie/runtime/html4/Runtime",ue="moxie/runtime/html4/file/FileInput",ce="moxie/runtime/html4/file/FileReader",le="moxie/runtime/html4/xhr/XMLHttpRequest",de="moxie/runtime/html4/image/Image";i(s,[],function(){var e=function(e){var t;return e===t?"undefined":null===e?"null":e.nodeType?"node":{}.toString.call(e).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},t=function p(t){var i;return n(arguments,function(r,o){o>0&&n(r,function(n,r){n!==i&&(e(t[r])===e(n)&&~a(e(n),["array","object"])?p(t[r],n):t[r]=n)})}),t},n=function h(e,t){var h,n,i,r;if(e){try{h=e.length}catch(o){h=r}if(h===r){for(n in e)if(e.hasOwnProperty(n)&&t(e[n],n)===!1)return}else for(i=0;h>i;i++)if(t(e[i],i)===!1)return}},i=function(t){var n;if(!t||"object"!==e(t))return!0;for(n in t)return!1;return!0},r=function g(t,n){function i(o){"function"===e(t[o])&&t[o](function(e){++o<r&&!e?i(o):n(e)})}var g=0,r=t.length;"function"!==e(n)&&(n=function(){}),t&&t.length||n(),i(g)},o=function m(e,t){var i=0,r=e.length,m=new Array(r);n(e,function(e,n){e(function(e){if(e)return t(e);var o=[].slice.call(arguments);o.shift(),m[n]=o,i++,i===r&&(m.unshift(null),t.apply(this,m))})})},a=function(e,t){if(t){if(Array.prototype.indexOf)return Array.prototype.indexOf.call(t,e);for(var n=0,i=t.length;i>n;n++)if(t[n]===e)return n}return-1},s=function(t,n){var i=[];"array"!==e(t)&&(t=[t]),"array"!==e(n)&&(n=[n]);for(var r in t)-1===a(t[r],n)&&i.push(t[r]);return i.length?i:!1},u=function(e,t){var i=[];return n(e,function(e){-1!==a(e,t)&&i.push(e)}),i.length?i:null},c=function(e){var t,n=[];for(t=0;t<e.length;t++)n[t]=e[t];return n},l=function(){var e=0;return function(t){var n,i=(new Date).getTime().toString(32);for(n=0;5>n;n++)i+=Math.floor(65535*Math.random()).toString(32);return(t||"o_")+i+(e++).toString(32)}}(),d=function(e){return e?String.prototype.trim?String.prototype.trim.call(e):e.toString().replace(/^\s*/,"").replace(/\s*$/,""):e},f=function(e){if("string"!=typeof e)return e;var t,n={t:1099511627776,g:1073741824,m:1048576,k:1024};return e=/^([0-9]+)([mgk]?)$/.exec(e.toLowerCase().replace(/[^0-9mkg]/g,"")),t=e[2],e=+e[1],n.hasOwnProperty(t)&&(e*=n[t]),e};return{guid:l,typeOf:e,extend:t,each:n,isEmptyObj:i,inSeries:r,inParallel:o,inArray:a,arrayDiff:s,arrayIntersect:u,toArray:c,trim:d,parseSizeStr:f}}),i(u,[s],function(e){var t={};return{addI18n:function(n){return e.extend(t,n)},translate:function(e){return t[e]||e},_:function(e){return this.translate(e)},sprintf:function(t){var n=[].slice.call(arguments,1);return t.replace(/%[a-z]/g,function(){var t=n.shift();return"undefined"!==e.typeOf(t)?t:""})}}}),i(c,[s,u],function(e,t){var n="application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mp3 mpga mpega mp2,audio/x-wav,wav,audio/x-m4a,m4a,audio/ogg,oga ogg,audio/aiff,aiff aif,audio/flac,flac,audio/aac,aac,audio/ac3,ac3,audio/x-ms-wma,wma,image/bmp,bmp,image/gif,gif,image/jpeg,jpg jpeg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe m2v,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/3gpp,3gpp 3gp,video/3gpp2,3g2,video/vnd.rn-realvideo,rv,video/ogg,ogv,video/x-matroska,mkv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe",i={mimes:{},extensions:{},addMimeType:function(e){var t,n,i,r=e.split(/,/);for(t=0;t<r.length;t+=2){for(i=r[t+1].split(/ /),n=0;n<i.length;n++)this.mimes[i[n]]=r[t];this.extensions[r[t]]=i}},extList2mimes:function(t,n){var i,r,o,a,s=this,u=[];for(r=0;r<t.length;r++)for(i=t[r].extensions.split(/\s*,\s*/),o=0;o<i.length;o++){if("*"===i[o])return[];if(a=s.mimes[i[o]])-1===e.inArray(a,u)&&u.push(a);else{if(!n||!/^\w+$/.test(i[o]))return[];u.push("."+i[o])}}return u},mimes2exts:function(t){var n=this,i=[];return e.each(t,function(t){if("*"===t)return i=[],!1;var r=t.match(/^(\w+)\/(\*|\w+)$/);r&&("*"===r[2]?e.each(n.extensions,function(e,t){new RegExp("^"+r[1]+"/").test(t)&&[].push.apply(i,n.extensions[t])}):n.extensions[t]&&[].push.apply(i,n.extensions[t]))}),i},mimes2extList:function(n){var i=[],r=[];return"string"===e.typeOf(n)&&(n=e.trim(n).split(/\s*,\s*/)),r=this.mimes2exts(n),i.push({title:t.translate("Files"),extensions:r.length?r.join(","):"*"}),i.mimes=n,i},getFileExtension:function(e){var t=e&&e.match(/\.([^.]+)$/);return t?t[1].toLowerCase():""},getFileMime:function(e){return this.mimes[this.getFileExtension(e)]||""}};return i.addMimeType(n),i}),i(l,[s],function(e){function t(e,t,n){var i=0,r=0,o=0,a={dev:-6,alpha:-5,a:-5,beta:-4,b:-4,RC:-3,rc:-3,"#":-2,p:1,pl:1},s=function(e){return e=(""+e).replace(/[_\-+]/g,"."),e=e.replace(/([^.\d]+)/g,".$1.").replace(/\.{2,}/g,"."),e.length?e.split("."):[-8]},u=function(e){return e?isNaN(e)?a[e]||-7:parseInt(e,10):0};for(e=s(e),t=s(t),r=Math.max(e.length,t.length),i=0;r>i;i++)if(e[i]!=t[i]){if(e[i]=u(e[i]),t[i]=u(t[i]),e[i]<t[i]){o=-1;break}if(e[i]>t[i]){o=1;break}}if(!n)return o;switch(n){case">":case"gt":return o>0;case">=":case"ge":return o>=0;case"<=":case"le":return 0>=o;case"==":case"=":case"eq":return 0===o;case"<>":case"!=":case"ne":return 0!==o;case"":case"<":case"lt":return 0>o;default:return null}}var n=function(e){var t="",n="?",i="function",r="undefined",o="object",a="major",s="name",u="version",c={has:function(e,t){return-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()}},l={rgx:function(){for(var t,n,a,s,u,c,l,d=0,f=arguments;d<f.length;d+=2){var p=f[d],h=f[d+1];if(("undefined"==typeof t?"undefined":_typeof(t))===r){t={};for(s in h)u=h[s],("undefined"==typeof u?"undefined":_typeof(u))===o?t[u[0]]=e:t[u]=e}for(n=a=0;n<p.length;n++)if(c=p[n].exec(this.getUA())){for(s=0;s<h.length;s++)l=c[++a],u=h[s],("undefined"==typeof u?"undefined":_typeof(u))===o&&u.length>0?2==u.length?t[u[0]]=_typeof(u[1])==i?u[1].call(this,l):u[1]:3==u.length?t[u[0]]=_typeof(u[1])!==i||u[1].exec&&u[1].test?l?l.replace(u[1],u[2]):e:l?u[1].call(this,l,u[2]):e:4==u.length&&(t[u[0]]=l?u[3].call(this,l.replace(u[1],u[2])):e):t[u]=l?l:e;break}if(c)break}return t},str:function(t,i){for(var r in i)if(_typeof(i[r])===o&&i[r].length>0){for(var a=0;a<i[r].length;a++)if(c.has(i[r][a],t))return r===n?e:r}else if(c.has(i[r],t))return r===n?e:r;return t}},d={browser:{oldsafari:{major:{1:["/8","/1","/3"],2:"/4","?":"/"},version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",RT:"ARM"}}}},f={browser:[[/(opera\smini)\/((\d+)?[\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/((\d+)?[\w\.-]+)/i,/(opera).+version\/((\d+)?[\w\.]+)/i,/(opera)[\/\s]+((\d+)?[\w\.]+)/i],[s,u,a],[/\s(opr)\/((\d+)?[\w\.]+)/i],[[s,"Opera"],u,a],[/(kindle)\/((\d+)?[\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?((\d+)?[\w\.]+)*/i,/(avant\s|iemobile|slim|baidu)(?:browser)?[\/\s]?((\d+)?[\w\.]*)/i,/(?:ms|\()(ie)\s((\d+)?[\w\.]+)/i,/(rekonq)((?:\/)[\w\.]+)*/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron)\/((\d+)?[\w\.-]+)/i],[s,u,a],[/(trident).+rv[:\s]((\d+)?[\w\.]+).+like\sgecko/i],[[s,"IE"],u,a],[/(yabrowser)\/((\d+)?[\w\.]+)/i],[[s,"Yandex"],u,a],[/(comodo_dragon)\/((\d+)?[\w\.]+)/i],[[s,/_/g," "],u,a],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?((\d+)?[\w\.]+)/i],[s,u,a],[/(dolfin)\/((\d+)?[\w\.]+)/i],[[s,"Dolphin"],u,a],[/((?:android.+)crmo|crios)\/((\d+)?[\w\.]+)/i],[[s,"Chrome"],u,a],[/((?:android.+))version\/((\d+)?[\w\.]+)\smobile\ssafari/i],[[s,"Android Browser"],u,a],[/version\/((\d+)?[\w\.]+).+?mobile\/\w+\s(safari)/i],[u,a,[s,"Mobile Safari"]],[/version\/((\d+)?[\w\.]+).+?(mobile\s?safari|safari)/i],[u,a,s],[/webkit.+?(mobile\s?safari|safari)((\/[\w\.]+))/i],[s,[a,l.str,d.browser.oldsafari.major],[u,l.str,d.browser.oldsafari.version]],[/(konqueror)\/((\d+)?[\w\.]+)/i,/(webkit|khtml)\/((\d+)?[\w\.]+)/i],[s,u,a],[/(navigator|netscape)\/((\d+)?[\w\.-]+)/i],[[s,"Netscape"],u,a],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?((\d+)?[\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix)\/((\d+)?[\w\.-]+)/i,/(mozilla)\/((\d+)?[\w\.]+).+rv\:.+gecko\/\d+/i,/(uc\s?browser|polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|qqbrowser)[\/\s]?((\d+)?[\w\.]+)/i,/(links)\s\(((\d+)?[\w\.]+)/i,/(gobrowser)\/?((\d+)?[\w\.]+)*/i,/(ice\s?browser)\/v?((\d+)?[\w\._]+)/i,/(mosaic)[\/\s]((\d+)?[\w\.]+)/i],[s,u,a]],engine:[[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[s,u],[/rv\:([\w\.]+).*(gecko)/i],[u,s]],os:[[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*|windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[s,[u,l.str,d.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[s,"Windows"],[u,l.str,d.os.windows.version]],[/\((bb)(10);/i],[[s,"BlackBerry"],u],[/(blackberry)\w*\/?([\w\.]+)*/i,/(tizen)\/([\w\.]+)/i,/(android|webos|palm\os|qnx|bada|rim\stablet\sos|meego)[\/\s-]?([\w\.]+)*/i],[s,u],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]+)*/i],[[s,"Symbian"],u],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[s,"Firefox OS"],u],[/(nintendo|playstation)\s([wids3portablevu]+)/i,/(mint)[\/\s\(]?(\w+)*/i,/(joli|[kxln]?ubuntu|debian|[open]*suse|gentoo|arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk)[\/\s-]?([\w\.-]+)*/i,/(hurd|linux)\s?([\w\.]+)*/i,/(gnu)\s?([\w\.]+)*/i],[s,u],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[s,"Chromium OS"],u],[/(sunos)\s?([\w\.]+\d)*/i],[[s,"Solaris"],u],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]+)*/i],[s,u],[/(ip[honead]+)(?:.*os\s*([\w]+)*\slike\smac|;\sopera)/i],[[s,"iOS"],[u,/_/g,"."]],[/(mac\sos\sx)\s?([\w\s\.]+\w)*/i],[s,[u,/_/g,"."]],[/(haiku)\s(\w+)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.]*)*/i,/(macintosh|mac(?=_powerpc)|plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos)/i,/(unix)\s?([\w\.]+)*/i],[s,u]]},p=function(e){var n=e||(window&&window.navigator&&window.navigator.userAgent?window.navigator.userAgent:t);this.getBrowser=function(){return l.rgx.apply(this,f.browser)},this.getEngine=function(){return l.rgx.apply(this,f.engine)},this.getOS=function(){return l.rgx.apply(this,f.os)},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS()}},this.getUA=function(){return n},this.setUA=function(e){return n=e,this},this.setUA(n)};return(new p).getResult()}(),i=function(){var t={define_property:function(){return!1}(),create_canvas:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),return_response_type:function(t){try{if(-1!==e.inArray(t,["","text","document"]))return!0;if(window.XMLHttpRequest){var n=new XMLHttpRequest;if(n.open("get","/"),"responseType"in n)return n.responseType=t,n.responseType===t}}catch(i){}return!1},use_data_uri:function(){var e=new Image;return e.onload=function(){t.use_data_uri=1===e.width&&1===e.height},setTimeout(function(){e.src="data:image/gif;base64,R0lGODlhAQABAIAAAP8AAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="},1),!1}(),use_data_uri_over32kb:function(){return t.use_data_uri&&("IE"!==r.browser||r.version>=9)},use_data_uri_of:function(e){return t.use_data_uri&&33e3>e||t.use_data_uri_over32kb()},use_fileinput:function(){var e=document.createElement("input");return e.setAttribute("type","file"),!e.disabled}};return function(n){var i=[].slice.call(arguments);return i.shift(),"function"===e.typeOf(t[n])?t[n].apply(this,i):!!t[n]}}(),r={can:i,browser:n.browser.name,version:parseFloat(n.browser.major),os:n.os.name,osVersion:n.os.version,verComp:t,swf_url:"../flash/Moxie.swf",xap_url:"../silverlight/Moxie.xap",global_event_dispatcher:"moxie.core.EventTarget.instance.dispatchEvent"};return r.OS=r.os,r}),i(d,[l],function(e){var t=function(e){return"string"!=typeof e?e:document.getElementById(e)},n=function u(e,t){if(!e.className)return!1;var u=new RegExp("(^|\\s+)"+t+"(\\s+|$)");return u.test(e.className)},i=function(e,t){n(e,t)||(e.className=e.className?e.className.replace(/\s+$/,"")+" "+t:t)},r=function(e,t){if(e.className){var n=new RegExp("(^|\\s+)"+t+"(\\s+|$)");e.className=e.className.replace(n,function(e,t,n){return" "===t&&" "===n?" ":""})}},o=function(e,t){return e.currentStyle?e.currentStyle[t]:window.getComputedStyle?window.getComputedStyle(e,null)[t]:void 0},a=function c(t,n){function i(e){var t,n,i=0,r=0;return e&&(n=e.getBoundingClientRect(),t="CSS1Compat"===u.compatMode?u.documentElement:u.body,i=n.left+t.scrollLeft,r=n.top+t.scrollTop),{x:i,y:r}}var c,r,o,a=0,s=0,u=document;if(t=t,n=n||u.body,t&&t.getBoundingClientRect&&"IE"===e.browser&&(!u.documentMode||u.documentMode<8))return r=i(t),o=i(n),{x:r.x-o.x,y:r.y-o.y};for(c=t;c&&c!=n&&c.nodeType;)a+=c.offsetLeft||0,s+=c.offsetTop||0,c=c.offsetParent;for(c=t.parentNode;c&&c!=n&&c.nodeType;)a-=c.scrollLeft||0,s-=c.scrollTop||0,c=c.parentNode;return{x:a,y:s}},s=function(e){return{w:e.offsetWidth||e.clientWidth,h:e.offsetHeight||e.clientHeight}};return{get:t,hasClass:n,addClass:i,removeClass:r,getStyle:o,getPos:a,getSize:s}}),i(f,[s],function(e){function t(e,t){var n;for(n in e)if(e[n]===t)return n;return null}return{RuntimeError:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": RuntimeError "+this.code}var i={NOT_INIT_ERR:1,NOT_SUPPORTED_ERR:9,JS_ERR:4};return e.extend(n,i),n.prototype=Error.prototype,n}(),OperationNotAllowedException:function(){function t(e){this.code=e,this.name="OperationNotAllowedException"}return e.extend(t,{NOT_ALLOWED_ERR:1}),t.prototype=Error.prototype,t}(),ImageError:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": ImageError "+this.code}var i={WRONG_FORMAT:1,MAX_RESOLUTION_ERR:2};return e.extend(n,i),n.prototype=Error.prototype,n}(),FileException:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": FileException "+this.code}var i={NOT_FOUND_ERR:1,SECURITY_ERR:2,ABORT_ERR:3,NOT_READABLE_ERR:4,ENCODING_ERR:5,NO_MODIFICATION_ALLOWED_ERR:6,INVALID_STATE_ERR:7,SYNTAX_ERR:8};return e.extend(n,i),n.prototype=Error.prototype,n}(),DOMException:function(){function n(e){this.code=e,this.name=t(i,e),this.message=this.name+": DOMException "+this.code}var i={INDEX_SIZE_ERR:1,DOMSTRING_SIZE_ERR:2,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,INVALID_CHARACTER_ERR:5,NO_DATA_ALLOWED_ERR:6,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INUSE_ATTRIBUTE_ERR:10,INVALID_STATE_ERR:11,SYNTAX_ERR:12,INVALID_MODIFICATION_ERR:13,NAMESPACE_ERR:14,INVALID_ACCESS_ERR:15,VALIDATION_ERR:16,TYPE_MISMATCH_ERR:17,SECURITY_ERR:18,NETWORK_ERR:19,ABORT_ERR:20,URL_MISMATCH_ERR:21,QUOTA_EXCEEDED_ERR:22,TIMEOUT_ERR:23,INVALID_NODE_TYPE_ERR:24,DATA_CLONE_ERR:25};return e.extend(n,i),n.prototype=Error.prototype,n}(),EventException:function(){function t(e){this.code=e,this.name="EventException"}return e.extend(t,{UNSPECIFIED_EVENT_TYPE_ERR:0}),t.prototype=Error.prototype,t}()}}),i(p,[f,s],function(e,t){function n(){var n={};t.extend(this,{uid:null,init:function(){this.uid||(this.uid=t.guid("uid_"))},addEventListener:function(e,i,r,o){var a,s=this;return e=t.trim(e),/\s/.test(e)?void t.each(e.split(/\s+/),function(e){s.addEventListener(e,i,r,o)}):(e=e.toLowerCase(),r=parseInt(r,10)||0,a=n[this.uid]&&n[this.uid][e]||[],a.push({fn:i,priority:r,scope:o||this}),n[this.uid]||(n[this.uid]={}),void(n[this.uid][e]=a))},hasEventListener:function(e){return e?!(!n[this.uid]||!n[this.uid][e]):!!n[this.uid]},removeEventListener:function(e,i){e=e.toLowerCase();var r,o=n[this.uid]&&n[this.uid][e];if(o){if(i){for(r=o.length-1;r>=0;r--)if(o[r].fn===i){o.splice(r,1);break}}else o=[];o.length||(delete n[this.uid][e],t.isEmptyObj(n[this.uid])&&delete n[this.uid])}},removeAllEventListeners:function(){n[this.uid]&&delete n[this.uid]},dispatchEvent:function(i){var r,o,a,s,u,c={},l=!0;if("string"!==t.typeOf(i)){if(s=i,"string"!==t.typeOf(s.type))throw new e.EventException(e.EventException.UNSPECIFIED_EVENT_TYPE_ERR);i=s.type,s.total!==u&&s.loaded!==u&&(c.total=s.total,c.loaded=s.loaded),c.async=s.async||!1}if(-1!==i.indexOf("::")?!function(e){r=e[0],i=e[1]}(i.split("::")):r=this.uid,i=i.toLowerCase(),o=n[r]&&n[r][i]){o.sort(function(e,t){return t.priority-e.priority}),a=[].slice.call(arguments),a.shift(),c.type=i,a.unshift(c);var d=[];t.each(o,function(e){a[0].target=e.scope,d.push(c.async?function(t){setTimeout(function(){t(e.fn.apply(e.scope,a)===!1)},1)}:function(t){t(e.fn.apply(e.scope,a)===!1)})}),d.length&&t.inSeries(d,function(e){l=!e})}return l},bind:function(){this.addEventListener.apply(this,arguments)},unbind:function(){this.removeEventListener.apply(this,arguments)},unbindAll:function(){this.removeAllEventListeners.apply(this,arguments)},trigger:function(){return this.dispatchEvent.apply(this,arguments)},convertEventPropsToHandlers:function(e){var n;"array"!==t.typeOf(e)&&(e=[e]);for(var i=0;i<e.length;i++)n="on"+e[i],"function"===t.typeOf(this[n])?this.addEventListener(e[i],this[n]):"undefined"===t.typeOf(this[n])&&(this[n]=null)}})}return n.instance=new n,n}),i(h,[],function(){var e=function(e){return unescape(encodeURIComponent(e))},t=function(e){return decodeURIComponent(escape(e))},n=function(e,n){if("function"==typeof window.atob)return n?t(window.atob(e)):window.atob(e);var i,r,o,a,s,u,c,l,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,p=0,h="",g=[];if(!e)return e;e+="";do a=d.indexOf(e.charAt(f++)),s=d.indexOf(e.charAt(f++)),u=d.indexOf(e.charAt(f++)),c=d.indexOf(e.charAt(f++)),l=a<<18|s<<12|u<<6|c,i=l>>16&255,r=l>>8&255,o=255&l,g[p++]=64==u?String.fromCharCode(i):64==c?String.fromCharCode(i,r):String.fromCharCode(i,r,o);while(f<e.length);return h=g.join(""),n?t(h):h},i=function r(t,n){if(n&&e(t),"function"==typeof window.btoa)return window.btoa(t);var i,o,a,s,u,c,l,d,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",f=0,p=0,h="",g=[];if(!t)return t;do i=t.charCodeAt(f++),o=t.charCodeAt(f++),a=t.charCodeAt(f++),d=i<<16|o<<8|a,s=d>>18&63,u=d>>12&63,c=d>>6&63,l=63&d,g[p++]=r.charAt(s)+r.charAt(u)+r.charAt(c)+r.charAt(l);while(f<t.length);h=g.join("");var m=t.length%3;return(m?h.slice(0,m-3):h)+"===".slice(m||3)};return{utf8_encode:e,utf8_decode:t,atob:n,btoa:i}}),i(g,[s,d,p],function(e,t,n){function i(n,r,a,s,u){var c,l=this,d=e.guid(r+"_"),f=u||"browser";n=n||{},o[d]=this,a=e.extend({access_binary:!1,access_image_binary:!1,display_media:!1,do_cors:!1,drag_and_drop:!1,filter_by_extension:!0,resize_image:!1,report_upload_progress:!1,return_response_headers:!1,return_response_type:!1,return_status_code:!0,send_custom_headers:!1,select_file:!1,select_folder:!1,select_multiple:!0,send_binary_string:!1,send_browser_cookies:!0,send_multipart:!0,slice_blob:!1,stream_upload:!1,summon_file_dialog:!1,upload_filesize:!0,use_http_method:!0},a),n.preferred_caps&&(f=i.getMode(s,n.preferred_caps,f)),c=function(){var t={};return{exec:function(e,n,i,r){return c[n]&&(t[e]||(t[e]={context:this,instance:new c[n]}),t[e].instance[i])?t[e].instance[i].apply(this,r):void 0},removeInstance:function(e){delete t[e]},removeAllInstances:function(){var n=this;e.each(t,function(t,i){"function"===e.typeOf(t.instance.destroy)&&t.instance.destroy.call(t.context),n.removeInstance(i)})}}}(),e.extend(this,{initialized:!1,uid:d,type:r,mode:i.getMode(s,n.required_caps,f),shimid:d+"_container",clients:0,options:n,can:function(t,n){var r=arguments[2]||a;if("string"===e.typeOf(t)&&"undefined"===e.typeOf(n)&&(t=i.parseCaps(t)),"object"===e.typeOf(t)){for(var o in t)if(!this.can(o,t[o],r))return!1;return!0}return"function"===e.typeOf(r[t])?r[t].call(this,n):n===r[t]},getShimContainer:function(){var n,i=t.get(this.shimid);return i||(n=this.options.container?t.get(this.options.container):document.body,i=document.createElement("div"),i.id=this.shimid,i.className="moxie-shim moxie-shim-"+this.type,e.extend(i.style,{position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),n.appendChild(i),n=null),i},getShim:function(){return c},shimExec:function(e,t){var n=[].slice.call(arguments,2);return l.getShim().exec.call(this,this.uid,e,t,n)},exec:function(e,t){var n=[].slice.call(arguments,2);return l[e]&&l[e][t]?l[e][t].apply(this,n):l.shimExec.apply(this,arguments)},destroy:function(){if(l){var e=t.get(this.shimid);e&&e.parentNode.removeChild(e),c&&c.removeAllInstances(),this.unbindAll(),delete o[this.uid],this.uid=null,d=l=c=e=null}}}),this.mode&&n.required_caps&&!this.can(n.required_caps)&&(this.mode=!1)}var r={},o={};return i.order="html5,flash,silverlight,html4",i.getRuntime=function(e){return o[e]?o[e]:!1},i.addConstructor=function(e,t){t.prototype=n.instance,r[e]=t},i.getConstructor=function(e){return r[e]||null},i.getInfo=function(e){var t=i.getRuntime(e);return t?{uid:t.uid,type:t.type,mode:t.mode,can:function(){return t.can.apply(t,arguments)}}:null},i.parseCaps=function(t){var n={};return"string"!==e.typeOf(t)?t||{}:(e.each(t.split(","),function(e){n[e]=!0}),n)},i.can=function(e,t){var n,r,o=i.getConstructor(e);return o?(n=new o({required_caps:t}),r=n.mode,n.destroy(),!!r):!1},i.thatCan=function(e,t){var n=(t||i.order).split(/\s*,\s*/);for(var r in n)if(i.can(n[r],e))return n[r];return null},i.getMode=function(t,n,i){var r=null;if("undefined"===e.typeOf(i)&&(i="browser"),n&&!e.isEmptyObj(t)){if(e.each(n,function(n,i){if(t.hasOwnProperty(i)){var o=t[i](n);if("string"==typeof o&&(o=[o]),r){if(!(r=e.arrayIntersect(r,o)))return r=!1}else r=o}}),r)return-1!==e.inArray(i,r)?i:r[0];if(r===!1)return!1}return i},i.capTrue=function(){return!0},i.capFalse=function(){return!1},i.capTest=function(e){return function(){return!!e}},i}),i(m,[f,s,g],function(e,t,n){return function i(){var i;t.extend(this,{connectRuntime:function(r){function o(t){var a,u;return t.length?(a=t.shift(),(u=n.getConstructor(a))?(i=new u(r),i.bind("Init",function(){i.initialized=!0,setTimeout(function(){i.clients++,s.trigger("RuntimeInit",i)},1)}),i.bind("Error",function(){i.destroy(),o(t)}),i.mode?void i.init():void i.trigger("Error")):void o(t)):(s.trigger("RuntimeError",new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)),void(i=null))}var a,s=this;if("string"===t.typeOf(r)?a=r:"string"===t.typeOf(r.ruid)&&(a=r.ruid),a){if(i=n.getRuntime(a))return i.clients++,i;throw new e.RuntimeError(e.RuntimeError.NOT_INIT_ERR)}o((r.runtime_order||n.order).split(/\s*,\s*/))},getRuntime:function(){return i&&i.uid?i:(i=null,null)},disconnectRuntime:function(){i&&--i.clients<=0&&(i.destroy(),i=null)}})}}),i(v,[s,h,m],function(e,t,n){function i(o,a){function s(t,n,o){var a,s=r[this.uid];return"string"===e.typeOf(s)&&s.length?(a=new i(null,{type:o,size:n-t}),a.detach(s.substr(t,a.size)),a):null}n.call(this),o&&this.connectRuntime(o),a?"string"===e.typeOf(a)&&(a={data:a}):a={},e.extend(this,{uid:a.uid||e.guid("uid_"),ruid:o,size:a.size||0,type:a.type||"",slice:function(e,t,n){return this.isDetached()?s.apply(this,arguments):this.getRuntime().exec.call(this,"Blob","slice",this.getSource(),e,t,n)},getSource:function(){return r[this.uid]?r[this.uid]:null},detach:function(e){this.ruid&&(this.getRuntime().exec.call(this,"Blob","destroy"),this.disconnectRuntime(),this.ruid=null),e=e||"";var n=e.match(/^data:([^;]*);base64,/);n&&(this.type=n[1],e=t.atob(e.substring(e.indexOf("base64,")+7))),this.size=e.length,r[this.uid]=e},isDetached:function(){return!this.ruid&&"string"===e.typeOf(r[this.uid])},destroy:function(){this.detach(),delete r[this.uid]}}),a.data?this.detach(a.data):r[this.uid]=a}var r={};return i}),i(_,[s,c,v],function(e,t,n){function i(i,r){var o,a;if(r||(r={}),a=r.type&&""!==r.type?r.type:t.getFileMime(r.name),r.name)o=r.name.replace(/\\/g,"/"),o=o.substr(o.lastIndexOf("/")+1);else{var s=a.split("/")[0];o=e.guid((""!==s?s:"file")+"_"),t.extensions[a]&&(o+="."+t.extensions[a][0])}n.apply(this,arguments),e.extend(this,{type:a||"",name:o||e.guid("file_"),lastModifiedDate:r.lastModifiedDate||(new Date).toLocaleString()})}return i.prototype=n.prototype,i}),i(y,[s,c,d,f,p,u,_,g,m],function(e,t,n,i,r,o,a,s,u){function c(r){var c,d,f,p=this;if(-1!==e.inArray(e.typeOf(r),["string","node"])&&(r={browse_button:r}),d=n.get(r.browse_button),!d)throw new i.DOMException(i.DOMException.NOT_FOUND_ERR);f={accept:[{title:o.translate("All Files"),extensions:"*"}],name:"file",multiple:!1,required_caps:!1,container:d.parentNode||document.body},r=e.extend({},f,r),"string"==typeof r.required_caps&&(r.required_caps=s.parseCaps(r.required_caps)),"string"==typeof r.accept&&(r.accept=t.mimes2extList(r.accept)),c=n.get(r.container),c||(c=document.body),"static"===n.getStyle(c,"position")&&(c.style.position="relative"),c=d=null,u.call(p),e.extend(p,{uid:e.guid("uid_"),ruid:null,shimid:null,files:null,init:function(){p.convertEventPropsToHandlers(l),p.bind("RuntimeInit",function(t,i){p.ruid=i.uid,p.shimid=i.shimid,p.bind("Ready",function(){p.trigger("Refresh")},999),p.bind("Change",function(){var t=i.exec.call(p,"FileInput","getFiles");p.files=[],e.each(t,function(e){return 0===e.size?!0:void p.files.push(new a(p.ruid,e))})},999),p.bind("Refresh",function(){var t,o,a,s;a=n.get(r.browse_button),s=n.get(i.shimid),a&&(t=n.getPos(a,n.get(r.container)),o=n.getSize(a),s&&e.extend(s.style,{top:t.y+"px",left:t.x+"px",width:o.w+"px",height:o.h+"px"})),s=a=null}),i.exec.call(p,"FileInput","init",r)}),p.connectRuntime(e.extend({},r,{required_caps:{select_file:!0}}))},disable:function(t){var n=this.getRuntime();n&&n.exec.call(this,"FileInput","disable","undefined"===e.typeOf(t)?!0:t)},refresh:function(){p.trigger("Refresh")},destroy:function(){var t=this.getRuntime();t&&(t.exec.call(this,"FileInput","destroy"),this.disconnectRuntime()),"array"===e.typeOf(this.files)&&e.each(this.files,function(e){e.destroy()}),this.files=null}})}var l=["ready","change","cancel","mouseenter","mouseleave","mousedown","mouseup"];return c.prototype=r.instance,c}),i(w,[u,d,f,s,_,m,p,c],function(e,t,n,i,r,o,a,s){function u(n){var a,u=this;"string"==typeof n&&(n={drop_zone:n}),a={accept:[{title:e.translate("All Files"),extensions:"*"}],required_caps:{drag_and_drop:!0}},n="object"==("undefined"==typeof n?"undefined":_typeof(n))?i.extend({},a,n):a,n.container=t.get(n.drop_zone)||document.body,"static"===t.getStyle(n.container,"position")&&(n.container.style.position="relative"),"string"==typeof n.accept&&(n.accept=s.mimes2extList(n.accept)),o.call(u),i.extend(u,{uid:i.guid("uid_"),ruid:null,files:null,init:function(){u.convertEventPropsToHandlers(c),u.bind("RuntimeInit",function(e,t){u.ruid=t.uid,u.bind("Drop",function(){var e=t.exec.call(u,"FileDrop","getFiles");u.files=[],i.each(e,function(e){u.files.push(new r(u.ruid,e))})},999),t.exec.call(u,"FileDrop","init",n),u.dispatchEvent("ready")}),u.connectRuntime(n)},destroy:function(){var e=this.getRuntime();e&&(e.exec.call(this,"FileDrop","destroy"),this.disconnectRuntime()),this.files=null}})}var c=["ready","dragenter","dragleave","drop","error"];return u.prototype=a.instance,u}),i(E,[s,m,p],function(e,t,n){function i(){this.uid=e.guid("uid_"),t.call(this),this.destroy=function(){this.disconnectRuntime(),this.unbindAll()}}return i.prototype=n.instance,i}),i(b,[s,h,f,p,v,_,E],function(e,t,n,i,r,o,a){function s(){function i(e,i){function l(e){c.readyState=s.DONE,c.error=e,c.trigger("error"),d()}function d(){o.destroy(),o=null,c.trigger("loadend")}function f(t){o.bind("Error",function(e,t){l(t)}),o.bind("Progress",function(e){c.result=t.exec.call(o,"FileReader","getResult"),c.trigger(e)}),o.bind("Load",function(e){c.readyState=s.DONE,c.result=t.exec.call(o,"FileReader","getResult"),c.trigger(e),d()}),t.exec.call(o,"FileReader","read",e,i)}if(o=new a,this.convertEventPropsToHandlers(u),this.readyState===s.LOADING)return l(new n.DOMException(n.DOMException.INVALID_STATE_ERR));if(this.readyState=s.LOADING,this.trigger("loadstart"),i instanceof r)if(i.isDetached()){var p=i.getSource();switch(e){case"readAsText":case"readAsBinaryString":this.result=p;break;case"readAsDataURL":this.result="data:"+i.type+";base64,"+t.btoa(p)}this.readyState=s.DONE,this.trigger("load"),d()}else f(o.connectRuntime(i.ruid));else l(new n.DOMException(n.DOMException.NOT_FOUND_ERR))}var o,c=this;e.extend(this,{uid:e.guid("uid_"),
readyState:s.EMPTY,result:null,error:null,readAsBinaryString:function(e){i.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){i.call(this,"readAsDataURL",e)},readAsText:function(e){i.call(this,"readAsText",e)},abort:function(){this.result=null,-1===e.inArray(this.readyState,[s.EMPTY,s.DONE])&&(this.readyState===s.LOADING&&(this.readyState=s.DONE),o&&o.getRuntime().exec.call(this,"FileReader","abort"),this.trigger("abort"),this.trigger("loadend"))},destroy:function(){this.abort(),o&&(o.getRuntime().exec.call(this,"FileReader","destroy"),o.disconnectRuntime()),c=o=null}})}var u=["loadstart","progress","load","abort","error","loadend"];return s.EMPTY=0,s.LOADING=1,s.DONE=2,s.prototype=i.instance,s}),i(R,[],function(){var e=function i(e,t){for(var n=["source","scheme","authority","userInfo","user","pass","host","port","relative","path","directory","file","query","fragment"],r=n.length,o={http:80,https:443},a={},s=/^(?:([^:\/?#]+):)?(?:\/\/()(?:(?:()(?:([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?()(?:(()(?:(?:[^?#\/]*\/)*)()(?:[^?#]*))(?:\\?([^#]*))?(?:#(.*))?)/,u=s.exec(e||"");r--;)u[r]&&(a[n[r]]=u[r]);if(!a.scheme){t&&"string"!=typeof t||(t=i(t||document.location.href)),a.scheme=t.scheme,a.host=t.host,a.port=t.port;var c="";/^[^\/]/.test(a.path)&&(c=t.path,/(\/|\/[^\.]+)$/.test(c)?c+="/":c=c.replace(/\/[^\/]+$/,"/")),a.path=c+(a.path||"")}return a.port||(a.port=o[a.scheme]||80),a.port=parseInt(a.port,10),a.path||(a.path="/"),delete a.source,a},t=function(t){var n={http:80,https:443},i=e(t);return i.scheme+"://"+i.host+(i.port!==n[i.scheme]?":"+i.port:"")+i.path+(i.query?i.query:"")},n=function r(t){function r(e){return[e.scheme,e.host,e.port].join("/")}return"string"==typeof t&&(t=e(t)),r(e())===r(t)};return{parseUrl:e,resolveUrl:t,hasSameOrigin:n}}),i(x,[s,m,h],function(e,t,n){return function(){function i(e,t){if(!t.isDetached()){var i=this.connectRuntime(t.ruid).exec.call(this,"FileReaderSync","read",e,t);return this.disconnectRuntime(),i}var r=t.getSource();switch(e){case"readAsBinaryString":return r;case"readAsDataURL":return"data:"+t.type+";base64,"+n.btoa(r);case"readAsText":for(var o="",a=0,s=r.length;s>a;a++)o+=String.fromCharCode(r[a]);return o}}t.call(this),e.extend(this,{uid:e.guid("uid_"),readAsBinaryString:function(e){return i.call(this,"readAsBinaryString",e)},readAsDataURL:function(e){return i.call(this,"readAsDataURL",e)},readAsText:function(e){return i.call(this,"readAsText",e)}})}}),i(S,[f,s,v],function(e,t,n){function i(){var e,i=[];t.extend(this,{append:function(r,o){var a=this,s=t.typeOf(o);o instanceof n?e={name:r,value:o}:"array"===s?(r+="[]",t.each(o,function(e){a.append(r,e)})):"object"===s?t.each(o,function(e,t){a.append(r+"["+t+"]",e)}):"null"===s||"undefined"===s||"number"===s&&isNaN(o)?a.append(r,"false"):i.push({name:r,value:o.toString()})},hasBlob:function(){return!!this.getBlob()},getBlob:function(){return e&&e.value||null},getBlobName:function(){return e&&e.name||null},each:function(n){t.each(i,function(e){n(e.value,e.name)}),e&&n(e.value,e.name)},destroy:function(){e=null,i=[]}})}return i}),i(T,[s,f,p,h,R,g,E,v,x,S,l,c],function(e,t,n,i,r,o,a,s,u,c,l,d){function f(){this.uid=e.guid("uid_")}function p(){function n(e,t){return T.hasOwnProperty(e)?1===arguments.length?l.can("define_property")?T[e]:S[e]:void(l.can("define_property")?T[e]=t:S[e]=t):void 0}function u(t){function i(){R&&(R.destroy(),R=null),s.dispatchEvent("loadend"),s=null}function r(r){R.bind("LoadStart",function(e){n("readyState",p.LOADING),s.dispatchEvent("readystatechange"),s.dispatchEvent(e),M&&s.upload.dispatchEvent(e)}),R.bind("Progress",function(e){n("readyState")!==p.LOADING&&(n("readyState",p.LOADING),s.dispatchEvent("readystatechange")),s.dispatchEvent(e)}),R.bind("UploadProgress",function(e){M&&s.upload.dispatchEvent({type:"progress",lengthComputable:!1,total:e.total,loaded:e.loaded})}),R.bind("Load",function(t){n("readyState",p.DONE),n("status",Number(r.exec.call(R,"XMLHttpRequest","getStatus")||0)),n("statusText",h[n("status")]||""),n("response",r.exec.call(R,"XMLHttpRequest","getResponse",n("responseType"))),~e.inArray(n("responseType"),["text",""])?n("responseText",n("response")):"document"===n("responseType")&&n("responseXML",n("response")),k=r.exec.call(R,"XMLHttpRequest","getAllResponseHeaders"),s.dispatchEvent("readystatechange"),n("status")>0?(M&&s.upload.dispatchEvent(t),s.dispatchEvent(t)):(F=!0,s.dispatchEvent("error")),i()}),R.bind("Abort",function(e){s.dispatchEvent(e),i()}),R.bind("Error",function(e){F=!0,n("readyState",p.DONE),s.dispatchEvent("readystatechange"),C=!0,s.dispatchEvent(e),i()}),r.exec.call(R,"XMLHttpRequest","send",{url:v,method:_,async:A,user:y,password:w,headers:O,mimeType:D,encoding:I,responseType:s.responseType,withCredentials:s.withCredentials,options:U},t)}var s=this;E=(new Date).getTime(),R=new a,"string"==typeof U.required_caps&&(U.required_caps=o.parseCaps(U.required_caps)),U.required_caps=e.extend({},U.required_caps,{return_response_type:s.responseType}),t instanceof c&&(U.required_caps.send_multipart=!0),P||(U.required_caps.do_cors=!0),U.ruid?r(R.connectRuntime(U)):(R.bind("RuntimeInit",function(e,t){r(t)}),R.bind("RuntimeError",function(e,t){s.dispatchEvent("RuntimeError",t)}),R.connectRuntime(U))}function m(){n("responseText",""),n("responseXML",null),n("response",null),n("status",0),n("statusText",""),E=b=null}var v,_,y,w,E,b,R,x,S=this,T={timeout:0,readyState:p.UNSENT,withCredentials:!1,status:0,statusText:"",responseType:"",responseXML:null,responseText:null,response:null},A=!0,O={},I=null,D=null,N=!1,L=!1,M=!1,C=!1,F=!1,P=!1,z=null,H=null,U={},k="";e.extend(this,T,{uid:e.guid("uid_"),upload:new f,open:function(o,a,s,u,c){var l;if(!o||!a)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(/[\u0100-\uffff]/.test(o)||i.utf8_encode(o)!==o)throw new t.DOMException(t.DOMException.SYNTAX_ERR);if(~e.inArray(o.toUpperCase(),["CONNECT","DELETE","GET","HEAD","OPTIONS","POST","PUT","TRACE","TRACK"])&&(_=o.toUpperCase()),~e.inArray(_,["CONNECT","TRACE","TRACK"]))throw new t.DOMException(t.DOMException.SECURITY_ERR);if(a=i.utf8_encode(a),l=r.parseUrl(a),P=r.hasSameOrigin(l),v=r.resolveUrl(a),(u||c)&&!P)throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);if(y=u||l.user,w=c||l.pass,A=s||!0,A===!1&&(n("timeout")||n("withCredentials")||""!==n("responseType")))throw new t.DOMException(t.DOMException.INVALID_ACCESS_ERR);N=!A,L=!1,O={},m.call(this),n("readyState",p.OPENED),this.convertEventPropsToHandlers(["readystatechange"]),this.dispatchEvent("readystatechange")},setRequestHeader:function(r,o){var a=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"];if(n("readyState")!==p.OPENED||L)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(/[\u0100-\uffff]/.test(r)||i.utf8_encode(r)!==r)throw new t.DOMException(t.DOMException.SYNTAX_ERR);return r=e.trim(r).toLowerCase(),~e.inArray(r,a)||/^(proxy\-|sec\-)/.test(r)?!1:(O[r]?O[r]+=", "+o:O[r]=o,!0)},getAllResponseHeaders:function(){return k||""},getResponseHeader:function(t){return t=t.toLowerCase(),F||~e.inArray(t,["set-cookie","set-cookie2"])?null:k&&""!==k&&(x||(x={},e.each(k.split(/\r\n/),function(t){var n=t.split(/:\s+/);2===n.length&&(n[0]=e.trim(n[0]),x[n[0].toLowerCase()]={header:n[0],value:e.trim(n[1])})})),x.hasOwnProperty(t))?x[t].header+": "+x[t].value:null},overrideMimeType:function(i){var r,o;if(~e.inArray(n("readyState"),[p.LOADING,p.DONE]))throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(i=e.trim(i.toLowerCase()),/;/.test(i)&&(r=i.match(/^([^;]+)(?:;\scharset\=)?(.*)$/))&&(i=r[1],r[2]&&(o=r[2])),!d.mimes[i])throw new t.DOMException(t.DOMException.SYNTAX_ERR);z=i,H=o},send:function(n,r){if(U="string"===e.typeOf(r)?{ruid:r}:r?r:{},this.convertEventPropsToHandlers(g),this.upload.convertEventPropsToHandlers(g),this.readyState!==p.OPENED||L)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);if(n instanceof s)U.ruid=n.ruid,D=n.type||"application/octet-stream";else if(n instanceof c){if(n.hasBlob()){var o=n.getBlob();U.ruid=o.ruid,D=o.type||"application/octet-stream"}}else"string"==typeof n&&(I="UTF-8",D="text/plain;charset=UTF-8",n=i.utf8_encode(n));this.withCredentials||(this.withCredentials=U.required_caps&&U.required_caps.send_browser_cookies&&!P),M=!N&&this.upload.hasEventListener(),F=!1,C=!n,N||(L=!0),u.call(this,n)},abort:function(){if(F=!0,N=!1,~e.inArray(n("readyState"),[p.UNSENT,p.OPENED,p.DONE]))n("readyState",p.UNSENT);else{if(n("readyState",p.DONE),L=!1,!R)throw new t.DOMException(t.DOMException.INVALID_STATE_ERR);R.getRuntime().exec.call(R,"XMLHttpRequest","abort",C),C=!0}},destroy:function(){R&&("function"===e.typeOf(R.destroy)&&R.destroy(),R=null),this.unbindAll(),this.upload&&(this.upload.unbindAll(),this.upload=null)}})}var h={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",306:"Reserved",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",510:"Not Extended"};f.prototype=n.instance;var g=["loadstart","progress","abort","error","load","timeout","loadend"];return p.UNSENT=0,p.OPENED=1,p.HEADERS_RECEIVED=2,p.LOADING=3,p.DONE=4,p.prototype=n.instance,p}),i(A,[s,h,m,p],function(e,t,n,i){function r(){function i(){l=d=0,c=this.result=null}function o(t,n){var i=this;u=n,i.bind("TransportingProgress",function(t){d=t.loaded,l>d&&-1===e.inArray(i.state,[r.IDLE,r.DONE])&&a.call(i)},999),i.bind("TransportingComplete",function(){d=l,i.state=r.DONE,c=null,i.result=u.exec.call(i,"Transporter","getAsBlob",t||"")},999),i.state=r.BUSY,i.trigger("TransportingStarted"),a.call(i)}function a(){var e,n=this,i=l-d;f>i&&(f=i),e=t.btoa(c.substr(d,f)),u.exec.call(n,"Transporter","receive",e,l)}var s,u,c,l,d,f;n.call(this),e.extend(this,{uid:e.guid("uid_"),state:r.IDLE,result:null,transport:function(t,n,r){var a=this;if(r=e.extend({chunk_size:204798},r),(s=r.chunk_size%3)&&(r.chunk_size+=3-s),f=r.chunk_size,i.call(this),c=t,l=t.length,"string"===e.typeOf(r)||r.ruid)o.call(a,n,this.connectRuntime(r));else{var u=function d(e,t){a.unbind("RuntimeInit",d),o.call(a,n,t)};this.bind("RuntimeInit",u),this.connectRuntime(r)}},abort:function(){var e=this;e.state=r.IDLE,u&&(u.exec.call(e,"Transporter","clear"),e.trigger("TransportingAborted")),i.call(e)},destroy:function(){this.unbindAll(),u=null,this.disconnectRuntime(),i.call(this)}})}return r.IDLE=0,r.BUSY=1,r.DONE=2,r.prototype=i.instance,r}),i(O,[s,d,f,x,T,g,m,A,l,p,v,_,h],function(e,t,n,i,r,o,a,s,u,c,l,d,f){function p(){function i(e){e||(e=this.getRuntime().exec.call(this,"Image","getInfo")),this.size=e.size,this.width=e.width,this.height=e.height,this.type=e.type,this.meta=e.meta,""===this.name&&(this.name=e.name)}function c(t){var i=e.typeOf(t);try{if(t instanceof p){if(!t.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);g.apply(this,arguments)}else if(t instanceof l){if(!~e.inArray(t.type,["image/jpeg","image/png"]))throw new n.ImageError(n.ImageError.WRONG_FORMAT);m.apply(this,arguments)}else if(-1!==e.inArray(i,["blob","file"]))c.call(this,new d(null,t),arguments[1]);else if("string"===i)/^data:[^;]*;base64,/.test(t)?c.call(this,new l(null,{data:t}),arguments[1]):v.apply(this,arguments);else{if("node"!==i||"img"!==t.nodeName.toLowerCase())throw new n.DOMException(n.DOMException.TYPE_MISMATCH_ERR);c.call(this,t.src,arguments[1])}}catch(r){this.trigger("error",r.code)}}function g(t,n){var i=this.connectRuntime(t.ruid);this.ruid=i.uid,i.exec.call(this,"Image","loadFromImage",t,"undefined"===e.typeOf(n)?!0:n)}function m(t,n){function i(e){r.ruid=e.uid,e.exec.call(r,"Image","loadFromBlob",t)}var r=this;r.name=t.name||"",t.isDetached()?(this.bind("RuntimeInit",function(e,t){i(t)}),n&&"string"==typeof n.required_caps&&(n.required_caps=o.parseCaps(n.required_caps)),this.connectRuntime(e.extend({required_caps:{access_image_binary:!0,resize_image:!0}},n))):i(this.connectRuntime(t.ruid))}function v(e,t){var n,i=this;n=new r,n.open("get",e),n.responseType="blob",n.onprogress=function(e){i.trigger(e)},n.onload=function(){m.call(i,n.response,!0)},n.onerror=function(e){i.trigger(e)},n.onloadend=function(){n.destroy()},n.bind("RuntimeError",function(e,t){i.trigger("RuntimeError",t)}),n.send(null,t)}a.call(this),e.extend(this,{uid:e.guid("uid_"),ruid:null,name:"",size:0,width:0,height:0,type:"",meta:{},clone:function(){this.load.apply(this,arguments)},load:function(){this.bind("Load Resize",function(){i.call(this)},999),this.convertEventPropsToHandlers(h),c.apply(this,arguments)},downsize:function(t){var i={width:this.width,height:this.height,crop:!1,preserveHeaders:!0};t="object"==("undefined"==typeof t?"undefined":_typeof(t))?e.extend(i,t):e.extend(i,{width:arguments[0],height:arguments[1],crop:arguments[2],preserveHeaders:arguments[3]});try{if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);if(this.width>p.MAX_RESIZE_WIDTH||this.height>p.MAX_RESIZE_HEIGHT)throw new n.ImageError(n.ImageError.MAX_RESOLUTION_ERR);this.getRuntime().exec.call(this,"Image","downsize",t.width,t.height,t.crop,t.preserveHeaders)}catch(r){this.trigger("error",r.code)}},crop:function(e,t,n){this.downsize(e,t,!0,n)},getAsCanvas:function(){if(!u.can("create_canvas"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);var e=this.connectRuntime(this.ruid);return e.exec.call(this,"Image","getAsCanvas")},getAsBlob:function(e,t){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return e||(e="image/jpeg"),"image/jpeg"!==e||t||(t=90),this.getRuntime().exec.call(this,"Image","getAsBlob",e,t)},getAsDataURL:function(e,t){if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);return this.getRuntime().exec.call(this,"Image","getAsDataURL",e,t)},getAsBinaryString:function(e,t){var n=this.getAsDataURL(e,t);return f.atob(n.substring(n.indexOf("base64,")+7))},embed:function(i){function r(){if(u.can("create_canvas")){var t=o.getAsCanvas();if(t)return i.appendChild(t),t=null,o.destroy(),void h.trigger("embedded")}var r=o.getAsDataURL(a,c);if(!r)throw new n.ImageError(n.ImageError.WRONG_FORMAT);if(u.can("use_data_uri_of",r.length))i.innerHTML='<img src="'+r+'" width="'+o.width+'" height="'+o.height+'" />',o.destroy(),h.trigger("embedded");else{var l=new s;l.bind("TransportingComplete",function(){d=h.connectRuntime(this.result.ruid),h.bind("Embedded",function(){e.extend(d.getShimContainer().style,{top:"0px",left:"0px",width:o.width+"px",height:o.height+"px"}),d=null},999),d.exec.call(h,"ImageView","display",this.result.uid,m,v),o.destroy()}),l.transport(f.atob(r.substring(r.indexOf("base64,")+7)),a,e.extend({},g,{required_caps:{display_media:!0},runtime_order:"flash,silverlight",container:i}))}}var o,a,c,l,d,h=this,g=arguments[1]||{},m=this.width,v=this.height;try{if(!(i=t.get(i)))throw new n.DOMException(n.DOMException.INVALID_NODE_TYPE_ERR);if(!this.size)throw new n.DOMException(n.DOMException.INVALID_STATE_ERR);if(this.width>p.MAX_RESIZE_WIDTH||this.height>p.MAX_RESIZE_HEIGHT)throw new n.ImageError(n.ImageError.MAX_RESOLUTION_ERR);if(a=g.type||this.type||"image/jpeg",c=g.quality||90,l="undefined"!==e.typeOf(g.crop)?g.crop:!1,g.width)m=g.width,v=g.height||m;else{var _=t.getSize(i);_.w&&_.h&&(m=_.w,v=_.h)}return o=new p,o.bind("Resize",function(){r.call(h)}),o.bind("Load",function(){o.downsize(m,v,l,!1)}),o.clone(this,!1),o}catch(y){this.trigger("error",y.code)}},destroy:function(){this.ruid&&(this.getRuntime().exec.call(this,"Image","destroy"),this.disconnectRuntime()),this.unbindAll()}})}var h=["progress","load","error","resize","embedded"];return p.MAX_RESIZE_WIDTH=6500,p.MAX_RESIZE_HEIGHT=6500,p.prototype=c.instance,p}),i(I,[s,f,g,l],function(e,t,n,i){function r(t){var r=this,s=n.capTest,u=n.capTrue,c=e.extend({access_binary:s(window.FileReader||window.File&&window.File.getAsDataURL),access_image_binary:function(){return r.can("access_binary")&&!!a.Image},display_media:s(i.can("create_canvas")||i.can("use_data_uri_over32kb")),do_cors:s(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest),drag_and_drop:s(function(){var e=document.createElement("div");return("draggable"in e||"ondragstart"in e&&"ondrop"in e)&&("IE"!==i.browser||i.version>9)}()),filter_by_extension:s(function(){return"Chrome"===i.browser&&i.version>=28||"IE"===i.browser&&i.version>=10}()),return_response_headers:u,return_response_type:function(e){return"json"===e&&window.JSON?!0:i.can("return_response_type",e)},return_status_code:u,report_upload_progress:s(window.XMLHttpRequest&&(new XMLHttpRequest).upload),resize_image:function(){return r.can("access_binary")&&i.can("create_canvas")},select_file:function(){return i.can("use_fileinput")&&window.File},select_folder:function(){return r.can("select_file")&&"Chrome"===i.browser&&i.version>=21},select_multiple:function(){return!(!r.can("select_file")||"Safari"===i.browser&&"Windows"===i.os||"iOS"===i.os&&i.verComp(i.osVersion,"7.0.4","<"))},send_binary_string:s(window.XMLHttpRequest&&((new XMLHttpRequest).sendAsBinary||window.Uint8Array&&window.ArrayBuffer)),send_custom_headers:s(window.XMLHttpRequest),send_multipart:function(){return!!(window.XMLHttpRequest&&(new XMLHttpRequest).upload&&window.FormData)||r.can("send_binary_string")},slice_blob:s(window.File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice)),stream_upload:function(){return r.can("slice_blob")&&r.can("send_multipart")},summon_file_dialog:s(function(){return"Firefox"===i.browser&&i.version>=4||"Opera"===i.browser&&i.version>=12||"IE"===i.browser&&i.version>=10||!!~e.inArray(i.browser,["Chrome","Safari"])}()),upload_filesize:u},arguments[2]);n.call(this,t,arguments[1]||o,c),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(r),e=r=null}}(this.destroy)}),e.extend(this.getShim(),a)}var o="html5",a={};return n.addConstructor(o,r),a}),i(D,[I,v],function(e,t){function n(){function e(e,t,n){var i;if(!window.File.prototype.slice)return(i=window.File.prototype.webkitSlice||window.File.prototype.mozSlice)?i.call(e,t,n):null;try{return e.slice(),e.slice(t,n)}catch(r){return e.slice(t,n-t)}}this.slice=function(){return new t(this.getRuntime().uid,e.apply(this,arguments))}}return e.Blob=n}),i(N,[s],function(e){function t(){this.returnValue=!1}function n(){this.cancelBubble=!0}var i={},r="moxie_"+e.guid(),o=function(o,a,s,u){var c,l;a=a.toLowerCase(),o.addEventListener?(c=s,o.addEventListener(a,c,!1)):o.attachEvent&&(c=function(){var e=window.event;e.target||(e.target=e.srcElement),e.preventDefault=t,e.stopPropagation=n,s(e)},o.attachEvent("on"+a,c)),o[r]||(o[r]=e.guid()),i.hasOwnProperty(o[r])||(i[o[r]]={}),l=i[o[r]],l.hasOwnProperty(a)||(l[a]=[]),l[a].push({func:c,orig:s,key:u})},a=function u(t,n,o){var u,a;if(n=n.toLowerCase(),t[r]&&i[t[r]]&&i[t[r]][n]){u=i[t[r]][n];for(var s=u.length-1;s>=0&&(u[s].orig!==o&&u[s].key!==o||(t.removeEventListener?t.removeEventListener(n,u[s].func,!1):t.detachEvent&&t.detachEvent("on"+n,u[s].func),u[s].orig=null,u[s].func=null,u.splice(s,1),o===a));s--);if(u.length||delete i[t[r]][n],e.isEmptyObj(i[t[r]])){delete i[t[r]];try{delete t[r]}catch(c){t[r]=a}}}},s=function(t,n){t&&t[r]&&e.each(i[t[r]],function(e,i){a(t,i,n)})};return{addEvent:o,removeEvent:a,removeAllEvents:s}}),i(L,[I,s,d,N,c,l],function(e,t,n,i,r,o){function a(){var e,a=[];t.extend(this,{init:function(s){var u,c,l,d,f,p,h=this,g=h.getRuntime();e=s,a=[],l=e.accept.mimes||r.extList2mimes(e.accept,g.can("filter_by_extension")),c=g.getShimContainer(),c.innerHTML='<input id="'+g.uid+'" type="file" style="font-size:999px;opacity:0;"'+(e.multiple&&g.can("select_multiple")?"multiple":"")+(e.directory&&g.can("select_folder")?"webkitdirectory directory":"")+(l?' accept="'+l.join(",")+'"':"")+" />",u=n.get(g.uid),t.extend(u.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),d=n.get(e.browse_button),g.can("summon_file_dialog")&&("static"===n.getStyle(d,"position")&&(d.style.position="relative"),f=parseInt(n.getStyle(d,"z-index"),10)||1,d.style.zIndex=f,c.style.zIndex=f-1,i.addEvent(d,"click",function(e){var t=n.get(g.uid);t&&!t.disabled&&t.click(),e.preventDefault()},h.uid)),p=g.can("summon_file_dialog")?d:c,i.addEvent(p,"mouseover",function(){h.trigger("mouseenter")},h.uid),i.addEvent(p,"mouseout",function(){h.trigger("mouseleave")},h.uid),i.addEvent(p,"mousedown",function(){h.trigger("mousedown")},h.uid),i.addEvent(n.get(e.container),"mouseup",function(){h.trigger("mouseup")},h.uid),u.onchange=function m(){if(a=[],e.directory?t.each(this.files,function(e){"."!==e.name&&a.push(e)}):a=[].slice.call(this.files),"IE"!==o.browser&&"IEMobile"!==o.browser)this.value="";else{var n=this.cloneNode(!0);this.parentNode.replaceChild(n,this),n.onchange=m}h.trigger("change")},h.trigger({type:"ready",async:!0}),c=null},getFiles:function(){return a},disable:function(e){var t,i=this.getRuntime();(t=n.get(i.uid))&&(t.disabled=!!e)},destroy:function(){var t=this.getRuntime(),r=t.getShim(),o=t.getShimContainer();i.removeAllEvents(o,this.uid),i.removeAllEvents(e&&n.get(e.container),this.uid),i.removeAllEvents(e&&n.get(e.browse_button),this.uid),o&&(o.innerHTML=""),r.removeInstance(this.uid),a=e=o=r=null}})}return e.FileInput=a}),i(M,[I,s,d,N,c],function(e,t,n,i,r){function o(){function e(e){if(!e.dataTransfer||!e.dataTransfer.types)return!1;var n=t.toArray(e.dataTransfer.types||[]);return-1!==t.inArray("Files",n)||-1!==t.inArray("public.file-url",n)||-1!==t.inArray("application/x-moz-file",n)}function o(e){for(var n=[],i=0;i<e.length;i++)[].push.apply(n,e[i].extensions.split(/\s*,\s*/));return-1===t.inArray("*",n)?n:[]}function a(e){if(!p.length)return!0;var n=r.getFileExtension(e.name);return!n||-1!==t.inArray(n,p)}function s(e,n){var i=[];t.each(e,function(e){var t=e.webkitGetAsEntry();if(t)if(t.isFile){var n=e.getAsFile();a(n)&&f.push(n)}else i.push(t)}),i.length?u(i,n):n()}function u(e,n){var i=[];t.each(e,function(e){i.push(function(t){c(e,t)})}),t.inSeries(i,function(){n()})}function c(e,t){e.isFile?e.file(function(e){a(e)&&f.push(e),t()},function(){t()}):e.isDirectory?l(e,t):t()}function l(e,t){function n(e){r.readEntries(function(t){t.length?([].push.apply(i,t),n(e)):e()},e)}var i=[],r=e.createReader();n(function(){u(i,t)})}var d,f=[],p=[];t.extend(this,{init:function(n){var r,u=this;d=n,p=o(d.accept),r=d.container,i.addEvent(r,"dragover",function(t){e(t)&&(t.preventDefault(),t.dataTransfer.dropEffect="copy")},u.uid),i.addEvent(r,"drop",function(n){e(n)&&(n.preventDefault(),f=[],n.dataTransfer.items&&n.dataTransfer.items[0].webkitGetAsEntry?s(n.dataTransfer.items,function(){u.trigger("drop")}):(t.each(n.dataTransfer.files,function(e){a(e)&&f.push(e)}),u.trigger("drop")))},u.uid),i.addEvent(r,"dragenter",function(e){u.trigger("dragenter")},u.uid),i.addEvent(r,"dragleave",function(e){u.trigger("dragleave")},u.uid)},getFiles:function(){return f},destroy:function(){i.removeAllEvents(d&&n.get(d.container),this.uid),f=p=d=null}})}return e.FileDrop=o}),i(C,[I,h,s],function(e,t,n){function i(){function e(e){return t.atob(e.substring(e.indexOf("base64,")+7))}var i,r=!1;n.extend(this,{read:function(e,t){var o=this;i=new window.FileReader,i.addEventListener("progress",function(e){o.trigger(e)}),i.addEventListener("load",function(e){o.trigger(e)}),i.addEventListener("error",function(e){o.trigger(e,i.error)}),i.addEventListener("loadend",function(){i=null}),"function"===n.typeOf(i[e])?(r=!1,i[e](t.getSource())):"readAsBinaryString"===e&&(r=!0,i.readAsDataURL(t.getSource()))},getResult:function(){return i&&i.result?r?e(i.result):i.result:null},abort:function(){i&&i.abort()},destroy:function(){i=null}})}return e.FileReader=i}),i(F,[I,s,c,R,_,v,S,f,l],function(e,t,n,i,r,o,a,s,u){function c(){function e(e,t){var n,i,r=this;n=t.getBlob().getSource(),i=new window.FileReader,i.onload=function(){t.append(t.getBlobName(),new o(null,{type:n.type,data:i.result})),h.send.call(r,e,t)},i.readAsBinaryString(n)}function c(){return!window.XMLHttpRequest||"IE"===u.browser&&u.version<8?function(){for(var e=["Msxml2.XMLHTTP.6.0","Microsoft.XMLHTTP"],t=0;t<e.length;t++)try{return new ActiveXObject(e[t])}catch(n){}}():new window.XMLHttpRequest}function l(e){var t=e.responseXML,n=e.responseText;return"IE"===u.browser&&n&&t&&!t.documentElement&&/[^\/]+\/[^\+]+\+xml/.test(e.getResponseHeader("Content-Type"))&&(t=new window.ActiveXObject("Microsoft.XMLDOM"),t.async=!1,t.validateOnParse=!1,t.loadXML(n)),t&&("IE"===u.browser&&0!==t.parseError||!t.documentElement||"parsererror"===t.documentElement.tagName)?null:t}function d(e){var t="----moxieboundary"+(new Date).getTime(),n="--",i="\r\n",r="",a=this.getRuntime();if(!a.can("send_binary_string"))throw new s.RuntimeError(s.RuntimeError.NOT_SUPPORTED_ERR);return f.setRequestHeader("Content-Type","multipart/form-data; boundary="+t),e.each(function(e,a){r+=e instanceof o?n+t+i+'Content-Disposition: form-data; name="'+a+'"; filename="'+unescape(encodeURIComponent(e.name||"blob"))+'"'+i+"Content-Type: "+(e.type||"application/octet-stream")+i+i+e.getSource()+i:n+t+i+'Content-Disposition: form-data; name="'+a+'"'+i+i+unescape(encodeURIComponent(e))+i}),r+=n+t+n+i}var f,p,h=this;t.extend(this,{send:function(n,r){var s=this,l="Mozilla"===u.browser&&u.version>=4&&u.version<7,h="Android Browser"===u.browser,g=!1;if(p=n.url.replace(/^.+?\/([\w\-\.]+)$/,"$1").toLowerCase(),f=c(),f.open(n.method,n.url,n.async,n.user,n.password),r instanceof o)r.isDetached()&&(g=!0),r=r.getSource();else if(r instanceof a){if(r.hasBlob())if(r.getBlob().isDetached())r=d.call(s,r),g=!0;else if((l||h)&&"blob"===t.typeOf(r.getBlob().getSource())&&window.FileReader)return void e.call(s,n,r);if(r instanceof a){var m=new window.FormData;r.each(function(e,t){e instanceof o?m.append(t,e.getSource()):m.append(t,e)}),r=m}}f.upload?(n.withCredentials&&(f.withCredentials=!0),f.addEventListener("load",function(e){s.trigger(e)}),f.addEventListener("error",function(e){s.trigger(e)}),f.addEventListener("progress",function(e){s.trigger(e)}),f.upload.addEventListener("progress",function(e){s.trigger({type:"UploadProgress",loaded:e.loaded,total:e.total})})):f.onreadystatechange=function(){switch(f.readyState){case 1:break;case 2:break;case 3:var e,t;try{i.hasSameOrigin(n.url)&&(e=f.getResponseHeader("Content-Length")||0),f.responseText&&(t=f.responseText.length)}catch(r){e=t=0}s.trigger({type:"progress",lengthComputable:!!e,total:parseInt(e,10),loaded:t});break;case 4:f.onreadystatechange=function(){},s.trigger(0===f.status?"error":"load")}},t.isEmptyObj(n.headers)||t.each(n.headers,function(e,t){f.setRequestHeader(t,e)}),""!==n.responseType&&"responseType"in f&&(f.responseType="json"!==n.responseType||u.can("return_response_type","json")?n.responseType:"text"),g?f.sendAsBinary?f.sendAsBinary(r):!function(){for(var e=new Uint8Array(r.length),t=0;t<r.length;t++)e[t]=255&r.charCodeAt(t);f.send(e.buffer)}():f.send(r),s.trigger("loadstart")},getStatus:function(){try{if(f)return f.status}catch(e){}return 0},getResponse:function(e){var t=this.getRuntime();try{switch(e){case"blob":var i=new r(t.uid,f.response),o=f.getResponseHeader("Content-Disposition");if(o){var a=o.match(/filename=([\'\"'])([^\1]+)\1/);a&&(p=a[2])}return i.name=p,i.type||(i.type=n.getFileMime(p)),i;case"json":return u.can("return_response_type","json")?f.response:200===f.status&&window.JSON?JSON.parse(f.responseText):null;case"document":return l(f);default:return""!==f.responseText?f.responseText:null}}catch(s){return null}},getAllResponseHeaders:function(){try{return f.getAllResponseHeaders()}catch(e){}return""},abort:function(){f&&f.abort()},destroy:function(){h=p=null}})}return e.XMLHttpRequest=c}),i(P,[],function(){return function(){function e(e,t){var n,i=o?0:-8*(t-1),a=0;for(n=0;t>n;n++)a|=r.charCodeAt(e+n)<<Math.abs(i+8*n);return a}function n(e,t,n){n=3===arguments.length?n:r.length-t-1,r=r.substr(0,t)+e+r.substr(n+t)}function i(e,t,i){var r,a="",s=o?0:-8*(i-1);for(r=0;i>r;r++)a+=String.fromCharCode(t>>Math.abs(s+8*r)&255);n(a,e,i)}var r,o=!1;return{II:function(e){return e===t?o:void(o=e)},init:function(e){o=!1,r=e},SEGMENT:function(e,t,i){switch(arguments.length){case 1:return r.substr(e,r.length-e-1);case 2:return r.substr(e,t);case 3:n(i,e,t);break;default:return r}},BYTE:function(t){return e(t,1)},SHORT:function(t){return e(t,2)},LONG:function(n,r){return r===t?e(n,4):void i(n,r,4)},SLONG:function(t){var n=e(t,4);return n>2147483647?n-4294967296:n},STRING:function(t,n){var i="";for(n+=t;n>t;t++)i+=String.fromCharCode(e(t,1));return i}}}}),i(z,[P],function(e){return function t(n){var i,r,o,a=[],s=0;if(i=new e,i.init(n),65496===i.SHORT(0)){for(r=2;r<=n.length;)if(o=i.SHORT(r),o>=65488&&65495>=o)r+=2;else{if(65498===o||65497===o)break;s=i.SHORT(r+2)+2,o>=65505&&65519>=o&&a.push({hex:o,name:"APP"+(15&o),start:r,length:s,segment:i.SEGMENT(r,s)}),r+=s}return i.init(null),{headers:a,restore:function(e){var t,n;for(i.init(e),r=65504==i.SHORT(2)?4+i.SHORT(4):2,n=0,t=a.length;t>n;n++)i.SEGMENT(r,0,a[n].segment),r+=a[n].length;return e=i.SEGMENT(),i.init(null),e},strip:function(e){var n,r,o;for(r=new t(e),n=r.headers,r.purge(),i.init(e),o=n.length;o--;)i.SEGMENT(n[o].start,n[o].length,"");return e=i.SEGMENT(),i.init(null),e},get:function(e){for(var t=[],n=0,i=a.length;i>n;n++)a[n].name===e.toUpperCase()&&t.push(a[n].segment);return t},set:function(e,t){var n,i,r,o=[];for("string"==typeof t?o.push(t):o=t,n=i=0,r=a.length;r>n&&(a[n].name===e.toUpperCase()&&(a[n].segment=o[i],a[n].length=o[i].length,i++),!(i>=o.length));n++);},purge:function(){a=[],i.init(null),i=null}}}}}),i(H,[s,P],function(e,n){return function i(){function i(e,n){var i,r,o,s,u,d,f,p,h=a.SHORT(e),g=[],m={};for(i=0;h>i;i++)if(f=d=e+12*i+2,o=n[a.SHORT(f)],o!==t){switch(s=a.SHORT(f+=2),u=a.LONG(f+=2),f+=4,g=[],s){case 1:case 7:for(u>4&&(f=a.LONG(f)+l.tiffHeader),r=0;u>r;r++)g[r]=a.BYTE(f+r);break;case 2:u>4&&(f=a.LONG(f)+l.tiffHeader),m[o]=a.STRING(f,u-1);continue;case 3:for(u>2&&(f=a.LONG(f)+l.tiffHeader),r=0;u>r;r++)g[r]=a.SHORT(f+2*r);break;case 4:for(u>1&&(f=a.LONG(f)+l.tiffHeader),r=0;u>r;r++)g[r]=a.LONG(f+4*r);break;case 5:for(f=a.LONG(f)+l.tiffHeader,r=0;u>r;r++)g[r]=a.LONG(f+4*r)/a.LONG(f+4*r+4);break;case 9:for(f=a.LONG(f)+l.tiffHeader,r=0;u>r;r++)g[r]=a.SLONG(f+4*r);break;case 10:for(f=a.LONG(f)+l.tiffHeader,r=0;u>r;r++)g[r]=a.SLONG(f+4*r)/a.SLONG(f+4*r+4);break;default:continue}p=1==u?g[0]:g,m[o]=c.hasOwnProperty(o)&&"object"!=("undefined"==typeof p?"undefined":_typeof(p))?c[o][p]:p}return m}function r(){var e=l.tiffHeader;return a.II(18761==a.SHORT(e)),42!==a.SHORT(e+=2)?!1:(l.IFD0=l.tiffHeader+a.LONG(e+=2),u=i(l.IFD0,s.tiff),"ExifIFDPointer"in u&&(l.exifIFD=l.tiffHeader+u.ExifIFDPointer,delete u.ExifIFDPointer),"GPSInfoIFDPointer"in u&&(l.gpsIFD=l.tiffHeader+u.GPSInfoIFDPointer,delete u.GPSInfoIFDPointer),!0)}function o(e,t,n){var i,r,o,u=0;if("string"==typeof t){var c=s[e.toLowerCase()];for(var d in c)if(c[d]===t){t=d;break}}i=l[e.toLowerCase()+"IFD"],r=a.SHORT(i);
for(var f=0;r>f;f++)if(o=i+12*f+2,a.SHORT(o)==t){u=o+8;break}return u?(a.LONG(u,n),!0):!1}var a,s,u,c,l={};return a=new n,s={tiff:{274:"Orientation",270:"ImageDescription",271:"Make",272:"Model",305:"Software",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}},c={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}},{init:function(e){return l={tiffHeader:10},e!==t&&e.length?(a.init(e),65505===a.SHORT(0)&&"EXIF\x00"===a.STRING(4,5).toUpperCase()?r():!1):!1},TIFF:function(){return u},EXIF:function(){var t;if(t=i(l.exifIFD,s.exif),t.ExifVersion&&"array"===e.typeOf(t.ExifVersion)){for(var n=0,r="";n<t.ExifVersion.length;n++)r+=String.fromCharCode(t.ExifVersion[n]);t.ExifVersion=r}return t},GPS:function(){var t;return t=i(l.gpsIFD,s.gps),t.GPSVersionID&&"array"===e.typeOf(t.GPSVersionID)&&(t.GPSVersionID=t.GPSVersionID.join(".")),t},setExif:function(e,t){return"PixelXDimension"!==e&&"PixelYDimension"!==e?!1:o("exif",e,t)},getBinary:function(){return a.SEGMENT()},purge:function(){a.init(null),a=u=null,l={}}}}}),i(U,[s,f,z,P,H],function(e,t,n,i,r){function o(o){function a(){for(var e,t,n=0;n<=u.length;){if(e=c.SHORT(n+=2),e>=65472&&65475>=e)return n+=5,{height:c.SHORT(n),width:c.SHORT(n+=2)};t=c.SHORT(n+=2),n+=t-2}return null}function s(){d&&l&&c&&(d.purge(),l.purge(),c.init(null),u=f=l=d=c=null)}var u,c,l,d,f,p;if(u=o,c=new i,c.init(u),65496!==c.SHORT(0))throw new t.ImageError(t.ImageError.WRONG_FORMAT);l=new n(o),d=new r,p=!!d.init(l.get("app1")[0]),f=a.call(this),e.extend(this,{type:"image/jpeg",size:u.length,width:f&&f.width||0,height:f&&f.height||0,setExif:function(t,n){return p?("object"===e.typeOf(t)?e.each(t,function(e,t){d.setExif(t,e)}):d.setExif(t,n),void l.set("app1",d.getBinary())):!1},writeHeaders:function(){return arguments.length?l.restore(arguments[0]):u=l.restore(u)},stripHeaders:function(e){return l.strip(e)},purge:function(){s.call(this)}}),p&&(this.meta={tiff:d.TIFF(),exif:d.EXIF(),gps:d.GPS()})}return o}),i(k,[f,s,P],function(e,t,n){function i(i){function r(){var e,t;return e=a.call(this,8),"IHDR"==e.type?(t=e.start,{width:u.LONG(t),height:u.LONG(t+=4)}):null}function o(){u&&(u.init(null),s=d=c=l=u=null)}function a(e){var t,n,i,r;return t=u.LONG(e),n=u.STRING(e+=4,4),i=e+=4,r=u.LONG(e+t),{length:t,type:n,start:i,CRC:r}}var s,u,c,l,d;s=i,u=new n,u.init(s),function(){var t=0,n=0,i=[35152,20039,3338,6666];for(n=0;n<i.length;n++,t+=2)if(i[n]!=u.SHORT(t))throw new e.ImageError(e.ImageError.WRONG_FORMAT)}(),d=r.call(this),t.extend(this,{type:"image/png",size:s.length,width:d.width,height:d.height,purge:function(){o.call(this)}}),o.call(this)}return i}),i(q,[s,f,U,k],function(e,t,n,i){return function(r){var o,a=[n,i];o=function(){for(var e=0;e<a.length;e++)try{return new a[e](r)}catch(n){}throw new t.ImageError(t.ImageError.WRONG_FORMAT)}(),e.extend(this,{type:"",size:0,width:0,height:0,setExif:function(){},writeHeaders:function(e){return e},stripHeaders:function(e){return e},purge:function(){}}),e.extend(this,o),this.purge=function(){o.purge(),o=null}}}),i(B,[],function(){function e(e,i,r){var o=e.naturalWidth,a=e.naturalHeight,s=r.width,u=r.height,c=r.x||0,l=r.y||0,d=i.getContext("2d");t(e)&&(o/=2,a/=2);var f=1024,p=document.createElement("canvas");p.width=p.height=f;for(var h=p.getContext("2d"),g=n(e,o,a),m=0;a>m;){for(var v=m+f>a?a-m:f,_=0;o>_;){var y=_+f>o?o-_:f;h.clearRect(0,0,f,f),h.drawImage(e,-_,-m);var w=_*s/o+c<<0,E=Math.ceil(y*s/o),b=m*u/a/g+l<<0,R=Math.ceil(v*u/a/g);d.drawImage(p,0,0,y,v,w,b,E,R),_+=f}m+=f}p=h=null}function t(e){var t=e.naturalWidth,n=e.naturalHeight;if(t*n>1048576){var i=document.createElement("canvas");i.width=i.height=1;var r=i.getContext("2d");return r.drawImage(e,-t+1,0),0===r.getImageData(0,0,1,1).data[3]}return!1}function n(e,t,n){var i=document.createElement("canvas");i.width=1,i.height=n;var r=i.getContext("2d");r.drawImage(e,0,0);for(var o=r.getImageData(0,0,1,n).data,a=0,s=n,u=n;u>a;){var c=o[4*(u-1)+3];0===c?s=u:a=u,u=s+a>>1}i=null;var l=u/n;return 0===l?1:l}return{isSubsampled:t,renderTo:e}}),i(G,[I,s,f,h,_,q,B,c,l],function(e,t,n,i,r,o,a,s,u){function c(){function e(){if(!y&&!v)throw new n.ImageError(n.DOMException.INVALID_STATE_ERR);return y||v}function c(e){return i.atob(e.substring(e.indexOf("base64,")+7))}function l(e,t){return"data:"+(t||"")+";base64,"+i.btoa(e)}function d(e){var t=this;v=new Image,v.onerror=function(){m.call(this),t.trigger("error",n.ImageError.WRONG_FORMAT)},v.onload=function(){t.trigger("load")},v.src=/^data:[^;]*;base64,/.test(e)?e:l(e,E.type)}function f(e,t){var i,r=this;return window.FileReader?(i=new FileReader,i.onload=function(){t(this.result)},i.onerror=function(){r.trigger("error",n.ImageError.WRONG_FORMAT)},void i.readAsDataURL(e)):t(e.getAsDataURL())}function p(n,i,r,o){var a,s,u,c,l,d=this,f=0,p=0;if(x=o,l=this.meta&&this.meta.tiff&&this.meta.tiff.Orientation||1,-1!==t.inArray(l,[5,6,7,8])){var m=n;n=i,i=m}return s=e(),r?(n=Math.min(n,s.width),i=Math.min(i,s.height),a=Math.max(n/s.width,i/s.height)):a=Math.min(n/s.width,i/s.height),a>1&&!r&&o?void this.trigger("Resize"):(y||(y=document.createElement("canvas")),u=Math.round(s.width*a),c=Math.round(s.height*a),r?(y.width=n,y.height=i,u>n&&(f=Math.round((u-n)/2)),c>i&&(p=Math.round((c-i)/2))):(y.width=u,y.height=c),x||g(y.width,y.height,l),h.call(this,s,y,-f,-p,u,c),this.width=y.width,this.height=y.height,R=!0,void d.trigger("Resize"))}function h(e,t,n,i,r,o){if("iOS"===u.OS)a.renderTo(e,t,{width:r,height:o,x:n,y:i});else{var s=t.getContext("2d");s.drawImage(e,n,i,r,o)}}function g(e,t,n){switch(n){case 5:case 6:case 7:case 8:y.width=t,y.height=e;break;default:y.width=e,y.height=t}var i=y.getContext("2d");switch(n){case 2:i.translate(e,0),i.scale(-1,1);break;case 3:i.translate(e,t),i.rotate(Math.PI);break;case 4:i.translate(0,t),i.scale(1,-1);break;case 5:i.rotate(.5*Math.PI),i.scale(1,-1);break;case 6:i.rotate(.5*Math.PI),i.translate(0,-t);break;case 7:i.rotate(.5*Math.PI),i.translate(e,-t),i.scale(-1,1);break;case 8:i.rotate(-.5*Math.PI),i.translate(-e,0)}}function m(){_&&(_.purge(),_=null),w=v=y=E=null,R=!1}var v,_,y,w,E,b=this,R=!1,x=!0;t.extend(this,{loadFromBlob:function(e){var t=this,i=t.getRuntime(),r=arguments.length>1?arguments[1]:!0;if(!i.can("access_binary"))throw new n.RuntimeError(n.RuntimeError.NOT_SUPPORTED_ERR);return E=e,e.isDetached()?(w=e.getSource(),void d.call(this,w)):void f.call(this,e.getSource(),function(e){r&&(w=c(e)),d.call(t,e)})},loadFromImage:function(e,t){this.meta=e.meta,E=new r(null,{name:e.name,size:e.size,type:e.type}),d.call(this,t?w=e.getAsBinaryString():e.getAsDataURL())},getInfo:function(){var t,n=this.getRuntime();return!_&&w&&n.can("access_image_binary")&&(_=new o(w)),t={width:e().width||0,height:e().height||0,type:E.type||s.getFileMime(E.name),size:w&&w.length||E.size||0,name:E.name||"",meta:_&&_.meta||this.meta||{}}},downsize:function(){p.apply(this,arguments)},getAsCanvas:function(){return y&&(y.id=this.uid+"_canvas"),y},getAsBlob:function(e,t){return e!==this.type&&p.call(this,this.width,this.height,!1),new r(null,{name:E.name||"",type:e,data:b.getAsBinaryString.call(this,e,t)})},getAsDataURL:function(e){var t=arguments[1]||90;if(!R)return v.src;if("image/jpeg"!==e)return y.toDataURL("image/png");try{return y.toDataURL("image/jpeg",t/100)}catch(n){return y.toDataURL("image/jpeg")}},getAsBinaryString:function(e,t){if(!R)return w||(w=c(b.getAsDataURL(e,t))),w;if("image/jpeg"!==e)w=c(b.getAsDataURL(e,t));else{var n;t||(t=90);try{n=y.toDataURL("image/jpeg",t/100)}catch(i){n=y.toDataURL("image/jpeg")}w=c(n),_&&(w=_.stripHeaders(w),x&&(_.meta&&_.meta.exif&&_.setExif({PixelXDimension:this.width,PixelYDimension:this.height}),w=_.writeHeaders(w)),_.purge(),_=null)}return R=!1,w},destroy:function(){b=null,m.call(this),this.getRuntime().getShim().removeInstance(this.uid)}})}return e.Image=c}),i(j,[s,l,d,f,g],function(e,t,n,i,r){function o(){var e;try{e=navigator.plugins["Shockwave Flash"],e=e.description}catch(t){try{e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(n){e="0.0"}}return e=e.match(/\d+/g),parseFloat(e[0]+"."+e[1])}function a(a){var c,l=this;a=e.extend({swf_url:t.swf_url},a),r.call(this,a,s,{access_binary:function(e){return e&&"browser"===l.mode},access_image_binary:function(e){return e&&"browser"===l.mode},display_media:r.capTrue,do_cors:r.capTrue,drag_and_drop:!1,report_upload_progress:function(){return"client"===l.mode},resize_image:r.capTrue,return_response_headers:!1,return_response_type:function(t){return"json"===t&&window.JSON?!0:!e.arrayDiff(t,["","text","document"])||"browser"===l.mode},return_status_code:function(t){return"browser"===l.mode||!e.arrayDiff(t,[200,404])},select_file:r.capTrue,select_multiple:r.capTrue,send_binary_string:function(e){return e&&"browser"===l.mode},send_browser_cookies:function(e){return e&&"browser"===l.mode},send_custom_headers:function(e){return e&&"browser"===l.mode},send_multipart:r.capTrue,slice_blob:function(e){return e&&"browser"===l.mode},stream_upload:function(e){return e&&"browser"===l.mode},summon_file_dialog:!1,upload_filesize:function(t){return e.parseSizeStr(t)<=2097152||"client"===l.mode},use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}},{access_binary:function(e){return e?"browser":"client"},access_image_binary:function(e){return e?"browser":"client"},report_upload_progress:function(e){return e?"browser":"client"},return_response_type:function(t){return e.arrayDiff(t,["","text","json","document"])?"browser":["client","browser"]},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"browser":["client","browser"]},send_binary_string:function(e){return e?"browser":"client"},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"browser":"client"},stream_upload:function(e){return e?"client":"browser"},upload_filesize:function(t){return e.parseSizeStr(t)>=2097152?"client":"browser"}},"client"),o()<10&&(this.mode=!1),e.extend(this,{getShim:function(){return n.get(this.uid)},shimExec:function(e,t){var n=[].slice.call(arguments,2);return l.getShim().exec(this.uid,e,t,n)},init:function(){var n,r,o;o=this.getShimContainer(),e.extend(o.style,{position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),n='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+a.swf_url+'" ',"IE"===t.browser&&(n+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),n+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+a.swf_url+'" /><param name="flashvars" value="uid='+escape(this.uid)+"&target="+t.global_event_dispatcher+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',"IE"===t.browser?(r=document.createElement("div"),o.appendChild(r),r.outerHTML=n,r=o=null):o.innerHTML=n,c=setTimeout(function(){l&&!l.initialized&&l.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},5e3)},destroy:function(e){return function(){e.call(l),clearTimeout(c),a=c=e=l=null}}(this.destroy)},u)}var s="flash",u={};return r.addConstructor(s,a),u}),i(X,[j,v],function(e,t){var n={slice:function(e,n,i,r){var o=this.getRuntime();return 0>n?n=Math.max(e.size+n,0):n>0&&(n=Math.min(n,e.size)),0>i?i=Math.max(e.size+i,0):i>0&&(i=Math.min(i,e.size)),e=o.shimExec.call(this,"Blob","slice",n,i,r||""),e&&(e=new t(o.uid,e)),e}};return e.Blob=n}),i(V,[j],function(e){var t={init:function(e){this.getRuntime().shimExec.call(this,"FileInput","init",{name:e.name,accept:e.accept,multiple:e.multiple}),this.trigger("ready")}};return e.FileInput=t}),i(W,[j,h],function(e,t){function n(e,n){switch(n){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var i="",r={read:function(e,t){var r=this,o=r.getRuntime();return"readAsDataURL"===e&&(i="data:"+(t.type||"")+";base64,"),r.bind("Progress",function(t,r){r&&(i+=n(r,e))}),o.shimExec.call(this,"FileReader","readAsBase64",t.uid)},getResult:function(){return i},destroy:function(){i=null}};return e.FileReader=r}),i(Y,[j,h],function(e,t){function n(e,n){switch(n){case"readAsText":return t.atob(e,"utf8");case"readAsBinaryString":return t.atob(e);case"readAsDataURL":return e}return null}var i={read:function(e,t){var i,r=this.getRuntime();return(i=r.shimExec.call(this,"FileReaderSync","readAsBase64",t.uid))?("readAsDataURL"===e&&(i="data:"+(t.type||"")+";base64,"+i),n(i,e,t.type)):null}};return e.FileReaderSync=i}),i($,[j,s,v,_,x,S,A],function(e,t,n,i,r,o,a){var s={send:function(e,i){function r(){e.transport=l.mode,l.shimExec.call(c,"XMLHttpRequest","send",e,i)}function s(e,t){l.shimExec.call(c,"XMLHttpRequest","appendBlob",e,t.uid),i=null,r()}function u(e,t){var n=new a;n.bind("TransportingComplete",function(){t(this.result)}),n.transport(e.getSource(),e.type,{ruid:l.uid})}var c=this,l=c.getRuntime();if(t.isEmptyObj(e.headers)||t.each(e.headers,function(e,t){l.shimExec.call(c,"XMLHttpRequest","setRequestHeader",t,e.toString())}),i instanceof o){var d;if(i.each(function(e,t){e instanceof n?d=t:l.shimExec.call(c,"XMLHttpRequest","append",t,e)}),i.hasBlob()){var f=i.getBlob();f.isDetached()?u(f,function(e){f.destroy(),s(d,e)}):s(d,f)}else i=null,r()}else i instanceof n?i.isDetached()?u(i,function(e){i.destroy(),i=e.uid,r()}):(i=i.uid,r()):r()},getResponse:function(e){var n,o,a=this.getRuntime();if(o=a.shimExec.call(this,"XMLHttpRequest","getResponseAsBlob")){if(o=new i(a.uid,o),"blob"===e)return o;try{if(n=new r,~t.inArray(e,["","text"]))return n.readAsText(o);if("json"===e&&window.JSON)return JSON.parse(n.readAsText(o))}finally{o.destroy()}}return null},abort:function(e){var t=this.getRuntime();t.shimExec.call(this,"XMLHttpRequest","abort"),this.dispatchEvent("readystatechange"),this.dispatchEvent("abort")}};return e.XMLHttpRequest=s}),i(J,[j,v],function(e,t){var n={getAsBlob:function(e){var n=this.getRuntime(),i=n.shimExec.call(this,"Transporter","getAsBlob",e);return i?new t(n.uid,i):null}};return e.Transporter=n}),i(Z,[j,s,A,v,x],function(e,t,n,i,r){var o={loadFromBlob:function(e){function t(e){r.shimExec.call(i,"Image","loadFromBlob",e.uid),i=r=null}var i=this,r=i.getRuntime();if(e.isDetached()){var o=new n;o.bind("TransportingComplete",function(){t(o.result.getSource())}),o.transport(e.getSource(),e.type,{ruid:r.uid})}else t(e.getSource())},loadFromImage:function(e){var t=this.getRuntime();return t.shimExec.call(this,"Image","loadFromImage",e.uid)},getAsBlob:function(e,t){var n=this.getRuntime(),r=n.shimExec.call(this,"Image","getAsBlob",e,t);return r?new i(n.uid,r):null},getAsDataURL:function(){var e,t=this.getRuntime(),n=t.Image.getAsBlob.apply(this,arguments);return n?(e=new r,e.readAsDataURL(n)):null}};return e.Image=o}),i(Q,[s,l,d,f,g],function(e,t,n,i,r){function o(e){var t,n,i,r,o,a=!1,s=null,u=0;try{try{s=new ActiveXObject("AgControl.AgControl"),s.IsVersionSupported(e)&&(a=!0),s=null}catch(c){var l=navigator.plugins["Silverlight Plug-In"];if(l){for(t=l.description,"1.0.30226.2"===t&&(t="2.0.30226.2"),n=t.split(".");n.length>3;)n.pop();for(;n.length<4;)n.push(0);for(i=e.split(".");i.length>4;)i.pop();do r=parseInt(i[u],10),o=parseInt(n[u],10),u++;while(u<i.length&&r===o);o>=r&&!isNaN(r)&&(a=!0)}}}catch(d){a=!1}return a}function a(a){var c,l=this;a=e.extend({xap_url:t.xap_url},a),r.call(this,a,s,{access_binary:r.capTrue,access_image_binary:r.capTrue,display_media:r.capTrue,do_cors:r.capTrue,drag_and_drop:!1,report_upload_progress:r.capTrue,resize_image:r.capTrue,return_response_headers:function(e){return e&&"client"===l.mode},return_response_type:function(e){return"json"!==e?!0:!!window.JSON},return_status_code:function(t){return"client"===l.mode||!e.arrayDiff(t,[200,404])},select_file:r.capTrue,select_multiple:r.capTrue,send_binary_string:r.capTrue,send_browser_cookies:function(e){return e&&"browser"===l.mode},send_custom_headers:function(e){return e&&"client"===l.mode},send_multipart:r.capTrue,slice_blob:r.capTrue,stream_upload:!0,summon_file_dialog:!1,upload_filesize:r.capTrue,use_http_method:function(t){return"client"===l.mode||!e.arrayDiff(t,["GET","POST"])}},{return_response_headers:function(e){return e?"client":"browser"},return_status_code:function(t){return e.arrayDiff(t,[200,404])?"client":["client","browser"]},send_browser_cookies:function(e){return e?"browser":"client"},send_custom_headers:function(e){return e?"client":"browser"},use_http_method:function(t){return e.arrayDiff(t,["GET","POST"])?"client":["client","browser"]}}),o("2.0.31005.0")&&"Opera"!==t.browser||(this.mode=!1),e.extend(this,{getShim:function(){return n.get(this.uid).content.Moxie},shimExec:function(e,t){var n=[].slice.call(arguments,2);return l.getShim().exec(this.uid,e,t,n)},init:function(){var e;e=this.getShimContainer(),e.innerHTML='<object id="'+this.uid+'" data="data:application/x-silverlight," type="application/x-silverlight-2" width="100%" height="100%" style="outline:none;"><param name="source" value="'+a.xap_url+'"/><param name="background" value="Transparent"/><param name="windowless" value="true"/><param name="enablehtmlaccess" value="true"/><param name="initParams" value="uid='+this.uid+",target="+t.global_event_dispatcher+'"/></object>',c=setTimeout(function(){l&&!l.initialized&&l.trigger("Error",new i.RuntimeError(i.RuntimeError.NOT_INIT_ERR))},"Windows"!==t.OS?1e4:5e3)},destroy:function(e){return function(){e.call(l),clearTimeout(c),a=c=e=l=null}}(this.destroy)},u)}var s="silverlight",u={};return r.addConstructor(s,a),u}),i(K,[Q,s,X],function(e,t,n){return e.Blob=t.extend({},n)}),i(ee,[Q],function(e){var t={init:function(e){function t(e){for(var t="",n=0;n<e.length;n++)t+=(""!==t?"|":"")+e[n].title+" | *."+e[n].extensions.replace(/,/g,";*.");return t}this.getRuntime().shimExec.call(this,"FileInput","init",t(e.accept),e.name,e.multiple),this.trigger("ready")}};return e.FileInput=t}),i(te,[Q,d,N],function(e,t,n){var i={init:function(){var e,i=this,r=i.getRuntime();return e=r.getShimContainer(),n.addEvent(e,"dragover",function(e){e.preventDefault(),e.stopPropagation(),e.dataTransfer.dropEffect="copy"},i.uid),n.addEvent(e,"dragenter",function(e){e.preventDefault();var n=t.get(r.uid).dragEnter(e);n&&e.stopPropagation()},i.uid),n.addEvent(e,"drop",function(e){e.preventDefault();var n=t.get(r.uid).dragDrop(e);n&&e.stopPropagation()},i.uid),r.shimExec.call(this,"FileDrop","init")}};return e.FileDrop=i}),i(ne,[Q,s,W],function(e,t,n){return e.FileReader=t.extend({},n)}),i(ie,[Q,s,Y],function(e,t,n){return e.FileReaderSync=t.extend({},n)}),i(re,[Q,s,$],function(e,t,n){return e.XMLHttpRequest=t.extend({},n)}),i(oe,[Q,s,J],function(e,t,n){return e.Transporter=t.extend({},n)}),i(ae,[Q,s,Z],function(e,t,n){return e.Image=t.extend({},n,{getInfo:function(){var e=this.getRuntime(),n=["tiff","exif","gps"],i={meta:{}},r=e.shimExec.call(this,"Image","getInfo");return r.meta&&t.each(n,function(e){var t,n,o,a,s=r.meta[e];if(s&&s.keys)for(i.meta[e]={},n=0,o=s.keys.length;o>n;n++)t=s.keys[n],a=s[t],a&&(/^(\d|[1-9]\d+)$/.test(a)?a=parseInt(a,10):/^\d*\.\d+$/.test(a)&&(a=parseFloat(a)),i.meta[e][t]=a)}),i.width=parseInt(r.width,10),i.height=parseInt(r.height,10),i.size=parseInt(r.size,10),i.type=r.type,i.name=r.name,i}})}),i(se,[s,f,g,l],function(e,t,n,i){function r(t){var r=this,s=n.capTest,u=n.capTrue;n.call(this,t,o,{access_binary:s(window.FileReader||window.File&&File.getAsDataURL),access_image_binary:!1,display_media:s(a.Image&&(i.can("create_canvas")||i.can("use_data_uri_over32kb"))),do_cors:!1,drag_and_drop:!1,filter_by_extension:s(function(){return"Chrome"===i.browser&&i.version>=28||"IE"===i.browser&&i.version>=10}()),resize_image:function(){return a.Image&&r.can("access_binary")&&i.can("create_canvas")},report_upload_progress:!1,return_response_headers:!1,return_response_type:function(t){return"json"===t&&window.JSON?!0:!!~e.inArray(t,["text","document",""])},return_status_code:function(t){return!e.arrayDiff(t,[200,404])},select_file:function(){return i.can("use_fileinput")},select_multiple:!1,send_binary_string:!1,send_custom_headers:!1,send_multipart:!0,slice_blob:!1,stream_upload:function(){return r.can("select_file")},summon_file_dialog:s(function(){return"Firefox"===i.browser&&i.version>=4||"Opera"===i.browser&&i.version>=12||!!~e.inArray(i.browser,["Chrome","Safari"])}()),upload_filesize:u,use_http_method:function(t){return!e.arrayDiff(t,["GET","POST"])}}),e.extend(this,{init:function(){this.trigger("Init")},destroy:function(e){return function(){e.call(r),e=r=null}}(this.destroy)}),e.extend(this.getShim(),a)}var o="html4",a={};return n.addConstructor(o,r),a}),i(ue,[se,s,d,N,c,l],function(e,t,n,i,r,o){function a(){function e(){var r,l,d,f,p,h,g=this,m=g.getRuntime();h=t.guid("uid_"),r=m.getShimContainer(),a&&(d=n.get(a+"_form"),d&&t.extend(d.style,{top:"100%"})),f=document.createElement("form"),f.setAttribute("id",h+"_form"),f.setAttribute("method","post"),f.setAttribute("enctype","multipart/form-data"),f.setAttribute("encoding","multipart/form-data"),t.extend(f.style,{overflow:"hidden",position:"absolute",top:0,left:0,width:"100%",height:"100%"}),p=document.createElement("input"),p.setAttribute("id",h),p.setAttribute("type","file"),p.setAttribute("name",s.name||"Filedata"),p.setAttribute("accept",c.join(",")),t.extend(p.style,{fontSize:"999px",opacity:0}),f.appendChild(p),r.appendChild(f),t.extend(p.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%"}),"IE"===o.browser&&o.version<10&&t.extend(p.style,{filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=0)"}),p.onchange=function(){var t;this.value&&(t=this.files?this.files[0]:{name:this.value},u=[t],this.onchange=function(){},e.call(g),g.bind("change",function i(){var e,t=n.get(h),r=n.get(h+"_form");g.unbind("change",i),g.files.length&&t&&r&&(e=g.files[0],t.setAttribute("id",e.uid),r.setAttribute("id",e.uid+"_form"),r.setAttribute("target",e.uid+"_iframe")),t=r=null},998),p=f=null,g.trigger("change"))},m.can("summon_file_dialog")&&(l=n.get(s.browse_button),i.removeEvent(l,"click",g.uid),i.addEvent(l,"click",function(e){p&&!p.disabled&&p.click(),e.preventDefault()},g.uid)),a=h,r=d=l=null}var a,s,u=[],c=[];t.extend(this,{init:function(t){var o,a=this,u=a.getRuntime();s=t,c=t.accept.mimes||r.extList2mimes(t.accept,u.can("filter_by_extension")),o=u.getShimContainer(),function(){var e,r,s;e=n.get(t.browse_button),u.can("summon_file_dialog")&&("static"===n.getStyle(e,"position")&&(e.style.position="relative"),r=parseInt(n.getStyle(e,"z-index"),10)||1,e.style.zIndex=r,o.style.zIndex=r-1),s=u.can("summon_file_dialog")?e:o,i.addEvent(s,"mouseover",function(){a.trigger("mouseenter")},a.uid),i.addEvent(s,"mouseout",function(){a.trigger("mouseleave")},a.uid),i.addEvent(s,"mousedown",function(){a.trigger("mousedown")},a.uid),i.addEvent(n.get(t.container),"mouseup",function(){a.trigger("mouseup")},a.uid),e=null}(),e.call(this),o=null,a.trigger({type:"ready",async:!0})},getFiles:function(){return u},disable:function(e){var t;(t=n.get(a))&&(t.disabled=!!e)},destroy:function(){var e=this.getRuntime(),t=e.getShim(),r=e.getShimContainer();i.removeAllEvents(r,this.uid),i.removeAllEvents(s&&n.get(s.container),this.uid),i.removeAllEvents(s&&n.get(s.browse_button),this.uid),r&&(r.innerHTML=""),t.removeInstance(this.uid),a=u=c=s=r=t=null}})}return e.FileInput=a}),i(ce,[se,C],function(e,t){return e.FileReader=t}),i(le,[se,s,d,R,f,N,v,S],function(e,t,n,i,r,o,a,s){function u(){function e(e){var t,i,r,a,s=this,u=!1;if(l){if(t=l.id.replace(/_iframe$/,""),i=n.get(t+"_form")){for(r=i.getElementsByTagName("input"),a=r.length;a--;)switch(r[a].getAttribute("type")){case"hidden":r[a].parentNode.removeChild(r[a]);break;case"file":u=!0}r=[],u||i.parentNode.removeChild(i),i=null}setTimeout(function(){o.removeEvent(l,"load",s.uid),l.parentNode&&l.parentNode.removeChild(l);var t=s.getRuntime().getShimContainer();t.children.length||t.parentNode.removeChild(t),t=l=null,e()},1)}}var u,c,l;t.extend(this,{send:function(d,f){function p(){var n=y.getShimContainer()||document.body,r=document.createElement("div");r.innerHTML='<iframe id="'+h+'_iframe" name="'+h+'_iframe" src="javascript:&quot;&quot;" style="display:none"></iframe>',l=r.firstChild,n.appendChild(l),o.addEvent(l,"load",function(){var n;try{n=l.contentWindow.document||l.contentDocument||window.frames[l.id].document,/^4(0[0-9]|1[0-7]|2[2346])\s/.test(n.title)?u=n.title.replace(/^(\d+).*$/,"$1"):(u=200,c=t.trim(n.body.innerHTML),_.trigger({type:"progress",loaded:c.length,total:c.length}),v&&_.trigger({type:"uploadprogress",loaded:v.size||1025,total:v.size||1025}))}catch(r){if(!i.hasSameOrigin(d.url))return void e.call(_,function(){_.trigger("error")});u=404}e.call(_,function(){_.trigger("load")})},_.uid)}var h,g,m,v,_=this,y=_.getRuntime();if(u=c=null,f instanceof s&&f.hasBlob()){if(v=f.getBlob(),h=v.uid,m=n.get(h),g=n.get(h+"_form"),!g)throw new r.DOMException(r.DOMException.NOT_FOUND_ERR)}else h=t.guid("uid_"),g=document.createElement("form"),g.setAttribute("id",h+"_form"),g.setAttribute("method",d.method),g.setAttribute("enctype","multipart/form-data"),g.setAttribute("encoding","multipart/form-data"),g.setAttribute("target",h+"_iframe"),y.getShimContainer().appendChild(g);f instanceof s&&f.each(function(e,n){if(e instanceof a)m&&m.setAttribute("name",n);else{var i=document.createElement("input");t.extend(i,{type:"hidden",name:n,value:e}),m?g.insertBefore(i,m):g.appendChild(i)}}),g.setAttribute("action",d.url),p(),g.submit(),_.trigger("loadstart")},getStatus:function(){return u},getResponse:function(e){if("json"===e&&"string"===t.typeOf(c)&&window.JSON)try{return JSON.parse(c.replace(/^\s*<pre[^>]*>/,"").replace(/<\/pre>\s*$/,""))}catch(n){return null}return c},abort:function(){var t=this;l&&l.contentWindow&&(l.contentWindow.stop?l.contentWindow.stop():l.contentWindow.document.execCommand?l.contentWindow.document.execCommand("Stop"):l.src="about:blank"),e.call(this,function(){t.dispatchEvent("abort")})}})}return e.XMLHttpRequest=u}),i(de,[se,G],function(e,t){return e.Image=t}),o([s,u,c,l,d,f,p,h,g,m,v,_,y,w,E,b,R,x,S,T,A,O,N])}(this),function(e){return e}(),function(e){"use strict";var t={},n=e.moxie.core.utils.Basic.inArray;return function i(e){var r,o;for(r in e)o=_typeof(e[r]),"object"!==o||~n(r,["Exceptions","Env","Mime"])?"function"===o&&(t[r]=e[r]):i(e[r])}(e.moxie),t.Env=e.moxie.core.utils.Env,t.Mime=e.moxie.core.utils.Mime,t.Exceptions=e.moxie.core.Exceptions,e.mOxie=t,e.o||(e.o=t),t}(this),function(e){return e}(),function(e,t,n){function i(e){function t(e,t,n){var r={chunks:"slice_blob",jpgresize:"send_binary_string",pngresize:"send_binary_string",progress:"report_upload_progress",multi_selection:"select_multiple",dragdrop:"drag_and_drop",drop_element:"drag_and_drop",headers:"send_custom_headers",urlstream_upload:"send_binary_string",canSendBinary:"send_binary",triggerDialog:"summon_file_dialog"};r[e]?i[r[e]]=t:n||(i[e]=t)}var n=e.required_features,i={};return"string"==typeof n?a.each(n.split(/\s*,\s*/),function(e){t(e,!0)}):"object"==("undefined"==typeof n?"undefined":_typeof(n))?a.each(n,function(e,n){t(n,e)}):n===!0&&(e.chunk_size>0&&(i.slice_blob=!0),!e.resize.enabled&&e.multipart||(i.send_binary_string=!0),a.each(e,function(e,n){t(n,!!e,!0)})),i}var r=e.setTimeout,o={},a={VERSION:"2.1.2",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,FILE_DUPLICATE_ERROR:-602,IMAGE_FORMAT_ERROR:-700,MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:t.mimes,ua:t.ua,typeOf:t.typeOf,extend:t.extend,guid:t.guid,get:function(e){var n,i=[];"array"!==t.typeOf(e)&&(e=[e]);for(var r=e.length;r--;)n=t.get(e[r]),n&&i.push(n);return i.length?i:null},each:t.each,getPos:t.getPos,getSize:t.getSize,xmlEncode:function(e){var t={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},n=/[<>&\"\']/g;return e?(""+e).replace(n,function(e){return t[e]?"&"+t[e]+";":e}):e},toArray:t.toArray,inArray:t.inArray,addI18n:t.addI18n,translate:t.translate,isEmptyObj:t.isEmptyObj,hasClass:t.hasClass,addClass:t.addClass,removeClass:t.removeClass,getStyle:t.getStyle,addEvent:t.addEvent,removeEvent:t.removeEvent,removeAllEvents:t.removeAllEvents,cleanName:function(e){var t,n;for(n=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"],t=0;t<n.length;t+=2)e=e.replace(n[t],n[t+1]);return e=e.replace(/\s+/g,"_"),e=e.replace(/[^a-z0-9_\-\.]+/gi,"")},buildUrl:function(e,t){var n="";return a.each(t,function(e,t){n+=(n?"&":"")+encodeURIComponent(t)+"="+encodeURIComponent(e)}),n&&(e+=(e.indexOf("?")>0?"&":"?")+n),e},formatSize:function(e){function t(e,t){return Math.round(e*Math.pow(10,t))/Math.pow(10,t)}if(e===n||/\D/.test(e))return a.translate("N/A");var i=Math.pow(1024,4);return e>i?t(e/i,1)+" "+a.translate("tb"):e>(i/=1024)?t(e/i,1)+" "+a.translate("gb"):e>(i/=1024)?t(e/i,1)+" "+a.translate("mb"):e>1024?Math.round(e/1024)+" "+a.translate("kb"):e+" "+a.translate("b")},parseSize:t.parseSizeStr,predictRuntime:function(e,n){var i,r;return i=new a.Uploader(e),r=t.Runtime.thatCan(i.getOption().required_features,n||e.runtimes),i.destroy(),r},addFileFilter:function(e,t){o[e]=t}};a.addFileFilter("mime_types",function(e,t,n){
e.length&&!e.regexp.test(t.name)?(this.trigger("Error",{code:a.FILE_EXTENSION_ERROR,message:a.translate("File extension error."),file:t}),n(!1)):n(!0)}),a.addFileFilter("max_file_size",function(e,t,n){var i;e=a.parseSize(e),t.size!==i&&e&&t.size>e?(this.trigger("Error",{code:a.FILE_SIZE_ERROR,message:a.translate("File size error."),file:t}),n(!1)):n(!0)}),a.addFileFilter("prevent_duplicates",function(e,t,n){if(e)for(var i=this.files.length;i--;)if(t.name===this.files[i].name&&t.size===this.files[i].size)return this.trigger("Error",{code:a.FILE_DUPLICATE_ERROR,message:a.translate("Duplicate file error."),file:t}),void n(!1);n(!0)}),a.Uploader=function(e){function s(){var e,t,n=0;if(this.state==a.STARTED){for(t=0;t<I.length;t++)e||I[t].status!=a.QUEUED?n++:(e=I[t],this.trigger("BeforeUpload",e)&&(e.status=a.UPLOADING,this.trigger("UploadFile",e)));n==I.length&&(this.state!==a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged")),this.trigger("UploadComplete",I))}}function u(e){e.percent=e.size>0?Math.ceil(e.loaded/e.size*100):100,c()}function c(){var e,t;for(T.reset(),e=0;e<I.length;e++)t=I[e],t.size!==n?(T.size+=t.origSize,T.loaded+=t.loaded*t.origSize/t.size):T.size=n,t.status==a.DONE?T.uploaded++:t.status==a.FAILED?T.failed++:T.queued++;T.size===n?T.percent=I.length>0?Math.ceil(T.uploaded/I.length*100):0:(T.bytesPerSec=Math.ceil(T.loaded/((+new Date-S||1)/1e3)),T.percent=T.size>0?Math.ceil(T.loaded/T.size*100):0)}function l(){var e=N[0]||L[0];return e?e.getRuntime().uid:!1}function d(e,n){if(e.ruid){var i=t.Runtime.getInfo(e.ruid);if(i)return i.can(n)}return!1}function f(){this.bind("FilesAdded FilesRemoved",function(e){e.trigger("QueueChanged"),e.refresh()}),this.bind("CancelUpload",w),this.bind("BeforeUpload",m),this.bind("UploadFile",v),this.bind("UploadProgress",_),this.bind("StateChanged",y),this.bind("QueueChanged",c),this.bind("Error",b),this.bind("FileUploaded",E),this.bind("Destroy",R)}function p(e,n){var i=this,r=0,o=[],s={runtime_order:e.runtimes,required_caps:e.required_features,preferred_caps:D,swf_url:e.flash_swf_url,xap_url:e.silverlight_xap_url};a.each(e.runtimes.split(/\s*,\s*/),function(t){e[t]&&(s[t]=e[t])}),e.browse_button&&a.each(e.browse_button,function(n){o.push(function(o){var u=new t.FileInput(a.extend({},s,{accept:e.filters.mime_types,name:e.file_data_name,multiple:e.multi_selection,container:e.container,browse_button:n}));u.onready=function(){var e=t.Runtime.getInfo(this.ruid);t.extend(i.features,{chunks:e.can("slice_blob"),multipart:e.can("send_multipart"),multi_selection:e.can("select_multiple")}),r++,N.push(this),o()},u.onchange=function(){i.addFile(this.files)},u.bind("mouseenter mouseleave mousedown mouseup",function(i){M||(e.browse_button_hover&&("mouseenter"===i.type?t.addClass(n,e.browse_button_hover):"mouseleave"===i.type&&t.removeClass(n,e.browse_button_hover)),e.browse_button_active&&("mousedown"===i.type?t.addClass(n,e.browse_button_active):"mouseup"===i.type&&t.removeClass(n,e.browse_button_active)))}),u.bind("mousedown",function(){i.trigger("Browse")}),u.bind("error runtimeerror",function(){u=null,o()}),u.init()})}),e.drop_element&&a.each(e.drop_element,function(e){o.push(function(n){var o=new t.FileDrop(a.extend({},s,{drop_zone:e}));o.onready=function(){var e=t.Runtime.getInfo(this.ruid);i.features.dragdrop=e.can("drag_and_drop"),r++,L.push(this),n()},o.ondrop=function(){i.addFile(this.files)},o.bind("error runtimeerror",function(){o=null,n()}),o.init()})}),t.inSeries(o,function(){"function"==typeof n&&n(r)})}function h(e,i,r){var o=new t.Image;try{o.onload=function(){return i.width>this.width&&i.height>this.height&&i.quality===n&&i.preserve_headers&&!i.crop?(this.destroy(),r(e)):void o.downsize(i.width,i.height,i.crop,i.preserve_headers)},o.onresize=function(){r(this.getAsBlob(e.type,i.quality)),this.destroy()},o.onerror=function(){r(e)},o.load(e)}catch(a){r(e)}}function g(e,n,r){function o(e,t,n){var i=x[e];switch(e){case"max_file_size":"max_file_size"===e&&(x.max_file_size=x.filters.max_file_size=t);break;case"chunk_size":(t=a.parseSize(t))&&(x[e]=t,x.send_file_name=!0);break;case"multipart":x[e]=t,t||(x.send_file_name=!0);break;case"unique_names":x[e]=t,t&&(x.send_file_name=!0);break;case"filters":"array"===a.typeOf(t)&&(t={mime_types:t}),n?a.extend(x.filters,t):x.filters=t,t.mime_types&&(x.filters.mime_types.regexp=function(e){var t=[];return a.each(e,function(e){a.each(e.extensions.split(/,/),function(e){/^\s*\*\s*$/.test(e)?t.push("\\.*"):t.push("\\."+e.replace(new RegExp("["+"/^$.*+?|()[]{}\\".replace(/./g,"\\$&")+"]","g"),"\\$&"))})}),new RegExp("("+t.join("|")+")$","i")}(x.filters.mime_types));break;case"resize":n?a.extend(x.resize,t,{enabled:!0}):x.resize=t;break;case"prevent_duplicates":x.prevent_duplicates=x.filters.prevent_duplicates=!!t;break;case"browse_button":case"drop_element":t=a.get(t);case"container":case"runtimes":case"multi_selection":case"flash_swf_url":case"silverlight_xap_url":x[e]=t,n||(u=!0);break;default:x[e]=t}n||s.trigger("OptionChanged",e,t,i)}var s=this,u=!1;"object"==("undefined"==typeof e?"undefined":_typeof(e))?a.each(e,function(e,t){o(t,e,r)}):o(e,n,r),r?(x.required_features=i(a.extend({},x)),D=i(a.extend({},x,{required_features:!0}))):u&&(s.trigger("Destroy"),p.call(s,x,function(e){e?(s.runtime=t.Runtime.getInfo(l()).type,s.trigger("Init",{runtime:s.runtime}),s.trigger("PostInit")):s.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})}))}function m(e,t){if(e.settings.unique_names){var n=t.name.match(/\.([^.]+)$/),i="part";n&&(i=n[1]),t.target_name=t.id+"."+i}}function v(e,n){function i(){l-- >0?r(o,1e3):(n.loaded=p,e.trigger("Error",{code:a.HTTP_ERROR,message:a.translate("HTTP Error."),file:n,response:A.responseText,status:A.status,responseHeaders:A.getAllResponseHeaders()}))}function o(){var d,h,g,m={};n.status===a.UPLOADING&&e.state!==a.STOPPED&&(e.settings.send_file_name&&(m.name=n.target_name||n.name),c&&f.chunks&&s.size>c?(g=Math.min(c,s.size-p),d=s.slice(p,p+g)):(g=s.size,d=s),c&&f.chunks&&(e.settings.send_chunk_number?(m.chunk=Math.ceil(p/c),m.chunks=Math.ceil(s.size/c)):(m.offset=p,m.total=s.size)),A=new t.XMLHttpRequest,A.upload&&(A.upload.onprogress=function(t){n.loaded=Math.min(n.size,p+t.loaded),e.trigger("UploadProgress",n)}),A.onload=function(){return A.status>=400?void i():(l=e.settings.max_retries,g<s.size?(d.destroy(),p+=g,n.loaded=Math.min(p,s.size),e.trigger("ChunkUploaded",n,{offset:n.loaded,total:s.size,response:A.responseText,status:A.status,responseHeaders:A.getAllResponseHeaders()}),"Android Browser"===t.Env.browser&&e.trigger("UploadProgress",n)):n.loaded=n.size,d=h=null,!p||p>=s.size?(n.size!=n.origSize&&(s.destroy(),s=null),e.trigger("UploadProgress",n),n.status=a.DONE,e.trigger("FileUploaded",n,{response:A.responseText,status:A.status,responseHeaders:A.getAllResponseHeaders()})):r(o,1),void 0)},A.onerror=function(){i()},A.onloadend=function(){this.destroy(),A=null},e.settings.multipart&&f.multipart?(A.open("post",u,!0),a.each(e.settings.headers,function(e,t){A.setRequestHeader(t,e)}),h=new t.FormData,a.each(a.extend(m,e.settings.multipart_params),function(e,t){h.append(t,e)}),h.append(e.settings.file_data_name,d),A.send(h,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:D,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})):(u=a.buildUrl(e.settings.url,a.extend(m,e.settings.multipart_params)),A.open("post",u,!0),A.setRequestHeader("Content-Type","application/octet-stream"),a.each(e.settings.headers,function(e,t){A.setRequestHeader(t,e)}),A.send(d,{runtime_order:e.settings.runtimes,required_caps:e.settings.required_features,preferred_caps:D,swf_url:e.settings.flash_swf_url,xap_url:e.settings.silverlight_xap_url})))}var s,u=e.settings.url,c=e.settings.chunk_size,l=e.settings.max_retries,f=e.features,p=0;n.loaded&&(p=n.loaded=c?c*Math.floor(n.loaded/c):0),s=n.getSource(),e.settings.resize.enabled&&d(s,"send_binary_string")&&~t.inArray(s.type,["image/jpeg","image/png"])?h.call(this,s,e.settings.resize,function(e){s=e,n.size=e.size,o()}):o()}function _(e,t){u(t)}function y(e){if(e.state==a.STARTED)S=+new Date;else if(e.state==a.STOPPED)for(var t=e.files.length-1;t>=0;t--)e.files[t].status==a.UPLOADING&&(e.files[t].status=a.QUEUED,c())}function w(){A&&A.abort()}function E(e){c(),r(function(){s.call(e)},1)}function b(e,t){t.code===a.INIT_ERROR?e.destroy():t.file&&(t.file.status=a.FAILED,u(t.file),e.state==a.STARTED&&(e.trigger("CancelUpload"),r(function(){s.call(e)},1)))}function R(e){e.stop(),a.each(I,function(e){e.destroy()}),I=[],N.length&&(a.each(N,function(e){e.destroy()}),N=[]),L.length&&(a.each(L,function(e){e.destroy()}),L=[]),D={},M=!1,S=A=null,T.reset()}var x,S,T,A,O=a.guid(),I=[],D={},N=[],L=[],M=!1;x={runtimes:t.Runtime.order,max_retries:0,chunk_size:0,multipart:!0,multi_selection:!0,file_data_name:"file",flash_swf_url:"js/Moxie.swf",silverlight_xap_url:"js/Moxie.xap",filters:{mime_types:[],prevent_duplicates:!1,max_file_size:0},resize:{enabled:!1,preserve_headers:!0,crop:!1},send_file_name:!0,send_chunk_number:!0},g.call(this,e,null,!0),T=new a.QueueProgress,a.extend(this,{id:O,uid:O,state:a.STOPPED,features:{},runtime:null,files:I,settings:x,total:T,init:function(){var e=this;return"function"==typeof x.preinit?x.preinit(e):a.each(x.preinit,function(t,n){e.bind(n,t)}),f.call(this),x.browse_button&&x.url?void p.call(this,x,function(n){"function"==typeof x.init?x.init(e):a.each(x.init,function(t,n){e.bind(n,t)}),n?(e.runtime=t.Runtime.getInfo(l()).type,e.trigger("Init",{runtime:e.runtime}),e.trigger("PostInit")):e.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})}):void this.trigger("Error",{code:a.INIT_ERROR,message:a.translate("Init error.")})},setOption:function(e,t){g.call(this,e,t,!this.runtime)},getOption:function(e){return e?x[e]:x},refresh:function(){N.length&&a.each(N,function(e){e.trigger("Refresh")}),this.trigger("Refresh")},start:function(){this.state!=a.STARTED&&(this.state=a.STARTED,this.trigger("StateChanged"),s.call(this))},stop:function(){this.state!=a.STOPPED&&(this.state=a.STOPPED,this.trigger("StateChanged"),this.trigger("CancelUpload"))},disableBrowse:function(){M=arguments[0]!==n?arguments[0]:!0,N.length&&a.each(N,function(e){e.disable(M)}),this.trigger("DisableBrowse",M)},getFile:function(e){var t;for(t=I.length-1;t>=0;t--)if(I[t].id===e)return I[t]},addFile:function(e,n){function i(e,n){var i=[];t.each(c.settings.filters,function(t,n){o[n]&&i.push(function(i){o[n].call(c,t,e,function(e){i(!e)})})}),t.inSeries(i,n)}function s(e){var o=t.typeOf(e);if(e instanceof t.File){if(!e.ruid&&!e.isDetached()){if(!u)return!1;e.ruid=u,e.connectRuntime(u)}s(new a.File(e))}else e instanceof t.Blob?(s(e.getSource()),e.destroy()):e instanceof a.File?(n&&(e.name=n),d.push(function(t){i(e,function(n){n||(I.push(e),f.push(e),c.trigger("FileFiltered",e)),r(t,1)})})):-1!==t.inArray(o,["file","blob"])?s(new t.File(null,e)):"node"===o&&"filelist"===t.typeOf(e.files)?t.each(e.files,s):"array"===o&&(n=null,t.each(e,s))}var u,c=this,d=[],f=[];u=l(),s(e),d.length&&t.inSeries(d,function(){f.length&&c.trigger("FilesAdded",f)})},removeFile:function(e){for(var t="string"==typeof e?e:e.id,n=I.length-1;n>=0;n--)if(I[n].id===t)return this.splice(n,1)[0]},splice:function(e,t){var i=I.splice(e===n?0:e,t===n?I.length:t),r=!1;return this.state==a.STARTED&&(a.each(i,function(e){return e.status===a.UPLOADING?(r=!0,!1):void 0}),r&&this.stop()),this.trigger("FilesRemoved",i),a.each(i,function(e){e.destroy()}),r&&this.start(),i},bind:function(e,t,n){var i=this;a.Uploader.prototype.bind.call(this,e,function(){var e=[].slice.call(arguments);return e.splice(0,1,i),t.apply(this,e)},0,n)},destroy:function(){this.trigger("Destroy"),x=T=null,this.unbindAll()}})},a.Uploader.prototype=t.EventTarget.instance,a.File=function(){function e(e){a.extend(this,{id:a.guid(),name:e.name||e.fileName,type:e.type||"",size:e.size||e.fileSize,origSize:e.size||e.fileSize,loaded:0,percent:0,status:a.QUEUED,lastModifiedDate:e.lastModifiedDate||(new Date).toLocaleString(),getNative:function(){var e=this.getSource().getSource();return-1!==t.inArray(t.typeOf(e),["blob","file"])?e:null},getSource:function(){return n[this.id]?n[this.id]:null},destroy:function(){var e=this.getSource();e&&(e.destroy(),delete n[this.id])}}),n[this.id]=e}var n={};return e}(),a.QueueProgress=function(){var e=this;e.size=0,e.loaded=0,e.uploaded=0,e.failed=0,e.queued=0,e.percent=0,e.bytesPerSec=0,e.reset=function(){e.size=e.loaded=e.uploaded=e.failed=e.queued=e.percent=e.bytesPerSec=0}},e.plupload=a}(window,mOxie);
/* <<< file end: js/lib/plupload/plupload-2.1.2.full.min.js */

//# map link was there [plupload-2.1.2.full.min.js.map]
/* >>> file start: js/core/angular/plupload.js */
//= require js/lib/plupload/plupload-2.1.2.full.min.js
!function(){"use strict";angular.module("angular-plupload",[]).provider("pluploadOption",function(){var l={flash_swf_url:LJ.get("siteroot")+"/js/lib/plupload/Moxie.cdn.swf",runtimes:"html5,flash",max_file_size:"10mb",multipart:!0,filters:[{title:"Image files",extensions:"jpg,jpeg,gif,png"}],chunk_size:0};return{setOptions:function(e){angular.extend(l,e)},$get:function(){return l}}}).directive("plupload",["$timeout","pluploadOption",function(l,e){function a(l){return l.charAt(0).toLowerCase()+l.slice(1)}return{scope:{url:"=plupload",options:"=pluploadOptions",callbacks:"=pluploadCallbacks",disbled:"=pluploadDisableOnUpload",delayed:"=pluploadDelayed"},link:function o(n,i){if(n.delayed&&!n.loaded)return l(function(){o(n,i)},10),void(n.loaded=!0);var t=e;t.url=n.url,angular.extend(t,n.options);var d=n.disbled,p=new plupload.Uploader(t);if(n.callbacks){var r=["Init","PostInit","OptionChanged","Refresh","StateChanged","UploadFile","BeforeUpload","QueueChanged","UploadProgress","FilesRemoved","FileFiltered","FilesAdded","FileUploaded","ChunkUploaded","UploadComplete","Error","Destroy"];angular.forEach(r,function(l){var e=n.callbacks[a(l)]||angular.noop;p.bind(l,function(){e.apply(null,arguments),n.$$phase||n.$root.$$phase||n.$apply()})})}p.init(),d&&p.bind("BeforeUpload",function(){p.addFile=angular.noop})}}}])}();
/* <<< file end: js/core/angular/plupload.js */

//# map link was there [plupload.js.map]
/* >>> file start: js/core/angular/checked.js */
angular.module("LJ.Checked",[]).factory("checkedGroup",[function(){function e(){this._models={}}function t(t){return r[t]?r[t]:(r[t]=new e,r[t])}var r={};return e.prototype.reset=function(e){var t,r=this.models();for(t in r)r.hasOwnProperty(t)&&delete r[t];return angular.isObject(e)&&angular.extend(r,e),this},e.prototype.length=function(){return Object.keys(this.models()).length},e.prototype.count=function(){var e,t=this.models(),r=0;for(e in t)t.hasOwnProperty(e)&&t[e]&&(r+=1);return r},e.prototype.models=function(){return this._models},e.prototype.toggle=function(e,t){var r=this.models(),n="undefined"!=typeof t;Array.isArray(e)||(e=[e]),e.forEach(function(e){r[e]=n?t:!Boolean(r[e])})},e.prototype.isChecked=function(e){return Boolean(this.models()[e])},e.prototype.isAllChecked=function(e){var t=this.models();return"undefined"==typeof e?this.count()===this.length():(Array.isArray(e)||(e=[e]),e.every(function(e){return t[e]}))},e.prototype.isNoneChecked=function(e){var t=this.models();return"undefined"==typeof e?0===this.count():(Array.isArray(e)||(e=[e]),e.every(function(e){return!t[e]}))},e.prototype.getChecked=function(e){var t,r=this.models(),n=[];for(t in r)r.hasOwnProperty(t)&&r[t]&&n.push(t);return"undefined"!=typeof e&&(Array.isArray(e)||(e=[e]),e=e.map(String),n=n.filter(function(t){return-1!==e.indexOf(t)})),n},t}]);
/* <<< file end: js/core/angular/checked.js */

//# map link was there [checked.js.map]
/* >>> file start: js/core/angular/privacy.js */
//= require js/core/angular/api.js
//= require js/core/angular/checked.js
Site.page.template['angular/privacy.ng.tmpl'] = ' <span>\n\n  <select\n          class=\"sharp-select\"\n          name=\"privacy\"\n          ng-model=\"model.privacy\"\n          ng-attr-tabindex=\"{{tab}}\"\n          ng-options=\"item.value as item.title for item in privacy.all\"\n          ng-disabled=\"disabled\"\n  ></select>\n\n  <ul class=\"privacy-list\" ng-if=\"model.privacy === \'custom\'\">\n    <li class=\"privacy-item\" ng-repeat=\"group in privacy.groups track by group.id\">\n        <label>\n          <input type=\"checkbox\" ng-model=\"privacy.selected[group.id]\" name=\"custom_bit_{{group.id}}\" ng-attr-tabindex=\"{{tab}}\">\n          <span ng-bind=\"group.name\"></span>\n        </label>\n    </li>\n  </ul>\n\n</span>\n';
//= require_ml flatmedia.security
//= require_ml admin.writers_block.answer.private
//= require_ml admin.writers_block.answer.public
//= require_ml admin.writers_block.answer.custom
//= require_ml admin.writers_block.answer.friends
//= require_ml admin.writers_block.answer.default
//= require_ml admin.writers_block.answer.members
//= require_ml admin.writers_block.answer.maintainers
!function(e){return e}(),function(){"use strict";angular.module("LJ.Privacy",["LJ.Templates","LJ.Api","LJ.Checked"]).factory("Privacy",["Api",function(e){function t(t){return e.call("user.get_privacy_list",t,{cache:!0}).then(function(e){return e.list})}function n(t){return t=t||{},e.call("groups.list",t,{cache:!0}).then(function(e){return e.groups})}return{getGroups:n,getPrivacyList:t}}]).directive("ljPrivacy",["$timeout","Privacy","checkedGroup",function(e,t,n){return{scope:{model:"=ljPrivacy",scope:"=ljPrivacyScope",user:"=ljPrivacyUser",tab:"=ljPrivacyTabindex",init:"=ljPrivacyInit",disabled:"=ljPrivacyDisabled"},templateUrl:"privacy.ng.tmpl",controllerAs:"privacy",controller:["$scope","$attrs",function(r,i){function c(){r.$watchCollection(function(){return a.getChecked()},function(e){r.model.groupids=e.map(Number)})}function o(){l&&""!==r.user&&(u.selected=a.models(),t.getPrivacyList({scope:r.scope,user:r.user}).then(function(e){if(u.all=[],e.forEach(function(e){u.all.push({title:LJ.ml("admin.writers_block.answer."+e),value:e})}),i.hasOwnProperty("ljPrivacyDeafult")&&u.all.unshift({title:LJ.ml("admin.writers_block.answer.default"),value:""}),!r.communityChanged)var t=u.all.find(function(e){return e.value===r.model.privacy});t||(r.model.privacy=u.all[0].value)}),t.getGroups({journal:r.user}).then(function(e){u.groups=e,a.toggle(r.model.groupids,!0),c()}))}var u=this,a=n("custom"),l=!0;i.hasOwnProperty("ljPrivacyInit")&&r.$watch("init",function(t){t&&(l=t,e(o))}),r.$watch("user",o),r.$watchCollection("model.groupids",function(){a.toggle(r.model.groupids,!0)}),r.$on("privacy:customGroups:reset",function(){a.reset()}),LJ.Event.on("community:change",function(){r.needStateRestore?r.needStateRestore=!1:r.communityChanged=!0}),LJ.Event.on("state_restore",function(){r.needStateRestore=!0})}]}}])}();
/* <<< file end: js/core/angular/privacy.js */

//# map link was there [privacy.js.map]
/* >>> file start: js/video/video.js */
var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};
//= require_ml flatmedia.adult.content.default
//= require_ml flatmedia.adult.content.none
//= require_ml flatmedia.adult.content.explicit
//= require_ml flatmedia.select.album.none
!function(e){return e}(),function(){"use strict";angular.module("Video.Service",[]).factory("Video",["Api",function(e){function t(t){return e.call("video.create_record",t).then(function(e){return g(e.record),e.record})}function r(t){return e.call("video.get_albums",_extends({user:E},t),{cache:!0}).then(function(e){e.albums.forEach(d)})}function n(t){return e.call("video.get_album",{id:t,user:E},{cache:!0}).then(function(e){d(e.album)})}function u(t,r){return e.call("video.get_records",_extends({albumid:t,user:E},r),{cache:!0}).then(function(e){var t=e.records.map(function(e){return e.url=e.url.replace(/^http:/,"https:"),e.screenshot=e.screenshot.replace(/^http:/,"https:"),e});return g(t),t})}function i(t){return e.call("video.get_record",{storageid:t},{cache:!0}).then(function(e){var t=e.record;return g(t),t})}function a(t){return e.call("video.update_album",t).then(function(){d(t),e.invalidate("video.get_albums",{user:E}),e.invalidate("video.get_album",{id:t.id,user:E})})}function c(t){var r=angular.extend({},{security:"public",user:E},t);return e.call("video.create_album",r).then(function(t){var r=t.album;return d(r),e.invalidate("video.get_albums",{user:E}),r})}function o(t){return e.call("video.delete_album",{id:t}).then(function(r){return l(t),e.invalidate("video.get_albums",{user:E}),e.invalidate("video.get_album",{user:E,id:t}),r})}function d(e){R[e.id]=e}function l(e){delete R[e],b(e).forEach(function(e){s(e.id)})}function s(e){delete y[e]}function f(){var e=[];return angular.forEach(R,function(t){e.push(t)}),e.sort(function(e,t){return t.id-e.id}),e}function v(e){return R[e]}function m(e){return y[e]}function b(e){var t=[];return angular.forEach(y,function(r){r.albumid===e&&t.push(r)}),t.sort(function(e,t){return t.timecreate-e.timecreate}),t}function h(t){return e.call("video.update_records",t).then(function(t){var r=t.records;return r.forEach(function(t){var r=m(t.id);e.invalidate("video.get_records",{albumid:t.albumid,user:E}),e.invalidate("video.get_album",{user:E,id:t.albumid}),e.invalidate("video.get_records",{albumid:r.albumid,user:E}),e.invalidate("video.get_album",{user:E,id:r.albumid}),e.invalidate("video.get_albums",{user:E}),g(t)}),r})}function _(t){return e.call("video.delete_records",{ids:t}).then(function(){t.forEach(function(e){s(e)})})}function g(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){y[e.id]=e})}var p={NON_SELECTED_ALBUM:{id:-1,name:LJ.ml("flatmedia.select.album.none")},RECORD_ADULT:!1,RECORD_PRIVACY:"public",ALBUM_PRIVACY:"public",ALBUM_NAME:""},A={createRecord:t,fetchAlbums:r,getAlbums:f,fetchAlbum:n,getAlbumById:v,fetchRecords:u,fetchRecordByStorageId:i,getRecordById:m,getRecordsByAlbumId:b,createAlbum:c,updateAlbum:a,removeAlbum:o,updateRecords:h,removeRecords:_,defaults:p},E=LJ.get("journal.username")||LJ.get("remote.username"),R={},y={};return A}])}();
/* <<< file end: js/video/video.js */

//# map link was there [video.js.map]
/* >>> file start: js/video/selectAlbum.js */
//= require js/video/video.js
Site.page.template['angular/video/selectVideoAlbum.ng.tmpl'] = '<div class=\"b-ljform-field\"\n  ng-class=\"{\n    \'flatpopup-create-state\': directive.state.create\n  }\"\n  >\n\n  <div class=\"flatmedia-edit-field\">\n    <label class=\"flatpopup-label\" lj-ml=\"flatmedia.select.album\"></label>\n    <select\n      class=\"sharp-select\"\n      ng-model=\"directive.selectedAlbumId\"\n      ng-options=\"album.id as album.name for album in directive.albums\"\n      ></select>\n    <span lj-ml=\"flatmedia.or\"></span>\n    <a\n      class=\"flatmedia-action-link\"\n      href=\"javascript:void(0);\"\n      ng-click=\"directive.toggle(true)\"\n      lj-ml=\"flatmedia.album.create.new\"\n      ></a>\n  </div>\n\n  <div class=\"flatmedia-create-field\">\n    <label class=\"flatpopup-label\" lj-ml=\"flatmedia.album.name\"></label>\n    <a\n      class=\"flatpopup-action-link flatpopup-aside-link\"\n      href=\"javascript:void(0);\"\n      ng-click=\"directive.toggle(false)\"\n      lj-ml=\"flatmedia.button.back\"\n      ng-if=\"directive.albums.length\"\n      ></a>\n    <input\n      type=\"text\"\n      class=\"b-input b-input-max\"\n      ng-model=\"directive.newAlbum.name\"\n      maxlength=\"150\"\n      />\n  </div>\n</div>\n';
//= require_ml flatmedia.album.create.new
//= require_ml flatmedia.album.name
//= require_ml flatmedia.button.back
//= require_ml flatmedia.or
//= require_ml flatmedia.select.album
!function(e){return e}(),function(){"use strict";angular.module("Video.SelectAlbum",["LJ.Templates","Video.Service"]).directive("selectVideoAlbum",["Video",function(e){return{templateUrl:"selectVideoAlbum.ng.tmpl",controllerAs:"directive",scope:{album:"=selectVideoAlbum",allowNonSelected:"=?allowNonSelected"},controller:["$scope","$attrs","Video",function(e,t,l){function n(){var l=t.allowNonSelected;return"string"==typeof l&&0===l.length?!0:e.allowNonSelected}function u(e){var t=[];return n()&&t.push(l.defaults.NON_SELECTED_ALBUM),t.concat(e?e:l.getAlbums())}var o=this,i=this.state={init:!1,create:!1};this.newAlbum={name:""},this.init=function(){i.init=!0,o.albums=angular.copy(l.getAlbums()),e.album.id?this.selectedAlbumId=e.album.id:0!==o.albums.length&&(this.selectedAlbumId=o.albums[0].id),e.$watch(function(){return o.selectedAlbumId+o.newAlbum.name+i.create},function(){e.album=i.create?o.newAlbum:l.getAlbumById(o.selectedAlbumId)}),e.$watchCollection(l.getAlbums,function(e){o.albums=u(e),0===e.length&&(i.create=!0)}),"undefined"!=typeof t.allowNonSelected&&e.$watch("allowNonSelected",function(){o.albums=u()})},this.toggle=function(e){i.create=e,this.newAlbum.name=""}}],link:function(t,l,n,u){if("undefined"==typeof t.album)throw new TypeError("You should provide album object");e.fetchAlbums().then(function(){u.init()})}}}])}();
/* <<< file end: js/video/selectAlbum.js */

//# map link was there [selectAlbum.js.map]
/* >>> file start: js/video/uploader.js */
//= require js/core/angular/api.js
//= require js/core/angular/adult.js
//= require js/core/angular/plupload.js
//= require js/core/angular/privacy.js
//= require js/video/video.js
//= require js/video/selectAlbum.js
Site.page.template['angular/video/uploaderVideo.ng.tmpl'] = '<div\n    class=\"flatpopup__body-inner flatpopup__text\"\n    ng-if=\"directive.state.init\"\n    ng-class=\'{\n        \"flatpopup-uploading\": directive.state.uploadInProgress,\n        \"flatpopup-uploading-complete\": directive.state.uploadDone\n    }\'\n    >\n    <div\n        class=\"b-ljform-field upload__box\"\n        id=\"upload-panel-video\"\n        plupload=\"directive.uploadUrl\"\n        plupload-options=\"directive.uploadOptions\"\n        plupload-callbacks=\"directive.uploadCallbacks\"\n        >\n        <label\n            for=\"pickfiles-video\"\n            class=\"upload__box-label\"\n            lj-ml=\"{\n                \'videouploader.upload.dragOrClick\': !directive.files.length,\n                \'videouploader.upload.selectedFile\': directive.files.length\n            }\"\n            lj-ml-resolve=\"{ filename: directive.files.length && directive.files[0].name }\"\n            lj-ml-dynamic=\"directive.files.length\"\n            ></label>\n        <input\n            type=\"file\"\n            class=\"upload__input\"\n            name=\"media\"\n            id=\"pickfiles-video\"\n            ng-hide=\"directive.state.uploading\"\n            >\n    </div>\n\n    <div class=\"upload-bar\">\n        <span\n            class=\"upload-bar__inner\"\n            ng-style=\"{ width: directive.file.percent + \'%\' }\"\n            ></span>\n    </div>\n\n    <div class=\"flatpopup__msg\">\n        <span\n            class=\"\n                b-bubble\n                b-bubble-warning\n                b-bubble-noarrow\n                flatpopup__msg-warning\n                flatpopup__msg-text\n                \"\n            ></span>\n    </div>\n\n    <div class=\"b-ljform-field\">\n        <div class=\"b-ljform-field-head\">\n            <label\n                class=\"flatpopup-label\"\n                lj-ml=\"flatmedia.name\"\n                ></label>\n        </div>\n        <div class=\"b-ljform-field-body\">\n            <input\n                class=\"b-input b-input-max\"\n                type=\"text\"\n                name=\"title\"\n                ng-model=\"directive.model.name\"\n                >\n        </div>\n    </div>\n\n    <div class=\"b-ljform-field\">\n        <div select-video-album=\"directive.model.album\"></div>\n    </div>\n\n    <div class=\"b-ljform-field flatmedia-privacy__field\">\n        <label\n            class=\"flatpopup-label\"\n            lj-ml=\"flatmedia.security\"\n            ></label>\n        <span\n            lj-privacy=\"directive.model\"\n            lj-privacy-scope=\"video\"\n            ></span>\n    </div>\n\n    <div\n        class=\"b-ljform-field\"\n        lj-adult=\"directive.model.adult_content\"\n        ></div>\n\n    <div class=\"b-ljform-field b-videouploader-action-panel\">\n        <a\n            class=\"flatpopup-action-link\"\n            href=\"javascript:void(0)\"\n            ng-click=\"directive.cancel()\"\n            lj-ml=\"flatmedia.button.cancel\"\n            ></a>\n        <button\n            class=\"\n                b-flatbutton\n                b-flatbutton-simple\n                \"\n            lj-ml=\"flatmedia.upload.video\"\n            lj-disabled=\"!directive.isUploadAllowed()\"\n            ng-click=\"directive.upload()\"\n            ></button>\n    </div>\n\n</div>\n\n<div class=\"b-photouploader-initfail\" ng-if=\"!directive.state.init\">\n    <span\n        class=\"b-photouploader-initfail-flash\"\n        lj-ml=\"photouploader.upload.initFail\"\n        ></span>\n</div>\n';
//= require_ml flatmedia.button.cancel
//= require_ml flatmedia.name
//= require_ml flatmedia.upload.video
//= require_ml videouploader.upload.dragOrClick
//= require_ml videouploader.upload.selectedFile
//= require_ml photouploader.upload.initFail
!function(e){return e}(),function(){"use strict";angular.module("Video.Uploader",["LJ.Templates","LJ.Api","LJ.Adult","LJ.Privacy","LJ.Messages","angular-plupload","Video.SelectAlbum","Video.Service"]).directive("ljVideoUploader",["$timeout",function(e){return{templateUrl:"uploaderVideo.ng.tmpl",scope:{albumId:"=ljVideoUploader",callback:"&ljVideoUploaderCallback",onError:"&ljVideoUploaderError",cancelUpload:"&ljVideoUploaderCancel"},controllerAs:"directive",controller:["$scope","$q","$rootScope","$element","$attrs","Video","Messages",function(o,t,n,l,i,a,r){function d(){return{name:a.defaults.ALBUM_NAME,privacy:a.defaults.RECORD_PRIVACY,album:a.getAlbumById(o.albumId)||{},adult_content:a.defaults.RECORD_ADULT}}function u(t,n){return c.state.uploadInProgress=!1,c.state.uploadDone=!1,c.state.error=!0,n.code===window.plupload.INIT_ERROR?void(c.state.init=!1):(n.code===window.plupload.HTTP_ERROR&&c.file&&a.removeRecords([c.file.id]),e(function(){r.error({body:n.message})}),void(angular.isFunction(o.onError)&&o.onError()))}var s,c=this,p=this.state={init:!1,error:!1,uploadInProgress:!1,uploadDone:!1,fileAdded:!1};this.isUploadAllowed=function(){return s&&0!==s.trim().length&&0!==this.model.name.trim().length&&(this.model.album.id||0!==this.model.album.name.trim().length)&&!this.state.uploadInProgress},this.init=function(){p.init=!0,this.model=d()},this.upload=function(){c.state.uploadInProgress=!0,this.beforeUpload().then(function(e){var t=c.uploader.files;c.state.error||(LJ.Event.trigger("video:upload:start"),t[0].name=e.name,c.file.id=e.id,c.uploader.settings.url=e.upload_link,c.uploader.setOption({chunk_size:"1000kb"}),c.uploader.setOption({send_chunk_number:!1}),c.uploader.start(),LJ.Event.once("video:upload:done",function(){o.callback({record:e})}))})},this.cancel=function(){LJ.Event.trigger("video:upload:cancel"),c.state.uploadInProgress=!1,"function"==typeof o.cancelUpload&&o.cancelUpload()},this.beforeUpload=function(){var e=angular.copy(c.model),o=t.defer(),n=o.promise;return"undefined"==typeof e.album.id?n=a.createAlbum({name:e.album.name}):o.resolve(e.album),delete e.album,n.then(function(o){var t=c.uploader.files[0],n=angular.extend(e,{name:c.model.name.trim(),size:t.size});return e.albumid=o.id,a.createRecord(n).then(function(e){return e})["catch"](function(e){u(null,e)})})},this.uploadUrl="/sampleUrl",this.uploadOptions={drop_element:"upload-panel-video",browse_button:"pickfiles-video",multi_selection:!1,filters:{max_file_size:"10240mb",mime_types:[{title:"Video files",extensions:"avi,mp4,mov,3gp,wmv,mkv,webm"}]},multipart:!0,file_data_name:"media"},this.uploadCallbacks={init:function(e){c.uploader=e},filesAdded:function(o,t){e(function(){c.state.uploadDone=!1,c.file=angular.copy(t[0]),o.splice(0,o.files.length-1),s=c.model.name=t[0].name})},uploadProgress:function(e,o){c.file.percent=o.percent},uploadComplete:function(){c.state.error||(c.state.uploadInProgress=!1,c.state.uploadDone=!0,LJ.Event.trigger("video:upload:done"))},error:u.bind(this)},LJ.Event.on("Uploader:filesAdded:video",function(o){e(function(){c.file=angular.copy(o[0])})})}],link:function(o,t,n,l){e(function(){l.init()})}}}])}();
/* <<< file end: js/video/uploader.js */

//# map link was there [uploader.js.map]
/* >>> file start: js/video/editor.js */
//= require js/editor/editor.js
//= require js/editor/media.js
//= require js/core/string.js
//!= require js/core/angular/messages.js
//= require js/core/angular/api.js
//= require js/core/angular/pills.js
//= require js/core/angular/authHelper.js
//= require js/video/uploader.js
//= require js/video/video.js
LJ.injectStyle('/* >>> file start: stc/photouploader.css */\n.b-photouploader-item-upload-start .b-photouploader-panel-controls,.b-photouploader-item-upload-start .b-photouploader-panel-pictures,.flatmedia-create-field{display:none}.flatpopup-loading .flatpopup__body:after,.flatpopup-loading-state:before{z-index:1;top:0;left:0;opacity:.6;background:#FFF;right:0;bottom:0}.b-photouploader{width:480px}.b-photouploader-items{margin:0}.b-photouploader-item{margin:0;padding:1em 0 0}.b-photouploader-item-noalbums{padding:1em 0;text-align:center}.b-photouploader-item-noalbums:not(.ng-hide)+.b-photouploader-item-instagram{padding-top:0}.b-photouploader-item-upload-start .b-photouploader-panel-upload{margin-bottom:0}.b-photouploader-item-upload-uploaded .b-photouploader-panel-pictures{margin-bottom:15px;overflow:auto;max-height:250px}.flatpopup-create-state .flatmedia-create-field,.flatpopup-loading .flatpopup__preloader,.flatpopup-success-state .flatpopup__msg-success,.flatpopup-warning-state .flatpopup__msg-warning{display:block}.flatpopup-loading .flatpopup__body:after{display:block;position:absolute}.flatpopup-create-state .flatmedia-edit-field{display:none}.flatpopup-loading-state{position:relative;width:100%;min-height:34px}.flatpopup-loading-state:after,.flatpopup-loading-state:before{display:block;position:absolute;content:\"\"}.flatpopup-loading-state:after{z-index:2;top:50%;left:50%;width:34px;height:34px;margin-top:-17px;margin-left:-17px;background:url(/img/preloader/preloader-disc-blue-white.gif?v=39255) 50% 50% no-repeat}.upload__box,.upload__box-label{border:4px dashed #DAE3E6;background:#FFF}.upload__item,.upload__item_remove{background-color:#FFF;cursor:pointer}.flatpopup-delete-btn{display:none}.flatpopup-edit-state .flatpopup-delete-btn{display:inline-block}.flatpopup SELECT,.flatpopup-label+SELECT{max-width:160px;margin:0 5px 0 0;font-size:14px;vertical-align:middle}.flatpopup-label{color:#004359}.b-ljform-field .flatpopup-label{margin-right:6px;vertical-align:middle}.upload__box{overflow:hidden;position:relative;min-height:49px;text-align:center}.upload__box-label{display:block;margin:-5px;padding:15px;cursor:pointer}.upload__input{position:absolute!important;top:0;right:0;width:100%;height:50px;margin:0;padding:0;border:0;opacity:0;filter:alpha(opacity=0);zoom:1;font-size:10000px;cursor:pointer}.upload__items{position:relative;margin:25px 0 19px;padding:0;list-style:none}.upload__item{display:inline-block;position:relative;width:144px;height:144px;margin:0 20px 30px;padding:22px;box-shadow:0 7px 22px -9px #999;box-sizing:border-box}.upload__item_pic{display:block;width:100px;height:100px;background-position:0 0;background-repeat:no-repeat;background-size:cover;text-align:center}.upload__item_remove{display:inline-block;position:absolute;top:-11px;right:-11px;width:20px;height:20px;border:2px solid #cf0011;border-radius:50%;box-shadow:0 3px 5px -3px #000}.upload__item_remove .svgicon{position:absolute;top:50%;left:50%;width:12px;height:12px;margin-top:-6px;margin-left:-6px}.upload-bar{opacity:0;position:relative;height:6px;margin:0 0 10px;border-radius:6px;background-color:#CCC}.upload-bar__inner{position:absolute;left:0;top:0;height:6px;border-radius:6px;background-color:#09C}.upload-bar__inner:after{content:\"\";z-index:1;position:absolute;overflow:hidden;top:0;left:0;bottom:0;right:0;background-image:-webkit-linear-gradient(135deg,rgba(255,255,255,.2) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.2) 50%,rgba(255,255,255,.2) 75%,transparent 75%,transparent);background-image:linear-gradient(-45deg,rgba(255,255,255,.2) 25%,transparent 25%,transparent 50%,rgba(255,255,255,.2) 50%,rgba(255,255,255,.2) 75%,transparent 75%,transparent);background-size:50px 50px;-webkit-animation:move 2s linear infinite;animation:move 2s linear infinite}@-webkit-keyframes move{0%{background-position:0 0}100%{background-position:50px 50px}}@keyframes move{0%{background-position:0 0}100%{background-position:50px 50px}}.flatpopup-uploading .upload-bar{opacity:1}.flatpopup-uploading .upload-bar,.flatpopup-uploading .upload-bar__inner{-webkit-transition-property:all;transition-property:all;-webkit-transition-duration:.3s;transition-duration:.3s}.flatpopup-uploading-complete .upload-bar{opacity:0;-webkit-transition-property:opacity;transition-property:opacity;-webkit-transition-duration:.3s;transition-duration:.3s}.flatpopup__msg-text{display:none;margin:1em 0}.b-photouploader-byurl:after,.b-photouploader-instahead:after,.b-photouploader-panel:after{display:table;border-collapse:collapse;clear:both}.flatpopup-action-link{font:600 .875em/1 ProximaNova,Tahoma,Arial,sans-serif;margin-right:4px;white-space:nowrap;text-transform:uppercase;color:#00a3d9;border:0;background-color:transparent}.flatpopup-aside-link{float:right}.b-photouploader-item-upload .sharp-select{font-size:14px;vertical-align:middle}.b-photouploader-item-upload .flatpopup-label{vertical-align:middle}.b-photouploader-action-panel,.b-videouploader-action-panel{text-align:right;margin-bottom:0}.b-photouploader-panel-dropbox,.b-photouploader-panel-instalogin{text-align:center}.b-photouploader-panel{margin:0}.b-photouploader-panel:after{content:\"\"}.b-photouploader-panel-upload{margin:0 0 15px}.b-photouploader-panel-albums,.b-photouploader-panel-pictures{margin:0}.b-photouploader-panel-url{margin:0 0 15px}.b-photouploader-panel-dropbox-intro{width:75%;margin:0 auto 1em;line-height:1.4}.b-photouploader-panel-instalogin-intro{width:70%;margin:0 auto 1em;text-align:left;line-height:1.4}.b-photouploader-byurl{margin:0 0 0 110px;padding:0}.b-photouploader-byurl:after{content:\"\"}.b-photouploader-byurl-picture{position:relative;left:-110px;float:left;width:100px;max-height:100px;margin:0 -100px 0 0;padding:0;box-shadow:0 0 10px #BBB;background:#FFF}.b-photouploader-byurl-image{max-width:100px;max-height:100px;margin:0;vertical-align:top}.b-photouploader-byurl-sub{display:block;margin:0;padding:10px;font-size:86%;color:#999}.b-photouploader-byurl-form{margin:0 0 1em}.b-photouploader-byurl-label{display:block;margin:0 0 .5em}.b-photouploader-byurl-link,.b-photouploader-byurl-src{width:100%;margin:0;box-sizing:border-box}.b-photouploader-byurl-br{display:none}.b-photouploader-byurl-note{display:block;margin:.5em 0 0;font-size:86%;font-style:normal;color:#666}.b-photouploader-albumsettings-separator{display:none}.b-photouploader-albumsettings-wrap{float:right}.b-photouploader-panel-controls{margin:0 -15px;padding:15px 15px 0;border-top:1px solid #FFF}.b-photouploader-albumselector-item,.b-photouploader-panel-controls .b-photouploader-albumsettings{margin:0 0 .5em}.b-photouploader-panel-controls .b-photouploader-albumselector{width:70%}.b-photouploader-albumselector-input{width:280px}.b-photouploader-albumsettings-select{margin:0 1em 0 0}.b-photouploader-panel-controls .b-photouploader-urlsettings{margin:0 0 1em}.b-photouploader-urlsettings-label{margin:0 .5em 0 0}.b-photouploader-panel-controls .b-photouploader-instasettings{float:left;width:75%}.b-photouploader-instasettings-label{margin:0 1em 0 0}.b-photouploader-instasettings-annex{display:block;margin:0 0 0 1.7em;color:#999}.b-photouploader-panel-controls .b-flatbutton,.b-photouploader-panel-controls .b-ljbutton{float:right}.b-photouploader-panel-controls .b-ljbutton{display:inline-block}.b-photouploader-panel-controls .b-flatbutton,.s-schemius .b-photouploader-panel-controls .b-ljbutton{display:none}.s-schemius .b-photouploader-panel-controls .b-flatbutton{display:inline-block}.b-photouploader-uploader{margin:0;padding:25px 15px;border:1px solid #BBB;border-radius:5px;text-align:center;line-height:2;color:#666}.drag-and-drop .b-photouploader-uploader{box-shadow:inset 0 0 15px #526283;border:2px dashed #999;border-radius:0;background:#FFF}.b-photouploader-uploader-drop{display:none;margin:0;padding:0;color:#666}.b-photouploader-uploader-drop STRONG{font-size:1.5em;font-weight:400;color:#666}.b-photouploader-uploader-nodrop{margin:0}.b-photouploader-uploader-nodrop STRONG{font-size:1.5em;font-weight:400;color:#666}.drag-and-drop .b-photouploader-uploader-drop{display:block}.drag-and-drop .b-photouploader-uploader-nodrop{display:none}.b-photouploader-uploader-input{color:#666}.b-photouploader-uploader-list{width:40%;margin:5px auto;padding:0;list-style-type:decimal;text-align:left;line-height:1.2}.b-photouploader-uploader-list-item{margin:0 0 .5em;padding:0}.b-photouploader-pictures{margin:0;padding:0;list-style:none}.b-photouploader-pictures-item{position:relative;display:inline-block;width:142px;margin:0 5px 5px 0;padding:10px;vertical-align:top}.b-photouploader-pictures-pic{display:table-cell;width:132px;height:132px;margin:0;padding:5px;vertical-align:middle;box-shadow:0 5px 10px #CCC;background:#FFF;text-align:center}.b-photouploader-pictures-img{max-width:132px;max-height:132px;vertical-align:top}.b-photouploader-pictures-remove{display:none;overflow:hidden;position:absolute;top:0;right:0;z-index:1;width:21px;height:21px;background:url(/img/icons/remove.png?v=37651) no-repeat;font:0/0 a;cursor:pointer}.b-photouploader-pictures-title{display:none;overflow:hidden;margin:0;padding:5px 5px 0;white-space:nowrap;text-overflow:ellipsis;text-align:center;font-size:90%;font-weight:400}.b-photouploader-pictures-item.selected{border-radius:3px;box-shadow:inset 0 0 4px #444;background:#2C5188;background:-webkit-linear-gradient(top,#2C5188 0,#2E8FED 100%) #2C5188;background:linear-gradient(to bottom,#2C5188 0,#2E8FED 100%) #2C5188;color:#FFF}.b-photouploader-pictures-item.selected .b-photouploader-pictures-pic{box-shadow:0 2px 4px #666}.b-photouploader-pictures-item.selected .b-photouploader-pictures-title{color:#FFF}.b-photouploader-pictures-withremove .b-photouploader-pictures-remove,.b-photouploader-pictures-withtitle .b-photouploader-pictures-title{display:block}.b-photouploader-pictures-withmove .b-photouploader-pictures-pic{cursor:move}.b-photouploader-nav{position:absolute;top:0;left:0;z-index:2;width:100%;margin:0;padding:10px 0 25px;list-style:none;background:-webkit-linear-gradient(top,rgba(247,249,250,1) 0,rgba(247,249,250,0) 100%);background:linear-gradient(to bottom,rgba(247,249,250,1) 0,rgba(247,249,250,0) 100%)}.b-photouploader-nav-item{display:inline;margin:0;padding:0}.b-photouploader-nav-item:before{content:\"/\"}.b-photouploader-nav-item:first-child:before{content:\"\"}.b-photouploader-nav-item A:link,.b-photouploader-nav-item A:visited{border-bottom:1px dotted;text-decoration:none;color:#0051B7!important}.b-photouploader-nav-item A:active,.b-photouploader-nav-item A:hover{border-bottom:1px dotted;text-decoration:none;color:#C00!important}.b-photouploader-nav>SELECT{width:100%}.b-photouploader-albums{position:relative}.b-photouploader-albums-inner{overflow:auto;height:250px;margin:0 -25px 0 -15px;padding:10px 15px 0;background:#F7F9FA}.b-photouploader-albums-withnav .b-photouploader-albums-inner{padding-top:40px}.b-photouploader-albums-loading .b-photouploader-albums-inner:after{content:\" \";position:absolute;bottom:0;left:50%;width:30px;height:30px;margin:0 0 0 -15px;padding:0;background:url(/img/preloader/preloader-blue-blue.gif?v=16423) no-repeat;font:0/0 a}.b-photouploader-search{margin:0 -15px 1px;padding:0 15px 15px;border-bottom:1px solid #CCC;box-shadow:0 1px 0 #FFF}.b-photouploader-search-input{width:100%;box-sizing:border-box}.b-photouploader-subhead{margin:0 0 .5em;font-weight:700;font-size:1em}.b-photouploader-subhead-annex{font-weight:400}.b-photouploader-subtext{margin:0 0 1em;font-size:1em;line-height:1.4}.b-photouploader-instahead,.b-photouploader-logout{margin:0}.b-photouploader .b-photouploader-logout:link,.b-photouploader .b-photouploader-logout:visited{border-bottom:1px dotted;text-decoration:none;color:#0051B7!important}.b-photouploader .b-photouploader-logout:active,.b-photouploader .b-photouploader-logout:hover{text-decoration:none;color:#C00!important}.b-photouploader-instahead--center{text-align:center}.b-photouploader-instahead:after{content:\"\"}.b-photouploader-instahead .b-photouploader-subhead{float:left}.b-photouploader-instahead:not(.b-photouploader-instahead--center) .b-photouploader-logout{float:right}.b-photouploader-instagram-signup:link{display:inline-block;position:relative;margin:0 0 1px;padding:.5em 1.75em .5em 1em;border:1px solid #CCC;border-right:.25em solid #00558D;border-radius:.25em;background:#F8F8F8;text-shadow:1px 1px #FFF;text-decoration:none;font-size:1.5em;color:#333}:root *>.b-photouploader-instagram-signup:after,:root *>.b-photouploader-instagram-signup:before{content:\' \';display:block;position:absolute}.b-photouploader-instagram-signup:before{top:0;right:0;width:.25em;height:100%;background:#FBB03B;border-left:.25em solid #D4145A;border-right:.25em solid #00A99D}.b-photouploader-instagram-signup:after{width:100%;height:100%;top:0;left:0;border-radius:.25em;padding-left:.25em;box-shadow:inset 1px 1px 0 rgba(255,255,255,.5),inset -1px -1px 0 rgba(0,0,0,.1);background:-webkit-linear-gradient(top,rgba(255,255,255,.35) 0,rgba(255,255,255,.2) 49%,rgba(255,255,255,0) 50%,rgba(0,0,0,.1) 100%);background:linear-gradient(to bottom,rgba(255,255,255,.35) 0,rgba(255,255,255,.2) 49%,rgba(255,255,255,0) 50%,rgba(0,0,0,.1) 100%)}.b-photouploader-instagram-signup,.b-photouploader-instagram-signup:before{-webkit-transition:.1s ease-in;transition:.1s ease-in}.b-photouploader-instagram-signup:focus,.b-photouploader-instagram-signup:hover{background:#FFF}.b-photouploader-instagram-signup:hover{border-right:.25em solid #09C}.b-photouploader-instagram-signup:hover:before{background:#FC6;border-left:.25em solid #F06;border-right:.25em solid #0CC}.b-photouploader-instagram-signup:hover:after{background:-webkit-linear-gradient(top,rgba(255,255,255,.25) 0,rgba(255,255,255,.1) 49%,rgba(255,255,255,0) 50%,rgba(0,0,0,.05) 100%);background:linear-gradient(to bottom,rgba(255,255,255,.25) 0,rgba(255,255,255,.1) 49%,rgba(255,255,255,0) 50%,rgba(0,0,0,.05) 100%)}.b-photouploader-instagram-signup:active{margin:1px 0 0}.b-popup .b-photouploader-instagram-signup:active,.b-popup .b-photouploader-instagram-signup:hover,.b-popup .b-photouploader-instagram-signup:link,.b-popup .b-photouploader-instagram-signup:visited{border:1px solid #CCC;border-right:.25em solid #00558D;text-decoration:none}@media all and (max-width:650px){.b-photouploader{width:auto}.b-photouploader-item{padding-bottom:0}.b-photouploader-albums-withnav .b-photouploader-albums-inner{margin-right:0}.b-photouploader-nav{width:calc(100% - 15px)}.b-photouploader-albumsettings-separator{display:block}.b-photouploader-albumsettings-wrap{float:none}.b-photouploader-byurl{margin-left:0}.b-photouploader-byurl-picture{left:auto;float:none;width:100%;max-width:380px;margin:0 auto 20px;text-align:center}.b-photouploader-byurl-link,.b-photouploader-byurl-src{width:100%}}.b-updateform-bubble-video-button{padding:15px 0 0 15px}.b-updateform-bubble-video-button:after{content:\"\";display:table;clear:both}.b-updateform-bubble-video-button .b-flatbutton{float:right}\n/* <<< file end: stc/photouploader.css */\n\n/*# sourceMappingURL=photouploader.css.map */\n');
LJ.injectStyle('/* >>> file start: stc/menu_v2.css */\n.b-menu,.b-menu-item-link{position:relative;padding:0;margin:0}.b-menu{list-style:none}.b-menu:after{content:\"\";display:table;border-collapse:collapse;clear:both}.b-menu-item{display:block;font-family:ProximaNova,Helvetica,sans-serif;font-weight:600;text-transform:uppercase}.b-menu-item .b-menu-item-link:not(.b-menu-item-link-external):link,.b-menu-item .b-menu-item-link:not(.b-menu-item-link-external):visited{color:#7A9199}.b-menu-item .b-menu-item-link:not(.b-menu-item-link-external):active,.b-menu-item .b-menu-item-link:not(.b-menu-item-link-external):hover{color:#242F33}.b-menu-item-disabled{opacity:.5;color:#7A9199}.b-menu-item-disabled .b-menu-item-link{pointer-events:none}.b-menu-item-active{color:#242F33}.b-menu-hrz .b-menu-item{display:inline-block}.b-menu-pills{margin:0;font-size:.8125rem}.b-menu-pills .b-menu-item-link{display:inline-block;padding:10px 13px}.b-menu-pills .b-menu-item-active,.b-menu-pills.b-menu-hrz .b-menu-item-active{padding:0}.b-menu-pills .b-menu-item-link:link,.b-menu-pills .b-menu-item-link:visited{color:#7A9199}.b-menu-pills .b-menu-item-link:active,.b-menu-pills .b-menu-item-link:hover{color:#00A3D9}.b-menu-pills .b-menu-item-active .b-menu-item-link{background:#DAE3E6;cursor:default}.b-menu-pills .b-menu-item-active .b-menu-item-link:active,.b-menu-pills .b-menu-item-active .b-menu-item-link:hover{color:#7A9199}.b-menu-pills.b-menu-hrz{margin:0}.b-menu-tabs{overflow:hidden;margin:0;padding:0}.b-menu-tabs:before{content:\" \";position:absolute;bottom:0;left:0;right:0;height:0;border-bottom:1px solid #dae3e6}.b-menu-tabs .b-menu-item{position:relative;display:inline-block;margin:0;padding:1em 1.5em;text-align:center;border:1px solid transparent;border-bottom:none;vertical-align:top;white-space:nowrap;text-transform:uppercase;letter-spacing:.05em;font-size:13px}.b-menu-tabs .b-menu-item-active{padding:1em 2em;border-color:#dae3e6;border-radius:2px 2px 0 0;background:#FFF}.b-menu-tabs .b-menu-item-active .b-menu-item-link{display:inline;margin:0;padding:0;border-radius:0;box-shadow:none;background:0 0;color:#242F33}.b-menu-tabs-min .b-menu-item{padding:.4em .7em}@media screen and (max-width:1260px){.b-menu-tabs:not(.b-menu-little)::before{content:none}.b-menu-tabs:not(.b-menu-little) .b-menu-item-active{border:1px solid #DAE3E6}}@media screen and (max-width:1050px){.b-menu-tabs .b-menu-item{padding:1em}.b-menu-tabs-min .b-menu-item{padding:.4em .7em}}@media screen and (max-width:880px){.b-menu-tabs .b-menu-item:last-child{margin-bottom:10px}.b-menu-tabs .b-menu-item-active{border-bottom:1px solid #DAE3E6}}@media print{.b-menu{display:none}}\n/* <<< file end: stc/menu_v2.css */\n\n/*# sourceMappingURL=menu_v2.css.map */\n');
Site.page.template['angular/video.ng.tmpl'] = '<div\n    class=\"b-photouploader\"\n    ng-controller=\"VideoEditorCtrl as video\"\n    >\n\n\n\n    <!-- menu -->\n    <ul\n        class=\"\n            b-menu\n            b-menu-hrz\n            b-menu-pills\n            b-menu-pseudo\n            b-photouploader-menu\n            \"\n        lj-pills-group=\"uploadVideo\"\n        ng-init=\"video.pill()\"\n        ng-if=\"video.state.canUpload\"\n        ><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"upload\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"video.pill(\'upload\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"videouploader.upload.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"album\"\n            ng-if=\"video.albums.all.length\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"video.pill(\'album\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"videouploader.album.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"embed\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"video.pill(\'embed\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"videouploader.embed.title\"\n                ></a>\n        </li><!--\n    --></ul>\n\n\n    <!-- items -->\n    <div class=\"b-photouploader-items\">\n\n\n\n        <!-- upload from computer -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-upload\n                \"\n            ng-class=\"\'b-photouploader-item-upload-\' + upload.state()\"\n            ng-if=\"video.state.canUpload && video.state.isOpen && video.isPill(\'upload\')\"\n            >\n            <!-- insert upload directive -->\n            <div lj-video-uploader\n                 lj-video-uploader-callback=\"video.records.insertUploadedRecord(record)\"\n                 lj-video-uploader-cancel=\"video.bubble.close()\"\n                />\n\n        </div><!-- /uploads item -->\n\n\n\n        <!-- select from albums -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-albums\n                \"\n            ng-hide=\"!video.isPill(\'album\') || !video.albums.all.length\"\n            >\n\n            <!-- albums -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-albums\n                    \"\n                >\n\n                <h4\n                    class=\"b-photouploader-subhead\"\n                    lj-ml=\"videouploader.album.select\"\n                    ></h4>\n\n                <div class=\"\n                        b-photouploader-albums\n                        b-photouploader-albums-withnav\n                        \">\n                    <div\n                        class=\"b-photouploader-albums-inner\"\n                        lj-when-scrolled=\"albums.loadMore()\"\n                        >\n                        <!-- albums nav -->\n                        <div\n                            class=\"b-photouploader-nav\"\n                            >\n                            <label\n                                for=\"albums\"\n                                class=\"b-photouploader-nav-label\"\n                                lj-ml=\"photouploader.album.your\"\n                                ></label>\n                            <select\n                                id=\"albums\"\n                                class=\"b-photouploader-albums-select sharp-select\"\n                                ng-model=\"video.albums.current\"\n                                ng-options=\"item as item.name for item in video.albums.all\"\n                                >\n                            </select>\n                        </div>\n\n                        <!-- pictures -->\n                        <ul\n                            class=\"\n                                b-photouploader-pictures\n                                b-photouploader-pictures-withtitle\n                                b-photouploader-pictures-withmove\n                                \"\n                            lj-ref=\"videoUploader\"\n                            ng-model=\"video.records.current\"\n                            >\n                            <li\n                                class=\"b-photouploader-pictures-item\"\n                                ng-repeat=\"record in video.records.all\"\n                                ng-click=\"video.records.toggleRecord(record)\"\n                                ng-class=\"{ \'selected\': record.selected }\"\n                                >\n                                <span class=\"b-photouploader-pictures-pic\"><!--\n                                    --><img\n                                        class=\"b-photouploader-pictures-img\"\n                                        ng-src=\"{{ record.screenshot }}\"\n                                        ><!--\n                                --></span>\n                                <strong\n                                    class=\"b-photouploader-pictures-title\"\n                                    ng-bind=\"record.name\"\n                                    ng-show=\"record.name\"\n                                    ><!--\n                                --></strong>\n                            </li>\n                        </ul>\n\n                    </div>\n                </div><!-- /albums -->\n\n            </div>\n\n            <!-- controls -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-controls\n                    \"\n                >\n                <div\n                    class=\"\n                        b-ljbutton\n                        b-ljbutton-submit\n                        \"\n                    >\n                    <button\n                        type=\"submit\"\n                        name=\"submit\"\n                        lj-disabled=\"video.records.noneSelected()\"\n                        lj-ml=\"videouploader.album.insert\"\n                        ></button>\n                </div>\n                <button\n                    type=\"submit\"\n                    name=\"submit\"\n                    class=\"\n                        b-flatbutton\n                        b-flatbutton-simple\n                        \"\n                    lj-disabled=\"video.records.noneSelected()\"\n                    ng-click=\"video.insert()\"\n                    lj-ml=\"videouploader.album.insert\"\n                    ></button>\n            </div>\n\n        </div><!-- /albums item -->\n\n\n        <div\n            class=\"b-photouploader-item\n                b-photouploader-item-embed\"\n            ng-hide=\"!video.isPill(\'embed\') && video.state.canUpload\"\n            ng-controller=\"MediaCtrl\">\n            <div class=\"b-updateform-bubble-video-fields\">\n\n                <label for=\"updateform-video-url\"\n                       lj-ml=\"talk.video\"></label>\n                <br>\n\n                <textarea\n                    rows=\"5\"\n                    cols=\"60\"\n                    id=\"updateform-video-url\"\n                    class=\"\n                        b-updateform-bubble-input\n                        b-input\n                        b-input-max\n                        \"\n                    ng-model=\"media\"\n                    focus-and-select=\"show\"\n                    lj-enter=\"insert()\"\n                    lj-enter-with-meta\n                    ></textarea>\n\n                <span\n                    class=\"b-updateform-bubble-hint\"\n                    ng-click=\"setHint($event)\"\n                    lj-ml=\"talk.video.paste\"\n                    ></span>\n            </div>\n\n            <div class=\"b-updateform-bubble-video-button\">\n                <div\n                    class=\"\n                        b-ljbutton\n                        b-ljbutton-submit\n                        \"\n                    >\n                    <button\n                        type=\"button\"\n                        lj-disabled=\"!media\"\n                        ng-click=\"insert()\"\n                        lj-ml=\"talk.video.insert\">\n                    </button>\n                </div>\n                <button\n                    type=\"button\"\n                    class=\"\n                        b-flatbutton\n                        b-flatbutton-simple\n                        \"\n                    lj-disabled=\"!media\"\n                    ng-click=\"insert()\"\n                    lj-ml=\"talk.video.insert\">\n                </button>\n            </div>\n        </div>\n\n    </div><!-- /items -->\n\n\n\n</div>\n';
//= require_ml videouploader.embed.title
//= require_ml videouploader.upload.title
//= require_ml videouploader.byUrl.title
//= require_ml videouploader.album.title
//= require_ml videouploader.album.select
//= require_ml videouploader.album.insert
//= require_ml videouploader.noalbum
//= require_ml tour.video_update_tour.tip
//= require_ml talk.video
//= require_ml talk.video.paste
//= require_ml talk.video.insert
!function(e){return e}(),function(){"use strict";function e(e,t,r,n,o,l,i,s){function u(e){var t=r.defer();return t.resolve(e),t.promise}function a(){var e=LiveJournal.parseGetArgs().video_id,t=LiveJournal.parseGetArgs().record_id;e&&c.records.insertRecords(e.split(","),{user:LiveJournal.parseGetArgs().user}),t&&s.fetchRecordByStorageId(t).then(function(e){c.records.all=[e],c.records.toggleRecord(e),c.insert()})}function d(){angular.element(".cke_button_LJEmbedLink").attr({ljTour:"",dataTour:"video_update_tour",dataStep:"1",dataTourText:"tour.regionalrating.step1.tip"})}var c=this;this.state={canUpload:LJ.get("remote")&&!LJ.get("remote_is_identity"),isOpen:!1},this.bubble=e.bubble,this.isPill=function(e){return l.group("uploadVideo")===e},this.pill=function(e){e=e||LJ.Storage.getItem("videoUploadPill")||"upload",l.group("uploadVideo",e),LJ.Storage.setItem("videoUploadPill",e)},this.albums={init:function(){return s.fetchAlbums({user:LJ.get("remote.username")}).then(function(){s.getAlbums().length&&(c.albums.all=s.getAlbums(),c.albums.current=s.getAlbums()[0])})},mapped:function(e){return c.albums._mappedAlbums||(c.albums._mappedAlbums=s.getAlbums().reduce(function(e,t){return e[t.id]=t,e},{})),e?c.albums._mappedAlbums[e]:c.albums._mappedAlbums[c.albums.current.id]}},this.records={request:function(e){return e=e||{},c.state.canUpload?n.call("video.get_records",e).then(function(e){return e.records?(c.records.all=e.records.slice(),e.records):void 0}):r.reject()},insertRecords:function(e,t){return t=t||{},Array.isArray(e)||(e=[e]),t.ids=e,c.records.request(t).then(function(e){c.records.all=e.map(function(e){return e.selected=!0,e}),c.insert()})},insertUploadedRecord:function(e){c.records.toggleRecord(e),c.records.all=[e],c.insert()},toggleRecord:function(e){e.selected=!e.selected},noneSelected:function(){return 0===(c.records.all||[]).filter(LJ.Function.get("selected")).length}},e.$watch(function(){return c.albums.current},function(e,t){e&&e!==t&&s.fetchRecords(e.id,{user:LJ.get("remote.username")}).then(function(){c.records.all=s.getRecordsByAlbumId(e.id),i.scrollTo("videoUploader",{toParent:!0})})}),c.insert=function(){function r(){try{o.insertContent("video",l.map(LJ.Function.get("embed")).join("\n"),l.map(u),l),e.bubble.close()}catch(n){c.state.isOpen&&t(r)}}if(c.records.all){var n='<iframe data-link="{url}" data-thumbnail="{thumbnail}" frameBorder="0" height="315" src="{url}" width="560" allowfullscreen="allowfullscreen"></iframe>',l=c.records.all.filter(LJ.Function.get("selected")).map(function(e){return e.thumbnail=e.screenshot,e.embed=n.supplant(e),e.link=e.url,e});r()}},e.$on("bubble:open:video",function(){c.state.canUpload&&c.albums.init(),c.state.isOpen=!0}),e.$on("bubble:close:video",function(){c.state.canUpload&&c.albums.all&&c.records.all&&c.records.all.filter(LJ.Function.get("selected")).map(function(e){delete e.selected}),c.state.isOpen=!1}),LJ.Event.on("video:upload:done",function(){c.bubble.close()}),LJ.get("is_dev_server")?LJ.Event.on("rte_embed_ready",function(){a(),d()}):t(function(){a(),d()})}angular.module("Video.Editor",["LJ.AuthHelper","LJ.Messages","LJ.Pills","LJ.Api","Video.Uploader","Video.Service","Editor"]).controller("VideoEditorCtrl",["$scope","$timeout","$q","Api","Editor","Pills","Ref","Video",e])}();
/* <<< file end: js/video/editor.js */

//# map link was there [editor.js.map]
/* >>> file start: js/lib/jquery-ui/jquery.ui.mouse.min.js */
!function(e,t){var s=!1;e(document).mouseup(function(e){s=!1}),e.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e){return t._mouseDown(e)}).bind("click."+this.widgetName,function(s){return!0===e.data(s.target,t.widgetName+".preventClickEvent")?(e.removeData(s.target,t.widgetName+".preventClickEvent"),s.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!s){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var o=this,i=1==t.which,u="string"==typeof this.options.cancel&&t.target.nodeName?e(t.target).closest(this.options.cancel).length:!1;return i&&!u&&this._mouseCapture(t)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){o.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(t)!==!1,!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return o._mouseMove(e)},this._mouseUpDelegate=function(e){return o._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),s=!0,!0)):!0}},_mouseMove:function(t){return!e.browser.msie||document.documentMode>=9||t.button?this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,t)!==!1,this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted):this._mouseUp(t)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target==this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(e){return this.mouseDelayMet},_mouseStart:function(e){},_mouseDrag:function(e){},_mouseStop:function(e){},_mouseCapture:function(e){return!0}})}(jQuery);
/* <<< file end: js/lib/jquery-ui/jquery.ui.mouse.min.js */

//# map link was there [jquery.ui.mouse.min.js.map]
/* >>> file start: js/lib/jquery-ui/jquery.ui.sortable.min.js */
!function(t,e){t.widget("ui.sortable",t.ui.mouse,{widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===t.axis||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},destroy:function(){t.Widget.prototype.destroy.call(this),this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var e=this.items.length-1;e>=0;e--)this.items[e].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,i){"disabled"===e?(this.options[e]=i,this.widget()[i?"addClass":"removeClass"]("ui-sortable-disabled")):t.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,i){var s=this;if(this.reverting)return!1;if(this.options.disabled||"static"==this.options.type)return!1;this._refreshItems(e);var r=null,o=this;t(e.target).parents().each(function(){return t.data(this,s.widgetName+"-item")==o?(r=t(this),!1):void 0});if(t.data(e.target,s.widgetName+"-item")==o&&(r=t(e.target)),!r)return!1;if(this.options.handle&&!i){var n=!1;if(t(this.options.handle,r).find("*").andSelf().each(function(){this==e.target&&(n=!0)}),!n)return!1}return this.currentItem=r,this._removeCurrentsFromItems(),!0},_mouseStart:function(e,i,s){var r=this.options,o=this;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,r.cursorAt&&this._adjustOffsetFromHelper(r.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),r.containment&&this._setContainment(),r.cursor&&(t("body").css("cursor")&&(this._storedCursor=t("body").css("cursor")),t("body").css("cursor",r.cursor)),r.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",r.opacity)),r.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",r.zIndex)),this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!s)for(var n=this.containers.length-1;n>=0;n--)this.containers[n]._trigger("activate",e,o._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!r.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){if(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll){var i=this.options,s=!1;this.scrollParent[0]!=document&&"HTML"!=this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<i.scrollSensitivity?this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop+i.scrollSpeed:e.pageY-this.overflowOffset.top<i.scrollSensitivity&&(this.scrollParent[0].scrollTop=s=this.scrollParent[0].scrollTop-i.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<i.scrollSensitivity?this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft+i.scrollSpeed:e.pageX-this.overflowOffset.left<i.scrollSensitivity&&(this.scrollParent[0].scrollLeft=s=this.scrollParent[0].scrollLeft-i.scrollSpeed)):(e.pageY-t(document).scrollTop()<i.scrollSensitivity?s=t(document).scrollTop(t(document).scrollTop()-i.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<i.scrollSensitivity&&(s=t(document).scrollTop(t(document).scrollTop()+i.scrollSpeed)),e.pageX-t(document).scrollLeft()<i.scrollSensitivity?s=t(document).scrollLeft(t(document).scrollLeft()-i.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<i.scrollSensitivity&&(s=t(document).scrollLeft(t(document).scrollLeft()+i.scrollSpeed))),s!==!1&&t.ui.ddmanager&&!i.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)}this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"==this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"==this.options.axis||(this.helper[0].style.top=this.position.top+"px");for(var r=this.items.length-1;r>=0;r--){var o=this.items[r],n=o.item[0],h=this._intersectsWithPointer(o);if(h&&o.instance===this.currentContainer&&n!=this.currentItem[0]&&this.placeholder[1==h?"next":"prev"]()[0]!=n&&!t.ui.contains(this.placeholder[0],n)&&("semi-dynamic"==this.options.type?!t.ui.contains(this.element[0],n):!0)){if(this.direction=1==h?"down":"up","pointer"!=this.options.tolerance&&!this._intersectsWithSides(o))break;this._rearrange(e,o),this._trigger("change",e,this._uiHash());break}}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,i){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var s=this,r=s.placeholder.offset();s.reverting=!0,t(this.helper).animate({left:r.left-this.offset.parent.left-s.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:r.top-this.offset.parent.top-s.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){s._clear(e)})}else this._clear(e,i);return!1}},cancel:function(){var e=this;if(this.dragging){this._mouseUp({target:null}),"original"==this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("deactivate",null,e._uiHash(this)),this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",null,e._uiHash(this)),this.containers[i].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!=this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},t(i).each(function(){var i=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[-=_](.+)/);i&&s.push((e.key||i[1]+"[]")+"="+(e.key&&e.expression?i[1]:i[2]))}),!s.length&&e.key&&s.push(e.key+"="),s.join("&")},toArray:function(e){var i=this._getItemsAsjQuery(e&&e.connected),s=[];return e=e||{},i.each(function(){s.push(t(e.item||this).attr(e.attribute||"id")||"")}),s},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,r=s+this.helperProportions.height,o=t.left,n=o+t.width,h=t.top,a=h+t.height,l=this.offset.click.top,c=this.offset.click.left,p=s+l>h&&a>s+l&&e+c>o&&n>e+c;return"pointer"==this.options.tolerance||this.options.forcePointerForContainers||"pointer"!=this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?p:o<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<n&&h<s+this.helperProportions.height/2&&r-this.helperProportions.height/2<a},_intersectsWithPointer:function(e){var i="x"===this.options.axis||t.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,e.top,e.height),s="y"===this.options.axis||t.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,e.left,e.width),r=i&&s,o=this._getDragVerticalDirection(),n=this._getDragHorizontalDirection();return r?this.floating?n&&"right"==n||"down"==o?2:1:o&&("down"==o?2:1):!1},_intersectsWithSides:function(e){var i=t.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,e.top+e.height/2,e.height),s=t.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,e.left+e.width/2,e.width),r=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"==o&&s||"left"==o&&!s:r&&("down"==r&&i||"up"==r&&!i)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!=t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!=t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor==String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){var i=[],s=[],r=this._connectWith();if(r&&e)for(var o=r.length-1;o>=0;o--)for(var n=t(r[o]),h=n.length-1;h>=0;h--){var a=t.data(n[h],this.widgetName);a&&a!=this&&!a.options.disabled&&s.push([t.isFunction(a.options.items)?a.options.items.call(a.element):t(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a])}s.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var o=s.length-1;o>=0;o--)s[o][0].each(function(){i.push(this)});return t(i)},_removeCurrentsFromItems:function(){for(var t=this.currentItem.find(":data("+this.widgetName+"-item)"),e=0;e<this.items.length;e++)for(var i=0;i<t.length;i++)t[i]==this.items[e].item[0]&&this.items.splice(e,1)},_refreshItems:function(e){this.items=[],this.containers=[this];var i=this.items,s=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],r=this._connectWith();if(r&&this.ready)for(var o=r.length-1;o>=0;o--)for(var n=t(r[o]),h=n.length-1;h>=0;h--){var a=t.data(n[h],this.widgetName);a&&a!=this&&!a.options.disabled&&(s.push([t.isFunction(a.options.items)?a.options.items.call(a.element[0],e,{item:this.currentItem}):t(a.options.items,a.element),a]),this.containers.push(a))}for(var o=s.length-1;o>=0;o--)for(var l=s[o][1],c=s[o][0],h=0,p=c.length;p>h;h++){var f=t(c[h]);f.data(this.widgetName+"-item",l),i.push({item:f,instance:l,width:0,height:0,left:0,top:0})}},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var i=this.items.length-1;i>=0;i--){var s=this.items[i];if(s.instance==this.currentContainer||!this.currentContainer||s.item[0]==this.currentItem[0]){var r=this.options.toleranceElement?t(this.options.toleranceElement,s.item):s.item;e||(s.width=r.outerWidth(),s.height=r.outerHeight());var o=r.offset();s.left=o.left,s.top=o.top}}if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(var i=this.containers.length-1;i>=0;i--){var o=this.containers[i].element.offset();this.containers[i].containerCache.left=o.left,this.containers[i].containerCache.top=o.top,this.containers[i].containerCache.width=this.containers[i].element.outerWidth(),this.containers[i].containerCache.height=this.containers[i].element.outerHeight()}return this},_createPlaceholder:function(e){var i=e||this,s=i.options;if(!s.placeholder||s.placeholder.constructor==String){var r=s.placeholder;s.placeholder={element:function(){var e=t(document.createElement(i.currentItem[0].nodeName)).addClass(r||i.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return r||(e.style.visibility="hidden"),e},update:function(t,e){r&&!s.forcePlaceholderSize||(e.height()||e.height(i.currentItem.innerHeight()-parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10)))}}}i.placeholder=t(s.placeholder.element.call(i.element,i.currentItem)),i.currentItem.after(i.placeholder),s.placeholder.update(i,i.placeholder)},_contactContainers:function(e){for(var i=null,s=null,r=this.containers.length-1;r>=0;r--)if(!t.ui.contains(this.currentItem[0],this.containers[r].element[0]))if(this._intersectsWith(this.containers[r].containerCache)){if(i&&t.ui.contains(this.containers[r].element[0],i.element[0]))continue;i=this.containers[r],s=r}else this.containers[r].containerCache.over&&(this.containers[r]._trigger("out",e,this._uiHash(this)),this.containers[r].containerCache.over=0);if(i)if(1===this.containers.length)this.containers[s]._trigger("over",e,this._uiHash(this)),this.containers[s].containerCache.over=1;else if(this.currentContainer!=this.containers[s]){for(var o=1e4,n=null,h=this.positionAbs[this.containers[s].floating?"left":"top"],a=this.items.length-1;a>=0;a--)if(t.ui.contains(this.containers[s].element[0],this.items[a].item[0])){var l=this.containers[s].floating?this.items[a].item.offset().left:this.items[a].item.offset().top;Math.abs(l-h)<o&&(o=Math.abs(l-h),n=this.items[a],this.direction=l-h>0?"down":"up")}if(!n&&!this.options.dropOnEmpty)return;this.currentContainer=this.containers[s],n?this._rearrange(e,n,null,!0):this._rearrange(e,null,this.containers[s].element,!0),this._trigger("change",e,this._uiHash()),this.containers[s]._trigger("change",e,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[s]._trigger("over",e,this._uiHash(this)),this.containers[s].containerCache.over=1}},_createHelper:function(e){var i=this.options,s=t.isFunction(i.helper)?t(i.helper.apply(this.element[0],[e,this.currentItem])):"clone"==i.helper?this.currentItem.clone():this.currentItem;return s.parents("body").length||t("parent"!=i.appendTo?i.appendTo:this.currentItem[0].parentNode)[0].appendChild(s[0]),s[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(""==s[0].style.width||i.forceHelperSize)&&s.width(this.currentItem.width()),(""==s[0].style.height||i.forceHelperSize)&&s.height(this.currentItem.height()),s},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"==this.cssPosition&&this.scrollParent[0]!=document&&t.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&"html"==this.offsetParent[0].tagName.toLowerCase()&&t.browser.msie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"==this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e=this.options;if("parent"==e.containment&&(e.containment=this.helper[0].parentNode),"document"!=e.containment&&"window"!=e.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"==e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"==e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),!/^(document|window|parent)$/.test(e.containment)){var i=t(e.containment)[0],s=t(e.containment).offset(),r="hidden"!=t(i).css("overflow");this.containment=[s.left+(parseInt(t(i).css("borderLeftWidth"),10)||0)+(parseInt(t(i).css("paddingLeft"),10)||0)-this.margins.left,s.top+(parseInt(t(i).css("borderTopWidth"),10)||0)+(parseInt(t(i).css("paddingTop"),10)||0)-this.margins.top,s.left+(r?Math.max(i.scrollWidth,i.offsetWidth):i.offsetWidth)-(parseInt(t(i).css("borderLeftWidth"),10)||0)-(parseInt(t(i).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,s.top+(r?Math.max(i.scrollHeight,i.offsetHeight):i.offsetHeight)-(parseInt(t(i).css("borderTopWidth"),10)||0)-(parseInt(t(i).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(e,i){i||(i=this.position);var s="absolute"==e?1:-1,r=(this.options,"absolute"!=this.cssPosition||this.scrollParent[0]!=document&&t.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent),o=/(html|body)/i.test(r[0].tagName);return{top:i.top+this.offset.relative.top*s+this.offset.parent.top*s-(t.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollTop():o?0:r.scrollTop())*s),left:i.left+this.offset.relative.left*s+this.offset.parent.left*s-(t.browser.safari&&"fixed"==this.cssPosition?0:("fixed"==this.cssPosition?-this.scrollParent.scrollLeft():o?0:r.scrollLeft())*s)}},_generatePosition:function(e){var i=this.options,s="absolute"!=this.cssPosition||this.scrollParent[0]!=document&&t.ui.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,r=/(html|body)/i.test(s[0].tagName);"relative"==this.cssPosition&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var o=e.pageX,n=e.pageY;if(this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(n=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(n=this.containment[3]+this.offset.click.top)),i.grid)){var h=this.originalPageY+Math.round((n-this.originalPageY)/i.grid[1])*i.grid[1];n=this.containment&&(h-this.offset.click.top<this.containment[1]||h-this.offset.click.top>this.containment[3])?h-this.offset.click.top<this.containment[1]?h+i.grid[1]:h-i.grid[1]:h;var a=this.originalPageX+Math.round((o-this.originalPageX)/i.grid[0])*i.grid[0];o=this.containment&&(a-this.offset.click.left<this.containment[0]||a-this.offset.click.left>this.containment[2])?a-this.offset.click.left<this.containment[0]?a+i.grid[0]:a-i.grid[0]:a}return{top:n-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(t.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollTop():r?0:s.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(t.browser.safari&&"fixed"==this.cssPosition?0:"fixed"==this.cssPosition?-this.scrollParent.scrollLeft():r?0:s.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"==this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var r=this,o=this.counter;window.setTimeout(function(){o==r.counter&&r.refreshPositions(!s)},0)},_clear:function(e,i){this.reverting=!1;var s=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]==this.currentItem[0]){for(var r in this._storedCSS)"auto"!=this._storedCSS[r]&&"static"!=this._storedCSS[r]||(this._storedCSS[r]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();this.fromOutside&&!i&&s.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!i&&s.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(i||(s.push(function(t){this._trigger("remove",t,this._uiHash())}),s.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),s.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer))));for(var r=this.containers.length-1;r>=0;r--)i||s.push(function(t){return function(e){t._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[r])),this.containers[r].containerCache.over&&(s.push(function(t){return function(e){t._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[r])),this.containers[r].containerCache.over=0);if(this._storedCursor&&t("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"==this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!i){this._trigger("beforeStop",e,this._uiHash());for(var r=0;r<s.length;r++)s[r].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!1}if(i||this._trigger("beforeStop",e,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null,!i){for(var r=0;r<s.length;r++)s[r].call(this,e);this._trigger("stop",e,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var i=e||this;return{helper:i.helper,placeholder:i.placeholder||t([]),position:i.position,originalPosition:i.originalPosition,offset:i.positionAbs,item:i.currentItem,sender:e?e.element:null}}}),t.extend(t.ui.sortable,{version:"1.8.24"})}(jQuery);
/* <<< file end: js/lib/jquery-ui/jquery.ui.sortable.min.js */

//# map link was there [jquery.ui.sortable.min.js.map]
/* >>> file start: js/lib/angular/ui/sortable.js */
angular.module("ui.sortable",[]).value("uiSortableConfig",{}).directive("uiSortable",["uiSortableConfig","$timeout","$log",function(e,t,n){return{require:"?ngModel",link:function(o,i,l,a){function r(e,t){return t&&"function"==typeof t?function(n,o){e(n,o),t(n,o)}:e}var c,s={},u={receive:null,remove:null,start:null,stop:null,update:null};angular.extend(s,e),a?(o.$watch(l.ngModel+".length",function(){t(function(){i.sortable("refresh")})}),u.start=function(e,t){t.item.sortable={index:t.item.index(),cancel:function(){t.item.sortable._isCanceled=!0},isCanceled:function(){return t.item.sortable._isCanceled},_isCanceled:!1}},u.activate=function(){c=i.contents();var e=i.sortable("option","placeholder");if(e&&e.element&&"function"==typeof e.element){var t=e.element();t.jquery||(t=angular.element(t));var n=i.find('[class="'+t.attr("class")+'"]');c=c.not(n)}},u.update=function(e,t){t.item.sortable.received||(t.item.sortable.dropindex=t.item.index(),t.item.sortable.droptarget=t.item.parent(),i.sortable("cancel")),c.detach(),"clone"===i.sortable("option","helper")&&(c=c.not(c.last())),c.appendTo(i),t.item.sortable.received&&!t.item.sortable.isCanceled()&&o.$apply(function(){a.$modelValue.splice(t.item.sortable.dropindex,0,t.item.sortable.moved)})},u.stop=function(e,t){!t.item.sortable.received&&"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled()?o.$apply(function(){a.$modelValue.splice(t.item.sortable.dropindex,0,a.$modelValue.splice(t.item.sortable.index,1)[0])}):"dropindex"in t.item.sortable&&!t.item.sortable.isCanceled()||"clone"===i.sortable("option","helper")||c.detach().appendTo(i)},u.receive=function(e,t){t.item.sortable.received=!0},u.remove=function(e,t){t.item.sortable.isCanceled()||o.$apply(function(){t.item.sortable.moved=a.$modelValue.splice(t.item.sortable.index,1)[0]})},o.$watch(l.uiSortable,function(e){angular.forEach(e,function(e,t){u[t]&&("stop"===t&&(e=r(e,function(){o.$apply()})),e=r(u[t],e)),i.sortable("option",t,e)})},!0),angular.forEach(u,function(e,t){s[t]=r(e,s[t])})):n.info("ui.sortable: ngModel not provided!",i),i.sortable(s)}}}]);
/* <<< file end: js/lib/angular/ui/sortable.js */

//# map link was there [sortable.js.map]
/* >>> file start: js/editor/photouploader.js */
//= require js/lib/jquery-ui/jquery.ui.mouse.min.js
//= require js/lib/jquery-ui/jquery.ui.sortable.min.js
//= require js/lib/angular/ui/sortable.js
//= require js/core/string.js
//!= require js/core/angular/messages.js
//= require js/core/angular/pills.js
//= require js/core/angular/plupload.js
//= require js/core/angular/authHelper.js
//= require js/editor/basicToolbar.js
// error: photouploader.css is already included
// error: menu_v2.css is already included
Site.page.template['angular/photouploader.ng.tmpl'] = '<div\n    class=\"b-photouploader\"\n    ng-controller=\"PhotouploaderCtrl\"\n    >\n\n\n\n    <!-- menu -->\n    <ul\n        class=\"\n            b-menu\n            b-menu-hrz\n            b-menu-pills\n            b-menu-pseudo\n            b-photouploader-menu\n            \"\n        lj-pills-group=\"photouploader\"\n        ><!--\n        --><li\n            class=\"b-menu-item b-menu-item-active\"\n            data-pill=\"upload\"\n            ng-if=\"hasUploadAbilities\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"pills.select(\'upload\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.upload.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"album\"\n            ng-if=\"hasUploadAbilities && hasAlbums()\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"pills.select(\'album\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.album.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"paste\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"pills.select(\'paste\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.paste.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"dropbox\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"pills.select(\'dropbox\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.dropbox.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"instagram\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"pills.select(\'instagram\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.instagram.title\"\n                ></a>\n        </li><!--\n    --></ul>\n\n\n    <!-- items -->\n    <div class=\"b-photouploader-items\">\n\n\n\n        <!-- upload from computer -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-upload\n                \"\n            ng-hide=\"!pills.isActive(\'upload\')\"\n            ng-class=\"\'b-photouploader-item-upload-\' + upload.state()\"\n            ng-if=\"hasUploadAbilities && pills.isActive(\'upload\')\"\n            >\n\n            <!-- upload form -->\n            <div\n                id=\"upload-panel\"\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-upload\n                    \"\n                >\n                <div class=\"b-photouploader-uploader\"\n                     plupload=\"upload.url\"\n                     plupload-options=\"pluploadOptions\"\n                     plupload-callbacks=\"pluploadCallbacks\"\n                     ng-hide=\"!uploaderInit\"\n                     >\n                    <p\n                        class=\"b-photouploader-uploader-drop\"\n                        lj-ml=\"photouploader.upload.drop\"\n                        ></p>\n                    <p\n                        class=\"b-photouploader-uploader-nodrop\"\n                        lj-ml=\"photouploader.upload.nodrop\"\n                        ></p>\n                    <input\n                        type=\"file\"\n                        multiple=\"multiple\"\n                        id=\"pickfiles\"\n                        value=\"Choose an image to upload\"\n                        class=\"b-photouploader-uploader-input\"\n                        ng-hide=\"upload.inProgress\"\n                        >\n                    <ol class=\"b-photouploader-uploader-list\">\n                        <li\n                            class=\"b-photouploader-uploader-list-item\"\n                            ng-repeat=\"file in upload.files\"\n                            >\n                            {{ file.name }} &mdash; {{ file.percent }}% ({{ file.formattedSize }})\n\n                            <a\n                                href=\"\"\n                                ng-show=\"file.percent < 100\"\n                                ng-click=\"upload.cancel(file);\"\n                                lj-ml=\"photouploader.upload.cancel\"\n                                ></a>\n                        </li>\n                    </ol>\n                </div>\n                <div class=\"b-photouploader-initfail\" ng-if=\"!uploaderInit\">\n                    <span class=\"b-photouploader-initfail-flash\" lj-ml=\"photouploader.upload.initFail\"></span>\n                </div>\n            </div>\n\n            <!-- select pictures -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-pictures\n                    \"\n                >\n                <ul\n                    class=\"\n                        b-photouploader-pictures\n                        b-photouploader-pictures-withremove\n                        b-photouploader-pictures-withmove\n                        \"\n                    ui-sortable=\"ui.sortableOptions\"\n                    ng-model=\"albums.current.photos\"\n                    >\n                    <li\n                        class=\"b-photouploader-pictures-item\"\n                        ng-repeat=\"photo in upload.photos()\"\n                        >\n                        <span class=\"b-photouploader-pictures-pic\"><!--\n                            --><img\n                                class=\"b-photouploader-pictures-img\"\n                                ng-src=\"{{ photo.photo_src }}\"\n                                ><!--\n                        --></span>\n                        <span\n                            class=\"b-photouploader-pictures-remove\"\n                            title=\"Remove Picture\"\n                            ng-click=\"upload.removePhoto(photo);\"\n                            lj-ml=\"photouploader.upload.remove\"\n                            lj-ml-attr=\"title\"\n                            ></span>\n                    </li>\n                </ul>\n            </div>\n\n            <!-- controls -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-controls\n                    \"\n                >\n                <div class=\"b-photouploader-albumselector\">\n                    <div class=\"b-photouploader-albumselector-item\">\n                        <span\n                            class=\"b-photouploader-albumselector-albums\"\n                            ng-show=\"!newAlbum\"\n                            >\n                            <label\n                                for=\"album\"\n                                class=\"b-photouploader-albumselector-label\"\n                                lj-ml=\"photouploader.upload.addto\"\n                                ></label>\n                            <select\n                                id=\"album\"\n                                class=\"b-photouploader-albumselector-select\"\n                                ng-model=\"upload.album\"\n                                ng-options=\"item as item.album_title for item in albums.list\"\n                                >\n                            </select>\n                            <span lj-ml=\"photouploader.upload.or\"></span>\n                            <a\n                                href=\"javascript:void(0);\"\n                                ng-click=\"newAlbum = true;\"\n                                lj-ml=\"photouploader.upload.create\"\n                                ></a>\n                        </span>\n                        <span\n                            class=\"b-photouploader-albumselector-newalbum\"\n                            ng-show=\"newAlbum\"\n                            >\n                            <label\n                                for=\"album\"\n                                class=\"b-photouploader-albumselector-label\"\n                                lj-ml=\"photouploader.album.create\"\n                                ></label>\n                            <input\n                                type=\"text\"\n                                id=\"\"\n                                value=\"\"\n                                size=\"40\"\n                                class=\"b-photouploader-albumselector-input\"\n                                ng-model=\"upload.newAlbumName\"\n                                >\n                            <br>\n                            <a\n                                href=\"javascript:void(0);\"\n                                ng-click=\"newAlbum = false;\"\n                                lj-ml=\"photouploader.upload.back\"\n                                ></a>\n                        </span>\n                    </div>\n                    <div class=\"b-photouploader-albumselector-item\">\n                        <label\n                            for=\"privacy\"\n                            class=\"b-photouploader-albumselector-label\"\n                            lj-ml=\"photouploader.upload.privacy\"\n                            ></label>\n                        <select\n                            id=\"privacy\"\n                            class=\"b-photouploader-albumselector-select\"\n                            ng-model=\"upload.privacy.current\"\n                            ng-options=\"item as item.groupname for item in upload.privacy.list\"\n                            >\n                        </select>\n                    </div>\n\n                    <div class=\"b-photouploader-albumselector-item\">\n                        <label\n                            for=\"upload-size\"\n                            class=\"b-photouploader-albumselector-label\"\n                            lj-ml=\"photouploader.upload.size\"\n                            ></label>\n                        <select\n                            id=\"upload-size\"\n                            class=\"b-photouploader-albumselector-select\"\n                            ng-model=\"ui.size.current\"\n                            ng-options=\"item as item.text for item in ui.size.list\"\n                            >\n                        </select>\n                    </div>\n\n\n                    <div class=\"b-photouploader-albumselector-item\">\n                        <input\n                            type=\"checkbox\"\n                            id=\"linktoneworiginal\"\n                            class=\"b-photouploader-albumselector-check\"\n                            ng-model=\"albums.originalLink\"\n                            />\n                        <label\n                            for=\"linktoneworiginal\"\n                            class=\"b-photouploader-albumselector-label\"\n                            lj-ml=\"photouploader.upload.addlink\"\n                            ></label>\n                    </div>\n\n                </div>\n\n                <div\n                    class=\"\n                        b-ljbutton\n                        b-ljbutton-submit\n                        \"\n                    >\n                    <button\n                        type=\"submit\"\n                        name=\"submit\"\n                        ng-click=\"upload.insert()\"\n                        lj-disabled=\"ui.insertInProgress\"\n                        lj-ml=\"photouploader.upload.insert\"\n                        ></button>\n                </div>\n\n                <!--\n                <button\n                    type=\"submit\"\n                    name=\"submit\"\n                    class=\"\n                        b-flatbutton\n                        b-flatbutton-simple\n                        \"\n                    ng-click=\"upload.insert()\"\n                    lj-disabled=\"ui.insertInProgress\"\n                    lj-ml=\"photouploader.upload.insert\"\n                    ></button> -->\n\n                <lj-flatbutton lj-flatbutton=\"[\'submit\', \'photouploader.upload.insert\', \'b-flatbutton b-flatbutton-simple\', \'ng-click\', \'upload.insert()\', \'lj-disabled\', \'ui.insertInProgress\', \'name\', \'submit\']\"></lj-flatbutton>\n\n            </div>\n\n        </div><!-- /uploads item -->\n\n\n\n        <!-- select from albums -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-albums\n                \"\n            ng-show=\"pills.isActive(\'album\')\"\n            ng-if=\"hasUploadAbilities\"\n            >\n\n            <!-- albums -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-albums\n                    \"\n                >\n\n                <h4\n                    class=\"b-photouploader-subhead\"\n                    lj-ml=\"photouploader.album.select\"\n                    ></h4>\n\n                <div class=\"\n                        b-photouploader-albums\n                        b-photouploader-albums-withnav\n                        \">\n                    <div\n                        class=\"b-photouploader-albums-inner\"\n                        lj-when-scrolled=\"albums.loadMore()\"\n                        >\n                        <!-- albums nav -->\n                        <div\n                            class=\"b-photouploader-nav\"\n                            >\n                            <label\n                                for=\"albums\"\n                                class=\"b-photouploader-nav-label\"\n                                lj-ml=\"photouploader.album.your\"\n                                ></label>\n                            <select\n                                id=\"albums\"\n                                ng-model=\"albums.current\"\n                                ng-options=\"item as item.album_title for item in albums.list\"\n                                >\n                            </select>\n                        </div>\n\n                        <!-- pictures -->\n                        <ul\n                            class=\"\n                                b-photouploader-pictures\n                                b-photouploader-pictures-withtitle\n                                b-photouploader-pictures-withmove\n                                \"\n                            ng-model=\"albums.current.photos\"\n                            >\n                            <li\n                                class=\"b-photouploader-pictures-item\"\n                                ng-repeat=\"photo in albums.current.photos\"\n                                ng-click=\"albums.togglePhoto(photo)\"\n                                ng-class=\"{ \'selected\': photo.selected }\"\n                                >\n                                <span class=\"b-photouploader-pictures-pic\"><!--\n                                    --><img\n                                        class=\"b-photouploader-pictures-img\"\n                                        ng-src=\"{{ photo.photo_url || photo.photo_src }}\"\n                                        ><!--\n                                --></span>\n                                <strong\n                                    class=\"b-photouploader-pictures-title\"\n                                    ng-bind=\"photo.photo_title\"\n                                    ng-show=\"photo.photo_title\"\n                                    ><!--\n                                --></strong>\n                            </li>\n                        </ul>\n\n                    </div>\n                </div><!-- /albums -->\n\n            </div>\n\n            <!-- controls -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-controls\n                    \"\n                >\n                <div class=\"b-photouploader-albumsettings\">\n                    <label\n                        for=\"sizepictures\"\n                        class=\"b-photouploader-albumsettings-label\"\n                        lj-ml=\"photouploader.album.size\"\n                        ></label>\n                    <select\n                        id=\"sizepictures\"\n                        class=\"b-photouploader-albumsettings-select\"\n                        ng-model=\"ui.size.current\"\n                        ng-options=\"item as item.text for item in ui.size.list\"\n                        >\n                    </select>\n                    <input\n                        type=\"checkbox\"\n                        id=\"linktooriginal\"\n                        class=\"b-photouploader-albumsettings-check\"\n                        ng-model=\"albums.originalLink\"\n                        />\n                    <label\n                        for=\"linktooriginal\"\n                        class=\"b-photouploader-albumsettings-label\"\n                        lj-ml=\"photouploader.album.addlink\"\n                        ></label>\n                </div>\n                <div\n                    class=\"\n                        b-ljbutton\n                        b-ljbutton-submit\n                        \"\n                    >\n                    <button\n                        type=\"submit\"\n                        name=\"submit\"\n                        lj-disabled=\"albums.noneSelected() || ui.insertInProgress\"\n                        ng-click=\"albums.insert()\"\n                        lj-ml=\"photouploader.album.insert\"\n                        ></button>\n                </div>\n                <!--\n                <button\n                    type=\"submit\"\n                    name=\"submit\"\n                    class=\"\n                        b-flatbutton\n                        b-flatbutton-simple\n                        \"\n                    lj-disabled=\"albums.noneSelected() || ui.insertInProgress\"\n                    ng-click=\"albums.insert()\"\n                    lj-ml=\"photouploader.album.insert\"\n                    ></button>\n                -->\n                <lj-flatbutton lj-flatbutton=\"[\'submit\', \'photouploader.album.insert\', \'b-flatbutton b-flatbutton-simple\', \'name\', \'submit\', \'lj-disabled\', \'albums.noneSelected() || ui.insertInProgress\', \'ng-click\', \'albums.insert()\']\">\n                </lj-flatbutton>\n            </div>\n\n        </div><!-- /albums item -->\n\n\n\n        <!-- by url -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-url\n                \"\n            ng-show=\"pills.isActive(\'paste\')\"\n            >\n\n            <form ng-submit=\"paste.insertUrl()\">\n\n                <!-- url form -->\n                <div\n                    class=\"\n                        b-photouploader-panel\n                        b-photouploader-panel-url\n                        \"\n                    >\n\n                    <dl class=\"b-photouploader-byurl\">\n\n                        <dt class=\"b-photouploader-byurl-picture\">\n                            <img\n                                ng-src=\"{{ paste.url }}\"\n                                ng-show=\"paste.url\"\n                                class=\"b-photouploader-byurl-image\"\n                                >\n                            <span\n                                ng-show=\"!paste.url\"\n                                class=\"b-photouploader-byurl-sub\"\n                                lj-ml=\"photouploader.paste.correctUrl\"\n                                ></span>\n                        </dt>\n\n                        <dd class=\"b-photouploader-byurl-form\">\n                            <label\n                                for=\"url\"\n                                class=\"b-photouploader-byurl-label\"\n                                lj-ml=\"photouploader.paste.pasteURL\"\n                                ></label>\n                            <br class=\"b-photouploader-byurl-br\">\n                            <input\n                                type=\"text\"\n                                id=\"url\"\n                                size=\"55\"\n                                class=\"b-photouploader-byurl-src\"\n                                placeholder=\"https://\"\n                                ng-model=\"paste.url\"\n                                focus-and-select=\"pills.isActive(\'paste\')\"\n                                >\n                            <br class=\"b-photouploader-byurl-br\">\n                            <em\n                                class=\"b-photouploader-byurl-note\"\n                                lj-ml=\"photouploader.paste.notice\"\n                                ></em>\n                        </dd>\n\n                        <dd class=\"b-photouploader-byurl-form\">\n                            <label\n                                for=\"imagelink\"\n                                class=\"b-photouploader-byurl-label\"\n                                lj-ml=\"photouploader.paste.link\"\n                                ></label>\n                            <br class=\"b-photouploader-byurl-br\">\n                            <input\n                                type=\"text\"\n                                id=\"imagelink\"\n                                size=\"35\"\n                                class=\"b-photouploader-byurl-link\"\n                                placeholder=\"https://\"\n                                ng-model=\"paste.link\"\n                                >\n                        </dd>\n\n                    </dl>\n\n                </div><!-- /panel -->\n\n                <!-- controls -->\n                <div\n                    class=\"\n                        b-photouploader-panel\n                        b-photouploader-panel-controls\n                        \"\n                    >\n                    <div class=\"b-photouploader-urlsettings\">\n                        <label\n                            for=\"picturesize\"\n                            class=\"b-photouploader-urlsettings-label\"\n                            lj-ml=\"photouploader.paste.size\"\n                            ></label>\n                        <select\n                            id=\"picturesize\"\n                            class=\"b-photouploader-urlsettings-select\"\n                            ng-model=\"ui.size.current\"\n                            ng-options=\"item as item.text for item in ui.size.list\"\n                            >\n                        </select>\n                    </div>\n                    <div\n                        class=\"\n                            b-ljbutton\n                            b-ljbutton-submit\n                            \"\n                        >\n                        <button\n                            type=\"submit\"\n                            name=\"submit\"\n                            lj-disabled=\"!paste.url\"\n                            lj-ml=\"photouploader.paste.insert\"\n                            ></button>\n                    </div>\n\n                    <!--\n                    <button\n                        type=\"submit\"\n                        name=\"submit\"\n                        class=\"\n                            b-flatbutton\n                            b-flatbutton-simple\n                            \"\n                        lj-disabled=\"!paste.url\"\n                        lj-ml=\"photouploader.paste.insert\"\n                        ></button>\n                    -->\n                    <lj-flatbutton lj-flatbutton=\"[\'submit\', \'photouploader.paste.insert\', \'b-flatbutton b-flatbutton-simple\', \'lj-disabled\', \'!paste.url\', \'name\', \'submit\']\">\n                    </lj-flatbutton>\n\n\n                </div><!-- /panel -->\n\n            </form>\n\n        </div><!-- /url item -->\n\n\n\n        <!-- dropbox -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-dropbox\n                \"\n            ng-show=\"pills.isActive(\'dropbox\')\"\n            >\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-dropbox\n                    \"\n                >\n                <p\n                    class=\"b-photouploader-panel-dropbox-intro\"\n                    lj-ml=\"photouploader.dropbox.choose\"\n                    ></p>\n                <span lj-dropbox-button></span>\n            </div>\n        </div><!-- /dropbox item -->\n\n\n\n        <!-- instagram -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-instargam\n                \"\n            ng-show=\"pills.isActive(\'instagram\')\"\n            >\n\n            <!-- login to instagram -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-instalogin\n                    \"\n                ng-show=\"!instagram.token()\"\n                >\n                <p\n                    class=\"b-photouploader-panel-instalogin-intro\"\n                    lj-ml=\"photouploader.instagram.intro\"\n                    ></p>\n                <a\n                    href=\"javascript:void(0);\"\n                    class=\"b-photouploader-instagram-signup\"\n                    ng-click=\"instagram.login()\"\n                    lj-ml=\"photouploader.instagram.loginButton\"\n                    ></a>\n            </div>\n\n            <!-- select pictures from instagram -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-pictures\n                    \"\n                ng-show=\"instagram.token()\"\n                >\n\n                <div class=\"b-photouploader-instahead\">\n                    <h4 class=\"b-photouploader-subhead\">\n                        <span\n                            lj-ml=\"photouploader.instagram.select\"\n                            ></span>\n                        <span\n                            class=\"b-photouploader-subhead-annex\"\n                            lj-ml=\"photouploader.instagram.select.help\"\n                            ></span>\n                    </h4>\n\n                    <a\n                        class=\"b-photouploader-logout\"\n                        href=\"javascript:void(0);\"\n                        ng-click=\"instagram.logout()\"\n                        lj-ml=\"photouploader.instagram.logout\"\n                        ></a>\n                </div>\n\n                <div\n                    class=\"\n                        b-photouploader-albums\n                        \"\n                    ng-class=\"{ \'b-photouploader-albums-loading\': instagram.loading }\"\n                    >\n                    <div\n                        class=\"b-photouploader-albums-inner\"\n                        lj-when-scrolled=\"instagram.loadMore()\"\n                        >\n                        <ul\n                            class=\"\n                                b-photouploader-pictures\n                                b-photouploader-pictures-withtitle\n                                b-photouploader-pictures-withmove\n                                \"\n                            ng-model=\"instagram.media\"\n                            ui-sortable=\"ui.sortableOptions\"\n                            >\n                            <li\n                                class=\"b-photouploader-pictures-item\"\n                                ng-repeat=\"media in instagram.media\"\n                                ng-click=\"instagram.select(media);\"\n                                ng-class=\"{ \'selected\': media.selected }\"\n                                >\n                                <span class=\"b-photouploader-pictures-pic\"><!--\n                                    --><img\n                                        ng-src=\"{{ media.images.thumbnail.url }}\"\n                                        class=\"b-photouploader-pictures-img\"\n                                        ><!--\n                                --></span>\n                                <strong\n                                    class=\"b-photouploader-pictures-title\"\n                                    title=\"{{ media.caption.text }}\"\n                                    ng-show=\"media.caption\"\n                                    ><!--\n                                    -->{{ media.caption.text }}<!--\n                                --></strong>\n                            </li>\n                        </ul><!-- /pictures -->\n                    </div>\n                </div><!-- /albums -->\n\n            </div><!-- /panel -->\n\n            <!-- controls -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-controls\n                    \"\n                ng-show=\"instagram.token()\"\n                >\n                <div\n                    class=\"\n                        b-ljbutton\n                        b-ljbutton-submit\n                        \"\n                    >\n                    <button\n                        type=\"submit\"\n                        name=\"submit\"\n                        lj-disabled=\"instagram.noneSelected()\"\n                        ng-click=\"instagram.insert()\"\n                        lj-ml=\"photouploader.instagram.insert\"\n                        ></button>\n                </div>\n                <!--\n                <button\n                    type=\"submit\"\n                    name=\"submit\"\n                    class=\"\n                        b-flatbutton\n                        b-flatbutton-simple\n                        \"\n                    lj-disabled=\"instagram.noneSelected()\"\n                    ng-click=\"instagram.insert()\"\n                    lj-ml=\"photouploader.instagram.insert\"\n                    ></button> -->\n\n                <lj-flatbutton lj-flatbutton=\"[\'submit\', \'photouploader.instagram.insert\', \'b-flatbutton b-flatbutton-simple\', \'lj-disabled\', \'instagram.noneSelected()\', \'ng-click\', \'instagram.insert()\', \'name\', \'submit\']\">\n            </lj-flatbutton>\n            </div><!-- /panel -->\n\n        </div><!-- /instagram item -->\n\n\n\n    </div><!-- /items -->\n\n\n\n</div>\n';
//= require_ml photouploader.paste.correctUrl
//= require_ml photouploader.paste.pasteURL
//= require_ml photouploader.paste.notice
//= require_ml photouploader.paste.link
//= require_ml photouploader.paste.size
//= require_ml photouploader.paste.insert
//= require_ml photouploader.paste.insert
//= require_ml photouploader.paste.title
//= require_ml photouploader.dropbox.title
//= require_ml photouploader.dropbox.choose
//= require_ml photouploader.instagram.title
//= require_ml photouploader.instagram.intro
//= require_ml photouploader.instagram.loginButton
//= require_ml photouploader.instagram.select
//= require_ml photouploader.instagram.select.help
//= require_ml photouploader.instagram.logout
//= require_ml photouploader.instagram.asEmbeds
//= require_ml photouploader.instagram.asEmbeds.help
//= require_ml photouploader.instagram.needTitle
//= require_ml photouploader.instagram.needTitle.help
//= require_ml photouploader.instagram.nophoto
//= require_ml photouploader.instagram.insert
//= require_ml photouploader.instagram.insert
//= require_ml photouploader.album.your
//= require_ml photouploader.album.size
//= require_ml photouploader.album.addlink
!function(e){"use strict";angular.module("LJ.Photouploader",["ui.sortable","LJ.AuthHelper","LJ.Messages","LJ.Pills","angular-plupload"]).factory("Photouploader",["$timeout","$log",function(t,o){var n={};if(LJ.get("fotki")||o.warn("Missing `fotki` data on page from server"),n.albums=angular.copy(LJ.get("fotki.uploader.albumsData")||[]),n.sizesData=LJ.get("fotki.uploader.sizesData")||[],n.space=LJ.get("fotki.uploader.availableSpace"),n.albums.forEach(function(e){e.photos=[]}),n.album=n.albums[0],n.hasUploadAbilities=Boolean(LJ.get("remote.username")&&!LJ.get("remote.is_identity")),n.keys={dropbox:"7ye0n6mhwlsdh9u",instagram:"2f36cf1bb0b74b4dbc3bf155321370b4"},n.getUnsortedAlbum=function(){return n.albums[0]},n.fetchAlbum=function(o,a){var r=20;n.hasUploadAbilities&&o.album.album_id&&(o.album.allFetched||e.ajax({url:(LJ.get("photo_prefix")||"")+"/__rpc_fotki_imgs?func=get_photos",dataType:"json",data:{album_id:o.album.album_id,start:o.start||0,required_size:100,count:r}}).then(function(e){var n=e.filter(LJ.Function.get("photo_url"));n.length<r&&(o.album.allFetched=!0),t(function(){a(n)})}))},n.updatePhotos=function(o,n,a){var r={photos_data:o};n.required_size&&(r.required_size=n.required_size),n.privacy&&(r.privacy=n.privacy),n.action&&(r.action=n.action),n.type&&(r.type=n.type),n.album&&("string"==typeof n.album?r.album_title=n.album:r.album_id=n.album.album_id),e.ajax({type:"POST",url:(LJ.get("photo_prefix")||"")+"/__rpc_fotki_imgs?func=update_photos",data:{data_to_update:angular.toJson(r)},dataType:"json"}).then(function(e){var r=e.resizes_data;if(n.required_size&&r){var i=o.reduce(function(e,t){return e[t.photo_id]=t,e},{});for(var u in r)i[u]["size_"+n.required_size]=r[u].image_url}t(function(){a(o)})})},n.removePhoto=function(e){var t=n.getUnsortedAlbum().photos,o=t.indexOf(e);-1!==o&&t.splice(o,1),e.is_deleted=1,n.updatePhotos([e],{},function(){})},n.getAlbumById=function(e){return n.albums.find(function(t){return t.album_id===e})},n.addAlbum=function(e,t){if(!e.album_id)throw new Error("album_id should be provided.");if(!e.album_title)throw new Error("album_title should be provided.");return r=angular.extend({photos:[]},e),t&&t.prepend?n.albums.unshift(r):n.albums.push(r),r},n.addPhotos=function(e,t,o){var a=n.getAlbumById(e);if(!a)throw new Error("Album with id %s not found",e);return o&&o.prepend?Array.prototype.unshift.apply(a.photos,t):Array.prototype.push.apply(a.photos,t),a},function(){var e,t=LJ.Storage.getItem("photouploader_album_id");t&&(e=n.getAlbumById(t),e&&(n.album=e))}(),LJ.get("fotki.insert")){var a=Number(LiveJournal.parseGetArgs().albums_id);if(a)n.album=n.getAlbumById(a),n.album.allFetched=!0,n.addPhotos(a,LJ.get("fotki.insert"));else{var r=n.addAlbum({album_id:"selected",album_title:LJ.ml("photouploader.album.scrapbookSelected"),photos:LJ.get("fotki.insert")});n.album=r}n.album.photos.forEach(LJ.Function.set("selected",!0))}return n}]).controller("PhotouploaderCtrl",["$scope","$q","$timeout","Pills","Editor","Photouploader","Messages","AuthHelper",function(t,o,n,a,r,i,u,l){var s=[];if(t.pluploadOptions={drop_element:"upload-panel",browse_button:"pickfiles",multi_selection:!0,filters:{max_file_size:"10mb",mime_types:[{title:"Image files",extensions:"jpg,jpeg,gif,png"}]},multipart:!0,multipart_params:{form_auth:LJ.get("fotki.uploader.guid")},file_data_name:"file"},!LJ.Flags.isEnabled("photo_v4")){t.hasUploadAbilities=i.hasUploadAbilities,t.hasAlbums=function(){return 0!==i.albums.length},t.$on("bubble:open:photouploader",function(){t.albums.current=i.album,LJ.get("fotki.insert")?a.group("photouploader","album"):(a.group("photouploader",t.hasUploadAbilities?LJ.Storage.getItem("photouploader2_state")||"upload":"paste"),"album"!==a.group("photouploader")||t.hasAlbums()||a.group("photouploader","upload"))}),t.$on("bubble:close:photouploader",function(){a.group("photouploader",null)}),t.ui={size:{list:i.sizesData,current:i.sizesData.find(LJ.Function.get("is_default"))||i.sizesData[0]},insertInProgress:!1,sortableOptions:{helper:"clone"}};var p=LJ.get("fotki.uploader.privacyData")||[];t.upload={files:[],url:(LJ.get("photo_prefix")||"")+"/up",privacy:{current:p[0],list:p},space:i.space,album:i.getUnsortedAlbum(),inProgress:!1,insert:function(){if(!t.ui.insertInProgress){t.ui.insertInProgress=!0;var e=t.ui.size.current.size,o=t.upload.photos();i.updatePhotos(o,{privacy:t.upload.privacy.current.security,required_size:e,album:t.upload.newAlbumName||t.upload.album,action:"add_new_post",type:"upload"},function(){LJ.Event.trigger("uploadInsert",e,o)})}},cancel:function(e){var o=t.upload.files.indexOf(e);-1!==o&&t.upload.files.splice(o,1)},photos:function(){return t.hasAlbums()?i.getUnsortedAlbum().photos.filter(LJ.Function.get("uploaded")):[]},removePhoto:function(e){i.removePhoto(e)},state:function(){return t.upload.photos().length>0?"uploaded":"start"}},t.pills={isActive:function(e){return a.group("photouploader")===e},select:function(e){a.group("photouploader",e),LJ.Storage.setItem("photouploader2_state",e)}},t.paste={url:"",link:"",insertUrl:function(){var e,o=Number(t.ui.size.current.size)||"",n='<img src="'+t.paste.url+'" width="'+o+'" />';e=t.paste.link?'<a href="'+LJ.String.linkify(t.paste.link)+'">'+n+"</a>":n,r.insertContent("photouploader",e,[e]),t.paste.url="",t.paste.link="",t.bubble.close(),LJ.Track.event("Photouploader","Paste","Insert")}},t.albums={current:{photos:[]},list:i.albums,originalLink:!1,noneSelected:function(){return t.hasAlbums()?0===t.albums.current.photos.filter(LJ.Function.get("selected")).length:!0},togglePhoto:function(e){e.selected=!e.selected},insert:function(){if(!t.ui.insertInProgress){t.ui.insertInProgress=!0;var e=t.ui.size.current.size,o=t.albums.current.photos.filter(LJ.Function.get("selected"));"custom"!==e?i.updatePhotos(o,{required_size:e},function(){LJ.Event.trigger("albumInsert",e,o)}):LJ.Event.trigger("albumInsert",e,o)}},loadMore:function(){i.fetchAlbum({album:t.albums.current,start:t.albums.current.photos.length},function(e){i.addPhotos(t.albums.current.album_id,e)})}},t.$watch("albums.current",function(e){e&&e.album_id&&(i.album=e,i.fetchAlbum({album:e},function(t){i.addPhotos(e.album_id,t)}),LJ.Storage.setItem("photouploader_album_id",e.album_id))}),t.instagram={media:[],asEmbed:!0,_token:null,token:function(e){var o=LJ.get("remote.username"),n="instagram_token",a={domain:LJ.get("siteroot").replace(/^https?:\/\/www/,"")};return o&&(n="instagram_token_"+o),"undefined"==typeof e?t.instagram._token||LJ.Cookie.get(n):(t.instagram._token=e,void LJ.Cookie.set(n,e,a))},noneSelected:function(){return 0===this.media.filter(LJ.Function.get("selected")).length},select:function(e){e.selected=!e.selected},insert:function(){var e,n,a=t.instagram.media.filter(LJ.Function.get("selected"));t.instagram.asEmbed?(n=a.map(function(e){return LJ.Media.parse(e.link).then(LJ.Function.get("embed"))}),o.all(n).then(function(e){r.insertContent("video",e.join("\n"),e)})):(e=a.map(function(e){return'<img src="{url}" title="{caption}">'.supplant({url:e.images.standard_resolution.url,caption:LJ.String.encodeHTML(e.caption&&e.caption.text||"")})}),r.insertContent("photouploader",e.join("\n"),e),LJ.Track.event("Photouploader","Instagram","Insert")),t.instagram.media.forEach(LJ.Function.set("selected",!1)),t.bubble.close()},login:function(){l.open(["https://instagram.com/oauth/authorize/?client_id=",i.keys.instagram,"&amp;redirect_uri=","https://www.livejournal.com","/auth_helper.html&amp;response_type=token"].join("")).then(function(e){e&&LJ.Event.trigger("instagram_token",e)})},logout:function(){(new Image).src="https://instagram.com/accounts/logout/",t.instagram.token(null),t.instagram.allFetched=!1,t.instagram.media.length=0},loadMore:function(){var o=t.instagram;if(o.token()&&!o.loading&&!o.allFetched){o.loading=!0;var a=["https://api.instagram.com","/v1/users/self/media/recent/?callback=?&access_token=",o.token()];if(o.media.length>0){var r=o.media[o.media.length-1].id;a.push("&max_id="+r)}e.getJSON(a.join("")).then(function(e){n(function(){e.data&&0===e.data.length&&(o.allFetched=!0),Array.prototype.push.apply(o.media,e.data),o.loading=!1})})}}},t.$watch(function(){return t.instagram.token()},t.instagram.loadMore),LJ.Event.on("instagram_token",function(e){n(function(){t.instagram.token(e)})}),t.dropbox={init:function(){window.Dropbox||LJ.injectScript("https://www.dropbox.com/static/api/2/dropins.js").done(function(){window.Dropbox&&(window.Dropbox.appKey=i.keys.dropbox),LJ.Event.trigger("dropbox_loaded",{linkType:"preview",multiselect:!0,extensions:["images"],success:function(e){n(function(){var o=e.map(function(e){return'<img src="{url}" alt="" title="">'.supplant({url:e.link.replace("www.dropbox.com","dl.dropboxusercontent.com")})});r.insertContent("photouploader",o.join("\n"),o),t.bubble.close(),LJ.Track.event("Photouploader","Dropbox","Success")})}})})}},t.dropbox.init(),t.uploaderInit=!0,t.pluploadCallbacks={filesAdded:function(e,o){t.upload.inProgress=!0,n(function(){t.upload.files.length=0,Array.prototype.push.apply(t.upload.files,angular.copy(o)),e.start()})},fileUploaded:function(e,o,n){return n=JSON.parse(n.response),"error"===n.status?(t.upload.files.shift(),void t.pluploadCallbacks.uploadError(e,n)):(n.photo_name=-1!==o.name.lastIndexOf(".")?o.name.substr(0,o.name.lastIndexOf(".")):o.name,void s.push(n))},uploadComplete:function(){s.length&&n(function(){var e,o=s[0].album_id;t.upload.inProgress=!1,s.forEach(LJ.Function.set("uploaded",!0)),i.getAlbumById(o)||(e=i.addAlbum({album_id:o,album_title:LJ.ml("fotki.album.default_album_name"),allFetched:!0},{prepend:!0}),t.albums.current=t.upload.album=e),i.addPhotos(o,s,{prepend:!0}),t.upload.files.length=0,s.length=0})},uploadProgress:function(e,o){n(function(){var e=t.upload.files.find(function(e){return e.id===o.id});e&&isFinite(o.percent)&&(e.percent=o.percent)})},uploadError:function(e,o){t.upload.inProgress=!1,o.code===plupload.INIT_ERROR?t.uploaderInit=!1:n(function(){u.error({body:o.message})})}},LJ.Event.on("uploadInsert",function(e,o){n(function(){var n=o.map(function(o){var n='<img src="{url}" alt="{name}" title="{name}">'.supplant({url:o["size_"+e],name:o.photo_name||""});return t.albums.originalLink?'<a target="_blank" href="'+o.photo_orig+'">'+n+"</a>":n});r.insertContent("photouploader",n.join("\n"),n),t.ui.insertInProgress=!1,o.forEach(LJ.Function.set("uploaded",!1)),t.bubble.close()})}),LJ.Event.on("albumInsert",function(e,o){var n=o.map(function(o){var n='<img src="{url}" alt="{name}" title="{name}">'.supplant({url:o["size_"+e],name:o.photo_title||""});return t.albums.originalLink?'<a target="_blank" href="'+o.photo_orig+'">'+n+"</a>":n});r.insertContent("photouploader",n.join("\n"),n),t.ui.insertInProgress=!1,t.albums.current.photos.forEach(LJ.Function.set("selected",!1)),t.bubble.close(),LJ.Track.event("Photouploader","Albums","Insert")})}}]).directive("ljWhenScrolled",function(){return function(e,t,o){var n=t[0];t.bind("scroll",function(){n.scrollTop+n.offsetHeight>=n.scrollHeight&&e.$apply(o.ljWhenScrolled)})}})}(jQuery);
/* <<< file end: js/editor/photouploader.js */

//# map link was there [photouploader.js.map]
/* >>> file start: js/core/array.js */
!function(n){return n}(),function(){"use strict";LJ.define("LJ.Array"),LJ.Array.intersection=function(n,r){var t;return r.length>n.length&&(t=r,r=n,n=t),n.filter(function(n){return-1!==r.indexOf(n)})}}();
/* <<< file end: js/core/array.js */

//# map link was there [array.js.map]
/* >>> file start: js/angularHttps.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r};
//= require js/core/angular/api.js
!function(){function r(r,e){function t(e){return new Promise(function(t,u){var i=n[e];return i?t(i.proxied):void r.call("imageproxy.get_proxy_url",{url:e}).then(function(r){i={proxied:r.url},n[e]=i,t(i.proxied)})["catch"](u)})}var n={},u={getSecureUrlVariation:function(r,e){if(!/^http/.test(r))return null;if(/^https:\/\//.test(r))return r;if(angular.isArray(e)&&e.length){var t=function(){var t=void 0,n=r.split("/");return e.some(function(e){return n[2]&&(n[2]===e||n[2].indexOf(e)>-1)?(t=r.replace(/^http/,"https"),!0):!1}),t?{v:t}:void 0}();if("object"===("undefined"==typeof t?"undefined":_typeof(t)))return t.v}return null},isSecureSrc:function(r){return angular.isString(u.getSecureUrlVariation(r))},getSecureImageUrl:function(r,e){if(!/^http/.test(r))return Promise.reject({url:r,reason:new Error('Url does not start with "http"')});var n=u.getSecureUrlVariation(r,e);return n?Promise.resolve({secureUrl:n}):t(r).then(function(r){return{secureUrl:r}})},getMetaFromHtmlString:function(r){var e=(new DOMParser).parseFromString(r,"text/html"),t=Array.prototype.slice.call(e.getElementsByTagName("img"));return t.map(function(r){return r.getAttribute("src")}).filter(function(r,e,t){return t.indexOf(r)===e}).map(function(r){return{src:r}})},isSecureHtmlString:function(r){var e=u.getMetaFromHtmlString(r);return e.every(function(r){return u.isSecureSrc(r.src)})},secureImgSrcInString:function(r,e,t){if(!t||!e)return r;var n=function(r){return new RegExp("src=['\"]"+r+"['\"]","g")},u="src='"+t+"' originalsrc='"+e+"'",i=e.replace(/\?/gi,"\\?"),c=i.encodeHTML(),o=n(i),a=n(c);return o.test(r)?r.replace(o,u):a.test(r)?r.replace(a,u):r},secureHtmlString:function(r,t){var n=u.getMetaFromHtmlString(r),i=n.map(function(r){return e(function(e){var n=r.src;u.getSecureImageUrl(n,t).then(function(t){var n=t.secureUrl;r.secureUrl=n,e()})["catch"](function(){e()})})});return e.all(i).then(function(){return n.reduce(function(r,e){return u.secureImgSrcInString(r,e.src,e.secureUrl)},r)})},desecureHtmlString:function(r){var e=r,t=e.match(new RegExp("<s*img[^>]+>","g"));return t&&t.length?(t.forEach(function(r){var t=r.match(new RegExp("originalsrc=['\"]([^'\"]+)['\"]"));if(t&&t.length){var n=t[1],u=r.replace(new RegExp("originalsrc=['\"][^'\"]+['\"] "),"").replace(new RegExp("src=['\"][^'\"]+['\"]"),"src='"+n+"'");e=e.replace(r,u)}}),e):e}};return u}r.$inject=["Api","$q"],angular.module("LJ.Https",["LJ.Api"]),angular.module("LJ.Https").factory("ljHttpsService",r)}();
/* <<< file end: js/angularHttps.js */

//# map link was there [angularHttps.js.map]
/* >>> file start: js/photo/photo.js */
var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};
//= require_ml flatmedia.adult.content.default
//= require_ml flatmedia.adult.content.none
//= require_ml flatmedia.adult.content.explicit
//= require_ml flatmedia.select.album.none
!function(e){return e}(),function(){"use strict";angular.module("Photo.Service",[]).factory("Photo",["$q","Api","$document",function(e,t,n){function r(e){return t.call("photo.create_record",e).then(function(e){return x(e.record),e.record})}function o(e){return t.call("photo.get_albums",_extends({user:O},e),{cache:!0}).then(function(e){e.albums.forEach(f)})}function u(n){var r=B.indexOf(n);return-1!==r?e.when(null):(B.push(n),t.call("photo.get_album",{id:n,user:O},{cache:!0}).then(function(e){B.splice(r,1),f(e.album)}))}function i(r,o,u){return"undefined"==typeof u&&(u=!0),o.offset<0?e.when(null):(n[0].querySelector('[ng-app="Photo"]')&&(o.migrated_info=1),t.call("photo.get_records",_extends({albumid:r,user:O},o),{cache:u}).then(function(e){var t=e.records;return x(t),t}))}function a(e){return t.call("photo.get_record",_extends({user:O},e),{cache:!0}).then(function(e){return e.record})}function c(e){return t.call("photo.update_album",e).then(function(n){return f(n.album),t.invalidate("photo.get_albums",{user:O}),t.invalidate("photo.get_album",{id:e.id,user:O}),n.album})}function l(e){var n=angular.extend({},{security:"public",user:O},e);return t.call("photo.create_album",n).then(function(e){var n=e.album;return f(n),t.invalidate("photo.get_albums",{user:O}),n})}function d(e){return t.call("photo.delete_album",{id:e}).then(function(n){return s(e),t.invalidate("photo.get_albums",{user:O}),t.invalidate("photo.get_album",{user:O,id:e}),n})}function f(e){J[e.id]=e}function s(e){delete J[e],g(e).forEach(function(e){h(e.id)})}function h(e){var n=b(e);t.invalidate("photo.get_albums",{user:O}),t.invalidate("photo.get_album",{user:O,id:n.albumid}),t.invalidate("photo.get_records",{albumid:n.albumid,user:O,offset:Math.floor(n.index/20),limit:20}),delete z[e]}function m(){var e=[];return angular.forEach(J,function(t){e.push(t)}),e.sort(function(e,t){return t.id-e.id}),e}function p(e){return J[e]}function b(e){return z[e]}function g(e,t){var n,r,o=[];return angular.forEach(z,function(t){t.albumid===e&&o.push(t)}),o=o.sort(function(e,t){return t.id-e.id}),t&&(n=t.offset,r=t.offset+t.limit,o=o.filter(function(e){return e.index>=n&&e.index<r})),o}function v(t,n){var r,o,u=e.defer();return 0>n?(u.resolve(),u.promise):(o=Object.keys(z).filter(function(e){return z[e].albumid===t}),r=o.find(function(e){var t=z[e];return t.index===n}),r?(u.resolve(z[r]),u.promise):i(t,{offset:n,limit:1}).then(function(e){return e[0]}))}function _(e){return t.call("photo.update_records",e).then(function(e){var t=e.records;return t.forEach(y),t})}function A(e){return t.call("photo.update_record",e).then(function(e){var t=e.record;return y(t),t})}function y(e){var n=b(e.id);t.invalidate("photo.get_records",{albumid:e.albumid,user:O,offset:Math.floor(e.index/20),limit:20}),t.invalidate("photo.get_album",{user:O,id:e.albumid}),t.invalidate("photo.get_albums",{user:O}),n&&(t.invalidate("photo.get_records",{albumid:n.albumid,user:O,offset:Math.floor(n.index/20),limit:20}),t.invalidate("photo.get_album",{user:O,id:n.albumid})),u(e.albumid),x(e)}function R(e,n){return t.call("photo.delete_records",{ids:e}).then(function(){n&&n.notCached||e.forEach(function(e){h(e)})})}function x(e){Array.isArray(e)||(e=[e]),e.forEach(function(e){z[e.id]=e})}var L={NON_SELECTED_ALBUM:{id:-1,name:LJ.ml("flatmedia.select.album.none")},RECORD_ADULT:!1,RECORD_PRIVACY:"public",ALBUM_PRIVACY:"public",ALBUM_NAME:""},E={createRecord:r,fetchAlbums:o,getAlbums:m,fetchAlbum:u,getAlbumById:p,fetchRecords:i,fetchRecordById:a,getRecordById:b,getRecordByIndex:v,getRecordsByAlbumId:g,createAlbum:l,updateAlbum:c,removeAlbum:d,updateRecord:A,updateRecords:_,removeRecords:R,defaults:L},O=LJ.get("journal.username")||LJ.get("remote.username"),J={},z={},B=[];return E}]).factory("PhotoSize",function(){function e(){var e=LJ.Cookie.get("photo_size"),t=e?LJ.Function.get("size",e.toString()):LJ.Function.get("is_default");return n&&(t&&n.filter(t)[0]||n[0])}function t(e){for(var t=n.map(LJ.Function.get("size")),r=0,o=e.length;o>r;r++)t=LJ.Array.intersection(e[r],t);return n.filter(function(e){return-1!==t.indexOf(e.size)})}var n=LJ.get("fotki.uploader.sizesData")||[{is_default:1,text:"Оригинал",size:"original"}];return{list:n,current:e(),insertInProgress:!1,sortableOptions:{helper:"clone"},intersect:t,getDefaultSize:e}}).filter("decodeRecord",[function(){return function(e){function t(e){return"&lt;"===e?"<":">"}return e.name=(e.name||"").replace(/(&(gt|lt);)/g,t),e.description=(e.description||"").replace(/(&(gt|lt);)/g,t),e}}])}();
/* <<< file end: js/photo/photo.js */

//# map link was there [photo.js.map]
/* >>> file start: js/photo/selectAlbum.js */
//= require js/photo/photo.js
Site.page.template['angular/photo/selectPhotoAlbum.ng.tmpl'] = '<div class=\"b-ljform-field\"\n  ng-class=\"{\n    \'flatpopup-create-state\': directive.state.create\n  }\"\n  >\n\n  <div class=\"flatmedia-edit-field\">\n    <label class=\"flatpopup-label\" lj-ml=\"flatmedia.select.album\"></label>\n    <select\n      class=\"sharp-select\"\n      ng-model=\"directive.selectedAlbumId\"\n      ng-options=\"album.id as album.name for album in directive.albums\"\n      ></select>\n    <span lj-ml=\"flatmedia.or\"></span>\n    <a\n      class=\"flatmedia-action-link\"\n      href=\"javascript:void(0);\"\n      ng-click=\"directive.toggle(true)\"\n      lj-ml=\"flatmedia.album.create.new\"\n      ></a>\n  </div>\n\n  <div class=\"flatmedia-create-field\">\n    <label class=\"flatpopup-label\" lj-ml=\"flatmedia.album.name\"></label>\n    <a\n      class=\"flatpopup-action-link flatpopup-aside-link\"\n      href=\"javascript:void(0);\"\n      ng-click=\"directive.toggle(false)\"\n      lj-ml=\"flatmedia.button.back\"\n      ng-if=\"directive.albums.length\"\n      ></a>\n    <input\n      type=\"text\"\n      class=\"b-input b-input-max\"\n      maxlength=\"150\"\n      ng-model=\"directive.newAlbum.name\"\n      />\n  </div>\n</div>\n';
//= require_ml flatmedia.album.create.new
//= require_ml flatmedia.album.name
//= require_ml flatmedia.button.back
//= require_ml flatmedia.or
//= require_ml flatmedia.select.album
!function(e){return e}(),function(){"use strict";angular.module("Photo.SelectAlbum",["LJ.Templates","Photo.Service"]).directive("selectPhotoAlbum",["Photo",function(e){return{templateUrl:"selectPhotoAlbum.ng.tmpl",controllerAs:"directive",scope:{album:"=selectPhotoAlbum",allowNonSelected:"=?allowNonSelected",scope:"=selectPhotoAlbumScope"},controller:["$scope","$attrs","Photo",function(e,t,l){function n(){var l=t.allowNonSelected;return"string"==typeof l&&0===l.length?!0:e.allowNonSelected}function o(e){var t=[];return n()&&t.push(l.defaults.NON_SELECTED_ALBUM),t.concat(e?e:l.getAlbums())}var u=this,c=this.state={init:!1,create:!1};this.newAlbum={name:""},this.init=function(){c.init=!0,u.albums=angular.copy(l.getAlbums()),e.album.id?this.selectedAlbumId=e.album.id:0!==u.albums.length&&(this.selectedAlbumId=u.albums[0].id),e.$watch(function(){return u.selectedAlbumId+u.newAlbum.name+c.create},function(){e.album=c.create?u.newAlbum:l.getAlbumById(u.selectedAlbumId)}),e.$watchCollection(l.getAlbums,function(e){u.albums=o(e),0===e.length&&(c.create=!0)}),"undefined"!=typeof t.allowNonSelected&&e.$watch("allowNonSelected",function(){u.albums=o()})},this.toggle=function(e){c.create=e,this.newAlbum.name=""}}],link:function(t,l,n,o){var u={};if("undefined"==typeof t.album)throw new TypeError("You should provide album object");"photo"!==t.scope&&(u={user:LJ.get("remote.username")}),e.fetchAlbums(u).then(function(){o.init()})}}}])}();
/* <<< file end: js/photo/selectAlbum.js */

//# map link was there [selectAlbum.js.map]
/* >>> file start: js/photo/uploader.js */
//= require js/core/angular/api.js
//= require js/core/angular/plupload.js
//!= require js/core/angular/messages.js
//= require js/photo/photo.js
//= require js/editor/editor.js
//= require js/photo/selectAlbum.js
Site.page.template['angular/photo/uploaderPhoto.ng.tmpl'] = '<div\n    class=\"flatpopup__body-inner\"\n    ng-if=\"directive.state.init\"\n    ng-class=\'{\n       \"flatpopup-uploading\": directive.state.uploadInProgress,\n       \"flatpopup-uploading-complete\": directive.state.uploadDone\n    }\'>\n    <div\n        class=\"b-ljform-field upload__box\"\n        id=\"upload-panel-photo\"\n        plupload=\"directive.uploadUrl\"\n        plupload-options=\"directive.uploadOptions\"\n        plupload-callbacks=\"directive.uploadCallbacks\"\n        plupload-disable-on-upload=\"directive.scope === \'photo\'\"\n        >\n        <label\n            class=\"upload__box-label\"\n            for=\"pickfiles-photo\"\n            lj-ml=\"{\n                  \'photouploader.upload.dragOrClick\':   directive.modulo() === -1,\n                  \'photouploader.upload.filesAdded1\':   directive.modulo() === 1,\n                  \'photouploader.upload.filesAdded2-4\': directive.modulo() >=  2 && directive.modulo() <= 4,\n                  \'photouploader.upload.filesAdded5\':   directive.modulo() === 0 || directive.modulo() >= 5\n                }\"\n            lj-ml-resolve=\"{ number: directive.files.length }\"\n            lj-ml-dynamic=\"directive.uploaded.length || directive.files.length\"\n            ></label>\n        <input\n            type=\"file\"\n            class=\"upload__input\"\n            name=\"media\"\n            id=\"pickfiles-photo\"\n            ng-value=\"directive.model.name\"\n            ng-placeholder=\"directive.inProgress\"\n            lj-disabled=\"directive.state.uploadInProgress\"\n            >\n    </div>\n\n    <ul\n        class=\"upload__items\"\n        ng-if=\"directive.state.preview\"\n        >\n        <li\n            class=\"upload__item\"\n            ng-repeat=\"photo in directive.uploaded\"\n            >\n            <span class=\"upload__item_pic\"><!--\n                --><img\n                    class=\"b-photouploader-pictures-img\"\n                    ng-src=\"{{ photo.thumbnail_url }}\"\n                    ><!--\n            --></span>\n            <span\n                class=\"upload__item_remove\"\n                lj-svg-icon=\"flaticon--cross\"\n                lj-ml=\"photouploader.upload.remove\"\n                lj-ml-attr=\"title\"\n                ng-click=\"directive.remove(photo, $index)\"\n                ></span>\n        </li>\n    </ul>\n\n    <div class=\"upload-bar\">\n        <span\n            class=\"upload-bar__inner\"\n            ng-style=\"{ width: directive.progress + \'%\' }\"\n            ></span>\n    </div>\n\n    <div class=\"flatpopup__msg\">\n        <span\n            class=\"\n                b-bubble\n                b-bubble-warning\n                b-bubble-noarrow\n                flatpopup__msg-warning\n                flatpopup__msg-text\n                \"\n            ></span>\n    </div>\n\n    <div class=\"b-ljform-field\">\n        <div select-photo-album=\"directive.model.album\" select-photo-album-scope=\"directive.scope\"></div>\n    </div>\n\n    <div class=\"b-ljform-field flatmedia-privacy__field\">\n        <label class=\"flatpopup-label\" lj-ml=\"flatmedia.security\"></label>\n        <span\n            lj-privacy=\"directive.model\"\n            lj-privacy-scope=\"photo\"></span>\n    </div>\n\n    <div\n        class=\"b-ljform-field\"\n        ng-if=\"directive.state.selectSize && directive.sizes.list\"\n        >\n        <label\n            for=\"albums\"\n            class=\"b-photouploader-nav-label flatpopup-label\"\n            lj-ml=\"photouploader.album.size\"\n            ></label>\n        <select\n            id=\"albums\"\n            class=\"sharp-select\"\n            ng-model=\"directive.sizes.current\"\n            ng-options=\"size as size.text for size in directive.sizes.list\"\n            ></select>\n    </div>\n\n    <div\n        class=\"b-photouploader-albumselector-item\"\n        ng-if=\"directive.state.selectSize && directive.sizes.list\"\n        >\n        <input\n            type=\"checkbox\"\n            id=\"linktoneworiginal\"\n            class=\"b-photouploader-albumselector-check\"\n            ng-model=\"directive.originalLink\"\n            >\n        <label\n            for=\"linktoneworiginal\"\n            class=\"b-photouploader-albumselector-label\"\n            lj-ml=\"photouploader.upload.addlink\"\n            ></label>\n    </div>\n\n    <div class=\"b-ljform-field b-photouploader-action-panel\">\n        <a\n            class=\"flatpopup-action-link\"\n            href=\"javascript:void(0)\"\n            ng-click=\"directive.cancel()\"\n            lj-ml=\"flatmedia.button.cancel\"\n            ></a>\n        <button\n            class=\"\n                b-flatbutton\n                b-flatbutton-simple\n                \"\n            lj-ml=\"{\n                    \'flatmedia.upload.photo\': directive.scope === \'photo\',\n                    \'photouploader.upload.insert\': directive.scope !== \'photo\'\n                }\"\n            lj-disabled=\"!directive.isSaveAllowed()\"\n            ng-click=\"directive.save()\"\n            ></button>\n    </div>\n\n</div>\n\n<div class=\"b-photouploader-initfail\" ng-if=\"!directive.state.init\">\n    <span class=\"b-photouploader-initfail-flash\" lj-ml=\"photouploader.upload.initFail\"></span>\n</div>\n';
//= require_ml flatmedia.button.cancel
//= require_ml flatmedia.name
//= require_ml flatmedia.upload.photo
//= require_ml photouploader.upload.initFail
//= require_ml photouploader.upload.dragOrClick
//= require_ml photouploader.upload.filesAdded1
//= require_ml photouploader.upload.filesAdded2-4
//= require_ml photouploader.upload.filesAdded5
//= require_ml photouploader.upload.insert
!function(e){return e}(),function(){"use strict";angular.module("Photo.Uploader",["LJ.Templates","LJ.Messages","LJ.Api","angular-plupload","Photo.SelectAlbum","Photo.Service","Editor"]).directive("ljPhotoUploader",["$timeout",function(e){return{templateUrl:"uploaderPhoto.ng.tmpl",scope:{albumId:"=ljPhotoUploader",scope:"@ljPhotoUploaderScope",callback:"&ljPhotoUploaderCallback",onError:"&ljPhotoUploaderError",cancelUpload:"&ljPhotoUploaderCancel"},controllerAs:"directive",controller:["$scope","$q","$rootScope","$element","$attrs","Photo","Editor","Bubble","Messages","PhotoSize",function(o,t,r,a,n,l,i,p,s,u){function d(){_.model=m(),J("ready")}function c(){function e(e){"function"==typeof o.callback&&o.callback({photo:e}),"photo"===_.scope&&LJ.Event.trigger("upload:photo:back"),U(),J("init")}LJ.Event.trigger("photo:upload:save"),L().then(y).then(e)}function g(){"function"==typeof o.cancelUpload&&o.cancelUpload(),J("cancel"),_.uploaded.map(f),j.length=0,p.close()}function f(e){l.removeRecords([e.id],{notCached:!0}).then(function(){_.uploaded.splice(_.uploaded.indexOf(e),1)})}function m(){return{name:l.defaults.ALBUM_NAME,privacy:l.defaults.RECORD_PRIVACY,album:l.getAlbumById(o.albumId)||{}}}function h(){return j.length&&j.every(function(e){return 0!==e.trim().length})&&(_.model.album.id||0!==_.model.album.name.trim().length)&&!_.state.inProgress}function v(){var e=_.files.length;return 0===e?-1:10>e||e>20?e%10:0}function b(){return _.state.inProgress?void LJ.Event.once("photo:upload:done",b):(J("uploading"),void _.uploader.start())}function P(){_.state.isWaiting||(_.state.isWaiting=!0,LJ.Event.once("photo:upload:save",b))}function y(){var e=_.uploaded.map(function(e,o){return l.updateRecord({id:e.id,albumid:_.model.album.id,privacy:_.model.privacy,groupids:_.model.groupids,name:j[o]})});return t.all(e)}function L(){if("photo"===_.scope&&!_.uploaded.length)return LJ.Event.once("photo:upload:done",c),t.reject();"editor"===_.scope&&J("progress");var e=angular.copy(_.model),o=t.defer(),r=o.promise;return"undefined"==typeof e.album.id?r=l.createAlbum({name:e.album.name}):o.resolve(e.album),delete e.album,r.then(function(e){_.model.album.id=e.id})}function k(e,t){return J("error"),t.code&&t.code===window.plupload.INIT_ERROR?void(_.state.init=!1):(_.files.pop(),s.error({body:t.message}),"function"==typeof o.onError&&o.onError(),void e.splice(_.uploaded.length))}function J(e){var t={inProgress:!1,uploadInProgress:!1,uploadDone:!1,error:!1,preview:n.hasOwnProperty("ljPhotoUploaderPreview"),selectSize:n.hasOwnProperty("ljPhotoUploaderSize")};switch(_.state&&"init"!==e||(_.state=angular.extend({},_.state,t)),e){default:case"init":break;case"progress":_.state.inProgress=!0;break;case"cancel":LJ.Event.trigger("photo:upload:cancel");break;case"uploading":LJ.Event.trigger("photo:upload:start"),_.state.inProgress=!0,_.state.uploadInProgress=!0;break;case"uploaded":_.uploaded.length&&(LJ.Event.trigger("photo:upload:done"),_.state.uploadDone=!0,_.state.inProgress=!1,_.state.uploadInProgress=!1);break;case"ready":_.state.init=!0,o.$apply();break;case"error":_.state.error=!0,_.state.inProgress=!1,_.state.uploadInProgress=!1}}function E(){var e=_.state.selectSize&&_.sizes.current.size,o='<img src="{url}" alt="{name}" title="{name}">',t='<a target="_blank" href="{originalLink}">{img}</a>';return _.uploaded.map(function(r){var a=o.supplant({url:e?r.url.replace("original",e):r.url,name:r.photo_name||r.name});return _.originalLink?t.supplant({originalLink:r.url,img:a}):a})}function U(){var e=E();i.insertContent("photouploader",e.join("\n"),e),_.uploaded.length=0,p.close()}var _=this,j=[];J(),_.init=d,_.files=[],_.uploaded=[],_.save=c,_.cancel=g,_.remove=f,_.isSaveAllowed=h,_.modulo=v,_.scope=o.scope,_.sizes=u,_.uploadUrl=(LJ.get("photo_prefix")||"")+"/up";var A=LJ.Object.resolve(LJ,"GlobalConfig.photoUploadMaxSize")+"mb"||"20mb";_.uploadOptions={drop_element:"upload-panel-photo",browse_button:"pickfiles-photo",multi_selection:!0,filters:{max_file_size:A,mime_types:[{title:"Image files",extensions:"jpg,jpeg,gif,png"}]},multipart:!0,multipart_params:{form_auth:LJ.get("fotki.uploader.guid")||LJ.get("page.guid")},file_data_name:"file"},_.uploadCallbacks={init:function(e){_.uploader=e,e.refresh()},filesAdded:function(o,t){J("init"),_.files.lenght=0,Array.prototype.push.apply(_.files,angular.copy(t)),Array.prototype.push.apply(j,t.map(LJ.Function.get("name"))),e("photo"!==_.scope?b:P)},fileUploaded:function(e,t,r){return r=JSON.parse(r.response),_.files.shift(),o.$apply(),"error"===r.status?void k(e,r):void(_.state.error||_.uploaded.push(r))},uploadProgress:function(e,o){var t=100/(_.files.length+_.uploaded.length);_.progress=isFinite(t)?Math.floor(t*(_.uploaded.length+o.percent/100)):0},uploadComplete:function(){_.progress=0,J("uploaded")},error:function(e,o){k(e,o)}}}],link:function(o,t,r,a){e(a.init)}}}])}();
/* <<< file end: js/photo/uploader.js */

//# map link was there [uploader.js.map]
/* >>> file start: js/misc/tempImageChecker.js */
//= require_ml message.warnings.temporary_url_insertion
LJ.define("LJ.Misc"),LJ.Misc.checkForTempImageURLs=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e.event,t=e.string,a="";if(t)a=t;else if(n)try{var r=n.originalEvent||n;a=r.clipboardData.getData("text/plain")}catch(i){console.log("Could not parse text content from pasted text")}var s=a.match(/https?:\/\/[^\s'"\r\n]+/g)||[],o=s.filter(function(e){return e.indexOf("imgprx.livejournal.net/")>0?!0:e.indexOf("downloader.disk.yandex.ru/")>0?!0:e.indexOf("fna.fbcdn.net/")>0});return o.length&&LJ.Messages&&LJ.Messages.add({body:LJ.ml("message.warnings.temporary_url_insertion"),type:"warning"}),o};
/* <<< file end: js/misc/tempImageChecker.js */

//# map link was there [tempImageChecker.js.map]
/* >>> file start: js/photo/editor.js */
//= require js/editor/editor.js
//= require js/editor/photouploader.js
//= require js/editor/media.js
//= require js/core/string.js
//= require js/core/array.js
//= require js/core/angular/api.js
//= require js/core/angular/pills.js
//= require js/core/angular/authHelper.js
//= require js/angularHttps.js
//= require js/photo/uploader.js
//= require js/photo/photo.js
//= require js/misc/tempImageChecker.js
// error: photouploader.css is already included
// error: menu_v2.css is already included
Site.page.template['angular/photo.ng.tmpl'] = '<div\n    class=\"b-photouploader\"\n    ng-controller=\"PhotoEditorCtrl as photo\"\n    >\n\n\n\n    <!-- menu -->\n    <ul\n        class=\"\n            b-menu\n            b-menu-hrz\n            b-menu-pills\n            b-menu-pseudo\n            b-photouploader-menu\n            \"\n        lj-pills-group=\"uploadPhoto\"\n        ><!--\n        --><li\n            class=\"b-menu-item b-menu-item-active\"\n            data-pill=\"upload\"\n            ng-if=\"photo.state.canUpload\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"photo.pill(\'upload\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.upload.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"album\"\n            ng-if=\"photo.state.canUpload && photo.albums.list\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"photo.pill(\'album\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.album.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"paste\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"photo.pill(\'paste\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.paste.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"dropbox\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"photo.pill(\'dropbox\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.dropbox.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            data-pill=\"instagram\"\n            >\n            <a\n                href=\"javascript:void(0);\"\n                ng-click=\"photo.pill(\'instagram\')\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photouploader.instagram.title\"\n                ></a>\n        </li><!--\n        --><li\n            class=\"b-menu-item\"\n            >\n            <a\n                href=\"/photo/migrate\"\n                class=\"b-menu-item-link\"\n                lj-ml=\"photo.migrate.title\"\n                target=\"_blank\"\n                ng-if=\"!photo.state.isMigrated\"\n                ></a>\n        </li><!--\n    --></ul>\n\n\n    <!-- items -->\n    <div class=\"b-photouploader-items\">\n        <!-- upload from computer -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-upload\n                \"\n            ng-class=\"\'b-photouploader-item-upload-\' + upload.state()\"\n            ng-if=\"photo.state.canUpload && photo.isPill(\'upload\')\"\n            >\n                <div lj-photo-uploader\n                     lj-photo-uploader-callback=\"photo.loaded(photo)\"\n                     lj-photo-uploader-cancel=\"photoUploadCancelled()\"\n                     lj-photo-uploader-scope=\"editor\"\n                     lj-photo-uploader-preview\n                     lj-photo-uploader-size\n                     ></div>\n            </div>\n\n\n        <!-- select from albums -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-albums\n                \"\n            ng-show=\"photo.isPill(\'album\')\"\n            ng-if=\"photo.state.canUpload\"\n            >\n\n            <!-- albums -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-albums\n                    \"\n                >\n\n                <h4\n                    class=\"b-photouploader-subhead\"\n                    lj-ml=\"photouploader.album.select\"\n                    ></h4>\n\n                <div class=\"\n                        b-photouploader-albums\n                        b-photouploader-albums-withnav\n                        \">\n                    <div\n                        class=\"b-photouploader-albums-inner\"\n                        lj-when-scrolled=\"photo.albums.loadMore()\"\n                        >\n                        <!-- albums nav -->\n                        <div\n                            class=\"b-photouploader-nav\"\n                            >\n                            <label\n                                for=\"albums\"\n                                class=\"b-photouploader-nav-label\"\n                                lj-ml=\"photouploader.album.your\"\n                                ></label>\n                            <select\n                                class=\"sharp-select\"\n                                id=\"albums\"\n                                ng-model=\"photo.albums.current\"\n                                ng-options=\"item as item.name for item in photo.albums.list\"\n                                >\n                            </select>\n                        </div>\n\n                        <!-- pictures -->\n                        <ul\n                            class=\"\n                                b-photouploader-pictures\n                                b-photouploader-pictures-withtitle\n                                b-photouploader-pictures-withmove\n                                \"\n                            ng-model=\"photo.albums.current.photos\"\n                            >\n                            <li\n                                class=\"b-photouploader-pictures-item\"\n                                ng-repeat=\"item in photo.albums.current.photos\"\n                                ng-click=\"photo.albums.togglePhoto(item)\"\n                                ng-class=\"{ \'selected\': item.selected }\"\n                                >\n                                <span class=\"b-photouploader-pictures-pic\"><!--\n                                    --><img\n                                    class=\"b-photouploader-pictures-img\"\n                                    ng-src=\"{{ item.thumbnail_url || item.url }}\"\n                                    ><!--\n                                --></span>\n                                <strong\n                                    class=\"b-photouploader-pictures-title\"\n                                    ng-bind=\"item.name\"\n                                    ng-show=\"item.name\"\n                                    ><!--\n                                --></strong>\n                            </li>\n                        </ul>\n\n                    </div>\n                </div><!-- /albums -->\n\n            </div>\n\n            <!-- controls -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-controls\n                    \"\n                >\n                <div class=\"b-photouploader-albumsettings\">\n                    <label\n                        for=\"sizepictures\"\n                        class=\"b-photouploader-albumsettings-label\"\n                        lj-ml=\"photouploader.album.size\"\n                        ></label>\n                    <select\n                        id=\"sizepictures\"\n                        class=\"b-photouploader-albumsettings-select\"\n                        ng-model=\"photo.ui.current\"\n                        ng-options=\"item as item.text for item in photo.ui.list\"\n                        >\n                    </select>\n                    <div class=\"b-photouploader-albumsettings-separator\"></div>\n                    <div class=\"b-photouploader-albumsettings-wrap\">\n                        <input\n                            type=\"checkbox\"\n                            id=\"linktooriginal\"\n                            class=\"b-photouploader-albumsettings-check\"\n                            ng-model=\"photo.albums.originalLink\"\n                            />\n                        <label\n                            for=\"linktooriginal\"\n                            class=\"b-photouploader-albumsettings-label\"\n                            lj-ml=\"photouploader.album.addlink\"\n                            ></label>\n                    </div>\n                </div>\n                <div\n                    class=\"\n                        b-ljbutton\n                        b-ljbutton-submit\n                        \"\n                    >\n                    <button\n                        type=\"submit\"\n                        name=\"submit\"\n                        lj-disabled=\"photo.albums.noneSelected() || photo.ui.insertInProgress\"\n                        ng-click=\"photo.albums.insert()\"\n                        lj-ml=\"photouploader.album.insert\"\n                        ></button>\n                </div>\n                <button\n                    type=\"submit\"\n                    name=\"submit\"\n                    class=\"\n                        b-flatbutton\n                        b-flatbutton-simple\n                        \"\n                    lj-disabled=\"photo.albums.noneSelected() || photo.ui.insertInProgress\"\n                    ng-click=\"photo.albums.insert()\"\n                    lj-ml=\"photouploader.album.insert\"\n                    ></button>\n            </div>\n\n        </div><!-- /albums item -->\n\n\n        <!-- by url -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-url\n                \"\n            ng-show=\"photo.isPill(\'paste\')\"\n            >\n\n            <form ng-submit=\"photo.paste.insertUrl()\">\n\n                <!-- url form -->\n                <div\n                    class=\"\n                        b-photouploader-panel\n                        b-photouploader-panel-url\n                        \"\n                    >\n\n                    <dl class=\"b-photouploader-byurl\">\n\n                        <dt class=\"b-photouploader-byurl-picture\">\n                            <img\n                                ng-src=\"{{ photo.paste.secureUrl }}\"\n                                ng-show=\"photo.paste.secureUrl\"\n                                class=\"b-photouploader-byurl-image\"\n                                >\n                            <span\n                                ng-show=\"!photo.paste.secureUrl\"\n                                class=\"b-photouploader-byurl-sub\"\n                                lj-ml=\"photouploader.paste.correctUrl\"\n                                ></span>\n                        </dt>\n\n                        <dd class=\"b-photouploader-byurl-form\">\n                            <label\n                                for=\"url\"\n                                class=\"b-photouploader-byurl-label\"\n                                lj-ml=\"photouploader.paste.pasteURL\"\n                                ></label>\n                            <br class=\"b-photouploader-byurl-br\">\n                            <input\n                                type=\"text\"\n                                id=\"url\"\n                                size=\"55\"\n                                class=\"b-photouploader-byurl-src\"\n                                placeholder=\"https://\"\n                                ng-model=\"photo.paste.url\"\n                                focus-and-select=\"photo.isPill(\'paste\')\"\n                                ng-paste=\"photo.handlePasteEvent($event)\"\n                                >\n                            <br class=\"b-photouploader-byurl-br\">\n                            <em\n                                class=\"b-photouploader-byurl-note\"\n                                lj-ml=\"photouploader.paste.notice\"\n                                ></em>\n                        </dd>\n\n                        <dd class=\"b-photouploader-byurl-form\">\n                            <label\n                                for=\"imagelink\"\n                                class=\"b-photouploader-byurl-label\"\n                                lj-ml=\"photouploader.paste.link\"\n                                ></label>\n                            <br class=\"b-photouploader-byurl-br\">\n                            <input\n                                type=\"text\"\n                                id=\"imagelink\"\n                                size=\"35\"\n                                class=\"b-photouploader-byurl-link\"\n                                placeholder=\"https://\"\n                                ng-model=\"photo.paste.link\"\n                                >\n                        </dd>\n\n                    </dl>\n\n                </div><!-- /panel -->\n\n                <!-- controls -->\n                <div\n                    class=\"\n                        b-photouploader-panel\n                        b-photouploader-panel-controls\n                        \"\n                    >\n                    <div class=\"b-photouploader-urlsettings\">\n                        <label\n                            for=\"picturesize\"\n                            class=\"b-photouploader-urlsettings-label\"\n                            lj-ml=\"photouploader.paste.size\"\n                            ></label>\n                        <select\n                            id=\"picturesize\"\n                            class=\"b-photouploader-urlsettings-select sharp-select\"\n                            ng-model=\"photo.ui.current\"\n                            ng-options=\"item as item.text for item in photo.ui.list\"\n                            >\n                        </select>\n                    </div>\n                    <div\n                        class=\"\n                            b-ljbutton\n                            b-ljbutton-submit\n                            \"\n                        >\n                        <button\n                            type=\"submit\"\n                            name=\"submit\"\n                            lj-disabled=\"!photo.paste.url\"\n                            lj-ml=\"photouploader.paste.insert\"\n                            ></button>\n                    </div>\n                    <button\n                        type=\"submit\"\n                        name=\"submit\"\n                        class=\"\n                            b-flatbutton\n                            b-flatbutton-simple\n                            \"\n                        lj-disabled=\"!photo.paste.url\"\n                        lj-ml=\"photouploader.paste.insert\"\n                        ></button>\n                </div><!-- /panel -->\n\n            </form>\n\n        </div><!-- /url item -->\n\n\n\n        <!-- dropbox -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-dropbox\n                \"\n            ng-show=\"photo.isPill(\'dropbox\')\"\n            >\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-dropbox\n                    \"\n                >\n                <p\n                    class=\"b-photouploader-panel-dropbox-intro\"\n                    lj-ml=\"photouploader.dropbox.choose\"\n                    ></p>\n                <span lj-dropbox-button></span>\n            </div>\n        </div><!-- /dropbox item -->\n\n\n\n        <!-- message for empty album -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-noalbums\n                \"\n            ng-hide=\"!photo.isPill(\'instagram\') || !photo.instagram.token() || photo.instagram.media.length\"\n            lj-ml=\"photouploader.instagram.nophoto\"\n            ></div>\n\n\n\n        <!-- instagram -->\n        <div\n            class=\"\n                b-photouploader-item\n                b-photouploader-item-instagram\n                \"\n            ng-show=\"photo.isPill(\'instagram\')\"\n            >\n\n            <!-- login to instagram -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-instalogin\n                    \"\n                ng-show=\"!photo.instagram.token()\"\n                >\n                <p\n                    class=\"b-photouploader-panel-instalogin-intro\"\n                    lj-ml=\"photouploader.instagram.intro\"\n                    ></p>\n                <a\n                    href=\"javascript:void(0);\"\n                    class=\"b-photouploader-instagram-signup\"\n                    ng-click=\"photo.instagram.login()\"\n                    lj-ml=\"photouploader.instagram.loginButton\"\n                    ></a>\n            </div>\n\n            <!-- select pictures from instagram -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-pictures\n                    \"\n                ng-show=\"photo.instagram.token()\"\n                >\n\n                <div\n                    class=\"b-photouploader-instahead\"\n                    ng-class=\"{ \'b-photouploader-instahead--center\': !photo.instagram.media.length }\"\n                    >\n                    <h4\n                        class=\"b-photouploader-subhead\"\n                        ng-show=\"photo.instagram.media.length\"\n                        >\n                        <span\n                            lj-ml=\"photouploader.instagram.select\"\n                            ></span>\n                        <span\n                            class=\"b-photouploader-subhead-annex\"\n                            lj-ml=\"photouploader.instagram.select.help\"\n                            ></span>\n                    </h4>\n\n                    <a\n                        class=\"b-photouploader-logout\"\n                        href=\"javascript:void(0);\"\n                        ng-click=\"photo.instagram.logout()\"\n                        lj-ml=\"photouploader.instagram.logout\"\n                        ></a>\n                </div>\n\n                <div\n                    class=\"\n                        b-photouploader-albums\n                        \"\n                    ng-show=\"photo.instagram.media.length\"\n                    ng-class=\"{ \'b-photouploader-albums-loading\': photo.instagram.loading }\"\n                    >\n                    <div\n                        class=\"b-photouploader-albums-inner\"\n                        lj-when-scrolled=\"photo.instagram.loadMore()\"\n                        >\n                        <ul\n                            class=\"\n                                b-photouploader-pictures\n                                b-photouploader-pictures-withtitle\n                                b-photouploader-pictures-withmove\n                                \"\n                            ng-model=\"photo.instagram.media\"\n                            ui-sortable=\"photo.ui.sortableOptions\"\n                            >\n                            <li\n                                class=\"b-photouploader-pictures-item\"\n                                ng-repeat=\"media in photo.instagram.media\"\n                                ng-click=\"photo.instagram.select(media);\"\n                                ng-class=\"{ \'selected\': media.selected }\"\n                                >\n                                <span class=\"b-photouploader-pictures-pic\"><!--\n                                    --><img\n                                    ng-src=\"{{ media.images.thumbnail.url }}\"\n                                    class=\"b-photouploader-pictures-img\"\n                                    ><!--\n                                --></span>\n                                <strong\n                                    class=\"b-photouploader-pictures-title\"\n                                    title=\"{{ media.caption.text }}\"\n                                    ng-show=\"media.caption\"\n                                    ><!--\n                                    -->{{ media.caption.text }}<!--\n                                --></strong>\n                            </li>\n                        </ul><!-- /pictures -->\n                    </div>\n                </div><!-- /albums -->\n\n            </div><!-- /panel -->\n\n            <!-- controls -->\n            <div\n                class=\"\n                    b-photouploader-panel\n                    b-photouploader-panel-controls\n                    \"\n                ng-show=\"photo.instagram.token() && photo.instagram.media.length\"\n                >\n                <div\n                    class=\"\n                        b-ljbutton\n                        b-ljbutton-submit\n                        \"\n                    >\n                    <button\n                        type=\"submit\"\n                        name=\"submit\"\n                        lj-disabled=\"photo.instagram.noneSelected()\"\n                        ng-click=\"photo.instagram.insert()\"\n                        lj-ml=\"photouploader.instagram.insert\"\n                        ></button>\n                </div>\n                <button\n                    type=\"submit\"\n                    name=\"submit\"\n                    class=\"\n                        b-flatbutton\n                        b-flatbutton-simple\n                        \"\n                    lj-disabled=\"photo.instagram.noneSelected()\"\n                    ng-click=\"photo.instagram.insert()\"\n                    lj-ml=\"photouploader.instagram.insert\"\n                    ></button>\n            </div><!-- /panel -->\n\n        </div><!-- /instagram item -->\n\n\n    </div>\n</div>\n';
//= require_ml photouploader.embed.title
//= require_ml photouploader.upload.title
//= require_ml photouploader.upload.addlink
//= require_ml photouploader.byUrl.title
//= require_ml photouploader.album.title
//= require_ml photouploader.album.select
//= require_ml photouploader.album.insert
//= require_ml fotki.album.edit.empty.photo.title
//= require_ml photo.migrate.title
//= require_ml tour.photo_update_tour.tip
//= require_ml talk.photo
//= require_ml talk.photo.paste
//= require_ml talk.photo.insert
!function(t){return t}(),function(){"use strict";function t(t,e,o,n,r,i,a,u,l,s,c,p,d){function h(){var t=LiveJournal.parseGetArgs().photo_id,e=LiveJournal.parseGetArgs().albums_id;return t?m(t):e?(L.requestAlbumId=+e,f(L.requestAlbumId)):void 0}function m(t){var e;e=t.split(",").map(function(t){return i.fetchRecordById({id:t})}),e.push(i.fetchAlbums()),o.all(e).then(function(t){t.splice(-1),L.albums.current=b(t.map(n("decodeRecord")))})}function f(t){LJ.Event.on("photo:albums:loaded",function(){var e=L.albums.list.find(function(e){return e.id===t});e.selected=!0,L.albums.current=e})}function g(){L.state.canUpload&&i.fetchAlbums({user:LJ.get("remote.username")}).then(function(){L.albums.list=i.getAlbums(),L.albums.current=L.albums.list[0],LJ.Event.trigger("photo:albums:loaded")})}function b(t){var e={id:"selected",name:LJ.ml("photouploader.album.scrapbookSelected"),photos:t.map(LJ.Function.set("selected",!0))};return L.albums.list.push(e),e}var L=this,J=L;L.state={canUpload:LJ.get("remote")&&!LJ.get("remote_is_identity"),isMigrated:LJ.get("is_images_migrated"),insertInProgress:!1,uploadInProgress:!1,isOpen:!1},L.instagram=l,L.paste=s,L.albums=c,L.ui=p,L.hasAlbums=function(){return 0!==c.length},L.isPill=function(t){return r.group("uploadPhoto")===t},L.pill=function(t){t=t||LJ.Storage.getItem("photoUploadPill")||"paste",r.group("uploadPhoto",t),LJ.Storage.setItem("photoUploadPill",t)},t.$watch(function(){return L.state.isOpen},function(t){t===!0&&(u.init(),g())});var v=LJ.Function.debounce(L.paste.updateSecureUrl,1500);t.$watch(function(){return L.paste.url},function(t,e){angular.isString(t)&&t!==e&&(L.paste.secureUrl="",v(t))}),t.$watch(function(){return L.instagram.token()},L.instagram.loadMore),LJ.Event.on("instagram_token",function(t){e(function(){L.instagram.token(t)})}),t.$watch(function(){return L.ui&&L.ui.current},function(t,e){t&&t!==e&&LJ.Cookie.set("photo_size",t.size)}),t.$watch(function(){return L.albums.current},function(t){if(t&&t.id&&/\d/.test(t.id)){if(LJ.get("fotki.insert")&&t.id===L.requestAlbumId){if(!L.cachedRequestPhotos){var e=LJ.get("fotki.insert").map(function(t){return{id:t.photo_id,name:t.photo_title?t.photo_title:LJ.ml("fotki.album.edit.empty.photo.title"),description:t.photo_desc,thumbnail_url:t.photo_url,url:t.photo_orig,available_sizes:t.available_sizes,selected:!0}});L.cachedRequestPhotos=e.map(n("decodeRecord"))}L.albums.current.photos=L.cachedRequestPhotos}else i.fetchRecords(t.id,{offset:0,limit:20,user:LJ.get("remote.username")}).then(function(t){L.albums.current.photos=t.map(n("decodeRecord"))});LJ.Storage.setItem("photouploader_album_id",t.id)}}),t.$on("bubble:open:photouploader",function(){var t=LiveJournal.parseGetArgs().albums_id||LiveJournal.parseGetArgs().photo_id;L.state.isOpen=!0,LJ.get("fotki.insert")||t&&L.state.canUpload?(L.pill("album"),h()):(L.pill(L.state.canUpload?LJ.Storage.getItem("photouploader2_state")||"upload":"paste"),L.isPill("album")&&!L.hasAlbums()&&L.pill("upload"))}),t.$on("bubble:close:photouploader",function(){L.state.isOpen=!1}),LJ.Event.on("photo:upload:start",function(){L.state.uploadInProgress=!0}),LJ.Event.on("upload:photo:cancel",function(){L.state.uploadInProgress=!1}),LJ.Event.on("upload:photo:done",function(){d.close()}),J.handlePasteEvent=function(t){var e=LJ.Object.resolve(LJ,"Misc.checkForTempImageURLs")||function(){};e({event:t})}}angular.module("Photo.Editor",["LJ.AuthHelper","LJ.Pills","LJ.Api","LJ.Bubble","Photo.Service","Photo.Uploader","LJ.Photouploader","Editor","LJ.Https"]).factory("DropboxPhoto",["$timeout","Editor","Bubble","Photouploader",function(t,e,o,n){var r={};return r.init=function(){window.Dropbox||LJ.injectScript("https://www.dropbox.com/static/api/2/dropins.js").done(function(){window.Dropbox&&(window.Dropbox.appKey=n.keys.dropbox),LJ.Event.trigger("dropbox_loaded",{linkType:"preview",multiselect:!0,extensions:["images"],success:function(n){t(function(){var t=n.map(function(t){return'<img src="{url}" alt="" title="">'.supplant({url:t.link.replace("www.dropbox.com","dl.dropboxusercontent.com")})});e.insertContent("photouploader",t.join("\n"),t),o.close(),LJ.Track.event("Photouploader","Dropbox","Success")})}})})},r}]).factory("InstagramPhoto",["$timeout","$q","Editor","Bubble","AuthHelper","Photouploader",function(t,e,o,n,r,i){var a={media:[],asEmbed:!0},u=null;return a.token=function(t){var e=LJ.get("remote.username"),o="instagram_token",n={domain:LJ.get("siteroot").replace(/^https?:\/\/www/,"")};return e&&(o="instagram_token_"+e),"undefined"==typeof t?u||LJ.Cookie.get(o):(u=t,void LJ.Cookie.set(o,t,n))},a.insert=function(){var t,r,i=a.media.filter(LJ.Function.get("selected"));a.asEmbed?(r=i.map(function(t){return LJ.Media.parse(t.link).then(LJ.Function.get("embed"))}),e.all(r).then(function(t){o.insertContent("video",t.join("\n"),t)})):(t=i.map(function(t){var e=LJ.String.encodeHTML(t.caption&&t.caption.text||"");return'<div>{title}<img src="{url}" alt="{caption}" title="{caption}"></div>'.supplant({url:t.images.standard_resolution.url,caption:e,title:a.needTitle?"<p>"+e+"</p>":""})}),o.insertContent("photouploader",t.join("\n"),t),LJ.Track.event("Photouploader","Instagram","Insert")),a.media.forEach(LJ.Function.set("selected",!1)),n.close()},a.noneSelected=function(){return 0===a.media.filter(LJ.Function.get("selected")).length},a.select=function(t){t.selected=!t.selected},a.login=function(){r.open(["https://instagram.com/oauth/authorize/?client_id=",i.keys.instagram,"&amp;redirect_uri=","https://www.livejournal.com","/auth_helper.html&amp;response_type=token"].join("")).then(function(t){t&&LJ.Event.trigger("instagram_token",t)})},a.logout=function(){(new Image).src="https://instagram.com/accounts/logout/",a.token(null),a.allFetched=!1,a.media.length=0},a.loadMore=function(){if(a.token()&&!a.loading&&!a.allFetched){a.loading=!0;var e=["https://api.instagram.com","/v1/users/self/media/recent/?callback=?&access_token=",a.token()];if(a.media.length>0){var o=a.media[a.media.length-1].id;e.push("&max_id="+o)}jQuery.getJSON(e.join("")).then(function(e){t(function(){e.data&&0===e.data.length&&(a.allFetched=!0),Array.prototype.push.apply(a.media,e.data),a.loading=!1})})}},a}]).factory("PastePhoto",["$rootScope","$timeout","$q","Editor","Bubble","PhotoSize","ljHttpsService",function(t,e,o,n,r,i,a){var u={url:"",link:"",secureUrl:""},l=LJ.get("whitelist_https")||[];return u.insertUrl=function(){return u.updateSecureUrl().then(function(){var t,e=n.htmlMode()?u.url:u.secureUrl,o=n.htmlMode()?null:"originalSrc='"+u.url+"'",a='<img src="{url}" alt="" {originalSrc}{width}/>'.supplant({url:e,width:Number(i.current.size)?'width="'+i.current.size+'" ':"",originalSrc:o?o+" ":""});t=u.link?'<a href="'+LJ.String.linkify(u.link)+'">'+a+"</a>":a,n.insertContent("photouploader",t,[t]),u.url="",u.link="",r.close(),LJ.Track.event("Photouploader","Paste","Insert")})},u.updateSecureUrl=function(){return u.url?a.getSecureImageUrl(u.url,l).then(function(t){var o=t.secureUrl;return e(function(){u.secureUrl=o},0)})["catch"](function(){}):(u.secureUrl="",o.resolve())},u}]).factory("AlbumPhoto",["$q","Editor","PhotoSize","Photouploader","Bubble","Photo",function(t,e,o,n,r,i){var a=o.list,u={current:{photos:[]},list:i.getAlbums(),originalLink:!1};return u.noneSelected=function(){return u.list.length&&u.current.photos?0===u.current.photos.filter(LJ.Function.get("selected")).length:!0},u.insert=function(){var t,e;o.insertInProgress||(o.insertInProgress=!0,t=o.current.size,e=u.current.photos.filter(LJ.Function.get("selected")),LJ.Event.trigger("albumInsert",t,e))},u.loadMore=function(e){var o=u.current;return o.photos&&o.photos.length!==o.count&&"selected"!==o.id?i.fetchRecords(o.id,{offset:o.photos.length||0,limit:e||20,user:LJ.get("remote.username")}).then(function(t){Array.prototype.push.apply(o.photos,t)}):t.when(null)},u.togglePhoto=function(t){t.selected=!t.selected,o.list=o.intersect(u.current.photos.filter(LJ.Function.get("selected")).map(LJ.Function.get("available_sizes"))),-1===o.list.indexOf(o.current)&&(o.current=o.list.slice(-2)[0])},LJ.Event.on("albumInsert",function(t,n){var i=n.map(function(e){var o='<img src="{url}" alt="{description}" title="{name}">'.supplant({url:e.url.replace("original",t),name:(e.name||"").encodeHTML(),description:(e.description||e.name).encodeHTML()});return u.originalLink?'<a target="_blank" href="'+e.url+'">'+o+"</a>":o});e.insertContent("photouploader",i.join("\n"),i),o.insertInProgress=!1,o.list=a,u.current.photos.forEach(LJ.Function.set("selected",!1)),r.close(),LJ.Track.event("Photouploader","Albums","Insert")}),u}]).controller("PhotoEditorCtrl",["$scope","$timeout","$q","$filter","Pills","Photo","Photouploader","DropboxPhoto","InstagramPhoto","PastePhoto","AlbumPhoto","PhotoSize","Bubble",t]).directive("ljDropboxButton",function(){return function(t,e){LJ.Event.on("dropbox_loaded",function(t){e[0].appendChild(window.Dropbox.createChooseButton(t))})}})}();
/* <<< file end: js/photo/editor.js */

//# map link was there [editor.js.map]
/* >>> file start: js/editor/basicToolbar.js */
//= require js/core/string.js
//= require js/core/angular/api.js
//= require js/core/angular/autocomplete.js
//= require js/core/angular/bubble.js
//= require js/core/angular/users.js
//= require js/editor/editor.js
//= require js/editor/media.js
//= require js/video/editor.js
//= require js/editor/photouploader.js
//= require js/photo/editor.js
!function(e){return e}(),function(e){"use strict";angular.module("BasicToolbar",["LJ.Api","LJ.Autocomplete","LJ.Bubble","LJ.Photouploader","Photo.Editor","Video.Editor","Editor","Users"]).controller("MediaCtrl",["$scope","Editor",function(t,n){t.media="",t.setHint=function(e){var n=e.target,r=n.getAttribute("href");r&&(t.media=r),e.preventDefault()},t.getMedia=function(t){var n=LJ.Media.parse(t,{thumbnail:!1}),r=e.Deferred();return n?n.then(function(e){e&&e.embed&&(r.resolve(e),LJ.Track.event("Editor","Embed",e.site))}):/^<(embed|iframe|object).*>$/.test(t)?(r.resolve({embed:["<lj-embed>",t,"</lj-embed>"].join("\n")}),LJ.Track.event("Editor","Embed","lj-embed")):(r.resolve({embed:'<a href="{link}">{caret}{link}{caret}</a>'.supplant({link:t})}),LJ.Track.event("Editor","Embed","link (not parsed)")),r},t.insert=function(){e.when(t.getMedia(t.media)).done(function(e){n.insertContent("video",e.embed,t.media),t.media=""}),t.bubble.close()}}]).controller("LinkCtrl",["$scope","Editor",function(e,t){e.newWindow="undefined"!=typeof LJ.Storage.getItem("newWindow")?LJ.Storage.getItem("newWindow"):!0,e.unlink=function(){LJ.Event.trigger("unlink"),e.bubble.close()},e.saveOption=function(){LJ.Storage.setItem("newWindow",e.newWindow)},e.$on("bubble:open:link",function(){e.link=e.bubble.options.defaultText||"",e.showUnlink=!(!e.bubble.options.rangeNotCollapsed&&!e.bubble.options.editMode),"undefined"!=typeof e.bubble.options.hasTarget?e.newWindow=e.bubble.options.hasTarget:"undefined"!=typeof LJ.Storage.getItem("newWindow")&&(e.newWindow=LJ.Storage.getItem("newWindow"))}),e.insertOrSave=function(n){n.preventDefault(),t.insertContent("link",'<a href="{text}"{target}>{caret}{text}{caret}</a>'.supplant({text:LJ.String.linkify(e.link),target:e.newWindow?' target="_blank"':""}),{url:e.link,target:e.newWindow?"_blank":""}),e.link="",e.bubble.close()}}]).controller("UserCtrl",["$scope","Editor","Api","Users",function(e,t,n,r){e.friends=null,e.$on("bubble:open:user",function(){e.user=e.bubble.options.user||"",LJ.get("remote")&&!e.friends&&r.fetchFriends().then(function(t){e.friends=t.map(LJ.Function.get("username"))}),e.title="undefined"===e.bubble.options.title?"":e.bubble.options.title||"",e.error=!1}),e.$watch("user",function(){e.error=!1}),e.insertOrSave=function(){if(e.user){var r=arguments[0];angular.isString(r)&&r.length>e.user.length&&(e.user=r),n.call("ljuser.get",{user:e.user,raw:!0},function(n){n.error?e.error=!0:(t.insertContent("user",'<lj user="{caret}{text}{caret}" />'.supplant({text:e.user}),n,e.title),e.user="",e.title="",e.bubble.close())})}}}])}(jQuery);
/* <<< file end: js/editor/basicToolbar.js */

//# map link was there [basicToolbar.js.map]
/* >>> file start: js/discovery/directives.js */
//= require js/core/angular/api.js
Site.page.template['angular/ljImage.ng.tmpl'] = '<a ng-href=\"{{link}}\">\n    <figure class=\"b-journalpicture\">\n        <img\n            class=\"b-journalpicture-image\"\n            title=\"{{textContent}}\"\n            alt=\"{{textContent}}\"\n            ng-src=\"{{source}}\"\n            ng-style=\"dimensions\"\n            >\n        <figcaption class=\"b-journalpicture-caption\" lj-html=\"content\"></figcaption>\n    </figure>\n</a>\n';
Site.page.template['angular/ljGallery.ng.tmpl'] = '<div\n    class=\"b-journalgallery\"\n    ng-style=\"galleryDimensions\"\n    ng-class=\"{\n        \'b-journalgallery-hightpriority\': isTall\n    }\"\n    >\n    <div\n        class=\"b-journalgallery-container\"\n        ng-style=\"containersDimensions\"\n        >\n        <figure\n            class=\"b-journalgallery-picture\"\n            ng-repeat=\"item in items\"\n            ng-style=\"containersDimensions\"\n            ng-if=\"isNearby($index)\"\n            ng-class=\"{\n                \'b-journalgallery-picture-prev\': $index < state.index,\n                \'b-journalgallery-picture-current\': $index === state.index,\n                \'b-journalgallery-picture-next\': $index > state.index\n            }\"\n            >\n            <span\n                class=\"\n                    b-journalgallery-preloader\n                    svgpreloader\n                    svgpreloader-tag\n                    svgpreloader-16\n                    \"\n                    ></span>\n            <div class=\"b-journalgallery-wrapper\"\n                style=\"background-image: url({{item.src}}); max-width: {{item.width}}; max-height: {{item.height}}\">\n                <img\n                    ng-src=\"{{item.src}}\"\n                    class=\"b-journalgallery-image\"\n                    lj-gallery-load\n                    >\n            </div>\n            <figcaption class=\"b-journalgallery-caption\">\n                <span\n                    class=\"b-journalgallery-caption-title\"\n                    lj-html=\"item.content\"></span>\n            </figcaption>\n        </figure>\n    </div>\n    <span\n        class=\"b-journalgallery-counter\"\n        ng-bind=\"(state.index + 1) + \'/\' + (state.total+1)\"\n        ></span>\n    <span\n        class=\"b-journalgallery-nav b-journalgallery-nav-prev\"\n        ng-show=\"state.index !== 0\"\n        ng-click=\"prev()\"\n        ></span>\n    <span\n        class=\"b-journalgallery-nav b-journalgallery-nav-next\"\n        ng-show=\"state.index < state.total\"\n        ng-click=\"next()\"\n        ></span>\n</div>\n';
Site.page.template['angular/discovery/ljSuggest.ng.tmpl'] = '<div\n    class=\"b-mainpage-seealso\"\n    ng-if=\"suggest\"\n    >\n\n    <!-- head -->\n    <h3\n        class=\"b-mainpage-seealso-head\"\n        lj-ml=\"discovery.article.seealso\"\n        ></h3>\n\n    <!-- items -->\n    <ul class=\"b-mainpage-seealso-items\">\n        <li\n            class=\"b-mainpage-seealso-item\"\n            ng-repeat=\"suggested in suggest\"\n            >\n            <a\n                ng-href=\"{{suggested.url}}\"\n                class=\"b-mainpage-seealso-link\"\n                data-track-event=\"LJMag:Post:OpenSeeAlso\"\n                >\n                <span\n                    class=\"b-mainpage-seealso-pic\"\n                    ng-if=\"suggested.image\"\n                    ng-style=\"{ backgroundImage: \'url({{suggested.image}})\' }\"\n                    ></span>\n                <span\n                    class=\"b-mainpage-seealso-title\"\n                    lj-html=\"suggested.subject\"\n                    ></span>\n            </a>\n            <span class=\"b-mainpage-seealso-user\" ng-if=\"suggested.user\">\n                <span\n                    lj-user-dynamic=\"suggested.user.username\"\n                    lj-user-dynamic-options=\"{target: \'_blank\'}\"\n                    ></span>\n            </span>\n        </li>\n    </ul><!-- /items -->\n\n</div>\n';
Site.page.template['angular/widgets/authors/posts.ng.tmpl'] = '<!-- author\'s posts -->\n\n<div\n    class=\"\n        b-authorsposts\n        l-flatslide-aside-block\n        \"\n    ng-class=\"{\n        \'b-authorsposts-loading\': state.isLoading,\n        \'b-authorsposts-empty\': !posts.length\n    }\"\n    >\n\n    <!-- head -->\n    <header class=\"b-authorsposts-head\">\n        <h3\n            class=\"b-authorsposts-title\"\n            lj-ml=\"main.authorsposts.head\"\n            >\n        </h3>\n    </header>\n\n    <!-- body -->\n    <div class=\"b-authorsposts-body\">\n\n        <!-- items -->\n        <ul class=\"b-authorsposts-items\">\n\n            <!-- item -->\n            <li class=\"b-authorsposts-item\"\n                ng-repeat=\"post in posts\">\n\n                <!-- link -->\n                <a\n                    class=\"b-authorsposts-link\"\n                    data-track-event=\"LJMag:Post:OpenAnotherPostByAuthor:{{post.user.username}}\"\n                    ng-href=\"{{ post.url }}\"\n                    >\n                    <!-- pic -->\n                    <span\n                        class=\"b-authorsposts-pic\"\n                        style=\"background-image: url({{post.image}});\"\n                        ng-if=\"post.image\"\n                        ></span>\n                    <!-- subject -->\n                    <span\n                        class=\"b-authorsposts-subject\"\n                        lj-html=\"post.subject\"\n                        ></span>\n                </a>\n\n            </li>\n\n        </ul>\n\n        <!-- dummy loader -->\n        <div class=\"b-authorsposts-dummy\">\n            <div class=\"b-authorsposts-dummy-item\">\n                <span class=\"b-authorsposts-dummy-pic\"></span>\n                <div class=\"b-authorsposts-dummy-caption\">\n                    <span class=\"b-authorsposts-dummy-subject\"></span>\n                </div>\n            </div>\n            <div class=\"b-authorsposts-dummy-item\">\n                <span class=\"b-authorsposts-dummy-pic\"></span>\n                <div class=\"b-authorsposts-dummy-caption\">\n                    <span class=\"b-authorsposts-dummy-subject\"></span>\n                </div>\n            </div>\n            <div class=\"b-authorsposts-dummy-item\">\n                <span class=\"b-authorsposts-dummy-pic\"></span>\n                <div class=\"b-authorsposts-dummy-caption\">\n                    <span class=\"b-authorsposts-dummy-subject\"></span>\n                </div>\n            </div>\n        </div>\n\n    </div><!-- /body -->\n\n</div><!-- /authorsposts -->\n\n\n';
LJ.injectStyle('/* >>> file start: stc/lj_gallery.css */\n.b-journalgallery{overflow:hidden;display:block;position:relative;width:100%;margin:0 auto;padding:0 0 70px;font:600 13px/1.1 ProximaNova,Tahoma,Arial,sans-serif;font:600 .8125rem/1.1 ProximaNova,Tahoma,Arial,sans-serif}.b-journalgallery-container{position:relative;margin:0 auto;background:#FFF}.b-journalgallery-picture{position:absolute;top:0;width:100%;margin:0!important;-webkit-transition:.5s cubic-bezier(.25,.25,.75,.75) all;transition:.5s cubic-bezier(.25,.25,.75,.75) all;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;text-align:center}.b-journalgallery-picture::after{content:\'\';display:inline-block;height:100%;margin:0 0 0 -.05em;vertical-align:middle}.b-journalgallery-preloader.svgpreloader{position:absolute;top:50%;left:50%;margin:-8px 0 0 -8px}.b-journalgallery-wrapper{position:absolute;top:0;right:0;bottom:0;left:0;margin:auto;background-size:contain;background-repeat:no-repeat;background-position:50% 50%}.b-journalgallery-hightpriority .b-journalgallery-wrapper{display:inline}.b-journalgallery-image{display:none}.b-journalgallery.b-journalgallery-hightpriority .b-journalgallery-picture .b-journalgallery-wrapper .b-journalgallery-image{width:auto;max-height:100%}.b-journalgallery-caption{position:absolute;top:100%;left:0;right:0;height:70px;margin:0;padding:0;border:0;text-align:center;background:#FFF;color:#829399}.b-journalgallery-caption-title{overflow:hidden;position:absolute;top:0;right:40px;left:40px;height:3.3em;margin:0;padding:10px 2px 0;line-height:1.1}.b-journalgallery-picture-loaded{background-image:none}.b-journalgallery-picture-loaded .b-journalgallery-image{opacity:1}.b-journalgallery-picture-prev{-webkit-transform:translate3d(-100%,0,0);transform:translate3d(-100%,0,0);opacity:0}.b-journalgallery-picture-next{-webkit-transform:translate3d(100%,0,0);transform:translate3d(100%,0,0);opacity:0}.b-journalgallery-picture-current{-webkit-transform:translate3d(0,0,0);transform:translate3d(0,0,0)}.b-journalgallery-counter{position:absolute;bottom:44px;right:0;margin:0;padding:2px;border:0;text-align:right;color:#829399}.b-journalgallery-nav{position:absolute;top:0;bottom:70px;margin:0;padding:0;border:0;cursor:pointer;font:0/0 a}.b-journalgallery-nav:after,.b-journalgallery-nav:before{content:\" \";position:absolute;top:50%;padding:0}.b-journalgallery-nav:before{width:50px;height:50px;margin:-25px 0 0;border:0;border-radius:3px;background:#839399}.b-journalgallery-nav:hover:before{background:#09C}.b-discoveryarticle .b-journalgallery-nav:hover:before{background:#39BF71}.b-journalgallery-nav:after{width:9px;height:16px;margin:-8px 0 0;background:url(/img/icons/journalgallery.png?v=39648) no-repeat}.b-journalgallery-nav-prev{left:0;width:30%}.b-journalgallery-nav-prev::before{left:20px}.b-journalgallery-nav-prev::after{left:40px}.b-journalgallery-nav-next{right:0;width:70%}.b-journalgallery-nav-next::before{right:20px}.b-journalgallery-nav-next::after{right:40px;background-position:0 -17px}@media all and (max-width:480px){.b-journalgallery-nav-prev::before{left:0}.b-journalgallery-nav-prev::after{left:20px}.b-journalgallery-nav-next::before{right:0}.b-journalgallery-nav-next::after{right:20px}}\n/* <<< file end: stc/lj_gallery.css */\n\n/*# sourceMappingURL=lj_gallery.css.map */\n');
angular.module("Discovery.Tags",["LJ.Templates","LJ.Api"]).directive("ljDiscoveryTags",["$compile",function(t){var e=["lj-gallery","[lj-memories]","[lj-lazy]","[lj-share]","[lj-likus]","[lj-cut]","[lj-screenable]","[feed-promo-control]","[feed-promo-click]","[lj-remove-repost]","[lj-quick-comments]","[ng-bind]","[ng-show]","[lj-sticky]"];return{restrict:"A",terminal:!0,link:function(i,n){t(n.find(e.join(",")))(i)}}}]).directive("ljGallery",["$templateCache","$compile",function(t,e){return{restrict:"E",scope:!0,link:function(i,n,l){i.paddingTop=75,i.maxWidth=l.width||2e3,i.maxHeight=l.height||350,i.containersDimensions={paddingTop:i.paddingTop+"%"},i.galleryDimensions={maxWidth:i.maxWidth+"px",maxHeight:i.maxHeight+"px"},i.items=n.find("lj-gallery-item").map(function(){var t=angular.element(this).find("img"),e=angular.element(this).find("a"),n=angular.element(this).find("lj-gallery-item-capture"),a={content:n.html(),src:t.attr("src"),href:e.attr("href")},s=void 0,o=void 0,r=void 0,d=void 0,c=function(){s=t[0].naturalHeight,o=t[0].naturalWidth,r=s/o,d=100*r,d<i.paddingTop&&(i.paddingTop=d,i.containersDimensions.paddingTop=i.paddingTop+"%",!l.width&&o<i.maxWidth&&(i.galleryDimensions.maxWidth=Math.round(i.maxHeight/r)+"px")),a.width=o+"px",a.height=s+"px"};return c(),t[0].addEventListener("load",function(){c()}),a}).toArray(),i.isTall="undefined"!=typeof l.tall,i.next=function(){i.state.index+=1},i.prev=function(){i.state.index-=1},i.state={index:0,total:i.items.length-1},i.isNearby=function(t){return Math.abs(i.state.index-t)<=1},n.html(e(t.get("ljGallery.ng.tmpl"))(i))}}}]).directive("ljSuggest",["Api",function(t){return{templateUrl:"ljSuggest.ng.tmpl",scope:{itemId:"@ljSuggest"},link:function(e){t.call("discovery.suggest",{itemid:e.itemId},{cache:!0}).then(function(t){e.suggest=t.items})}}}]).directive("ljWidgetAuthorsPosts",["Api",function(t){return{templateUrl:"posts.ng.tmpl",scope:{userId:"@ljWidgetAuthorsPosts",itemId:"@ljWidgetAuthorsPostsExclude"},link:function(e){e.state={isLoading:!0},t.call("discovery.author_posts",{itemid:e.itemId,userid:e.userId},{cache:!0}).then(function(t){e.state.isLoading=!1,e.posts=t.items})}}}]);
/* <<< file end: js/discovery/directives.js */

//# map link was there [directives.js.map]
/* >>> file start: js/core/angular/ljUser.js */
//= require js/core/angular/api.js
//= require js/core/angular/users.js
Site.page.template['angular/ljUser.ng.tmpl'] = '<span\n    class=\"\n        ljuser\n        i-ljuser\n        i-ljuser-type-{{user.journaltype}}\n        \"\n    ng-class=\"{\n        \'i-ljuser-deleted\': user.is_invisible,\n        \'i-ljuser-nopopup noctxpopup\': user.noctxpopup,\n        \'i-ljuser-withalias\': user.alias,\n        \'i-ljuser-showalias\': user.showalias\n    }\"\n    data-ljuser=\"{{user.username}}\"\n    lj:user=\"{{user.username}}\"\n    ><!--\n\n    Userhead\n    --><a\n        class=\"i-ljuser-profile\"\n        ng-href=\"{{user.profile_url}}\"\n        ng-attr-target=\"{{user.target ? user.target : \'_self\'}}\"\n        ><!--\n        --><img\n            class=\"i-ljuser-userhead\"\n            ng-src=\"{{user.userhead_url}}\"\n            ><!--\n    --></a><!--\n\n    Username\n    --><a\n        class=\"i-ljuser-username\"\n        ng-href=\"{{user.journal_url}}\"\n        ng-attr-title=\"{{user.display_username || user.alias}}\"\n        ng-attr-target=\"{{user.target ? user.target : \'_self\'}}\"\n        ><b ng-bind=\"user.display_name || user.display_username\"></b></a><!--\n\n    Alias\n    --><span\n        class=\"i-ljuser-alias\"\n        ng-bind=\"user.alias\"\n        ></span><!--\n\n--></span>\n';
!function(){"use strict";function e(e,r,n,t,a,s,u){function l(e){var r=n.defer(),t=u.Cache.get(e);return t&&t.userhead_url?(r.resolve(t),r.promise):u.fetchUser(e,u.USERHEAD_FIELDS,{cache:!0,silent:!0})}function i(e){var r=n.defer(),t=u.Cache.getById(e);return t&&t.userhead_url?(r.resolve(t),r.promise):u.fetchUserById(e,u.USERHEAD_FIELDS,{cache:!0,silent:!0})}function c(r,t){var i=n.defer(),c=e.$new();return l(r).then(function(){var e;c.user=angular.extend({},u.Cache.get(r),t||{}),e=a(d)(c),s(function(){i.resolve(p.empty().append(e).html()),c.$destroy()})}),i.promise}function o(r,t){var l=n.defer(),c=e.$new();return i(r).then(function(){var e;c.user=angular.extend({},u.Cache.getById(r),t||{}),e=a(d)(c),s(function(){l.resolve(p.empty().append(e).html()),c.$destroy()})}),l.promise}var p=angular.element("<div />"),d=t.get("ljUser.ng.tmpl");return{prepare:l,prepareById:i,getById:o,get:c}}function r(e,r,n){return{templateUrl:"ljUser.ng.tmpl",replace:!0,scope:!0,compile:function(t,a){var s=e(a.ljUserDynamic),u=e(a.ljUserDynamicOptions);return function(e){var t=u(e);e.$watch(function(){return s(e)},function(a){var s=a;e.user=angular.extend({username:s,display_username:s},t||{}),n.prepare(s).then(function(){e.$watch(function(){return r.Cache.get(s)},function(r){angular.extend(e.user,r)},!0)})})}}}}function n(e,r,n){return{template:'<img class="{{user.class}}" src="https://l-userpic.livejournal.net/default/{{user.id}}" alt="" />',scope:!0,compile:function(t,a){return function(t){var s=e(a.ljUserAvatarImg)(t),u=e(a.ljUserAvatarImgOptions)(t),l=+s;return NaN!==l&&s.toString().length===l.toString().length?void(t.user=angular.extend({id:s},u||{})):(function(e){return e}(),t.user=angular.extend({username:s},u||{}),void n.prepare(s).then(function(e){t.$watch(function(){return r.Cache.get(s)},function(e){angular.extend(t.user,e)},!0)}))}}}}function t(e,r,n){return{templateUrl:"ljUser.ng.tmpl",replace:!0,scope:!0,compile:function(t,a){return function(t){var s=e(a.ljUserById)(t),u=e(a.ljUserByIdOptions)(t);t.user=angular.extend({username:"user-"+s,display_username:"user-"+s},u||{}),n.prepareById(s).then(function(){t.$watch(function(){return r.Cache.getById(s)},function(e){angular.extend(t.user,e)},!0)})}}}}function a(e){var r="https:";return{templateUrl:"ljUser.ng.tmpl",replace:!0,scope:!0,compile:function(n,t){var a=e(t.ljUserStatic),s=e(t.ljUserStaticId),u=e(t.ljUserStaticOptions);return function(e){var n=a(e),t=s(e),l=u(e)||{},i=l.journal_url||r+"//"+n+".livejournal.com/",c=r+"//"+n+".livejournal.com/profile";"zyalt"===n&&(c=i+"profile",n="varlamov.ru"),e.user={alias:"",display_name:l.display_name||n,display_username:l.display_username||n,id:t,is_invisible:!1,journal_url:i,journaltype:"P",profile_url:c,userhead_url:r+"//l-files.livejournal.net/userhead/default/"+t,username:n,noctxpopup:l.noctxpopup}}}}}function s(e,r){var n="https:";return{template:'\n        <img\n          class="{{user.class}}"\n          ng-src="'+n+'//l-userpic.livejournal.net/default/{{user.id}}"\n          alt=""\n        />',scope:!0,compile:function(r,n){var t=e(n.ljUserAvatarStaticId),a=e(n.ljUserAvatarStaticOptions);return function(e){var r=t(e),n=a(e);e.user={id:r,"class":n["class"]||""}}}}}a.$inject=["$parse"],s.$inject=["$parse","$location"],angular.module("LJ.User",["LJ.Api","LJ.Templates","Users"]),angular.module("LJ.User").factory("ljUser",e).directive("ljUserById",t).directive("ljUserDynamic",r).directive("ljUserAvatarImg",n).directive("ljUserStatic",a).directive("ljUserAvatarStatic",s),e.$inject=["$rootScope","Api","$q","$templateCache","$compile","$timeout","Users"],r.$inject=["$parse","Users","ljUser"],n.$inject=["$parse","Users","ljUser"],t.$inject=["$parse","Users","ljUser"]}();
/* <<< file end: js/core/angular/ljUser.js */

//# map link was there [ljUser.js.map]
/* >>> file start: js/widgets/likus.js */
function _defineProperty(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}var _extends=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e};
//= require js/core/angular/ljUser.js
//= require js/core/angular/api.js
//= require js/core/angular/bubble.js
Site.page.template['angular/widgets/likus/likusMain.ng.tmpl'] = '<a\n    class=\"ljlikus-button ljlikus--like\"\n    ng-class=\"{\'ljlikus--like-active\': likus.liked}\"\n    ng-href=\"#\"\n    ng-click=\"likus.vote($event)\"\n    ng-if=\"likus.show && !likus.link\"\n    ><span class=\"ljlikus-icon\" lj-svg-icon=\"flaticon--like\"></span></a>\n<a\n    class=\"ljlikus-action\"\n    ng-href=\"#\"\n    ng-if=\"likus.show && likus.count && !likus.link\"\n    ng-click=\"likus.countClick($event)\"\n    ng-mouseover=\"likus.countHover($event)\"\n    ><span class=\"ljlikus-counter\">{{likus.formattedCount || likus.count}}</span></a>\n\n<!-- no actions -->\n<a\n    class=\"ljlikus--like ljlikus-no-action\"\n    ng-href=\"{{likus.link}}\"\n    ng-if=\"likus.show && likus.link\"\n    >\n    <span class=\"ljlikus-icon\" lj-svg-icon=\"flaticon--like\"></span>\n    <span\n        class=\"ljlikus-counter\"\n        ng-if=\"likus.show && likus.link && likus.count\"\n        >{{likus.formattedCount || likus.count}}</span>\n</a>\n';
Site.page.template['angular/widgets/likus/likusUsers.ng.tmpl'] = '<ul class=\"ljlikus-list\">\n    <li class=\"ljlikus__item\" ng-repeat=\"user in users.slice(0, 5)\">\n        <span lj-user-by-id=\"user\" lj-user-by-id-options=\"{ noctxpopup: true }\" />\n    </li>\n    <li\n        ng-if=\"count > 5\"\n        class=\"ljlikus__item ljlikus--more\"\n        >\n        <a href=\"#\" class=\"ljlikus__item--more\" ng-click=\"more($event)\">\n            <span lj-ml=\"likus.users.add_more\" lj-ml-resolve=\"{count: count - 5}\" />\n        </a>\n    </li>\n</ul>\n';
Site.page.template['angular/widgets/likus/likusBubble.ng.tmpl'] = '<!-- Bubble -->\n<div class=\"ljlikus-bubble\">\n\n    <!-- header -->\n    <header class=\"ljlikus-bubble__header\">\n        <span class=\"ljlikus-bubble__title\" lj-ml=\"likus.users.title\"></span>\n        <span class=\"ljlikus-counter\">{{likusBubble.count}}</span>\n        <span\n            class=\"ljlikus-bubble__close\"\n            lj-svg-icon=\"flaticon--cross\"\n            ng-click=\"likusBubble.close($event)\"\n        ></span>\n    </header> <!-- /header -->\n\n    <!-- body -->\n    <div class=\"ljlikus-bubble__body\">\n\n        <!-- list -->\n        <ul class=\"ljlikus-list ljlikus-list--full\">\n            <li ng-repeat=\"user in likusBubble.users\" class=\"ljlikus__item\">\n                <span class=\"ljlikus__item-userpic\">\n                    <img ng-src=\"{{likusBubble.getUserImage(user)}}\" alt=\"\" >\n                </span>\n                <div class=\"ljlikus__item-meta\">\n                    <span lj-html=\"user.entry_title\" />\n                    <p class=\"ljlikus__item-usertitle\">{{user.title}}</p>\n                </div>\n                <div class=\"ljlikus__friends-wrap\">\n                    <button class=\"ljlikus__friends\n                                    ljlikus__friends--add\n                                    flatbutton\n                                    flatbutton--small\n                                    flatbutton--neutral\"\n                          ng-class=\"{ \'ljlikus__friends--hide\': user.is_friend }\"\n                          ng-disabled=\"user.updating\"\n                          ng-click=\"likusBubble.toggleFriend(user, true)\"\n                          lj-ml=\"likus.users.add.friends\"\n                    ></button>\n                    <button class=\"ljlikus__friends\n                                    ljlikus__friends--list\n                                    flatbutton\n                                    flatbutton--small\n                                    flatbutton--neutral\"\n                          ng-class=\"{ \'ljlikus__friends--hide\': !user.is_friend }\"\n                          ng-disabled=\"user.updating\"\n                          ng-click=\"likusBubble.toggleFriend(user, false)\">\n                        <span class=\"ljlikus__friends--list-span\"\n                              lj-ml=\"likus.users.friend.list\"\n                        ></span>\n                        <span lj-ml=\"likus.users.friend.remove\"\n                              class=\"ljlikus__friends--remove\"\n                        ></span>\n                    </button>\n                </div>\n            </li>\n            <li\n                class=\"ljlikus__item ljlikus__item--more\"\n                ng-if=\"likusBubble.hasMore\"\n                >\n                <a\n                    class=\"b-flatbutton b-flatbutton-simple\"\n                    href=\"#\"\n                    ng-click=\"likusBubble.loadMore($event)\"\n                    lj-ml=\"likus.users.show.more\"\n                ></a><!--\n            --></li>\n            <li\n                class=\"ljlikus__item ljlikus__item--loading\"\n                ng-if=\"likusBubble.loading\"\n                >\n                <span class=\"svgpreloader-16 svgpreloader-tag\"></span>\n            </li>\n        </ul> <!-- /list -->\n\n    </div> <!-- /body -->\n</div> <!-- /bubble -->\n';
//= require_ml likus.users.add_more
//= require_ml likus.users.sc
//= require_ml likus.users.add.friends
//= require_ml likus.users.friend.list
//= require_ml likus.users.friend.remove
//= require_ml likus.users.title
!function(){"use strict";function e(){return{scope:{noActions:"@ljLikusNoActions",count:"@ljLikusCount",medius:"@ljLikusMedius",journal:"@ljLikusJournal",item:"@ljLikusItem",token:"@ljLikusToken",uri:"@ljLikusUri"},templateUrl:"likusMain.ng.tmpl",controllerAs:"likus",controller:n}}function n(e,n,t,r,i,o,u,s){function l(e){e.preventDefault(),u.close("likus-users"),angular.isFunction(f)&&f(),o.showUsers(_extends({},d),{likes_signature:y})}function a(e){d={journal:e.journal,item:e.item,uniq:e.journal+"-"+e.item},p.count=parseInt(e.count)||0,p.liked=Boolean(e.liked),p.formattedCount=e.short_count,v||Promise.all(e.users.map(function(e){return s.prepareById(e)})).then(function(n){c=[].concat(e.users)})}var c,d,f,g,p=this,v=e.noActions||!1,m=parseInt(e.count)||0,k=e.medius,h=e.journal,b=e.item,j=e.uri||r.LJ.get("currentEntry"),y=e.token||r.LJ.get("likes_signature"),L=r.LJ.Flags.isEnabled("likes"),w=r.LJ.Flags.isEnabled("medius"),J=r.LJ.Flags.isEnabled("likes_display"),_=r.LJ.Flags.isDisabled("homepage_v3"),$=r.LJ.get("remote");angular.element("body");return L?_?void n.remove():k&&!w&&"/"==location.pathname?void n.remove():(h&&b&&(d={journal:h,item:b,uniq:""+h+"-"+b}),!d&&j&&(d={uri:j,uniq:j}),void(d&&y&&(J&&n.removeClass("lj-likus--hidden"),p.show=J,p.count=m,p.liked=!1,p.link=v,o.getVote(d,{token:y,type:v?"short":"full",count:m&&v?m:!1},a).then(a),p.vote=function(e){return e.preventDefault(),$?g?void i.log("You don't want to vote so quickly!"):(g=!0,void o.setVote(_extends({},d),{mark:+p.liked}).then(a).then(function(){g=!1},function(){g=!1})):void LJ.Util.Action.login(e)},p.users=function(n){var r=t.$new();r.users=c,r.count=this.count,r.more=l,f=u.register({name:"likus-users",template:"likusUsers.ng.tmpl",closeControl:!1,closeOnScroll:!0,autoClose:200,tryAsideIfNoHorizSpace:!0},r),u.open("likus-users",angular.element(n.currentTarget)),e.$on("bubble:close:likus-users",f)},p.countHover=function(e){return r.innerWidth<=650?void e.preventDefault():void p.users(e)},p.countClick=function(e){e.preventDefault(),r.innerWidth>650||p.users(e)}))):void n.remove()}function t(){return{scope:!0,templateUrl:"likusBubble.ng.tmpl",controllerAs:"likusBubble",controller:r}}function r(e,n,t,r){function i(){return t.showUsers()}function o(e){return e?(f.addClass(c),s.count=t.getCached(e),void u(e)):(f.removeClass(c),s.users=[],s.count=0,void(a=null))}function u(e){s.loading=!0,s.hasMore=!1,t.getUsers(e,{limit:l,lastid:a}).then(function(e){var n=e.res,t=e.count;s.count=t,s.loading=!1,a=(n[l-1]||{}).id,s.hasMore=!1,s.users=s.users.concat(s.lastid?n.slice(1):n)})}var s=this,l=100,a=null,c="ljlikus-bubble--full",d=n.LJ.Flags.isEnabled("likes"),f=angular.element("body");d&&(s.loading=!1,s.hasMore=!1,s.users=[],s.count=0,s.fader=angular.element(".b-fader"),s.fader.on("click",function(n){s.close(n),e.$apply()}),s.getUserImage=function(e){return e.userpic||LJ.get("siteroot")+"/img/userpics/userpic-user.png"},s.close=function(e){e&&e.preventDefault(),t.showUsers(!1)},s.loadMore=function(e){e.preventDefault(),u(t.showUsers())},s.toggleFriend=function(e,n){e.updating=!0,r.call(n?"relations.addfriend":"relations.removefriend",{target:e.username},{silent:!0}).then(function(){e.updating=!1,e.is_friend=n})},e.$watch(i,o))}function i(e){function n(n){return i[n]=i[n]||new Promise(function(t){var r=e.document.createElement("iframe");r.style="display: none; width: 0; height: 0; border: 0;",r.frameBorder=0,r.src=LJ.get("statprefix")+"/??plain/storage.html?key="+n+"&v="+LJ.get("v"),e.document.body.appendChild(r),r.onload=function(){t(r)}}),i[n]}function t(e,t){n(e).then(function(e){e.contentWindow.postMessage(angular.toJson(t),"*")})}function r(n,t){e.addEventListener("message",function(e){if(e.origin===LJ.get("statprefix")){var n=void 0;try{n=angular.fromJson(e.data||"{}")||{}}catch(r){n={}}t(n)}})}var i={};return{push:t,listen:r}}function o(e,n,t,r,i,o){function u(t,r,i){var o=n.defer(),u=r.token+"#"+r.type;if(r.count){var s=_extends({},t,{count:r.count,liked:!1,users:[]});return k[t.uniq]=r.count,f(s),g(t.uniq,i),o.resolve(s),o.promise}return m.hasOwnProperty(u)||(m[u]={},e(l.bind(null,u),50)),m[u][t.uniq]?m[u][t.uniq].listeners.push(i):m[u][t.uniq]={entity:t,params:r,listeners:[i],resolve:o.resolve,reject:o.reject},o.promise}function s(e,n){var t=_extends({},e,n);return i.call("likes.vote",t).then(function(e){return e.result?(k[t.uniq]=e.result.count,f([e.result]),e.result):(LJ.Messages.error("An error has occurred."),{})})}function l(e){var n=void 0,r=void 0,o=void 0,u=e.split("#")[0],s=e.split("#")[1];return m.hasOwnProperty(e)?(n=m[e],delete m[e],r=Object.keys(n).map(function(e){return n[e].entity}),o={entities:r,mode:"feed",type:s,likes_signature:u},void i.call("likes.get_votes",o,{silent:!0}).then(function(e){var r=e.result;return angular.isArray(r)?(f(r),void r.map(function(e){var t=n[e.uniq];k[e.uniq]=e.count,t&&g(e.journal+"-"+e.item,t.listeners),t&&t.resolve(e)})):void t.log("Unexpected response [getVotes / ljkus]")})):void t.log("Unhandled error [getVotes / ljkus]")}function a(e){return k[e.uniq]||0}function c(e,n){var t=_extends({},e,n);return i.call("likes.get_users",t).then(function(n){return f([{count:n.count,item:e.item,journal:e.journal}]),{res:n.result,count:n.count}})}function d(e,n){return angular.isDefined(e)&&!e&&(h=!1),angular.isObject(e)&&(h=_extends({},e,n)),h}function f(e){if(!angular.isArray(e))return[];var n=Object.values(j).filter(function(e){return e&&e.expire>(new Date).getTime()}),t=n.concat(e).reduce(function(e,n){var t=n.journal+"-"+n.item;return _extends({},e,_defineProperty({},t,_extends({},e[t],n,{users:n.users&&n.users.length?n.users:e[t]&&e[t].users||[],expire:new Date((new Date).getTime()+864e5).getTime()})))},{});return o.push(v,t),t}function g(e,n){Array.isArray(n)||(n=[n]);var t=n.filter(function(e){return angular.isFunction(e)});t.length&&b.push({uniq:e,callbackFunctions:t})}function p(e){j=_extends({},e),b.forEach(function(n){e.hasOwnProperty(n.uniq)&&n.callbackFunctions.forEach(function(t){return t(e[n.uniq])})})}var v="lj-likus",m={},k={},h=!1,b=[],j={};return o.listen(v,p),{getVote:u,setVote:s,getCached:a,getUsers:c,showUsers:d}}i.$inject=["$window"],o.$inject=["$timeout","$q","$log","$window","Api","SyncService"],angular.module("LJ.Likus",["LJ.Directives","LJ.User","LJ.Bubble","LJ.Api"]).run(function(){LJ.Flags.isEnabled("likes_display")&&(angular.element("body").addClass("j-p-likus"),angular.element("[ng-app]").append("<div lj-likus-bubble></div>"))}).factory("SyncService",i).factory("LikusService",o).directive("ljLikus",e).directive("ljLikusBubble",t),n.$inject=["$scope","$element","$rootScope","$window","$log","LikusService","Bubble","ljUser"],r.$inject=["$scope","$window","LikusService","Api"]}();
/* <<< file end: js/widgets/likus.js */

//# map link was there [likus.js.map]
/* >>> file start: js/core/angular/ljMemories.js */
//= require js/core/angular/bubble.js
//= require js/core/angular/api.js
Site.page.template['angular/memories.ng.tmpl'] = '<div ng-controller=\"MemoriesCtrl\">\n\n    <div\n        class=\"b-addtomemories\"\n        ng-class=\"{ \'b-addtomemories-loading\': loading }\"\n        >\n\n        <!-- head -->\n        <h3\n            class=\"b-addtomemories-head\"\n            lj-ml=\"memories.title\"\n            ></h3>\n\n        <!-- intro -->\n        <p class=\"b-addtomemories-intro\">\n            <span\n                ng-show=\"!security\"\n                lj-ml=\"memories.title.add\"\n                ></span>\n            <span\n                ng-show=\"security\"\n                lj-ml=\"memories.title.edit\"\n                ></span>\n        </p>\n\n        <!-- items -->\n        <ul class=\"b-addtomemories-items\">\n\n            <li class=\"b-addtomemories-item\">\n                <label class=\"b-addtomemories-label\">\n                    <input\n                        type=\"radio\"\n                        name=\"security\"\n                        class=\"b-addtomemories-radio\"\n                        value=\"public\"\n                        ng-model=\"security\"\n                        ng-change=\"update()\"\n                        >\n                    <span\n                        class=\"b-addtomemories-title\"\n                        lj-ml=\"memories.security.public\"\n                        ></span>\n                </label>\n            </li>\n\n            <li class=\"b-addtomemories-item\">\n                <label class=\"b-addtomemories-label\">\n                    <input\n                        type=\"radio\"\n                        name=\"security\"\n                        class=\"b-addtomemories-radio\"\n                        value=\"friends\"\n                        ng-model=\"security\"\n                        ng-change=\"update()\"\n                        >\n                    <span\n                        class=\"b-addtomemories-title\"\n                        lj-ml=\"memories.security.friends\"\n                        ></span>\n                </label>\n            </li>\n\n            <li class=\"b-addtomemories-item\">\n                <label class=\"b-addtomemories-label\">\n                    <input\n                        type=\"radio\"\n                        name=\"security\"\n                        class=\"b-addtomemories-radio\"\n                        value=\"private\"\n                        ng-model=\"security\"\n                        ng-change=\"update()\"\n                        >\n                    <span\n                        class=\"b-addtomemories-title\"\n                        lj-ml=\"memories.security.private\"\n                        ></span>\n                </label>\n            </li>\n\n        </ul><!-- /items -->\n\n        <!-- footer -->\n        <div\n            class=\"b-addtomemories-footer\"\n            ng-show=\"removeButton\"\n            >\n            \n            <lj-flatbutton lj-flatbutton=\"[\'button\', \'memories.remove\', \'b-flatbutton b-flatbutton-simple b-flatbutton-red\', \'ng-click\', \'remove()\']\"></lj-flatbutton>\n        </div><!-- /footer -->\n\n        <p class=\"b-addtomemories-options\">\n            <a\n                ng-href=\"{{siteroot}}/tools/memadd.bml?journal={{bubble.options.journal}}&amp;itemid={{bubble.options.ditemid}}\"\n                target=\"_blank\"\n                lj-ml=\"memories.options\"\n                ></a>\n        </p>\n\n    </div><!-- /addtomemories -->\n\n</div>\n';
LJ.injectStyle('/* >>> file start: stc/popup/popup-memories.css */\n.b-addtomemories{width:150px;margin:0;padding:0;text-align:left}.b-addtomemories-head{margin:0 0 .5em;padding:0;font:700 1.13em/1.1 Arial,sans-serif;color:#000}.b-addtomemories-intro{margin:0 0 .3em}.b-addtomemories-items{margin:0;padding:0;list-style:none}.b-addtomemories-item{margin:0;padding:0}.b-addtomemories-label{display:block;margin:0 -5px;padding:5px;cursor:pointer}.b-addtomemories-item:hover .b-addtomemories-label{background:#C8E6FF}.b-addtomemories-footer{margin:1em 0}.b-addtomemories-options{margin:.3em -5px 0;padding:.3em 5px 0;border-top:1px solid #DAE3E6}.b-addtomemories-loading{background:url(/img/preloader/preloader-blue-gray.gif?v=16423) 50% 50% no-repeat}.b-addtomemories-loading .b-addtomemories-footer,.b-addtomemories-loading .b-addtomemories-head,.b-addtomemories-loading .b-addtomemories-intro,.b-addtomemories-loading .b-addtomemories-items,.b-addtomemories-loading .b-addtomemories-options{visibility:hidden}\n/* <<< file end: stc/popup/popup-memories.css */\n\n/*# sourceMappingURL=popup-memories.css.map */\n');
!function(e){angular.module("LJ.Memories",["LJ.Bubble","LJ.Api"]).directive("ljMemories",["$parse","$timeout","Bubble",function(o,t,i){return{scope:{ljMemories:"&"},link:function(o,t){function n(n){n.preventDefault(),i.open("memories",r,e(t)),o.$apply()}var r="function"==typeof o.ljMemories?o.ljMemories({element:t}):o.ljMemories;i.exists("memories")||i.register({name:"memories",template:"memories.ng.tmpl",disableClick:!0,closeOnScroll:r.closeOnScroll}),t.on("click",n),o.$on("$destroy",function(){t.off("click",n)})}}}]).controller("MemoriesCtrl",["$scope","Api",function(o,t){var i=o.bubble;o.security=null,o.$watch("removeButton",function(){e(window).trigger("resize")}),o.$on("bubble:open:memories",function(){t.call("memories.get",i.options,function(e){o.security=e.result?e.result.security:null,o.removeButton=Boolean(o.security)})}),o.$on("bubble:close:memories",function(){o.removeButton=!1}),o.siteroot=LJ.get("siteroot"),o.update=function(){t.call("memories.set",{journal:i.options.journal,ditemid:i.options.ditemid,description:i.options.journal+": "+i.options.title.decodeHTML(),security:o.security},function(e){o.security=e,i.close(),o.removeButton=!0})},o.remove=function(){t.call("memories.remove",{journal:i.options.journal,ditemid:i.options.ditemid},function(){o.security=null,i.close(),o.removeButton=!1})},LJ.Event.on("api:request:change",function(e,t){/^memories/.test(e)&&(o.loading=t)})}])}(jQuery);
/* <<< file end: js/core/angular/ljMemories.js */

//# map link was there [ljMemories.js.map]
/* >>> file start: js/core/angular/ljEmbed.js */
//= require js/core/angular/api.js
Site.page.template['angular/embed.ng.tmpl'] = '<!-- Bubble -->\n<div ng-if=\"embed.show\" class=\"ljembed-bubble\">\n    <button class=\"ljembed-bubble__close\" ng-click=\"embed.close()\" lj-svg-icon=\"flaticon--cross-2\" tabindex=\"1\"></button>\n    <header class=\"ljembed-bubble__header\">\n        <h4 class=\"ljembed-bubble__title\" lj-ml=\"embed.post.title\"></h4>\n        <span class=\"ljembed-bubble__desc\" lj-ml=\"embed.post.desc\"></span>\n        <input\n            class=\"ljembed-bubble__code\"\n            tabindex=\"2\"\n            ng-value=\"embed.code\"\n            onclick=\"this.select()\"\n        />\n        <button class=\"ljembed-bubble-copy\" ng-click=\"embed.copy()\" tabindex=\"3\">\n            <span class=\"ljembed-bubble-copy__icon\" lj-svg-icon=\"flaticon--copy\"></span>\n            <span class=\"ljembed-bubble-copy__text\" lj-ml=\"embed.post.btn.copy\"></span>\n        </button>\n    </header>\n    <div class=\"ljembed-bubble__body\">\n        <div\n            ng-if=\"embed.spinner\"\n            class=\"ljembed-bubble__spinner svgpreloader svgpreloader-pseudo svgpreloader-30\"\n            ng-class=\"{\'ljembed-bubble__spinner--show\': embed.spinner}\">\n        </div>\n        <iframe\n            ng-if=\"!embed.pre\"\n            class=\"ljembed-bubble__preview\"\n            ng-src=\"{{embed.url}}\"\n            width=\"{{embed.width}}\"\n            height=\"{{embed.height}}\"\n            ng-style=\"{ height: embed.height }\"\n        >\n        </iframe>\n    </div>\n</div>\n<!-- /Bubble -->';
//= require_ml embed.post.btn.copy
//= require_ml embed.post.title
//= require_ml embed.post.desc
!function(){function e(){return{scope:!0,templateUrl:"embed.ng.tmpl",controllerAs:"embed",controller:t}}function t(e,t,n,r){function a(t){t.data&&t.data.height&&(i.height=t.data.height,i.spinner=!1,i.code=l(i.plainUrl,i.width,i.height),e.$$phase||e.$apply())}function l(e,t,n){return'<iframe style="max-width: 100%" src="'+e+'" width="'+t+'" height="'+n+'" frameborder="0"></iframe>'}var i=this,o="ljembed-bubble--full",d=angular.element("body");i.show=!1,i.spinner=!0,i.width=502,i.height=252,i.fader=angular.element("[lj-embed-share]"),i.fader.on("click",function(t){return t.target!==t.currentTarget?!1:(i.close(t),void e.$apply())}),i.close=function(e){e&&e.preventDefault(),d.removeClass(o),i.show=!1,i.spinner=!0,i.width=502,i.height=252,n.removeEventListener("message",a)},i.copy=function(e){e&&e.preventDefault();var t=angular.element(".ljembed-bubble__code")[0];t.select();try{return document.execCommand("copy")}catch(n){return console.warn("Copy to clipboard failed.",n),!1}},LJ.Event.on("lj:embed",function(e){d.addClass(o),i.show=!0,i.pre=!0,i.plainUrl=e,i.url=r.trustAsResourceUrl(e),i.code=l(i.plainUrl,i.width,i.height),t(function(){i.pre=!1,n.addEventListener("message",a)},0)})}t.$inject=["$scope","$timeout","$window","$sce"],angular.module("LJ.Embed",["LJ.Directives","LJ.Api"]).run(function(){angular.element("body").addClass("j-p-embed"),angular.element("[ng-app]").append("<div lj-embed-share></div>")}).directive("ljEmbedShare",e)}(jQuery);
/* <<< file end: js/core/angular/ljEmbed.js */

//# map link was there [ljEmbed.js.map]
/* >>> file start: js/core/angular/share.js */
//= require js/core/angular/bubble.js
//= require js/core/string.js
Site.page.template['angular/share.ng.tmpl'] = '<p\n        class=\"b-sharethis-head\"\n        lj-ml=\"sharing.popup.title\"\n></p>\n\n<ul\n        ng-controller=\"ShareBubbleCtrl as share\"\n        class=\"\n        b-sharethis-services\n        b-sharethis-services-{{ share.version }}\n        \"\n>\n    <li\n            ng-if=\"share.ljRepostFlag\"\n            ng-repeat=\"service in share.services\"\n            class=\"\n                b-sharethis-services-item\n                b-sharethis-{{ service.name }}\n                \"\n    >\n        <a\n                ng-if=\"service.name !== \'livejournal\'\"\n                class=\"b-sharethis-services-link\"\n                ng-class=\"{\'b-sharethis-services__open\': isAdvState}\"\n                ng-click=\"share.openPopup($event, service.name, bubble.options.params);\"\n                ng-href=\"{{ service.link }}\"\n                ng-bind=\"service.title\"\n        >\n        </a>\n        <a  ng-if=\"service.name == \'livejournal\'\"\n            class=\"b-sharethis-services-link b-sharethis-services-link--adv\"\n            ng-class=\"{\'b-sharethis-services-link--open\': isAdvState}\"\n            ng-click=\"isToogleAdv()\"\n        >\n            <span class=\"b-sharethis-services-link__title\">{{service.title}}</span>\n            <span class=\"b-sharethis-services-link__dropdown\" lj-svg-icon=\"flaticon--arrow-dropdown\"></span>\n        </a>\n        <div class=\"b-sharethis-services-adv\" ng-if=\"service.name == \'livejournal\'\">\n            <div class=\"b-sharethis-services-adv__wrap\">\n                <a class=\"b-sharethis-services-adv__link\" href=\"#\">Поделиться мнгновенно</a>\n                <a class=\"b-sharethis-services-adv__link\" href=\"#\">Поделиться</a>\n            </div>\n        </div>\n    </li>\n\n    <li\n            ng-if=\"!share.ljRepostFlag\"\n            ng-repeat=\"service in share.services\"\n            class=\"\n                b-sharethis-services-item\n                b-sharethis-{{ service.name }}\n                \"\n    >\n        <div\n            ng-if=\"service.name === \'livejournal\'\"\n            lj-share-button=\"{{share.entryUrl}}\"\n            lj-share-button-title=\"{{service.title}}\"\n        ></div>\n        <a\n            target=\"_blank\"\n            class=\"b-sharethis-services-link\"\n            ng-click=\"share.openPopup($event, service.name, bubble.options.params);\"\n            ng-href=\"{{ service.link }}\"\n            ng-if=\"service.name !== \'livejournal\'\"\n        >\n            <span class=\"b-sharethis-services-link__icon-wrap\">\n                <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"svgicon flaticon flaticon--{{service.name}} b-sharethis-services-link__icon\">\n                    <use ng-href=\"#flaticon--{{service.name}}\" xlink:href=\"\"></use>\n                </svg>\n            </span>\n            <span class=\"b-sharethis-services-link__title\" ng-bind=\"service.title\"></span>\n        </a>\n    </li>\n</ul>';
//= require_ml sharing.popup.title
!function(e){return e}(),function(){"use strict";angular.module("LJ.Share",["LJ.Directives","LJ.Templates","LJ.Bubble"]).config(["$compileProvider",function(e){e.aHrefSanitizationWhitelist(/^\s*(https?|viber):/)}]).directive("ljShare",["Bubble",function(e){return{restrict:"A",scope:!0,link:function(t,r,i){function l(){e.open("share",{params:a,services:n},r),t.$evalAsync()}var a=t.$eval(i.ljShare),n=t.$eval(i.ljShareServices),o=t.$eval(i.ljShareServicesExclude);if(n=n?LJ.String.smartSplit(n):LJ.Social.Share.services(),o=o?LJ.String.smartSplit(o):[],o.length&&(n=n.filter(function(e){return-1===o.indexOf(e)})),n.length){var s=e.register({name:"share",template:"share.ng.tmpl",alwaysBottom:a.alwaysBottom,recalculateOnScroll:i.hasOwnProperty("ljShareScrollable")});r.on("click",l),t.$on("$destroy",function(){r.off("click",l),s()})}}}}]).controller("ShareBubbleCtrl",["$scope","Bubble",function(e,t){var r=this,i=r;this.ljRepostFlag=LJ.Flags.isEnabled("lj_repost"),e.isAdvState=!1,e.$on("bubble:open:share",function(){i.version=LJ.Flags.isEnabled("adaptive_lj_mobile")?"v4":"v3",i.services=e.bubble.options.services.map(function(t){return{name:t,link:LJ.Social.Share.getUrl(t,e.bubble.options.params),title:LJ.Social.Share.getTitle(t)}}),r.entryUrl=e.bubble.options.params.url}),e.isToogleAdv=function(){e.isAdvState=!e.isAdvState},i.openPopup=function(e,r,i){return LJ.Social.Share.isTab(r)?void t.close("share"):(e.preventDefault(),LJ.Social.Share.openPopup(r,i),void t.close("share"))}}])}();
/* <<< file end: js/core/angular/share.js */

//# map link was there [share.js.map]
/* >>> file start: js/lib/jquery.qrcode.min.js */
!function(t){t.fn.qrcode=function(e){function r(t){this.mode=u,this.data=t}function o(t,e){this.typeNumber=t,this.errorCorrectLevel=e,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function n(t,e){if(void 0==t.length)throw Error(t.length+"/"+e);for(var r=0;r<t.length&&0==t[r];)r++;this.num=Array(t.length-r+e);for(var o=0;o<t.length-r;o++)this.num[o]=t[o+r]}function i(t,e){this.totalCount=t,this.dataCount=e}function s(){this.buffer=[],this.length=0}var u;r.prototype={getLength:function(){return this.data.length},write:function(t){for(var e=0;e<this.data.length;e++)t.put(this.data.charCodeAt(e),8)}},o.prototype={addData:function(t){this.dataList.push(new r(t)),this.dataCache=null},isDark:function(t,e){if(0>t||this.moduleCount<=t||0>e||this.moduleCount<=e)throw Error(t+","+e);return this.modules[t][e]},getModuleCount:function(){return this.moduleCount},make:function(){if(1>this.typeNumber){for(var t=1,t=1;40>t;t++){for(var e=i.getRSBlocks(t,this.errorCorrectLevel),r=new s,o=0,n=0;n<e.length;n++)o+=e[n].dataCount;for(n=0;n<this.dataList.length;n++)e=this.dataList[n],r.put(e.mode,4),r.put(e.getLength(),a.getLengthInBits(e.mode,t)),e.write(r);if(r.getLengthInBits()<=8*o)break}this.typeNumber=t}this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(t,e){this.moduleCount=4*this.typeNumber+17,this.modules=Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=Array(this.moduleCount);for(var n=0;n<this.moduleCount;n++)this.modules[r][n]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(t,e),7<=this.typeNumber&&this.setupTypeNumber(t),null==this.dataCache&&(this.dataCache=o.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(t,e){for(var r=-1;7>=r;r++)if(!(-1>=t+r||this.moduleCount<=t+r))for(var o=-1;7>=o;o++)-1>=e+o||this.moduleCount<=e+o||(this.modules[t+r][e+o]=r>=0&&6>=r&&(0==o||6==o)||o>=0&&6>=o&&(0==r||6==r)||r>=2&&4>=r&&o>=2&&4>=o)},getBestMaskPattern:function(){for(var t=0,e=0,r=0;8>r;r++){this.makeImpl(!0,r);var o=a.getLostPoint(this);(0==r||t>o)&&(t=o,e=r)}return e},createMovieClip:function(t,e,r){for(t=t.createEmptyMovieClip(e,r),this.make(),e=0;e<this.modules.length;e++)for(var r=1*e,o=0;o<this.modules[e].length;o++){var n=1*o;this.modules[e][o]&&(t.beginFill(0,100),t.moveTo(n,r),t.lineTo(n+1,r),t.lineTo(n+1,r+1),t.lineTo(n,r+1),t.endFill())}return t},setupTimingPattern:function(){for(var t=8;t<this.moduleCount-8;t++)null==this.modules[t][6]&&(this.modules[t][6]=0==t%2);for(t=8;t<this.moduleCount-8;t++)null==this.modules[6][t]&&(this.modules[6][t]=0==t%2)},setupPositionAdjustPattern:function(){for(var t=a.getPatternPosition(this.typeNumber),e=0;e<t.length;e++)for(var r=0;r<t.length;r++){var o=t[e],n=t[r];if(null==this.modules[o][n])for(var i=-2;2>=i;i++)for(var s=-2;2>=s;s++)this.modules[o+i][n+s]=-2==i||2==i||-2==s||2==s||0==i&&0==s}},setupTypeNumber:function(t){for(var e=a.getBCHTypeNumber(this.typeNumber),r=0;18>r;r++){var o=!t&&1==(e>>r&1);this.modules[Math.floor(r/3)][r%3+this.moduleCount-8-3]=o}for(r=0;18>r;r++)o=!t&&1==(e>>r&1),this.modules[r%3+this.moduleCount-8-3][Math.floor(r/3)]=o},setupTypeInfo:function(t,e){for(var r=a.getBCHTypeInfo(this.errorCorrectLevel<<3|e),o=0;15>o;o++){var n=!t&&1==(r>>o&1);6>o?this.modules[o][8]=n:8>o?this.modules[o+1][8]=n:this.modules[this.moduleCount-15+o][8]=n}for(o=0;15>o;o++)n=!t&&1==(r>>o&1),8>o?this.modules[8][this.moduleCount-o-1]=n:9>o?this.modules[8][15-o-1+1]=n:this.modules[8][15-o-1]=n;this.modules[this.moduleCount-8][8]=!t},mapData:function(t,e){for(var r=-1,o=this.moduleCount-1,n=7,i=0,s=this.moduleCount-1;s>0;s-=2)for(6==s&&s--;;){for(var u=0;2>u;u++)if(null==this.modules[o][s-u]){var h=!1;i<t.length&&(h=1==(t[i]>>>n&1)),a.getMask(e,o,s-u)&&(h=!h),this.modules[o][s-u]=h,n--,-1==n&&(i++,n=7)}if(o+=r,0>o||this.moduleCount<=o){o-=r,r=-r;break}}}},o.PAD0=236,o.PAD1=17,o.createData=function(t,e,r){for(var e=i.getRSBlocks(t,e),n=new s,u=0;u<r.length;u++){var h=r[u];n.put(h.mode,4),n.put(h.getLength(),a.getLengthInBits(h.mode,t)),h.write(n)}for(u=t=0;u<e.length;u++)t+=e[u].dataCount;if(n.getLengthInBits()>8*t)throw Error("code length overflow. ("+n.getLengthInBits()+">"+8*t+")");for(n.getLengthInBits()+4<=8*t&&n.put(0,4);0!=n.getLengthInBits()%8;)n.putBit(!1);for(;!(n.getLengthInBits()>=8*t)&&(n.put(o.PAD0,8),!(n.getLengthInBits()>=8*t));)n.put(o.PAD1,8);return o.createBytes(n,e)},o.createBytes=function(t,e){for(var r=0,o=0,i=0,s=Array(e.length),u=Array(e.length),h=0;h<e.length;h++){var l=e[h].dataCount,g=e[h].totalCount-l,o=Math.max(o,l),i=Math.max(i,g);s[h]=Array(l);for(var f=0;f<s[h].length;f++)s[h][f]=255&t.buffer[f+r];for(r+=l,f=a.getErrorCorrectPolynomial(g),l=new n(s[h],f.getLength()-1).mod(f),u[h]=Array(f.getLength()-1),f=0;f<u[h].length;f++)g=f+l.getLength()-u[h].length,u[h][f]=g>=0?l.get(g):0}for(f=h=0;f<e.length;f++)h+=e[f].totalCount;for(r=Array(h),f=l=0;o>f;f++)for(h=0;h<e.length;h++)f<s[h].length&&(r[l++]=s[h][f]);for(f=0;i>f;f++)for(h=0;h<e.length;h++)f<u[h].length&&(r[l++]=u[h][f]);return r},u=4;for(var a={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(t){for(var e=t<<10;0<=a.getBCHDigit(e)-a.getBCHDigit(a.G15);)e^=a.G15<<a.getBCHDigit(e)-a.getBCHDigit(a.G15);return(t<<10|e)^a.G15_MASK},getBCHTypeNumber:function(t){for(var e=t<<12;0<=a.getBCHDigit(e)-a.getBCHDigit(a.G18);)e^=a.G18<<a.getBCHDigit(e)-a.getBCHDigit(a.G18);return t<<12|e},getBCHDigit:function(t){for(var e=0;0!=t;)e++,t>>>=1;return e},getPatternPosition:function(t){return a.PATTERN_POSITION_TABLE[t-1]},getMask:function(t,e,r){switch(t){case 0:return 0==(e+r)%2;case 1:return 0==e%2;case 2:return 0==r%3;case 3:return 0==(e+r)%3;case 4:return 0==(Math.floor(e/2)+Math.floor(r/3))%2;case 5:return 0==e*r%2+e*r%3;case 6:return 0==(e*r%2+e*r%3)%2;case 7:return 0==(e*r%3+(e+r)%2)%2;default:throw Error("bad maskPattern:"+t)}},getErrorCorrectPolynomial:function(t){for(var e=new n([1],0),r=0;t>r;r++)e=e.multiply(new n([1,h.gexp(r)],0));return e},getLengthInBits:function(t,e){if(e>=1&&10>e)switch(t){case 1:return 10;case 2:return 9;case u:return 8;case 8:return 8;default:throw Error("mode:"+t)}else if(27>e)switch(t){case 1:return 12;case 2:return 11;case u:return 16;case 8:return 10;default:throw Error("mode:"+t)}else{if(!(41>e))throw Error("type:"+e);switch(t){case 1:return 14;case 2:return 13;case u:return 16;case 8:return 12;default:throw Error("mode:"+t)}}},getLostPoint:function(t){for(var e=t.getModuleCount(),r=0,o=0;e>o;o++)for(var n=0;e>n;n++){for(var i=0,s=t.isDark(o,n),u=-1;1>=u;u++)if(!(0>o+u||o+u>=e))for(var a=-1;1>=a;a++)0>n+a||n+a>=e||0==u&&0==a||s==t.isDark(o+u,n+a)&&i++;i>5&&(r+=3+i-5)}for(o=0;e-1>o;o++)for(n=0;e-1>n;n++)i=0,t.isDark(o,n)&&i++,t.isDark(o+1,n)&&i++,t.isDark(o,n+1)&&i++,t.isDark(o+1,n+1)&&i++,(0==i||4==i)&&(r+=3);for(o=0;e>o;o++)for(n=0;e-6>n;n++)t.isDark(o,n)&&!t.isDark(o,n+1)&&t.isDark(o,n+2)&&t.isDark(o,n+3)&&t.isDark(o,n+4)&&!t.isDark(o,n+5)&&t.isDark(o,n+6)&&(r+=40);for(n=0;e>n;n++)for(o=0;e-6>o;o++)t.isDark(o,n)&&!t.isDark(o+1,n)&&t.isDark(o+2,n)&&t.isDark(o+3,n)&&t.isDark(o+4,n)&&!t.isDark(o+5,n)&&t.isDark(o+6,n)&&(r+=40);for(n=i=0;e>n;n++)for(o=0;e>o;o++)t.isDark(o,n)&&i++;return t=Math.abs(100*i/e/e-50)/5,r+10*t}},h={glog:function(t){if(1>t)throw Error("glog("+t+")");return h.LOG_TABLE[t]},gexp:function(t){for(;0>t;)t+=255;for(;t>=256;)t-=255;return h.EXP_TABLE[t]},EXP_TABLE:Array(256),LOG_TABLE:Array(256)},l=0;8>l;l++)h.EXP_TABLE[l]=1<<l;for(l=8;256>l;l++)h.EXP_TABLE[l]=h.EXP_TABLE[l-4]^h.EXP_TABLE[l-5]^h.EXP_TABLE[l-6]^h.EXP_TABLE[l-8];for(l=0;255>l;l++)h.LOG_TABLE[h.EXP_TABLE[l]]=l;return n.prototype={get:function(t){return this.num[t]},getLength:function(){return this.num.length},multiply:function(t){for(var e=Array(this.getLength()+t.getLength()-1),r=0;r<this.getLength();r++)for(var o=0;o<t.getLength();o++)e[r+o]^=h.gexp(h.glog(this.get(r))+h.glog(t.get(o)));return new n(e,0)},mod:function(t){if(0>this.getLength()-t.getLength())return this;for(var e=h.glog(this.get(0))-h.glog(t.get(0)),r=Array(this.getLength()),o=0;o<this.getLength();o++)r[o]=this.get(o);for(o=0;o<t.getLength();o++)r[o]^=h.gexp(h.glog(t.get(o))+e);return new n(r,0).mod(t)}},i.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],i.getRSBlocks=function(t,e){var r=i.getRsBlockTable(t,e);if(void 0==r)throw Error("bad rs block @ typeNumber:"+t+"/errorCorrectLevel:"+e);for(var o=r.length/3,n=[],s=0;o>s;s++)for(var u=r[3*s+0],a=r[3*s+1],h=r[3*s+2],l=0;u>l;l++)n.push(new i(a,h));return n},i.getRsBlockTable=function(t,e){switch(e){case 1:return i.RS_BLOCK_TABLE[4*(t-1)+0];case 0:return i.RS_BLOCK_TABLE[4*(t-1)+1];case 3:return i.RS_BLOCK_TABLE[4*(t-1)+2];case 2:return i.RS_BLOCK_TABLE[4*(t-1)+3]}},s.prototype={get:function(t){return 1==(this.buffer[Math.floor(t/8)]>>>7-t%8&1)},put:function(t,e){for(var r=0;e>r;r++)this.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return this.length},putBit:function(t){var e=Math.floor(this.length/8);this.buffer.length<=e&&this.buffer.push(0),t&&(this.buffer[e]|=128>>>this.length%8),this.length++}},"string"==typeof e&&(e={text:e}),e=t.extend({},{render:"canvas",width:256,height:256,typeNumber:-1,correctLevel:2,background:"#ffffff",foreground:"#000000"},e),this.each(function(){var r;if("canvas"==e.render){r=new o(e.typeNumber,e.correctLevel),r.addData(e.text),r.make();var n=document.createElement("canvas");n.width=e.width,n.height=e.height;for(var i=n.getContext("2d"),s=e.width/r.getModuleCount(),u=e.height/r.getModuleCount(),a=0;a<r.getModuleCount();a++)for(var h=0;h<r.getModuleCount();h++){i.fillStyle=r.isDark(a,h)?e.foreground:e.background;var l=Math.ceil((h+1)*s)-Math.floor(h*s),g=Math.ceil((a+1)*s)-Math.floor(a*s);i.fillRect(Math.round(h*s),Math.round(a*u),l,g)}}else for(r=new o(e.typeNumber,e.correctLevel),r.addData(e.text),r.make(),n=t("<table></table>").css("width",e.width+"px").css("height",e.height+"px").css("border","0px").css("border-collapse","collapse").css("background-color",e.background),i=e.width/r.getModuleCount(),s=e.height/r.getModuleCount(),u=0;u<r.getModuleCount();u++)for(a=t("<tr></tr>").css("height",s+"px").appendTo(n),h=0;h<r.getModuleCount();h++)t("<td></td>").css("width",i+"px").css("background-color",r.isDark(u,h)?e.foreground:e.background).appendTo(a);r=n,jQuery(r).appendTo(this)})}}(jQuery);
/* <<< file end: js/lib/jquery.qrcode.min.js */

//# map link was there [jquery.qrcode.min.js.map]
/* >>> file start: js/widgets/angular/mediusCardPager.js */
!function(){"use strict";function e(){function e(e,r,n,t){var i="[medius-card-pager-next]",l="[medius-card-pager-list]",a="medius-card-pager-disable-arrow-class",s="[medius-card-pager-prev]";t.list=r.find(l),t.nextEl=r.find(i),t.prevEl=r.find(s),t.nextEl.on("click",t.next),t.prevEl.on("click",t.prev),t.arrowDisableClass=t.nextEl.attr(a)||t.prevEl.attr(a),t.init()}return{scope:!0,restrict:"AE",controller:"mediusCardPagerCtrl",controllerAs:"pager",link:e}}function r(e,r,n){function t(e,r){e&&e.toggleClass(C.arrowDisableClass,!!r)}function i(){c=C.list.children().outerWidth(),v=C.list.width(),p=C.list.children().length,g=c*p,e.$watch(u,t.bind(null,C.nextEl)),e.$watch(d,t.bind(null,C.prevEl))}function l(){if(f||u())return void t(C.nextEl,u());if(!(v>=g)){var e=g-v+h;if(e>v){var r=2*c;E.push(r),h-=r}else E.push(e),h-=e;o(h)}}function a(){f=!1,t(C.nextEl,u()),t(C.prevEl,d())}function s(){if(f||d())return void t(C.prevEl,d());var e=E.pop();h+=e,o(h)}function u(){var e=void 0,n=C.list.children();return w>=n.length?!0:(e=n.last(),e.length?e.offset().left+c<=r.innerWidth:!0)}function d(){return!E.length}function o(e){f=!0,C.list.css({marginLeft:e}),n(a,m),n(a,2*m)}var c=0,f=!1,p=0,g=0,v=0,h=0,E=[],m=800,w=0,C=this;C.init=i,C.next=l,C.prev=s,jQuery(window).resize(LJ.Function.debounce(function(){v=C.list.parent().width(),a()},400))}r.$inject=["$scope","$window","$timeout"],angular.module("Medius.CardPager",[]),angular.module("Medius.CardPager").controller("mediusCardPagerCtrl",r).directive("mediusCardPager",e)}();
/* <<< file end: js/widgets/angular/mediusCardPager.js */

//# map link was there [mediusCardPager.js.map]
/* >>> file start: js/widgets/angular/mediusSubscribe.js */
//!= require js/core/angular/messages.js
//= require_ml medius.subscribe.banner.title
//= require_ml medius.subscribe.banner.text
//= require_ml medius.subscribe.button.text
//= require_ml medius.subscribe.subscribed
//= require_ml medius.footer.newsletter
//= require_ml medius.main.subscription.text
//= require_ml medius.main.subscription.success
//= require_ml medius.main.subscription
//= require_ml schemius.medius.subscribe
//= require_ml schemius.medius.subscribetonews
//= require_ml schemius.medius.dailynewsletter
//= require_ml schemius.medius.youremail
//= require_ml schemius.medius.subscribed
//= require_ml schemius.medius.unsubscribe
Site.page.template['Widgets/Medius/subscribe.tmpl'] = '<!-- if subscribed -->\n\n<div class=\"subscription\">\n    <h4 class=\"mdsfooter-section__title\" lj-ml=\"medius.footer.newsletter\"></h4>\n    <header class=\"subscription__header\">\n        <h2 lj-ml=\"medius.subscribe.banner.title\" class=\"subscription__title\"></h2>\n        <p lj-ml=\"medius.subscribe.banner.text\" class=\"subscription__title subscription--subtitle\"></p>\n    </header>\n    <form class=\"subscription__aside\">\n        <button ng-click=\"subscribe.do($event)\" lj-ml=\"medius.subscribe.button.text\" class=\"flatbutton flatbutton--small\"></button>\n    </form>\n</div>\n';
Site.page.template['Widgets/Medius/subscribe137.tmpl'] = '<!-- if subscribed -->\n\n<div \n    class=\"stories__subscription-main story story--size-10by05\"\n    ng-class=\"{\n      \'stories__subscription-main--subscribed\': subscribe.subscribed,\n      \'stories__subscription-main--hide\': subscribe.hide\n    }\"\n    >\n    <div class=\"stories__subscription-main-inner\">\n        <span\n            class=\"stories__subscription-main-text\"\n            lj-ml=\"medius.main.subscription.text\"\n            >\n        </span>\n        <span\n            class=\"stories__subscription-main-success\"\n            lj-ml=\"medius.main.subscription.success\"\n            >\n        </span>\n        <button\n            class=\"flatbutton\"\n            lj-ml=\"medius.main.subscription\"\n            ng-click=\"subscribe.do($event)\" \n            >\n        </button>\n    </div>\n</div>\n';
Site.page.template['Widgets/Medius/schemius_header_subscribe.tmpl'] = '<header\n    class=\"\n        s-header-menu-head\n        s-header-menu-subscription__head\n        \"\n    >\n    <span\n        class=\"s-header-menu-head__title\"\n        ><!--\n        --><span\n            class=\"s-header-menu-head__title--long\"\n            lj-ml=\"schemius.medius.subscribetonews\"\n            ></span><!--\n        --><span\n            class=\"s-header-menu-head__title--short\"\n            lj-ml=\"schemius.medius.dailynewsletter\"\n            ></span><!--\n    --></span>\n</header>\n\n<div\n    class=\"s-header-menu-subscription__body\"\n    >\n\n    <div\n        class=\"\n            s-header-menu-subscription__unsubscribed\n            s-header-menu-subscription-unsubscribed\n            \"\n        >\n        <button\n            type=\"submit\"\n            class=\"s-header-menu-subscription-unsubscribed__button\"\n            ng-click=\"subscribe.do($event)\"\n            lj-ml=\"schemius.medius.subscribe\"\n            ></button>\n    </div>\n\n    <div\n        class=\"\n            s-header-menu-subscription__subscribed\n            s-header-menu-subscription-subscribed\n            \"\n        >\n        <span\n            class=\"s-header-menu-subscription-subscribed__icon\"\n            lj-svg-icon=\"flaticon--check\"\n            ></span>\n        <h3\n            class=\"s-header-menu-subscription-subscribed__title\"\n            lj-ml=\"schemius.medius.subscribed\"\n            ></h3>\n    </div>\n</div>\n';
!function(){"use strict";function e(e,i){function s(i){return LJ.get("is_subscribed")?void 0:LJ.get("remote")?e.call("discovery.subscribe",null,{silent:!0}).then(r.hideWidget)["catch"](t):LJ.Util.Action.login(i)}function t(e){var s=e.message;"Access Denied"===s?LJ.Util.Action.login():i.add({type:"error",body:s})}var r=this;r["do"]=s}function i(){function e(e,i,s,t){var r=LJ.get("is_subscribed");return t.widget=i,t.hideWidget=function(e){var i=e.status;"OK"===i&&t.widget.addClass("stories__subscription--hidden")},r||angular.isUndefined(r)?t.hideWidget({status:"OK"}):void 0}return{restrict:"AE",templateUrl:"subscribe.tmpl",controller:"mediusSubscribeCtrl",controllerAs:"subscribe",link:e}}function s(e){function i(i,s,t,r){var u=LJ.get("is_subscribed");return r.widget=s,r.hideWidget=function(i){var s=i.status;"OK"===s&&(r.subscribed=!0,e(function(){r.hide=!0},3e3))},u||angular.isUndefined(u)?r.hideWidget({status:"OK"}):void 0}return{restrict:"AE",templateUrl:"subscribe137.tmpl",controller:"mediusSubscribeCtrl",controllerAs:"subscribe",link:i}}function t(e){function i(e,i,s,t){t.widget=i,t.subscribed=LJ.get("is_subscribed"),t.hideWidget=function(e){var i=e.status;"OK"===i&&(t.subscribed=!0)}}return{restrict:"AE",templateUrl:"schemius_header_subscribe.tmpl",controller:"mediusSubscribeCtrl",controllerAs:"subscribe",link:i}}e.$inject=["Api","Messages"],s.$inject=["$timeout"],t.$inject=["$timeout"],angular.module("Medius.Subscribe",["LJ.Messages","LJ.Api"]),angular.module("Medius.Subscribe").controller("mediusSubscribeCtrl",e).directive("mediusSubscribe",i).directive("mediusSubscribe137",s).directive("mediusSchemiusHeaderSubscribe",t),LJ.Flags.isEnabled("medius_schemius")&&angular.element(window.document).ready(function(){angular.bootstrap(".s-header-menu-subscription",["Medius.Subscribe"])})}();
/* <<< file end: js/widgets/angular/mediusSubscribe.js */

//# map link was there [mediusSubscribe.js.map]
/* >>> file start: js/widgets/angular/mediusFooter.js */
!function(){function t(){function t(){u.list=angular.element(s),a=u.list.children().length}function e(){r()||(c++,i(-1*u.columnWidth))}function n(){o()||(c--,i(u.columnWidth))}function i(t){var e=u.list.css("marginLeft");e=Number(e.toString().match(/(-?\d+)/)[1]),u.list.animate({marginLeft:e+t},300)}function r(){return c===a-2}function o(){return!c}var u=this,l=".stories__categories-column",a=0,c=0,s=".stories__categories-list";u.next=e,u.prev=n,u.disableNext=r,u.disablePrev=o,Object.defineProperty(u,"columnWidth",{get:function(){return angular.element(l).width()}}),t()}angular.module("Medius.Footer",[]),angular.module("Medius.Footer").controller("MediusFooterCategoriesCtrl",t)}();
/* <<< file end: js/widgets/angular/mediusFooter.js */

//# map link was there [mediusFooter.js.map]
/* >>> file start: js/node_modules/moment/min/moment.min.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t,e){"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.moment=e()}(this,function(){"use strict";function t(){return Pn.apply(null,arguments)}function e(t){Pn=t}function n(t){return"[object Array]"===Object.prototype.toString.call(t)}function i(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function r(t,e){var n,i=[];for(n=0;n<t.length;++n)i.push(e(t[n],n));return i}function s(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function o(t,e){for(var n in e)s(e,n)&&(t[n]=e[n]);return s(e,"toString")&&(t.toString=e.toString),s(e,"valueOf")&&(t.valueOf=e.valueOf),t}function a(t,e,n,i){return Ot(t,e,n,i,!0).utc()}function u(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function d(t){return null==t._pf&&(t._pf=u()),t._pf}function l(t){if(null==t._isValid){var e=d(t);t._isValid=!(isNaN(t._d.getTime())||!(e.overflow<0)||e.empty||e.invalidMonth||e.invalidWeekday||e.nullInput||e.invalidFormat||e.userInvalidated),t._strict&&(t._isValid=t._isValid&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour)}return t._isValid}function c(t){var e=a(NaN);return null!=t?o(d(e),t):d(e).userInvalidated=!0,e}function f(t,e){var n,i,r;if("undefined"!=typeof e._isAMomentObject&&(t._isAMomentObject=e._isAMomentObject),"undefined"!=typeof e._i&&(t._i=e._i),"undefined"!=typeof e._f&&(t._f=e._f),"undefined"!=typeof e._l&&(t._l=e._l),"undefined"!=typeof e._strict&&(t._strict=e._strict),"undefined"!=typeof e._tzm&&(t._tzm=e._tzm),"undefined"!=typeof e._isUTC&&(t._isUTC=e._isUTC),"undefined"!=typeof e._offset&&(t._offset=e._offset),"undefined"!=typeof e._pf&&(t._pf=d(e)),"undefined"!=typeof e._locale&&(t._locale=e._locale),Hn.length>0)for(n in Hn)i=Hn[n],r=e[i],"undefined"!=typeof r&&(t[i]=r);return t}function h(e){f(this,e),this._d=new Date(null!=e._d?e._d.getTime():NaN),Ln===!1&&(Ln=!0,t.updateOffset(this),Ln=!1)}function m(t){return t instanceof h||null!=t&&null!=t._isAMomentObject}function _(t){return 0>t?Math.ceil(t):Math.floor(t)}function y(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=_(e)),n}function p(t,e,n){var i,r=Math.min(t.length,e.length),s=Math.abs(t.length-e.length),o=0;for(i=0;r>i;i++)(n&&t[i]!==e[i]||!n&&y(t[i])!==y(e[i]))&&o++;return o+s}function g(){}function v(t){return t?t.toLowerCase().replace("_","-"):t}function D(t){for(var e,n,i,r,s=0;s<t.length;){for(r=v(t[s]).split("-"),e=r.length,n=v(t[s+1]),n=n?n.split("-"):null;e>0;){if(i=M(r.slice(0,e).join("-")))return i;if(n&&n.length>=e&&p(r,n,!0)>=e-1)break;e--}s++}return null}function M(t){var e=null;if(!In[t]&&"undefined"!=typeof module&&module&&module.exports)try{e=xn._abbr,require("./locale/"+t),Y(e)}catch(n){}return In[t]}function Y(t,e){var n;return t&&(n="undefined"==typeof e?S(t):w(t,e),n&&(xn=n)),xn._abbr}function w(t,e){return null!==e?(e.abbr=t,In[t]=In[t]||new g,In[t].set(e),Y(t),In[t]):(delete In[t],null)}function S(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return xn;if(!n(t)){if(e=M(t))return e;t=[t]}return D(t)}function k(t,e){var n=t.toLowerCase();An[n]=An[n+"s"]=An[e]=t}function T(t){return"string"==typeof t?An[t]||An[t.toLowerCase()]:void 0}function b(t){var e,n,i={};for(n in t)s(t,n)&&(e=T(n),e&&(i[e]=t[n]));return i}function O(e,n){return function(i){return null!=i?(W(this,e,i),t.updateOffset(this,n),this):U(this,e)}}function U(t,e){return t._d["get"+(t._isUTC?"UTC":"")+e]()}function W(t,e,n){return t._d["set"+(t._isUTC?"UTC":"")+e](n)}function C(t,e){var n;if("object"==("undefined"==typeof t?"undefined":_typeof(t)))for(n in t)this.set(n,t[n]);else if(t=T(t),"function"==typeof this[t])return this[t](e);return this}function G(t,e,n){var i=""+Math.abs(t),r=e-i.length,s=t>=0;return(s?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}function F(t,e,n,i){var r=i;"string"==typeof i&&(r=function(){return this[i]()}),t&&(jn[t]=r),e&&(jn[e[0]]=function(){return G(r.apply(this,arguments),e[1],e[2])}),n&&(jn[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function P(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function x(t){var e,n,i=t.match(zn);for(e=0,n=i.length;n>e;e++)jn[i[e]]?i[e]=jn[i[e]]:i[e]=P(i[e]);return function(r){var s="";for(e=0;n>e;e++)s+=i[e]instanceof Function?i[e].call(r,t):i[e];return s}}function H(t,e){return t.isValid()?(e=L(e,t.localeData()),Zn[e]=Zn[e]||x(e),Zn[e](t)):t.localeData().invalidDate()}function L(t,e){function n(t){return e.longDateFormat(t)||t}var i=5;for(Nn.lastIndex=0;i>=0&&Nn.test(t);)t=t.replace(Nn,n),Nn.lastIndex=0,i-=1;return t}function I(t){return"function"==typeof t&&"[object Function]"===Object.prototype.toString.call(t)}function A(t,e,n){ri[t]=I(e)?e:function(t){return t&&n?n:e}}function z(t,e){return s(ri,t)?ri[t](e._strict,e._locale):new RegExp(N(t))}function N(t){return t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,i,r){return e||n||i||r}).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Z(t,e){var n,i=e;for("string"==typeof t&&(t=[t]),"number"==typeof e&&(i=function(t,n){n[e]=y(t)}),n=0;n<t.length;n++)si[t[n]]=i}function j(t,e){Z(t,function(t,n,i,r){i._w=i._w||{},e(t,i._w,i,r)})}function E(t,e,n){null!=e&&s(si,t)&&si[t](e,n._a,n,t)}function V(t,e){return new Date(Date.UTC(t,e+1,0)).getUTCDate()}function q(t){return this._months[t.month()]}function J(t){return this._monthsShort[t.month()]}function $(t,e,n){var i,r,s;for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;12>i;i++){if(r=a([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),n||this._monthsParse[i]||(s="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(s.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[i].test(t))return i;if(n&&"MMM"===e&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function R(t,e){var n;return"string"==typeof e&&(e=t.localeData().monthsParse(e),"number"!=typeof e)?t:(n=Math.min(t.date(),V(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t)}function B(e){return null!=e?(R(this,e),t.updateOffset(this,!0),this):U(this,"Month")}function Q(){return V(this.year(),this.month())}function X(t){var e,n=t._a;return n&&-2===d(t).overflow&&(e=n[ai]<0||n[ai]>11?ai:n[ui]<1||n[ui]>V(n[oi],n[ai])?ui:n[di]<0||n[di]>24||24===n[di]&&(0!==n[li]||0!==n[ci]||0!==n[fi])?di:n[li]<0||n[li]>59?li:n[ci]<0||n[ci]>59?ci:n[fi]<0||n[fi]>999?fi:-1,d(t)._overflowDayOfYear&&(oi>e||e>ui)&&(e=ui),d(t).overflow=e),t}function K(e){t.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}function tt(t,e){var n=!0;return o(function(){return n&&(K(t+"\n"+(new Error).stack),n=!1),e.apply(this,arguments)},e)}function et(t,e){_i[t]||(K(e),_i[t]=!0)}function nt(t){var e,n,i=t._i,r=yi.exec(i);if(r){for(d(t).iso=!0,e=0,n=pi.length;n>e;e++)if(pi[e][1].exec(i)){t._f=pi[e][0];break}for(e=0,n=gi.length;n>e;e++)if(gi[e][1].exec(i)){t._f+=(r[6]||" ")+gi[e][0];break}i.match(ei)&&(t._f+="Z"),Mt(t)}else t._isValid=!1}function it(e){var n=vi.exec(e._i);return null!==n?void(e._d=new Date(+n[1])):(nt(e),void(e._isValid===!1&&(delete e._isValid,t.createFromInputFallback(e))))}function rt(t,e,n,i,r,s,o){var a=new Date(t,e,n,i,r,s,o);return 1970>t&&a.setFullYear(t),a}function st(t){var e=new Date(Date.UTC.apply(null,arguments));return 1970>t&&e.setUTCFullYear(t),e}function ot(t){return at(t)?366:365}function at(t){return t%4===0&&t%100!==0||t%400===0}function ut(){return at(this.year())}function dt(t,e,n){var i,r=n-e,s=n-t.day();return s>r&&(s-=7),r-7>s&&(s+=7),i=Ut(t).add(s,"d"),{week:Math.ceil(i.dayOfYear()/7),year:i.year()}}function lt(t){return dt(t,this._week.dow,this._week.doy).week}function ct(){return this._week.dow}function ft(){return this._week.doy}function ht(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")}function mt(t){var e=dt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")}function _t(t,e,n,i,r){var s,o=6+r-i,a=st(t,0,1+o),u=a.getUTCDay();return r>u&&(u+=7),n=null!=n?1*n:r,s=1+o+7*(e-1)-u+n,{year:s>0?t:t-1,dayOfYear:s>0?s:ot(t-1)+s}}function yt(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")}function pt(t,e,n){return null!=t?t:null!=e?e:n}function gt(t){var e=new Date;return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function vt(t){var e,n,i,r,s=[];if(!t._d){for(i=gt(t),t._w&&null==t._a[ui]&&null==t._a[ai]&&Dt(t),t._dayOfYear&&(r=pt(t._a[oi],i[oi]),t._dayOfYear>ot(r)&&(d(t)._overflowDayOfYear=!0),n=st(r,0,t._dayOfYear),t._a[ai]=n.getUTCMonth(),t._a[ui]=n.getUTCDate()),e=0;3>e&&null==t._a[e];++e)t._a[e]=s[e]=i[e];for(;7>e;e++)t._a[e]=s[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[di]&&0===t._a[li]&&0===t._a[ci]&&0===t._a[fi]&&(t._nextDay=!0,t._a[di]=0),t._d=(t._useUTC?st:rt).apply(null,s),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[di]=24)}}function Dt(t){var e,n,i,r,s,o,a;e=t._w,null!=e.GG||null!=e.W||null!=e.E?(s=1,o=4,n=pt(e.GG,t._a[oi],dt(Ut(),1,4).year),i=pt(e.W,1),r=pt(e.E,1)):(s=t._locale._week.dow,o=t._locale._week.doy,n=pt(e.gg,t._a[oi],dt(Ut(),s,o).year),i=pt(e.w,1),null!=e.d?(r=e.d,s>r&&++i):r=null!=e.e?e.e+s:s),a=_t(n,i,r,o,s),t._a[oi]=a.year,t._dayOfYear=a.dayOfYear}function Mt(e){if(e._f===t.ISO_8601)return void nt(e);e._a=[],d(e).empty=!0;var n,i,r,s,o,a=""+e._i,u=a.length,l=0;for(r=L(e._f,e._locale).match(zn)||[],n=0;n<r.length;n++)s=r[n],i=(a.match(z(s,e))||[])[0],i&&(o=a.substr(0,a.indexOf(i)),o.length>0&&d(e).unusedInput.push(o),a=a.slice(a.indexOf(i)+i.length),l+=i.length),jn[s]?(i?d(e).empty=!1:d(e).unusedTokens.push(s),E(s,i,e)):e._strict&&!i&&d(e).unusedTokens.push(s);d(e).charsLeftOver=u-l,a.length>0&&d(e).unusedInput.push(a),d(e).bigHour===!0&&e._a[di]<=12&&e._a[di]>0&&(d(e).bigHour=void 0),e._a[di]=Yt(e._locale,e._a[di],e._meridiem),vt(e),X(e)}function Yt(t,e,n){var i;return null==n?e:null!=t.meridiemHour?t.meridiemHour(e,n):null!=t.isPM?(i=t.isPM(n),i&&12>e&&(e+=12),i||12!==e||(e=0),e):e}function wt(t){var e,n,i,r,s;if(0===t._f.length)return d(t).invalidFormat=!0,void(t._d=new Date(NaN));for(r=0;r<t._f.length;r++)s=0,e=f({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[r],Mt(e),l(e)&&(s+=d(e).charsLeftOver,s+=10*d(e).unusedTokens.length,d(e).score=s,(null==i||i>s)&&(i=s,n=e));o(t,n||e)}function St(t){if(!t._d){var e=b(t._i);t._a=[e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],vt(t)}}function kt(t){var e=new h(X(Tt(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Tt(t){var e=t._i,r=t._f;return t._locale=t._locale||S(t._l),null===e||void 0===r&&""===e?c({nullInput:!0}):("string"==typeof e&&(t._i=e=t._locale.preparse(e)),m(e)?new h(X(e)):(n(r)?wt(t):r?Mt(t):i(e)?t._d=e:bt(t),t))}function bt(e){var s=e._i;void 0===s?e._d=new Date:i(s)?e._d=new Date(+s):"string"==typeof s?it(e):n(s)?(e._a=r(s.slice(0),function(t){return parseInt(t,10)}),vt(e)):"object"==("undefined"==typeof s?"undefined":_typeof(s))?St(e):"number"==typeof s?e._d=new Date(s):t.createFromInputFallback(e)}function Ot(t,e,n,i,r){var s={};return"boolean"==typeof n&&(i=n,n=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=r,s._l=n,s._i=t,s._f=e,s._strict=i,kt(s)}function Ut(t,e,n,i){return Ot(t,e,n,i,!1)}function Wt(t,e){var i,r;if(1===e.length&&n(e[0])&&(e=e[0]),!e.length)return Ut();for(i=e[0],r=1;r<e.length;++r)(!e[r].isValid()||e[r][t](i))&&(i=e[r]);return i}function Ct(){var t=[].slice.call(arguments,0);return Wt("isBefore",t)}function Gt(){var t=[].slice.call(arguments,0);return Wt("isAfter",t)}function Ft(t){var e=b(t),n=e.year||0,i=e.quarter||0,r=e.month||0,s=e.week||0,o=e.day||0,a=e.hour||0,u=e.minute||0,d=e.second||0,l=e.millisecond||0;this._milliseconds=+l+1e3*d+6e4*u+36e5*a,this._days=+o+7*s,this._months=+r+3*i+12*n,this._data={},this._locale=S(),this._bubble()}function Pt(t){return t instanceof Ft}function xt(t,e){F(t,0,0,function(){var t=this.utcOffset(),n="+";return 0>t&&(t=-t,n="-"),n+G(~~(t/60),2)+e+G(~~t%60,2)})}function Ht(t){var e=(t||"").match(ei)||[],n=e[e.length-1]||[],i=(n+"").match(Si)||["-",0,0],r=+(60*i[1])+y(i[2]);return"+"===i[0]?r:-r}function Lt(e,n){var r,s;return n._isUTC?(r=n.clone(),s=(m(e)||i(e)?+e:+Ut(e))-+r,r._d.setTime(+r._d+s),t.updateOffset(r,!1),r):Ut(e).local()}function It(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function At(e,n){var i,r=this._offset||0;return null!=e?("string"==typeof e&&(e=Ht(e)),Math.abs(e)<16&&(e=60*e),!this._isUTC&&n&&(i=It(this)),this._offset=e,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==e&&(!n||this._changeInProgress?ee(this,Bt(e-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,t.updateOffset(this,!0),this._changeInProgress=null)),this):this._isUTC?r:It(this)}function zt(t,e){return null!=t?("string"!=typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function Nt(t){return this.utcOffset(0,t)}function Zt(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(It(this),"m")),this}function jt(){return this._tzm?this.utcOffset(this._tzm):"string"==typeof this._i&&this.utcOffset(Ht(this._i)),this}function Et(t){return t=t?Ut(t).utcOffset():0,(this.utcOffset()-t)%60===0}function Vt(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qt(){if("undefined"!=typeof this._isDSTShifted)return this._isDSTShifted;var t={};if(f(t,this),t=Tt(t),t._a){var e=t._isUTC?a(t._a):Ut(t._a);this._isDSTShifted=this.isValid()&&p(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Jt(){return!this._isUTC}function $t(){return this._isUTC}function Rt(){return this._isUTC&&0===this._offset}function Bt(t,e){var n,i,r,o=t,a=null;return Pt(t)?o={ms:t._milliseconds,d:t._days,M:t._months}:"number"==typeof t?(o={},e?o[e]=t:o.milliseconds=t):(a=ki.exec(t))?(n="-"===a[1]?-1:1,o={y:0,d:y(a[ui])*n,h:y(a[di])*n,m:y(a[li])*n,s:y(a[ci])*n,ms:y(a[fi])*n}):(a=Ti.exec(t))?(n="-"===a[1]?-1:1,o={y:Qt(a[2],n),M:Qt(a[3],n),d:Qt(a[4],n),h:Qt(a[5],n),m:Qt(a[6],n),s:Qt(a[7],n),w:Qt(a[8],n)}):null==o?o={}:"object"==("undefined"==typeof o?"undefined":_typeof(o))&&("from"in o||"to"in o)&&(r=Kt(Ut(o.from),Ut(o.to)),o={},o.ms=r.milliseconds,o.M=r.months),i=new Ft(o),Pt(t)&&s(t,"_locale")&&(i._locale=t._locale),i}function Qt(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Xt(t,e){var n={milliseconds:0,months:0};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function Kt(t,e){var n;return e=Lt(e,t),t.isBefore(e)?n=Xt(t,e):(n=Xt(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n}function te(t,e){return function(n,i){var r,s;return null===i||isNaN(+i)||(et(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period)."),s=n,n=i,i=s),n="string"==typeof n?+n:n,r=Bt(n,i),ee(this,r,t),this}}function ee(e,n,i,r){var s=n._milliseconds,o=n._days,a=n._months;r=null==r?!0:r,s&&e._d.setTime(+e._d+s*i),o&&W(e,"Date",U(e,"Date")+o*i),a&&R(e,U(e,"Month")+a*i),r&&t.updateOffset(e,o||a)}function ne(t,e){var n=t||Ut(),i=Lt(n,this).startOf("day"),r=this.diff(i,"days",!0),s=-6>r?"sameElse":-1>r?"lastWeek":0>r?"lastDay":1>r?"sameDay":2>r?"nextDay":7>r?"nextWeek":"sameElse";return this.format(e&&e[s]||this.localeData().calendar(s,this,Ut(n)))}function ie(){return new h(this)}function re(t,e){var n;return e=T("undefined"!=typeof e?e:"millisecond"),"millisecond"===e?(t=m(t)?t:Ut(t),+this>+t):(n=m(t)?+t:+Ut(t),n<+this.clone().startOf(e))}function se(t,e){var n;return e=T("undefined"!=typeof e?e:"millisecond"),"millisecond"===e?(t=m(t)?t:Ut(t),+t>+this):(n=m(t)?+t:+Ut(t),+this.clone().endOf(e)<n)}function oe(t,e,n){return this.isAfter(t,n)&&this.isBefore(e,n)}function ae(t,e){var n;return e=T(e||"millisecond"),"millisecond"===e?(t=m(t)?t:Ut(t),+this===+t):(n=+Ut(t),+this.clone().startOf(e)<=n&&n<=+this.clone().endOf(e))}function ue(t,e,n){var i,r,s=Lt(t,this),o=6e4*(s.utcOffset()-this.utcOffset());return e=T(e),"year"===e||"month"===e||"quarter"===e?(r=de(this,s),"quarter"===e?r/=3:"year"===e&&(r/=12)):(i=this-s,r="second"===e?i/1e3:"minute"===e?i/6e4:"hour"===e?i/36e5:"day"===e?(i-o)/864e5:"week"===e?(i-o)/6048e5:i),n?r:_(r)}function de(t,e){var n,i,r=12*(e.year()-t.year())+(e.month()-t.month()),s=t.clone().add(r,"months");return 0>e-s?(n=t.clone().add(r-1,"months"),i=(e-s)/(s-n)):(n=t.clone().add(r+1,"months"),i=(e-s)/(n-s)),-(r+i)}function le(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function ce(){var t=this.clone().utc();return 0<t.year()&&t.year()<=9999?"function"==typeof Date.prototype.toISOString?this.toDate().toISOString():H(t,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):H(t,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}function fe(e){var n=H(this,e||t.defaultFormat);return this.localeData().postformat(n)}function he(t,e){return this.isValid()?Bt({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function me(t){return this.from(Ut(),t)}function _e(t,e){return this.isValid()?Bt({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function ye(t){return this.to(Ut(),t)}function pe(t){var e;return void 0===t?this._locale._abbr:(e=S(t),null!=e&&(this._locale=e),this)}function ge(){return this._locale}function ve(t){switch(t=T(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this}function De(t){return t=T(t),void 0===t||"millisecond"===t?this:this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms")}function Me(){return+this._d-6e4*(this._offset||0)}function Ye(){return Math.floor(+this/1e3)}function we(){return this._offset?new Date(+this):this._d}function Se(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function ke(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Te(){return l(this)}function be(){return o({},d(this))}function Oe(){return d(this).overflow}function Ue(t,e){F(0,[t,t.length],0,e)}function We(t,e,n){return dt(Ut([t,11,31+e-n]),e,n).week}function Ce(t){var e=dt(this,this.localeData()._week.dow,this.localeData()._week.doy).year;return null==t?e:this.add(t-e,"y")}function Ge(t){var e=dt(this,1,4).year;return null==t?e:this.add(t-e,"y")}function Fe(){return We(this.year(),1,4)}function Pe(){var t=this.localeData()._week;return We(this.year(),t.dow,t.doy)}function xe(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)}function He(t,e){return"string"!=typeof t?t:isNaN(t)?(t=e.weekdaysParse(t),"number"==typeof t?t:null):parseInt(t,10)}function Le(t){return this._weekdays[t.day()]}function Ie(t){return this._weekdaysShort[t.day()]}function Ae(t){return this._weekdaysMin[t.day()]}function ze(t){var e,n,i;for(this._weekdaysParse=this._weekdaysParse||[],e=0;7>e;e++)if(this._weekdaysParse[e]||(n=Ut([2e3,1]).day(e),i="^"+this.weekdays(n,"")+"|^"+this.weekdaysShort(n,"")+"|^"+this.weekdaysMin(n,""),this._weekdaysParse[e]=new RegExp(i.replace(".",""),"i")),this._weekdaysParse[e].test(t))return e}function Ne(t){var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=He(t,this.localeData()),this.add(t-e,"d")):e}function Ze(t){var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")}function je(t){return null==t?this.day()||7:this.day(this.day()%7?t:t-7)}function Ee(t,e){F(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function Ve(t,e){return e._meridiemParse}function qe(t){return"p"===(t+"").toLowerCase().charAt(0)}function Je(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}function $e(t,e){e[fi]=y(1e3*("0."+t))}function Re(){return this._isUTC?"UTC":""}function Be(){return this._isUTC?"Coordinated Universal Time":""}function Qe(t){return Ut(1e3*t)}function Xe(){return Ut.apply(null,arguments).parseZone()}function Ke(t,e,n){var i=this._calendar[t];return"function"==typeof i?i.call(e,n):i}function tn(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])}function en(){return this._invalidDate}function nn(t){return this._ordinal.replace("%d",t)}function rn(t){return t}function sn(t,e,n,i){var r=this._relativeTime[n];return"function"==typeof r?r(t,e,n,i):r.replace(/%d/i,t)}function on(t,e){var n=this._relativeTime[t>0?"future":"past"];return"function"==typeof n?n(e):n.replace(/%s/i,e)}function an(t){var e,n;for(n in t)e=t[n],"function"==typeof e?this[n]=e:this["_"+n]=e;this._ordinalParseLenient=new RegExp(this._ordinalParse.source+"|"+/\d{1,2}/.source)}function un(t,e,n,i){var r=S(),s=a().set(i,e);return r[n](s,t)}function dn(t,e,n,i,r){if("number"==typeof t&&(e=t,t=void 0),t=t||"",null!=e)return un(t,e,n,r);var s,o=[];for(s=0;i>s;s++)o[s]=un(t,s,n,r);return o}function ln(t,e){return dn(t,e,"months",12,"month")}function cn(t,e){return dn(t,e,"monthsShort",12,"month")}function fn(t,e){return dn(t,e,"weekdays",7,"day")}function hn(t,e){return dn(t,e,"weekdaysShort",7,"day")}function mn(t,e){return dn(t,e,"weekdaysMin",7,"day")}function _n(){var t=this._data;return this._milliseconds=Ri(this._milliseconds),this._days=Ri(this._days),this._months=Ri(this._months),t.milliseconds=Ri(t.milliseconds),t.seconds=Ri(t.seconds),t.minutes=Ri(t.minutes),t.hours=Ri(t.hours),t.months=Ri(t.months),t.years=Ri(t.years),this}function yn(t,e,n,i){var r=Bt(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function pn(t,e){return yn(this,t,e,1)}function gn(t,e){return yn(this,t,e,-1)}function vn(t){return 0>t?Math.floor(t):Math.ceil(t)}function Dn(){var t,e,n,i,r,s=this._milliseconds,o=this._days,a=this._months,u=this._data;return s>=0&&o>=0&&a>=0||0>=s&&0>=o&&0>=a||(s+=864e5*vn(Yn(a)+o),o=0,a=0),u.milliseconds=s%1e3,t=_(s/1e3),u.seconds=t%60,e=_(t/60),u.minutes=e%60,n=_(e/60),u.hours=n%24,o+=_(n/24),r=_(Mn(o)),a+=r,o-=vn(Yn(r)),i=_(a/12),a%=12,u.days=o,u.months=a,u.years=i,this}function Mn(t){return 4800*t/146097}function Yn(t){return 146097*t/4800}function wn(t){var e,n,i=this._milliseconds;if(t=T(t),"month"===t||"year"===t)return e=this._days+i/864e5,n=this._months+Mn(e),"month"===t?n:n/12;switch(e=this._days+Math.round(Yn(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return 24*e+i/36e5;case"minute":return 1440*e+i/6e4;case"second":return 86400*e+i/1e3;case"millisecond":return Math.floor(864e5*e)+i;default:throw new Error("Unknown unit "+t)}}function Sn(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*y(this._months/12)}function kn(t){return function(){return this.as(t)}}function Tn(t){return t=T(t),this[t+"s"]()}function bn(t){return function(){return this._data[t]}}function On(){return _(this.days()/7)}function Un(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function Wn(t,e,n){var i=Bt(t).abs(),r=cr(i.as("s")),s=cr(i.as("m")),o=cr(i.as("h")),a=cr(i.as("d")),u=cr(i.as("M")),d=cr(i.as("y")),l=r<fr.s&&["s",r]||1===s&&["m"]||s<fr.m&&["mm",s]||1===o&&["h"]||o<fr.h&&["hh",o]||1===a&&["d"]||a<fr.d&&["dd",a]||1===u&&["M"]||u<fr.M&&["MM",u]||1===d&&["y"]||["yy",d];return l[2]=e,l[3]=+t>0,l[4]=n,Un.apply(null,l)}function Cn(t,e){return void 0===fr[t]?!1:void 0===e?fr[t]:(fr[t]=e,!0)}function Gn(t){var e=this.localeData(),n=Wn(this,!t,e);return t&&(n=e.pastFuture(+this,n)),e.postformat(n)}function Fn(){var t,e,n,i=hr(this._milliseconds)/1e3,r=hr(this._days),s=hr(this._months);t=_(i/60),e=_(t/60),i%=60,t%=60,n=_(s/12),s%=12;var o=n,a=s,u=r,d=e,l=t,c=i,f=this.asSeconds();return f?(0>f?"-":"")+"P"+(o?o+"Y":"")+(a?a+"M":"")+(u?u+"D":"")+(d||l||c?"T":"")+(d?d+"H":"")+(l?l+"M":"")+(c?c+"S":""):"P0D"}var Pn,xn,Hn=t.momentProperties=[],Ln=!1,In={},An={},zn=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Nn=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Zn={},jn={},En=/\d/,Vn=/\d\d/,qn=/\d{3}/,Jn=/\d{4}/,$n=/[+-]?\d{6}/,Rn=/\d\d?/,Bn=/\d{1,3}/,Qn=/\d{1,4}/,Xn=/[+-]?\d{1,6}/,Kn=/\d+/,ti=/[+-]?\d+/,ei=/Z|[+-]\d\d:?\d\d/gi,ni=/[+-]?\d+(\.\d{1,3})?/,ii=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,ri={},si={},oi=0,ai=1,ui=2,di=3,li=4,ci=5,fi=6;F("M",["MM",2],"Mo",function(){return this.month()+1}),F("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),F("MMMM",0,0,function(t){return this.localeData().months(this,t)}),k("month","M"),A("M",Rn),A("MM",Rn,Vn),A("MMM",ii),A("MMMM",ii),Z(["M","MM"],function(t,e){e[ai]=y(t)-1}),Z(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);null!=r?e[ai]=r:d(n).invalidMonth=t});var hi="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),mi="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),_i={};t.suppressDeprecationWarnings=!1;var yi=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,pi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],gi=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],vi=/^\/?Date\((\-?\d+)/i;t.createFromInputFallback=tt("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),F(0,["YY",2],0,function(){return this.year()%100}),F(0,["YYYY",4],0,"year"),F(0,["YYYYY",5],0,"year"),F(0,["YYYYYY",6,!0],0,"year"),k("year","y"),A("Y",ti),A("YY",Rn,Vn),A("YYYY",Qn,Jn),A("YYYYY",Xn,$n),A("YYYYYY",Xn,$n),Z(["YYYYY","YYYYYY"],oi),Z("YYYY",function(e,n){n[oi]=2===e.length?t.parseTwoDigitYear(e):y(e)}),Z("YY",function(e,n){n[oi]=t.parseTwoDigitYear(e)}),t.parseTwoDigitYear=function(t){return y(t)+(y(t)>68?1900:2e3)};var Di=O("FullYear",!1);F("w",["ww",2],"wo","week"),F("W",["WW",2],"Wo","isoWeek"),k("week","w"),k("isoWeek","W"),A("w",Rn),A("ww",Rn,Vn),A("W",Rn),A("WW",Rn,Vn),j(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=y(t)});var Mi={dow:0,doy:6};F("DDD",["DDDD",3],"DDDo","dayOfYear"),k("dayOfYear","DDD"),A("DDD",Bn),A("DDDD",qn),Z(["DDD","DDDD"],function(t,e,n){n._dayOfYear=y(t)}),t.ISO_8601=function(){};var Yi=tt("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(){var t=Ut.apply(null,arguments);return this>t?this:t}),wi=tt("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(){var t=Ut.apply(null,arguments);return t>this?this:t});xt("Z",":"),xt("ZZ",""),A("Z",ei),A("ZZ",ei),Z(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Ht(t)});var Si=/([\+\-]|\d\d)/gi;t.updateOffset=function(){};var ki=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Ti=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/;Bt.fn=Ft.prototype;var bi=te(1,"add"),Oi=te(-1,"subtract");t.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";var Ui=tt("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});F(0,["gg",2],0,function(){return this.weekYear()%100}),F(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ue("gggg","weekYear"),Ue("ggggg","weekYear"),Ue("GGGG","isoWeekYear"),Ue("GGGGG","isoWeekYear"),k("weekYear","gg"),k("isoWeekYear","GG"),A("G",ti),A("g",ti),A("GG",Rn,Vn),A("gg",Rn,Vn),A("GGGG",Qn,Jn),A("gggg",Qn,Jn),A("GGGGG",Xn,$n),A("ggggg",Xn,$n),j(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=y(t)}),j(["gg","GG"],function(e,n,i,r){n[r]=t.parseTwoDigitYear(e)}),F("Q",0,0,"quarter"),k("quarter","Q"),A("Q",En),Z("Q",function(t,e){e[ai]=3*(y(t)-1)}),F("D",["DD",2],"Do","date"),k("date","D"),A("D",Rn),A("DD",Rn,Vn),A("Do",function(t,e){return t?e._ordinalParse:e._ordinalParseLenient}),Z(["D","DD"],ui),Z("Do",function(t,e){e[ui]=y(t.match(Rn)[0],10)});var Wi=O("Date",!0);F("d",0,"do","day"),F("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),F("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),F("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),F("e",0,0,"weekday"),F("E",0,0,"isoWeekday"),k("day","d"),k("weekday","e"),k("isoWeekday","E"),A("d",Rn),A("e",Rn),A("E",Rn),A("dd",ii),A("ddd",ii),A("dddd",ii),j(["dd","ddd","dddd"],function(t,e,n){var i=n._locale.weekdaysParse(t);null!=i?e.d=i:d(n).invalidWeekday=t}),j(["d","e","E"],function(t,e,n,i){e[i]=y(t)});var Ci="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Gi="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Fi="Su_Mo_Tu_We_Th_Fr_Sa".split("_");F("H",["HH",2],0,"hour"),F("h",["hh",2],0,function(){return this.hours()%12||12}),Ee("a",!0),Ee("A",!1),k("hour","h"),A("a",Ve),A("A",Ve),A("H",Rn),A("h",Rn),A("HH",Rn,Vn),A("hh",Rn,Vn),Z(["H","HH"],di),Z(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t}),Z(["h","hh"],function(t,e,n){e[di]=y(t),d(n).bigHour=!0});var Pi=/[ap]\.?m?\.?/i,xi=O("Hours",!0);F("m",["mm",2],0,"minute"),k("minute","m"),A("m",Rn),A("mm",Rn,Vn),Z(["m","mm"],li);var Hi=O("Minutes",!1);F("s",["ss",2],0,"second"),k("second","s"),A("s",Rn),A("ss",Rn,Vn),Z(["s","ss"],ci);var Li=O("Seconds",!1);F("S",0,0,function(){return~~(this.millisecond()/100)}),F(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),F(0,["SSS",3],0,"millisecond"),F(0,["SSSS",4],0,function(){return 10*this.millisecond()}),F(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),F(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),F(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),F(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),F(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),k("millisecond","ms"),A("S",Bn,En),A("SS",Bn,Vn),A("SSS",Bn,qn);var Ii;for(Ii="SSSS";Ii.length<=9;Ii+="S")A(Ii,Kn);for(Ii="S";Ii.length<=9;Ii+="S")Z(Ii,$e);var Ai=O("Milliseconds",!1);F("z",0,0,"zoneAbbr"),F("zz",0,0,"zoneName");var zi=h.prototype;zi.add=bi,zi.calendar=ne,zi.clone=ie,zi.diff=ue,zi.endOf=De,zi.format=fe,zi.from=he,zi.fromNow=me,zi.to=_e,zi.toNow=ye,zi.get=C,zi.invalidAt=Oe,zi.isAfter=re,zi.isBefore=se,zi.isBetween=oe,zi.isSame=ae,zi.isValid=Te,zi.lang=Ui,zi.locale=pe,zi.localeData=ge,zi.max=wi,zi.min=Yi,zi.parsingFlags=be,zi.set=C,zi.startOf=ve,zi.subtract=Oi,zi.toArray=Se,zi.toObject=ke,zi.toDate=we,zi.toISOString=ce,zi.toJSON=ce,zi.toString=le,
zi.unix=Ye,zi.valueOf=Me,zi.year=Di,zi.isLeapYear=ut,zi.weekYear=Ce,zi.isoWeekYear=Ge,zi.quarter=zi.quarters=xe,zi.month=B,zi.daysInMonth=Q,zi.week=zi.weeks=ht,zi.isoWeek=zi.isoWeeks=mt,zi.weeksInYear=Pe,zi.isoWeeksInYear=Fe,zi.date=Wi,zi.day=zi.days=Ne,zi.weekday=Ze,zi.isoWeekday=je,zi.dayOfYear=yt,zi.hour=zi.hours=xi,zi.minute=zi.minutes=Hi,zi.second=zi.seconds=Li,zi.millisecond=zi.milliseconds=Ai,zi.utcOffset=At,zi.utc=Nt,zi.local=Zt,zi.parseZone=jt,zi.hasAlignedHourOffset=Et,zi.isDST=Vt,zi.isDSTShifted=qt,zi.isLocal=Jt,zi.isUtcOffset=$t,zi.isUtc=Rt,zi.isUTC=Rt,zi.zoneAbbr=Re,zi.zoneName=Be,zi.dates=tt("dates accessor is deprecated. Use date instead.",Wi),zi.months=tt("months accessor is deprecated. Use month instead",B),zi.years=tt("years accessor is deprecated. Use year instead",Di),zi.zone=tt("moment().zone is deprecated, use moment().utcOffset instead. https://github.com/moment/moment/issues/1779",zt);var Ni=zi,Zi={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},ji={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ei="Invalid date",Vi="%d",qi=/\d{1,2}/,Ji={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},$i=g.prototype;$i._calendar=Zi,$i.calendar=Ke,$i._longDateFormat=ji,$i.longDateFormat=tn,$i._invalidDate=Ei,$i.invalidDate=en,$i._ordinal=Vi,$i.ordinal=nn,$i._ordinalParse=qi,$i.preparse=rn,$i.postformat=rn,$i._relativeTime=Ji,$i.relativeTime=sn,$i.pastFuture=on,$i.set=an,$i.months=q,$i._months=hi,$i.monthsShort=J,$i._monthsShort=mi,$i.monthsParse=$,$i.week=lt,$i._week=Mi,$i.firstDayOfYear=ft,$i.firstDayOfWeek=ct,$i.weekdays=Le,$i._weekdays=Ci,$i.weekdaysMin=Ae,$i._weekdaysMin=Fi,$i.weekdaysShort=Ie,$i._weekdaysShort=Gi,$i.weekdaysParse=ze,$i.isPM=qe,$i._meridiemParse=Pi,$i.meridiem=Je,Y("en",{ordinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=1===y(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th";return t+n}}),t.lang=tt("moment.lang is deprecated. Use moment.locale instead.",Y),t.langData=tt("moment.langData is deprecated. Use moment.localeData instead.",S);var Ri=Math.abs,Bi=kn("ms"),Qi=kn("s"),Xi=kn("m"),Ki=kn("h"),tr=kn("d"),er=kn("w"),nr=kn("M"),ir=kn("y"),rr=bn("milliseconds"),sr=bn("seconds"),or=bn("minutes"),ar=bn("hours"),ur=bn("days"),dr=bn("months"),lr=bn("years"),cr=Math.round,fr={s:45,m:45,h:22,d:26,M:11},hr=Math.abs,mr=Ft.prototype;mr.abs=_n,mr.add=pn,mr.subtract=gn,mr.as=wn,mr.asMilliseconds=Bi,mr.asSeconds=Qi,mr.asMinutes=Xi,mr.asHours=Ki,mr.asDays=tr,mr.asWeeks=er,mr.asMonths=nr,mr.asYears=ir,mr.valueOf=Sn,mr._bubble=Dn,mr.get=Tn,mr.milliseconds=rr,mr.seconds=sr,mr.minutes=or,mr.hours=ar,mr.days=ur,mr.weeks=On,mr.months=dr,mr.years=lr,mr.humanize=Gn,mr.toISOString=Fn,mr.toString=Fn,mr.toJSON=Fn,mr.locale=pe,mr.localeData=ge,mr.toIsoString=tt("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Fn),mr.lang=Ui,F("X",0,0,"unix"),F("x",0,0,"valueOf"),A("x",ti),A("X",ni),Z("X",function(t,e,n){n._d=new Date(1e3*parseFloat(t,10))}),Z("x",function(t,e,n){n._d=new Date(y(t))}),t.version="2.10.6",e(Ut),t.fn=Ni,t.min=Ct,t.max=Gt,t.utc=a,t.unix=Qe,t.months=ln,t.isDate=i,t.locale=Y,t.invalid=c,t.duration=Bt,t.isMoment=m,t.weekdays=fn,t.parseZone=Xe,t.localeData=S,t.isDuration=Pt,t.monthsShort=cn,t.weekdaysMin=mn,t.defineLocale=w,t.weekdaysShort=hn,t.normalizeUnits=T,t.relativeTimeThreshold=Cn;var _r=t;return _r});
/* <<< file end: js/node_modules/moment/min/moment.min.js */

//# map link was there [moment.min.js.map]
/* >>> file start: js/node_modules/moment/locale/ru.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module?t(require("../moment")):"function"==typeof define&&define.amd?define(["moment"],t):t(e.moment)}(this,function(e){"use strict";function t(e,t){var n=e.split("_");return t%10===1&&t%100!==11?n[0]:t%10>=2&&4>=t%10&&(10>t%100||t%100>=20)?n[1]:n[2]}function n(e,n,_){var i={mm:n?"минута_минуты_минут":"минуту_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"};return"m"===_?n?"минута":"минуту":e+" "+t(i[_],+e)}function _(e,t){var n={nominative:"январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),accusative:"января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_")},_=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(t)?"accusative":"nominative";return n[_][e.month()]}function i(e,t){var n={nominative:"янв_фев_март_апр_май_июнь_июль_авг_сен_окт_ноя_дек".split("_"),accusative:"янв_фев_мар_апр_мая_июня_июля_авг_сен_окт_ноя_дек".split("_")},_=/D[oD]?(\[[^\[\]]*\]|\s+)+MMMM?/.test(t)?"accusative":"nominative";return n[_][e.month()]}function d(e,t){var n={nominative:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),accusative:"воскресенье_понедельник_вторник_среду_четверг_пятницу_субботу".split("_")},_=/\[ ?[Вв] ?(?:прошлую|следующую|эту)? ?\] ?dddd/.test(t)?"accusative":"nominative";return n[_][e.day()]}var r=e.defineLocale("ru",{months:_,monthsShort:i,weekdays:d,weekdaysShort:"вс_пн_вт_ср_чт_пт_сб".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),monthsParse:[/^янв/i,/^фев/i,/^мар/i,/^апр/i,/^ма[й|я]/i,/^июн/i,/^июл/i,/^авг/i,/^сен/i,/^окт/i,/^ноя/i,/^дек/i],longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., HH:mm",LLLL:"dddd, D MMMM YYYY г., HH:mm"},calendar:{sameDay:"[Сегодня в] LT",nextDay:"[Завтра в] LT",lastDay:"[Вчера в] LT",nextWeek:function(){return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT"},lastWeek:function(e){if(e.week()===this.week())return 2===this.day()?"[Во] dddd [в] LT":"[В] dddd [в] LT";switch(this.day()){case 0:return"[В прошлое] dddd [в] LT";case 1:case 2:case 4:return"[В прошлый] dddd [в] LT";case 3:case 5:case 6:return"[В прошлую] dddd [в] LT"}},sameElse:"L"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:n,mm:n,h:"час",hh:n,d:"день",dd:n,M:"месяц",MM:n,y:"год",yy:n},meridiemParse:/ночи|утра|дня|вечера/i,isPM:function(e){return/^(дня|вечера)$/.test(e)},meridiem:function(e,t,n){return 4>e?"ночи":12>e?"утра":17>e?"дня":"вечера"},ordinalParse:/\d{1,2}-(й|го|я)/,ordinal:function(e,t){switch(t){case"M":case"d":case"DDD":return e+"-й";case"D":return e+"-го";case"w":case"W":return e+"-я";default:return e}},week:{dow:1,doy:7}});return r});
/* <<< file end: js/node_modules/moment/locale/ru.js */

//# map link was there [ru.js.map]
/* >>> file start: js/widgets/angular/mediusTimeAgo.js */
//= require js/node_modules/moment/min/moment.min.js
//= require js/node_modules/moment/locale/ru.js
!function(){function e(){function e(e,i){var t=LJ.get("server_time")-moment().unix(),m=moment.unix(e.timeAgo-t).locale("ru");moment.locale("ru",{relativeTime:{future:"через %s",past:"%s назад",s:"%d с.",m:"%d мин.",mm:"%d мин.",h:"%d ч.",hh:"%d ч.",d:"%d д.",dd:"%d д.",M:"%d м.",MM:"%d м.",y:"%d г.",yy:"%d г."}}),m.isValid()&&(e.timeAgoText=m.fromNow(!0),i.attr("title",m.calendar()))}return{template:"{{timeAgoText}}",scope:{timeAgo:"@mediusTimeAgo"},link:e,restrict:"AE"}}angular.module("Medius.TimeAgo",[]),angular.module("Medius.TimeAgo").directive("mediusTimeAgo",e)}();
/* <<< file end: js/widgets/angular/mediusTimeAgo.js */

//# map link was there [mediusTimeAgo.js.map]
/* >>> file start: js/widgets/angular/mediusShareButtons.js */
//= require js/node_modules/moment/min/moment.min.js
//= require js/node_modules/moment/locale/ru.js
!function(t){"use strict";function e(e,n){function i(t,e){if(t){var n={facebook:"fbsharing",vkontakte:"vksharing",odnoklassniki:"oksharing",twitter:"twsharing"};if(!n[e])return t;var i=~t.indexOf("?")?"&":"?";return""+t+i+"utm_source="+n[e]+"&utm_medium=social"}}function r(t){var r=t.title,a=t.service,c=t.text,u=t.link;return c=c||"",r=r||e.document.title,u=u||e.location.href,"livejournal"===a?LJ.get("remote")?n.call("repost.create",{url:u,timezone:s}):(LJ.Util.Action.login(),Promise.resolve()):new Promise(function(t){var e=l[a]({title:r,text:c,link:i(u,a)});o(e,{allowScrollbars:"pocket"===a}),t()})}function o(t){var n=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],i=n.allowScrollbars||!1,r=i?1:0;e.open(t,"","left="+(u.width-630)/2+",top="+(u.height-440)/2+",toolbar=0,status=0,scrollbars="+r+",menubar=0,location=0,width=630,height=440")}var l,a={},s=t().format("ZZ");a.share=r;var c=e.encodeURIComponent.bind(e),u=e.screen||{width:1e3,height:1e3};return l={facebook:function(t){var e=t.link;return"https://www.facebook.com/sharer.php?u="+c(e)},livejournal:function(t){var e=t.text,n=t.title,i=t.link;return"https://livejournal.com/update.bml?subject="+c(n)+"&event="+c('<a href="'+i+'">'+n+"</a> "+e)},twitter:function(t){var e=t.link,n=t.title;return"https://twitter.com/share?text="+c(n)+"&via=livejournalru&url="+c(e)},vkontakte:function(t){var e=t.link,n=t.title,i=t.text;return"https://vk.com/share.php?url="+c(e)+"&title="+c(n)+"&description="+c(i)},odnoklassniki:function(t){var e=t.link,n=t.title;return"https://www.odnoklassniki.ru/dk?st.cmd=addShare&st.s=1&st.comments="+c(n)+"&st._surl="+c(e)},mailru:function(t){var e=t.link,n=t.title,i=t.text;return"https://connect.mail.ru/share?url="+c(e)+"&title="+c(n)+"&description="+c(i)},pocket:function(t){var e=t.link,n=t.title;return"https://getpocket.com/save?url="+c(e)+"&title="+c(n)},tumblr:function(t){var e=t.link,n=t.title,i=t.text;return"https://www.tumblr.com/widgets/share/tool?canonicalUrl="+c(e)+"&title="+c(n)+"&caption="+c(i)+"&posttype=link"}},a}function n(t,e){var n=this;n.bottomPanel={},n.bottomPanel.visible=!0,t.$on("mediusSharings:bottomInited",function(){e(function(){n.bottomPanel=t.bottomPanelVisible},100)})}function i(t){function e(e,n){n.one("click",function(n){n&&(n.preventDefault(),n.stopPropagation()),t.share(e).then(LJ.Event.emit.bind(LJ.Event,"Sharings:add")).then(function(){var t=LJ.get("entry"),n=t.ditemid,i=t.poster;LJ.Track.event("Medius","Post","Share",e.service,i,n)})})}return{restrict:"AE",scope:{service:"@",text:"@",title:"@",link:"@"},link:e}}function r(t){function e(e,n){function i(){var t=n.position().top+n.height()>r.scrollTop()+l-a;t!==s&&(s=t,e.bottomPanelVisible.visible=!s)}var r=angular.element(t),o=LJ.get("ljlive").is_enabled,l=t.innerHeight;e.bottomPanelVisible={};var a=0,s=void 0;o&&r.width()>650&&(a=50),r.scroll(function(){i(),e.$apply()}),i(),e.$broadcast("mediusSharings:bottomInited")}return{link:e}}function o(){return{controllerAs:"stickyShare",controller:n}}e.$inject=["$window","Api"],i.$inject=["shareService"],angular.module("Medius.ShareButtons",["LJ.Api"]),angular.module("Medius.ShareButtons").factory("shareService",e).controller("ShareCtrl",n).directive("mediusShareButton",i).directive("stickyPanel",o).directive("shareBottomPanel",r),n.$inject=["$scope","$timeout"],r.$inject=["$window"]}(moment);
/* <<< file end: js/widgets/angular/mediusShareButtons.js */

//# map link was there [mediusShareButtons.js.map]
/* >>> file start: js/widgets/sharings.js */
//!= require js/entry/likes.js
//!= require js/core/social-caching.js
Site.page.template['angular/widgets/sharings.ng.tmpl'] = '<div>\n  <span class=\"mdspost-social__share-value\">{{sharings.count}}</span>\n  <span lj-ml=\"medius.entry.shared\"></span>\n</div>\n';
//= require_ml medius.entry.shared
!function(){"use strict";function n(n){return function(t){try{return n(t)}catch(e){return console.warn(e),0}}}function t(t,e,r){function o(n){function t(n,e,r){var o=n[0],u=n.slice(1);return r=r||window,u.length?t(u,e,r[o]={}):r[o]=e}var r=n.page,o=n.jsonpUrlPrefix,u=n.callbackFnPath,c=n.utmMark,a=n.shtype,i=r.split("?")[0],s=u[0];return new Promise(function(n){LJ.SocialCaching.get(i,function(n){n=n.split("?")[0];var r=["","?media","?utm_source="+c+"&utm_medium=social","?media&utm_source="+c+"&utm_medium=social"],a=r.map(function(t){return n+t}),i=a.map(function(n){return new Promise(function(r){var c=void 0;angular.isObject(window[s])&&(c=window[s]),t(u,function(n,t){r(Number(t)||0),c&&(window[s]=c)}),e.jsonp(""+o+encodeURIComponent(n)+"&callback=JSON_CALLBACK")}).then(function(n){return Number(n)||0})["catch"](function(){return 0})});return Promise.all(i).then(function(n){return n.reduce(function(n,t){return n+t},0)})},a).then(function(t){return n(Number(t)||0)})["catch"](function(){return 0})})}function u(n){return new Promise(function(t){return l?t(l):p?void p.push(t):(p=[t],a(n).then(function(n){return p.forEach(function(t){t(n)}),p=[],n}))})}function c(n,t){return LJ.get("remote")?(h!==t&&(h=t,r.call("entry.set_sharings",{count:t,url:n},{silent:!0})),t):t}function a(n){var t=Object.keys(f);return Promise.all(t.map(function(t){return f[t].count(n)})).then(function(n){return n.reduce(function(n,e,r){return n[t[r]]=e,n},{})})["catch"](s(0))}function i(n){return u(n).then(function(n){return Object.values(n).reduce(function(n,t){return n+=Number(t)},0)})["catch"](s(0))}function s(n){return function(){return n}}var l,h,p,m=encodeURIComponent(t.location.href),f={};return f.facebook={count:function(t){return t=t||m,LJ.SocialCaching.get(t,function(t){return e.jsonp("https://graph.facebook.com/?id="+encodeURIComponent(t)+"&callback=JSON_CALLBACK").then(n(function(n){return Number(n.data.share&&n.data.share.share_count||n.data.shares||0)}))},"fb")["catch"](s(0))}},f.twitter={count:function(n){return new Promise(function(n,t){n(0)}).then(function(n){return n})}},f.vkontakte={count:function(n){return n=n||m,LJ.define("VK.Share"),o({page:n,jsonpUrlPrefix:"https://vk.com/share.php?act=count&index=1&url=",callbackFnPath:["VK","Share","count"],utmMark:"vksharing",shtype:"vk"})}},f.odnoklassniki={count:function(n){return n=n||m,o({page:n,jsonpUrlPrefix:"https://connect.ok.ru/dk?st.cmd=extLike&uid=1&ref=",callbackFnPath:["ODKL","updateCount"],utmMark:"oksharing",shtype:"ok"})}},f.googleplus={count:function(t){return t=t||m,e.post("https://clients6.google.com/rpc",{method:"pos.plusones.get",id:t,params:{nolog:!0,id:t,source:"widget",userId:"@viewer",groupId:"@self"},jsonrpc:"2.0",key:"p",apiVersion:"v1"},{processData:!0,contentType:"application/json"}).then(n(function(n){return n.results?Number(n.result.metadata.globalCounts.count):0}))["catch"](s(0))}},f.mailru={count:function(t){return t=t||m,e.jsonp("https://connect.mail.ru/share_count?url_list="+encodeURIComponent(t)+"&callback=1&func=JSON_CALLBACK").then(n(function(n){var e=n.data;return e[t]?Number(e[t].shares):0}))["catch"](s(0))}},f.pinterest={count:function(t){return t=t||m,e.jsonp("https://api.pinterest.com/v1/urls/count.json?url="+encodeURIComponent(t)+"&callback=JSON_CALLBACK").then(n(function(n){return Number(n.data.count)||0}))["catch"](s(0))}},f.livejournal={count:function(n){var t=n||m;return r.call("repost.get_status",{url:t},{silent:!0}).then(function(n){var t=n.count;return parseInt(t)||0})["catch"](s(0))}},f.linkedin={count:function(t){return t=t||m,e.jsonp("https://www.linkedin.com/countserv/count/share?url="+encodeURIComponent(t)+"&callback=JSON_CALLBACK").then(n(function(n){return Number(n.data.count)||0}))["catch"](s(0))}},f.tumblr={count:function(t){return t=t||m,e.jsonp("https://api.tumblr.com/v2/share/stats?url="+encodeURIComponent(t)+"&callback=JSON_CALLBACK").then(n(function(n){return Number(n.data.response.note_count)||0}))["catch"](s(0))}},f.reddit={count:function(t){return t=t||m,e.jsonp("https://www.reddit.com/api/info.json?url="+encodeURIComponent(t)+"&jsonp=JSON_CALLBACK").then(n(function(n){var t=n.data.data.children;return 0===t.length?0:Number(t[0].data.score)}))["catch"](s(0))}},f.stumbleupon={count:function(t){return e.jsonp("https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent('select * from html where url="http://www.stumbleupon.com/services/1.01/badge.getinfo?url='+t+'" and xpath="*"')+"&format=json&callback=JSON_CALLBACK").then(n(function(n){var t=void 0;try{var e=angular.fromJson(n.data.query.results.html.body);t=Number(e.result.views)||0}catch(r){console.warn("stumbleupon answer parse error",r),t=0}return t}))["catch"](s(0))}},f.pocket={count:function(t){return t=t||m,e.jsonp("https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent('select * from html where url="https://widgets.getpocket.com/v1/button?count=horizontal&url='+t+'" and xpath="*"')+"&format=json&callback=JSON_CALLBACK").then(n(function(n){var t=void 0;try{t=Number(n.data.query.results.html.body.div.a.span.em.content)||0}catch(e){console.warn("pocket answer parse error",e),t=0}return t}))["catch"](s(0))}},f.buffer={count:function(t){return t=t||m,e.jsonp("https://api.bufferapp.com/1/links/shares.json?url="+encodeURIComponent(t)+"&callback=JSON_CALLBACK").then(n(function(n){return Number(n.data.shares)||0}))["catch"](s(0))}},f.xing={count:function(t){return t=t||m,e.jsonp("https://query.yahooapis.com/v1/public/yql?q="+encodeURIComponent('select * from html where url="https://www.xing-share.com/app/share?op=get_share_button;counter=top;url='+t+'" and xpath="*"')+"&format=json&callback=JSON_CALLBACK").then(n(function(n){var t=void 0;try{t=Number(n.data.query.results.html.body.div[0].div[0].span.content)||0}catch(e){console.warn("xing answer parse error",e),t=0}return t}))["catch"](s(0))}},{total:i,saveSharings:c,service:f}}function e(){function n(n,t){LJ.Flags.isDisabled("medius_sharings")}return{restrict:"AE",link:n,controller:"mediusSharingsCtrl",templateUrl:"sharings.ng.tmpl",controllerAs:"sharings"}}function r(n,t,e,r,o){var u=this;if(!LJ.Flags.isDisabled("medius_sharings")){u.count=0;var c=n.location.href;e.total(c).then(function(n){return r.$apply(function(){return u.count=n}),n}).then(e.saveSharings.bind(e,c)),LJ.Event.on("Sharings:add",function(){return o(function(){return r.$apply(function(){return u.count++})})})}}t.$inject=["$window","$http","Api"],r.$inject=["$window","Api","likesCount","$scope","$timeout"],angular.module("LJ.Sharings",["LJ.Api"]),angular.module("LJ.Sharings").factory("likesCount",t).controller("mediusSharingsCtrl",r).directive("mediusSharings",e)}();
/* <<< file end: js/widgets/sharings.js */

//# map link was there [sharings.js.map]
/* >>> file start: js/referral/mamydirectControl.js */
!function(){if(LJ.Util.runMamydirect=function(){},!LJ.get("remote")){LJ.Util.getWindow().ao_subid="Moneylink";var i=!1;LJ.Util.runMamydirect=function(){i=!0},LJ.Api.authInitPromise.then(function(){LJ.Api.call("site.settings").then(function(t){t.referral_substitution_enabled&&(LJ.Util.getWindow().ao_subid="Moneylink",LJ.Util.runMamydirect=function(){LJ.injectScript("//js.mamydirect.com/js/?h=R6USVIac")},i&&LJ.Util.runMamydirect())})})}}();
/* <<< file end: js/referral/mamydirectControl.js */

//# map link was there [mamydirectControl.js.map]
/* >>> file start: js/ljShareButton.js */
Site.page.template['angular/ljShareButton.ng.tmpl'] = '<span\n    target=\"_blank\"\n    class=\"b-sharethis-services-link\"\n    ng-click=\"LJShareButtonCtrl.onClick()\"\n    ng-class=\"{\n      \'b-sharethis-services-link--reposted\': LJShareButtonCtrl.reposted,\n      \'b-sharethis-services-link--disabled\': LJShareButtonCtrl.disabled(),\n      \'b-sharethis-services-link--loading\': LJShareButtonCtrl.loading\n    }\"\n>\n    <span\n      class=\"b-sharethis-services-link__icon-wrap\"\n    >\n        <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"svgicon flaticon flaticon--livejournal b-sharethis-services-link__icon\">\n            <use ng-href=\"#flaticon--livejournal\" xlink:href=\"\"></use>\n        </svg>\n    </span>\n    <span\n      class=\"b-sharethis-services-link__title\"\n    >{{title}}</span>\n</span>';
//= require js/core/angular/api.js
function LJShareButtonCtrl(t,e){var r=this;r.reposted=!1,r.loading=!0,e.call("repost.get_status",{url:t.entryUrl},function(t){r.reposted=!!t.reposted,r.loading=!1});var l=(t.entryUrl.match(/https?:\/\/([^\.]+)/)||[])[1],n=5===t.entryUrl.split("/").length;"users"===l&&n&&(l=t.entryUrl.split("/")[3]),l=l.replace("-","_"),r.disabled=function(){return LJ.get("preview")?!0:LJ.get("remoteUser")?LJ.get("remote_is_identity")?!0:LJ.get("remoteUser")===l:!0},r.onClick=function(){if(!r.disabled()){var l={url:t.entryUrl};r.reposted?e.call("repost.delete",l,function(){r.reposted=!1,LJ.Event.trigger("afterRepostDelete",{postURL:t.entryUrl})}):(l.timezone=LJ.Util.Date.timezone(),e.call("repost.create",l,function(){r.reposted=!0}))}}}function ljShareButtonDirective(){return{controller:LJShareButtonCtrl,controllerAs:"LJShareButtonCtrl",restrict:"A",scope:{entryUrl:"@ljShareButton",title:"@ljShareButtonTitle"},templateUrl:"ljShareButton.ng.tmpl",link:function(t,e,r){}}}LJShareButtonCtrl.$inject=["$scope","Api"],angular.module("LJShareButtonModule",["LJ.Api","LJ.Directives","LJ.Templates"]).directive("ljShareButton",ljShareButtonDirective);
/* <<< file end: js/ljShareButton.js */

//# map link was there [ljShareButton.js.map]
/* >>> file start: js/widgets/angular/pinterestHelpers.js */
var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};
LJ.injectStyle('/* >>> file start: stc/widgets/pinterestHelpers.css */\n.customPinterestHoverSaveButton{position:absolute;border-radius:2px;text-indent:20px;width:auto;padding:0 4px 0 0;text-align:center;text-decoration:none;font:11px/20px \"Helvetica Neue\",Helvetica,sans-serif;font-weight:700;color:#fff;background:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMzBweCIgd2lkdGg9IjMwcHgiIHZpZXdCb3g9Ii0xIC0xIDMxIDMxIj48Zz48cGF0aCBkPSJNMjkuNDQ5LDE0LjY2MiBDMjkuNDQ5LDIyLjcyMiAyMi44NjgsMjkuMjU2IDE0Ljc1LDI5LjI1NiBDNi42MzIsMjkuMjU2IDAuMDUxLDIyLjcyMiAwLjA1MSwxNC42NjIgQzAuMDUxLDYuNjAxIDYuNjMyLDAuMDY3IDE0Ljc1LDAuMDY3IEMyMi44NjgsMC4wNjcgMjkuNDQ5LDYuNjAxIDI5LjQ0OSwxNC42NjIiIGZpbGw9IiNmZmYiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxIj48L3BhdGg+PHBhdGggZD0iTTE0LjczMywxLjY4NiBDNy41MTYsMS42ODYgMS42NjUsNy40OTUgMS42NjUsMTQuNjYyIEMxLjY2NSwyMC4xNTkgNS4xMDksMjQuODU0IDkuOTcsMjYuNzQ0IEM5Ljg1NiwyNS43MTggOS43NTMsMjQuMTQzIDEwLjAxNiwyMy4wMjIgQzEwLjI1MywyMi4wMSAxMS41NDgsMTYuNTcyIDExLjU0OCwxNi41NzIgQzExLjU0OCwxNi41NzIgMTEuMTU3LDE1Ljc5NSAxMS4xNTcsMTQuNjQ2IEMxMS4xNTcsMTIuODQyIDEyLjIxMSwxMS40OTUgMTMuNTIyLDExLjQ5NSBDMTQuNjM3LDExLjQ5NSAxNS4xNzUsMTIuMzI2IDE1LjE3NSwxMy4zMjMgQzE1LjE3NSwxNC40MzYgMTQuNDYyLDE2LjEgMTQuMDkzLDE3LjY0MyBDMTMuNzg1LDE4LjkzNSAxNC43NDUsMTkuOTg4IDE2LjAyOCwxOS45ODggQzE4LjM1MSwxOS45ODggMjAuMTM2LDE3LjU1NiAyMC4xMzYsMTQuMDQ2IEMyMC4xMzYsMTAuOTM5IDE3Ljg4OCw4Ljc2NyAxNC42NzgsOC43NjcgQzEwLjk1OSw4Ljc2NyA4Ljc3NywxMS41MzYgOC43NzcsMTQuMzk4IEM4Ljc3NywxNS41MTMgOS4yMSwxNi43MDkgOS43NDksMTcuMzU5IEM5Ljg1NiwxNy40ODggOS44NzIsMTcuNiA5Ljg0LDE3LjczMSBDOS43NDEsMTguMTQxIDkuNTIsMTkuMDIzIDkuNDc3LDE5LjIwMyBDOS40MiwxOS40NCA5LjI4OCwxOS40OTEgOS4wNCwxOS4zNzYgQzcuNDA4LDE4LjYyMiA2LjM4NywxNi4yNTIgNi4zODcsMTQuMzQ5IEM2LjM4NywxMC4yNTYgOS4zODMsNi40OTcgMTUuMDIyLDYuNDk3IEMxOS41NTUsNi40OTcgMjMuMDc4LDkuNzA1IDIzLjA3OCwxMy45OTEgQzIzLjA3OCwxOC40NjMgMjAuMjM5LDIyLjA2MiAxNi4yOTcsMjIuMDYyIEMxNC45NzMsMjIuMDYyIDEzLjcyOCwyMS4zNzkgMTMuMzAyLDIwLjU3MiBDMTMuMzAyLDIwLjU3MiAxMi42NDcsMjMuMDUgMTIuNDg4LDIzLjY1NyBDMTIuMTkzLDI0Ljc4NCAxMS4zOTYsMjYuMTk2IDEwLjg2MywyNy4wNTggQzEyLjA4NiwyNy40MzQgMTMuMzg2LDI3LjYzNyAxNC43MzMsMjcuNjM3IEMyMS45NSwyNy42MzcgMjcuODAxLDIxLjgyOCAyNy44MDEsMTQuNjYyIEMyNy44MDEsNy40OTUgMjEuOTUsMS42ODYgMTQuNzMzLDEuNjg2IiBmaWxsPSIjYmQwODFjIj48L3BhdGg+PC9nPjwvc3ZnPg==) 3px 50% no-repeat #bd081c;background-size:14px 14px;-webkit-font-smoothing:antialiased;display:inline-block;box-sizing:border-box;box-shadow:inset 0 0 1px #888;height:20px;vertical-align:baseline;cursor:pointer}\n/* <<< file end: stc/widgets/pinterestHelpers.css */\n\n/*# sourceMappingURL=pinterestHelpers.css.map */\n');
//= require_ml widget.pinterest.save
!function(){function t(t,e,n,r){var i={},o=t.find("body"),l=!1;return i.mountHoverSaveButton=function(i){var a={left:10,top:10},c={width:200,height:200};if(angular.isObject(i)){l||(LJ.injectScript("//assets.pinterest.com/js/pinit.js"),l=!0);var u=i.container,s=i.filterImgFn,f=void 0===s?function(){return!0}:s,p=i.getPinDataForImage,v=void 0===p?function(){return{}}:p,d=null,h=null,m=function(){if(h){var t=angular.element(d).offset(),e=Math.max(t.left,0),n={left:e+a.left,top:t.top+a.top};h.css({left:n.left,top:n.top})}},g=function(){var n=0,r=null,i=function(){var e=t[0].body.scrollHeight;n!==e&&(n=e,m())},o=function(){r||(r=e(i,100))},l=function(){r&&(e.cancel(r),r=null)};return{start:o,stop:l,doSingleCheck:i}}();t.on("mouseover",function(t){var e=t.target;e!==d&&e!==(h&&h[0])&&(d=null,h&&(h.css({display:"none"}),g.stop()))});var b={},j=function(t){var e=t.replace(/lj-[0-9]+.dev.lj.rambler.tech\//,"").replace(/livejournal.com\//,"").match(/^https?:\/\/ic.pics./);return e&&!!e[0]},H=function(t){var e=t.url;return j(e)?b[e]?n.resolve("public"===b[e]):r({method:"HEAD",url:e}).then(function(t){var n=t.headers();return 0===n["cache-control"].indexOf("public")?void(b[e]="public"):void(b[e]="non-public")},function(){b[e]="non-public"}).then(function(){return"public"===b[e]}):n.resolve(!0)};angular.element(u).on("mouseover",function(t){var e=t.target,n=function(){if(e===d&&h)return h.css({display:"block"}),void g.start();if(f(e)){h&&h.remove(),d=e;var t=LJ.ml("widget.pinterest.save");h=angular.element("<span>"+t+"</span>"),h.addClass("customPinterestHoverSaveButton"),h.on("click",function(t){t.preventDefault(),PinUtils.pinOne(_extends({media:d.src},v(d)))}),m(),o.append(h),g.start()}};"IMG"!==e.tagName||e.clientWidth<c.width||e.clientHeight<c.height||H({url:e.src}).then(function(t){t&&n()})})}},i}t.$inject=["$document","$interval","$q","$http"],angular.module("PinterestHelpersModule",[]),angular.module("PinterestHelpersModule").factory("pinterestHelperService",t)}();
/* <<< file end: js/widgets/angular/pinterestHelpers.js */

//# map link was there [pinterestHelpers.js.map]
/* >>> file start: js/hashtag.js */
var _extends=Object.assign||function(n){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var e in r)Object.prototype.hasOwnProperty.call(r,e)&&(n[e]=r[e])}return n};!function(n){return n}(),function(){var n={};n.tagsFromInput=function(n){return n.split("#").reduce(function(n,t,r){var e=0===r?t:"#"+t,a=n.charIndex+e.length,g=_extends({},n,{charIndex:a});if("#"!==e[0])return g;var o=/[\s\r\n]+[^]*$/,u=t.replace(o,"");if(!u)return g;var d=e.replace(o,"");return g.tags=n.tags.concat({tag:d,body:u,tagStartIndex:n.charIndex,tagEndIndex:n.charIndex+d.length}),g},{charIndex:0,tags:[]}).tags},n.firstGoodTagInInput=function(t){var r=arguments.length<=1||void 0===arguments[1]?3:arguments[1],e=n.tagsFromInput(t);return e&&e.length?e.filter(function(n){return n.body.length>=r})[0]:null},n.getTagNearCaret=function(t,r){var e=arguments.length<=2||void 0===arguments[2]?{}:arguments[2],a=e.minBodyLength,g=void 0===a?3:a,o=n.tagsFromInput(t);return o&&o.length?o.filter(function(n){return n.body.length>=g&&r>n.tagStartIndex&&r<=n.tagEndIndex})[0]:null},LJ.define("LJ.Hashtag"),LJ.Hashtag=n}();
/* <<< file end: js/hashtag.js */

//# map link was there [hashtag.js.map]
/* >>> file start: js/widgets/angular/hints/inputHint.js */
var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t};
Site.page.template['angular/widgets/inputHintPopup.ng.tmpl'] = '<div\n  class=\"b-popup-lite\"\n  ng-style=\"widget.getContainerStyle()\"\n>\n  <span\n    ng-repeat=\"suggestion in widget.suggestions\"\n    ng-mousedown=\"widget.onSuggestionMouseDown($event, suggestion)\"\n    ng-class=\"{\n      \'b-popup-lite__button--selected\': widget.suggestionIsSelected($index)\n    }\"\n    class=\"b-popup-lite__button\"\n  >{{suggestion}}</span>\n  <span\n    class=\"b-popup-lite__arrow\"\n    ng-style=\"widget.getArrowStyle()\"\n  ></span>\n</div>';
LJ.injectStyle('/* >>> file start: stc/popup/hint-popup.css */\n.b-popup-lite{font:400 14px/20px ProximaNova,Helvetica,sans-serif;color:#333;position:absolute;display:inline-block;box-sizing:border-box;min-width:160px;padding:7px 0;margin-top:.8em;border:1px solid #D4DDE1;box-shadow:0 0 1px rgba(0,0,0,.12),0 8px 12px rgba(0,0,0,.12);border-radius:6px;z-index:4;text-align:left;background-color:#FFF}.b-popup-lite__button{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;box-sizing:border-box;width:100%;padding:6px 15px;outline:0;border:0;text-align:inherit;text-decoration:none;-webkit-transition:background-color .15s;transition:background-color .15s;background-color:transparent;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer;color:#333}.b-popup-lite__button--selected,.b-popup-lite__button:focus,.b-popup-lite__button:not(:disabled):hover{background-color:#F5F7F8}.b-popup-lite__arrow{font-size:16px;position:absolute;top:-.5em;left:1em;overflow:hidden;width:1em;height:.5em}.b-popup-lite__arrow::before{content:\"\";font-size:11.31px;position:absolute;left:0;bottom:0;display:block;box-sizing:border-box;width:1em;height:1em;border:1px solid #D4DDE1;-webkit-transform-origin:bottom left;-ms-transform-origin:bottom left;transform-origin:bottom left;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);background-color:#FFF}\n/* <<< file end: stc/popup/hint-popup.css */\n\n/*# sourceMappingURL=hint-popup.css.map */\n');
!function(){function t(t,e,n,i,o,r){var u=function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=t.angularController,n={};n.renderPopup=e.renderPopup,n.setWordCoordinates=e.setTargetRect,n.hideHints=e.hidePopup,n.isShown=e.isShown;var i="";return n.setContent=function(t){var n=t.word,o=t.hints;e&&n&&(i!==n&&e.resetSelection(),i=n,e.setSuggestions(o))},n.inputOnKeydown=function(t){if(e.isShown()&&e.hasData()){var i=40,o=38,r=13;t.keyCode===i?(e.adjustSelection(1),t.preventDefault()):t.keyCode===o?(e.adjustSelection(-1),t.preventDefault()):t.keyCode===r&&(LJ.Event.trigger("inputHint::hintActivated",{hint:e.suggestions[e.selectedHintIndex]}),n.hideHints(),t.preventDefault())}},n},l=function(){var t=i.$new(),e=angular.element("body"),n="<div input-hint></div>",l=0===e.closest("[ng-app]").length;return l&&(n=o("<div input-hint></div>")(t)),angular.element("body").append(n),r(function(t,e){LJ.Event.on("inputHint::angularControllerReady",function(){var n=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];n.controller||e();var i=u({angularController:n.controller});t(i)})})},p={},s={};return s.getInputHint=function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],e=p[t.id];return e?r.resolve(e):(p[t.id]=l().then(function(e){return p[t.id]=e,e}),p[t.id])},s}function e(t){var e={};return e.getPositionData=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=e.targetRect,i=e.popupRect,o={popup:{left:0,top:0},arrow:{side:"top",left:0,top:0}};if(!n||!i)return o;var r=i.width/2,u=(n.left+n.right)/2;o.popup.left=n.right,o.popup.left=u-r,o.popup.right=o.popup.left+i.width,o.popup.top=n.bottom,o.arrow.left=r;var l=15,p=t[0].body.getBoundingClientRect(),s=p.width-l,a=Math.max(0,o.popup.right-s),c=Math.max(0,l-o.popup.left);return a>0&&!c?(o.popup.left-=a,o.arrow.left+=a,o):c>0&&!a?(o.popup.left+=c,o.arrow.left-=c,o):o},e}function n(t,e,n,i,o,r,u,l,p){var s=this;s.suggestions=[],s.selectedHintIndex=0,s.containerStyle={top:0,left:0,display:"none"};var a={baseWidth:16,apexHeight:8},c={},d=l.getPositionData(),g=p.resolve();s.getPopupRect=function(){var t=s.getPopupElement()[0];if(s.isShown())return t.getBoundingClientRect();var e={display:t.style.display,visibility:t.style.visibility};t.style.visibility="hidden",t.style.display="block";var n=t.getBoundingClientRect();return t.style.visibility=e.visibility,t.style.display=e.display,n},s.renderPopup=function(){return s.suggestions.length?void g.then(function(){var t=s.getPopupRect();d=l.getPositionData({targetRect:c,popupRect:t}),s.containerStyle.display="block",delete s.containerStyle.visibility,s.containerStyle.top=d.popup.top,s.containerStyle.left=d.popup.left}):void s.hidePopup()},s.setTargetRect=function(t){c=t},s.hidePopup=function(){n(function(){s.containerStyle.display="none"})},s.getPopupElement=function(){return o.find(".b-popup-lite")},s.adjustSelection=function(t){n(function(){return s.suggestions.length<2?void(s.selectedHintIndex=0):void(s.selectedHintIndex=(s.selectedHintIndex+t+s.suggestions.length)%s.suggestions.length)})},s.getContainerStyle=function(){return _extends({},s.containerStyle)},s.getArrowStyle=function(){return{left:d.arrow.left-a.baseWidth/2,right:"auto"}},s.resetSelection=function(){n(function(){s.selectedHintIndex=0})},s.onSuggestionMouseDown=function(t,e){t.preventDefault(),LJ.Event.trigger("inputHint::hintActivated",{hint:e}),s.hidePopup()},s.setSuggestions=function(t){s.suggestions=t,g=n(function(){})},s.suggestionIsSelected=function(t){return t===s.selectedHintIndex},s.styleForHintByIndex=function(t){return s.suggestionIsSelected(t)?{background:"#c5e7ff"}:null},s.isShown=function(){return"none"!==s.containerStyle.display},s.hasData=function(){return!!s.suggestions.length},i.on("mousedown",function(t){s.isShown()&&!angular.element(t.target).closest(o).length&&s.hidePopup()}),LJ.Event.trigger("inputHint::angularControllerReady",{controller:s})}function i(){return{controller:"inputHintCtrl",controllerAs:"widget",templateUrl:"inputHintPopup.ng.tmpl"}}t.$inject=["Api","$document","$window","$rootScope","$compile","$q"],n.$inject=["$scope","inputHintService","$timeout","$document","$element","$window","$log","inputHintPositioner","$q"],e.$inject=["$document"],angular.module("InputHintModule",[]),angular.module("InputHintModule").factory("inputHintService",t).controller("inputHintCtrl",n).directive("inputHint",i).factory("inputHintPositioner",e)}();
/* <<< file end: js/widgets/angular/hints/inputHint.js */

//# map link was there [inputHint.js.map]
/* >>> file start: js/lib/textareaCaretPosition.js */
!function(){function e(e,r,i){if(!o)throw new Error("textarea-caret-position#getCaretCoordinates should only be called in a browser");var d=i&&i.debug||!1;if(d){var a=document.querySelector("#input-textarea-caret-position-mirror-div");a&&a.parentNode.removeChild(a)}var l=document.createElement("div");l.id="input-textarea-caret-position-mirror-div",document.body.appendChild(l);var p=l.style,f=window.getComputedStyle?window.getComputedStyle(e):e.currentStyle,h="INPUT"===e.nodeName;p.whiteSpace="pre-wrap",h||(p.wordWrap="break-word"),p.position="absolute",d||(p.visibility="hidden"),t.forEach(function(e){h&&"lineHeight"===e?p.lineHeight=f.height:p[e]=f[e]}),n?e.scrollHeight>parseInt(f.height)&&(p.overflowY="scroll"):p.overflow="hidden",i&&i.textareaStyle&&"overflow"in i.textareaStyle&&(p.overflow=i.textareaStyle.overflow),i&&i.adjustStyleObj&&(p=i.adjustStyleObj(p)),l.textContent=e.value.substring(0,r),h&&(l.textContent=l.textContent.replace(/\s/g," "));var s=document.createElement("span");s.textContent=e.value.substring(r)||".","string"==typeof i.tailSpanContent&&(s.textContent=i.tailSpanContent),l.appendChild(s);var u={top:s.offsetTop+parseInt(f.borderTopWidth),left:s.offsetLeft+parseInt(f.borderLeftWidth),height:parseInt(f.lineHeight)};return d?s.style.backgroundColor="#aaa":document.body.removeChild(l),u}var t=["direction","boxSizing","width","height","overflowX","overflowY","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize"],o="undefined"!=typeof window,n=o&&null!=window.mozInnerScreenX;"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=e:o&&(window.textareaCaretPosition={getCoordinates:e})}();
/* <<< file end: js/lib/textareaCaretPosition.js */

//# map link was there [textareaCaretPosition.js.map]
/* >>> file start: js/widgets/angular/hints/inputHintHelpers.js */
var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t};
//= require js/widgets/angular/hints/inputHint.js
//= require js/lib/textareaCaretPosition.js
!function(){function t(t,e,n){var r={};return r.doStandardTextareaMount=function(r){if(r){var i=r.inputHintID,o=r.textarea,a=r.getTriggerWordNearCaret,d=r.getHintsForWord,l=r.decorateBeforeInsertion;if(o&&a)return e.getInputHint({id:i}).then(function(e){var i=angular.element(o),a=null,u=function(){var t=n[0].body.getBoundingClientRect(),e=i[0].getBoundingClientRect();return{left:e.left-t.left,top:e.top-t.top}},s=function(){var e=arguments.length<=0||void 0===arguments[0]?{}:arguments[0],n=t.textareaCaretPosition,r=e.triggerWordData||a;if(!n||!r)return null;var d=t.getComputedStyle(i[0]),l=parseInt(d.lineHeight)||parseInt(d.fontSize),s={textareaStyle:{overflow:"auto"},adjustStyleObj:function(t){var e=LJ.Support.isMobile()&&LJ.Support.browser.safari;if(e){var n=3,r=t.padding,i=r.split(" ");if(2===i.length){var o=parseInt(i[1]),a=o+n,d=i[0]+" "+a+"px";t.padding=d}}}},g={start:null,end:null};g.start=n.getCoordinates(o,r.wordStartIndex,s);var f=null;""===o.value.substring(r.wordEndIndex)&&(f="");var c=_extends({},s,{tailSpanContent:f});g.end=n.getCoordinates(o,r.wordEndIndex,c);var p=u(),v={x:p.left-o.scrollLeft,y:p.top-o.scrollTop};return{left:v.x+g.start.left,right:v.x+g.end.left,top:v.y+g.start.top,bottom:v.y+g.start.top+l}},g=function(){var n=t.textareaCaretPosition;if(!n||o.selectionStart!==o.selectionEnd)return void e.hideHints();var i=r.getTriggerWordNearCaret(o.value,o.selectionStart);if(a=i,!i)return void e.hideHints();var l=i.word;return l?d(l).then(function(t){e.setContent({word:l,hints:t}),e.setWordCoordinates(s({triggerWordData:i})),e.renderPopup()}):void e.hideHints()},f=function(t){var n=t.hint;if(o.selectionStart!==o.selectionEnd)return void e.hideHints();var a=r.getTriggerWordNearCaret(o.value,o.selectionStart);if(!a)return void e.hideHints();var d=a.wordStartIndex,u=a.wordEndIndex,s=i.val(),g=s.substring(0,d),f=s.substring(u),c=n;l&&(c=l({beforeTriggerWord:g,hint:n,afterTriggerWord:f}));var p=[g,c,f].join("");i.val(p),o.selectionStart=g.length+c.length,o.selectionEnd=o.selectionStart};i.on("keydown",function(t){e.inputOnKeydown(t)}).on("input click",function(t){g({e:t})}).on("scroll",function(){if(e.isShown()){var t=s();if(t&&a&&a.word){var n=u(),r=n.top+i[0].getBoundingClientRect().height,o=t.bottom>r;if(o)return void e.hideHints();e.setWordCoordinates(t),e.renderPopup()}}}),angular.element(t).on("resize orientationchange",function(){e.hideHints()}),LJ.Event.on("inputHint::hintActivated",f)})}},r}t.$inject=["$window","inputHintService","$document"],angular.module("InputHintHelpersModule",["InputHintModule"]),angular.module("InputHintHelpersModule").factory("inputHintHelpersService",t)}();
/* <<< file end: js/widgets/angular/hints/inputHintHelpers.js */

//# map link was there [inputHintHelpers.js.map]
/* >>> file start: js/widgets/angular/hints/hashHint.js */
//= require js/hashtag.js
//= require js/core/angular/api.js
//= require js/widgets/angular/hints/inputHintHelpers.js
!function(){function t(t,n,e,r){var a={};a.doStandardTextareaMount=function(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];return n.doStandardTextareaMount({inputHintID:"hashtag",textarea:t.textarea,getTriggerWordNearCaret:function(){var t=LJ.Hashtag.getTagNearCaret.apply(this,arguments);return t?{word:t.tag,wordStartIndex:t.tagStartIndex,wordEndIndex:t.tagEndIndex}:null},getHintsForWord:function(t){return/[\]\[\/\\\(\)]/.test(t)?r.resolve([]):e.call("hashtags.search",{journaltype:"P",query:t,size:8}).then(function(t){var n=t.tags||[],e=function(t,n,e){return e.indexOf(t)===n};return n.filter(e).map(function(t){return"#"+t})})}})};var i=function(){return LJ.Event.trigger("api::broadcast",{name:"hashHint",api:a})};return i(),LJ.Event.on("api::request",function(t){t&&"hashHint"===t.name&&i()}),a}t.$inject=["$window","inputHintHelpersService","Api","$q"],angular.module("HashHintModule",["LJ.Api","InputHintHelpersModule"]),angular.module("HashHintModule").factory("hashHintService",t)}();
/* <<< file end: js/widgets/angular/hints/hashHint.js */

//# map link was there [hashHint.js.map]
/* >>> file start: js/entry/main.js */
//= require js/core/string.js
//= require js/editor/basicToolbar.js
//= require js/discovery/directives.js
//= require js/widgets/likus.js
//= require js/core/angular/ljMemories.js
//= require js/core/angular/ljEmbed.js
//= require js/core/angular/share.js
//= require js/lib/jquery.qrcode.min.js
//= require js/widgets/angular/mediusCardPager.js
//= require js/widgets/angular/mediusSubscribe.js
//= require js/widgets/angular/mediusFooter.js
//= require js/widgets/angular/mediusTimeAgo.js
//= require js/widgets/angular/mediusShareButtons.js
//= require js/widgets/sharings.js
//= require js/core/angular/api.js
//= require js/referral/mamydirectControl.js
//= require js/ljShareButton.js
//= require js/widgets/angular/pinterestHelpers.js
//= require js/widgets/angular/hints/hashHint.js
//= require_ml tretyakovskaya.postpage.toreviewlist
//= require_ml talk.goback.tomain
//= require_ml talk.goback.tomedius
//= require_ml talk.wrote
//= require_ml portal.recent.nosubject
Site.page.template['Widgets/Medius/likesItemsPopup.ng.tmpl'] = '<ul\n    ng-class=\"{\n        \'mdspost-social--popup-top\': bubble.options.topClass,\n        \'mdspost-social--popup-full\': bubble.options.mediusRepost\n    }\"\n    class=\"mdspost-social mdspost-social--popup\"\n    ><!--\n  --><li medius-share-button service=\'livejournal\' class=\"mdspost-social__item mdspost-social__item--livejournal\"><!--\n      --><a class=\"mdspost-social__button\" lj-svg-icon=\"flaticon--lj\" ></a><!--\n  --></li><!--\n  --><li medius-share-button service=\'vkontakte\' class=\"mdspost-social__item mdspost-social__item--vk\"><!--\n    --><a class=\"mdspost-social__button\" lj-svg-icon=\"flaticon--vk\" ></a><!--\n  --></li><!--\n  --><li medius-share-button service=\'facebook\' class=\"mdspost-social__item mdspost-social__item--facebook\"><!--\n      --><a class=\"mdspost-social__button\" lj-svg-icon=\"flaticon--facebook\" ></a><!--\n  --></li><!--\n  --><li medius-share-button service=\'twitter\' class=\"mdspost-social__item mdspost-social__item--twitter\"><!--\n      --><a class=\"mdspost-social__button\" lj-svg-icon=\"flaticon--twitter\" ></a><!--\n  --></li><!--\n  --><li medius-share-button service=\'odnoklassniki\' class=\"mdspost-social__item mdspost-social__item--odnoklassniki\"><!--\n      --><a class=\"mdspost-social__button\" lj-svg-icon=\"flaticon--odnoklassniki\" ></a><!--\n  --></li><!--\n  --><li medius-share-button service=\'pocket\' class=\"mdspost-social__item mdspost-social__item--pocket\"><!--\n      --><a class=\"mdspost-social__button\" lj-svg-icon=\"flaticon--pocket\" ></a><!--\n  --></li><!--\n--></ul>\n';
LJ.UI.registerTemplate('templates-Comments-PrevNext', " {{if $data.previous_entry_link || $data.next_entry_link}} <div class=\"b-singlepost-prevnext\"> <span class=\"b-singlepost-prevnext-drag\"></span> <ul class=\"b-singlepost-prevnext-items\"> {{if $data.previous_entry_link}} <li class=\" b-singlepost-prevnext-item b-singlepost-prevnext-prev \" > <span class=\"b-singlepost-prevnext-author\">{{html $data.previous_poster}}{{if $data.is_community}} {{html LJ.mltext(\'talk.wrote\')}} {{html $data.journal_ljuser}}{{/if}}</span> <a href=\"{{html $data.previous_entry_link}}\" class=\"b-singlepost-prevnext-link\" target=\"_self\" {{if $data.previous_entry_subject}} title=\"{{html ehtml($data.previous_entry_subject)}}\" {{/if}} ><span class=\" b-singlepost-prevnext-arrow b-singlepost-prevnext-arrow-left \" ><span lj-svg-icon=\"flaticon--arrow-left-bold\"></span></span><span class=\"b-singlepost-prevnext-inner\">{{if $data.previous_entry_subject}}{{html $data.previous_entry_subject}}{{else}}{{html LJ.mltext(\'portal.recent.nosubject\')}}{{/if}}</span></a> </li> {{/if}} {{if $data.next_entry_link}} <li class=\" b-singlepost-prevnext-item b-singlepost-prevnext-next \" > <span class=\"b-singlepost-prevnext-author\">{{html $data.next_poster}}{{if $data.is_community}} {{html LJ.mltext(\'talk.wrote\')}} {{html $data.journal_ljuser}}{{/if}}</span> <a href=\"{{html $data.next_entry_link}}\" class=\"b-singlepost-prevnext-link\" target=\"_self\" {{if $data.next_entry_subject}} title=\"{{html ehtml($data.next_entry_subject)}}\" {{/if}} ><span class=\" b-singlepost-prevnext-arrow b-singlepost-prevnext-arrow-right \" ><span lj-svg-icon=\"flaticon--arrow-right-bold\"></span></span><span class=\"b-singlepost-prevnext-inner\">{{if $data.next_entry_subject}}{{html $data.next_entry_subject}}{{else}}{{html LJ.mltext(\'portal.recent.nosubject\')}}{{/if}}</span></a> </li> {{/if}} </ul> </div> {{/if}} ", 'JQuery.stat');
!function(e){"use strict";function t(){function e(e,t){var r=t.find(".mdspost-extra-allauthors__button"),i=t.find(".mdspost-extra-follow");r.click(function(){i.removeClass("mdspost-extra-follow--collapsed"),r.hide()})}return{link:e}}function r(e){function t(t,r){var i=LJ.get("siteroot"),n=LJ.get("remote_is_sup");return r.css("display","block"),LJ.get("is_tretyakovgallery")?(r.attr("href",LJ.get("category_url")),void r.find("[go-back-text]").text(LJ.ml("tretyakovskaya.postpage.toreviewlist"))):e.document.referrer.match(i)&&e.history.length>1?n?void 0:(r.attr("href",LJ.get("siteroot")+"/media"),void r.find("[go-back-text]").text(LJ.ml("talk.goback.tomedius"))):(r.attr("href",LJ.get("siteroot")),void r.find("[go-back-text]").text(LJ.ml("talk.goback.tomain")))}return{link:t}}function i(){return{scope:!0,link:function(e,t){e.firstCharacterIsPunctuation=/[-−–—+]/.test(t.text()[0])}}}function n(e,t){function r(r,i){function n(){c--,c>0||i.append(e(LJ.UI.template("templates-Comments-PrevNext",l))(r))}var o=LJ.get("entry")||{},a={journal:o.journal,ditemid:o.ditemid},s={silent:!0},c=2,l={};l.ehtml=function(e){return LJ.String.encodeHTML(e.replace(/&/g,"&amp;"))},[{direction:"previous",apiMethod:"entry.get_itemid_before"},{direction:"next",apiMethod:"entry.get_itemid_after"}].forEach(function(e){t.call(e.apiMethod,a,s).then(function(t){var r=e.direction+"_";l[r+"poster"]=t.poster,l[r+"entry_link"]=t.link,l[r+"entry_subject"]=t.subject,t.is_community&&!l.is_community&&(l.is_community=t.is_community,l.journal_ljuser=t.journal),n()},function(){n()})})}return{link:r}}function o(t,r,i,n){function o(){e("a:not([target])").attr("target","_self")}LJ.Util.isMediusJournal()&&d&&n.find(".mdspost-text-container .aentry-post__embed--big iframe").each(function(e,t){var r,i=LJ.GlobalConfig.POST2017_EMBED_FORMATS.postWidth;t.setAttribute("width",i.width),t.setAttribute("height",i.height);var n=["aentry-post__embed--big--1000px","aentry-post__embed--big"];(r=t.closest("figure").classList).remove.apply(r,n)}),LJ.get("preview")&&LJ.Social.parseWidgets(),t(function(){o()}),LJ.Event.on("entry/fixLinks",o),LJ.Util.runMamydirect(),!LJ.Support.isMobile()&&d&&LJ.get("entry.is_public")&&i.mountHoverSaveButton({container:n.find(".mdspost-text")[0]})}function a(e,t){e.enabled(!1),t.html5Mode({enabled:!0,requireBase:!1})}function s(){function e(){function e(e,n){function o(o,a){if(e.className===p||n===f||!~l.indexOf(e.nodeName)||d.filter(t(e)).length)return void o();var s=e.appendChild(document.createElement("div"));s.className=p,[].reduce.call(e.childNodes,r,[]).reduce(i,Promise.resolve({reffer:e.firstChild,offset:0,level:n,prev:null})).then(o)["catch"](function(e){a(e)})}return new Promise(o)}function t(e){return function(t){return~e.className.indexOf(t)}}function r(e,t){var r,i=e[e.length-1];return i&&!i.el||(e.push({el:null}),i=e[e.length-1]),(~m.indexOf(t.nodeName)||t.querySelectorAll&&t.querySelectorAll(m).length)&&(i.el=t,r=getComputedStyle(t,null).display),e}function i(e,t){return e.then(function(e){return n(t.el).then(a.bind(null,t.el,e))})}function n(e){var t="IMG"===e.nodeName?[e]:e.querySelectorAll("img");return Promise.all([].map.call(t,o))}function o(e){function t(t){e.complete?t():e.onload=t}return new Promise(t)}function a(t,r){function i(i,u){return l&&r.prev&&t.offsetTop-r.prev.top>c?void u(r.prev.reffer):(l&&n-a>s?r.prev=r.prev?r.prev:{top:r.offset,reffer:r.reffer}:r.prev=null,l&&r.prev&&o-r.prev.top>c?void u(r.prev.reffer):l&&t.offsetTop-r.offset>c?void u(r.reffer):void e(t,r.level+1).then(function(){i({reffer:t.nextSibling,offset:o,prev:r.prev})})["catch"](function(e){u(e)}))}var n=window.innerWidth-2*g.winmarg,o=t.offsetTop+t.offsetHeight,a=t.offsetLeft+t.offsetWidth,s=g.width+g.margin,c=g.height+2*g.margin,l=n<=g.wmax&&n>=g.wmin;return new Promise(i)}function s(e){var t,r,i,n,o=window.innerWidth-2*g.winmarg;t=document.createElement("div"),t.setAttribute("lj-sale","s1_right"),t.setAttribute("lj-sale-hide-cookie","s1_rightbanner_closed"),t.className="ljsale ljsale--empty b-singlepost-postbanner",n=g.post-o<g.winmarg?g.post-o:0,t.style.marginRight=String(n)+"px",e.parentElement.insertBefore(t,e),r=angular.element(".b-singlepost").injector(),i=angular.element(t),r&&r.invoke(["$compile",function(e){e(i)(i.scope())}])}var c=document.querySelector(".b-singlepost-body"),l=["DIV","ARTICLE"],u=["IMG","IFRAME","TABLE"],d=["lj-like","fb-post"],m=[].concat(l).concat(u),p=Math.random().toString(36).substring(7),f=4,g={wmin:1001,wmax:1440,winmarg:30,post:1100,width:300,height:600,margin:30};LJ.get("adv.s1_right")&&e(c,0)["catch"](s)}return{link:e}}function c(){return{scope:{text:"@ljQrcode",width:"@ljQrcodeWidth",height:"@ljQrcodeHeight"},link:function(e,t){t.qrcode({text:e.text,width:e.width,height:e.height})}}}function l(e){return{scope:!0,link:function(t,r){var i,n="//news.smi2.ru/data/js/82652.js",o="82630";return i='<div class="sk_item_{id}"><a href="{url}" class="sk_img_{id}" style="width: 150px !important; height: 120px !important;"><img src="{img}" alt="{title}" style="width: 150px !important; height: 120px !important;" /></a><a href="{url}" class="sk_text_{id}">{title}</a></div>',n?void e.get(n).success(function(e){r.html(e.news.reduce(function(e,t){return e+i.supplant({id:o||"",url:t.url,img:t.img,title:t.title})},""))}):void r.remove()}}}o.$inject=["$timeout","hashHintService","pinterestHelperService","$document"],r.$inject=["$window"],n.$inject=["$compile","Api"],e(function(){e('[type="submit"]').on("click",function(t){var r=e(this).closest("form");(!r.attr("action")&&!r.attr("ng-submit")||r.attr("onclick"))&&(t.preventDefault(),r.submit())})});var u=LJ.Util.isMediusJournal()?["LJ.Templates","BasicToolbar","LJ.Share","LJ.Memories","Discovery.Tags","LJ.Likus","LJ.Embed","LJ.Sale","LJ.Api","Medius.CardPager","Medius.Footer","LJ.Sharings","Medius.ShareButtons","Medius.TimeAgo","Medius.Subscribe","Medius.Recommended","Medius.Menu","Medius.SignupBanner"]:["LJ.Templates","BasicToolbar","LJ.Share","LJ.Memories","Discovery.Tags","LJ.Likus","LJ.Embed","LJ.Sale","LJ.Api"];LJ.Flags.isEnabled("branding_tretyakovgallery")&&LJ.Util.isMediusJournal()&&u.push("Medius.Branding.Tretyakovka"),u=u.concat(["LJShareButtonModule","PinterestHelpersModule","HashHintModule"]),angular.module("Entry",u),angular.module("Entry").run(o).config(a).directive("ljSaleEntry",s).directive("ljQrcode",c).directive("ljSmi",l).directive("authorsList",t).directive("goBack",r).directive("ljFirstLetterHelper",i).directive("prevNextNav",n);var d=LJ.get("entry.is_version2");a.$inject=["$sceProvider","$locationProvider"],function(e){return e}(),l.$inject=["$http"],e(function(){var t=e(LJ.Util.isMediusJournal()?".mdspost-comments":".b-grove"),r=jQuery(".b-watering");LJ.S2Comments||(t.commentsMassActions().commentsOperations(),r.commentator({publicKey:LJ.get("captcha_public"),captchaContainerId:"captcha-container",selectors:{errorBlock:".b-msgsystem-error-ajax",blockingErrorBlocks:".b-msgsystem-error",preloaderElem:".b-watering-preload",submitControl:".b-ljbutton-submit",captchaBox:".b-watering-captchabox"},classNames:{captchaActive:"b-watering-captchabox-active",replyPage:"b-watering-replypage"}}).commentform(),LJ.get("remoteUser")&&LJ.get("hasuserpics")&&r.userpicker(),r.authtype({forceStartupCaptcha:Boolean(LJ.get("need_captcha")),classNames:{expanded:"b-watering-user-options-show",startAuthTypePrefix:"b-watering-trueauth-",captchaForAnonymous:"b-watering-captcha-anon",captchaForNonFriends:"b-watering-captcha-nonfriend",notfriend:"b-watering-user-notafriend",notaspammer:"b-watering-notaspammer",captchaForAll:"b-watering-captcha-all",authTypePrefix:"b-watering-authtype-"},selectors:{activeSelectItem:"a[href=#{authType}]",selectControl:".b-watering-user-options",authTypesControls:".b-watering-user-services-item a",authTypeRadios:".b-watering-user-login-{authType} .b-watering-user-login-checkbox"}}),t.comments(),e(".b-linkbar").on("click",".b-controls",function(e){var t=e.currentTarget.className,r=t.match(/b-controls-([a-z]+)/),i=r&&r[1];i&&LJ.Track.event("S1 Entry","Linkbar",i)}))})}(jQuery);
/* <<< file end: js/entry/main.js */

//# map link was there [main.js.map]
/* >>> file start: js/jquery/jquery.calendarEvents.js */
!function(e){var t={};e.fn.calendarEvents=function(n){function a(e,t){return"cache_"+e+t}function s(e,t){var n=this;this.calendar=e,this.events=null,this.options=t,this._ajaxActive=!1,this._currentDate;var s,i=function(t,i){"string"!=typeof e.data("noFetch")&&(clearTimeout(s),n._currentDate=a(t.getFullYear(),t.getMonth()+1),s=setTimeout(function(){n.fetchEvents(t.getFullYear(),t.getMonth()+1,i)},200))};this.calendar.bind("dateChange",function(e){var t=n.calendar[n.options.calendarType]("option","displayedMonth"),a=1===Math.abs(12*(e.date.getFullYear()-t.getFullYear())+(e.date.getMonth()-t.getMonth()));i(e.date,a)}),this.options.fetchOnFirstDisplay&&this.calendar.one("calendarshow",function(e){i(new Date,!0)})}var i={calendarType:"calendar",classNames:{idle:"idle"},fetchOnFirstDisplay:!1};return s.prototype={getEvents:function(e,t,n){var a={};return a[+e]={},a[+e][+t-1]=n,a},fetchEvents:function(n,s,i){i=arguments.length>=3?!!i:!0;var o=this,r=(this.calendar[this.options.calendarType]("option","displayedMonth"),this.calendar[this.options.calendarType]("getElement",i?"month":"year")),c=this.options.classNames.idle,l=!0,h=function(){o._ajaxActive||l||r.removeClass(c)};this.calendar[this.options.calendarType]("getElement","year").removeClass(c),this.calendar[this.options.calendarType]("getElement","month").removeClass(c),r.addClass(c),this._ajaxActive=!0,setTimeout(function(){l=!1,h()},500);var d=a(n,s);processResults=function(e){d===o._currentDate&&(o.events=t[d],o.calendar[o.options.calendarType]("option","events",o.getEvents(o.events.year,o.events.month,o.events.days)),o._ajaxActive=!1,h())},d in t?processResults(t[d]):e.getJSON(LiveJournal.getAjaxUrl("calendar"),{year:n,month:s},function(e){t[d]=e,processResults(e)})}},this.each(function(){new s(e(this),e.extend({},i,n))})}}(jQuery);
/* <<< file end: js/jquery/jquery.calendarEvents.js */

//# map link was there [jquery.calendarEvents.js.map]
/* >>> file start: js/settings/services/filters/filters.js */
//= require js/core/angular/api.js
//= require js/core/angular/options.js
//= require js/core/angular/users.js
!function(t){return t}(),function(){"use strict";angular.module("GroupsAndFilters.Services.Filters",["LJ.Api","LJ.Options","Users"]).filter("filtersOrder",function(){return function(t){var r=t.slice(0);return r.sort(function(t,r){if(31===t.id)return-1;if(31===r.id)return 1;var e=t.name.toLowerCase(),i=r.name.toLowerCase();return e>i?1:-1}),r}}).factory("FilterGroupFactory",["$q","$timeout","Api","Options","Users",function(t,r,e,i,n){function o(){angular.extend(this,{MAX_COUNT:31,filters:[],key:"filters",rpc:{}},i.create({journal:LJ.get("remoteUser")}))}return o.prototype.toJSON=function(t){var r=angular.copy(t);return delete r.checked,delete r.users,r},o.prototype.nextId=function(){for(var t=null,r=this.filters.map(LJ.Function.get("id")),e=1,i=this.MAX_COUNT;i>e&&null===t;)-1===r.indexOf(e)&&(t=e),e+=1;return t},o.prototype.sync=function(t){var r={};return angular.isArray(t)||(t=[t]),r[this.key]=t.map(this.toJSON),r.journal=this.get("journal"),e.call(this.rpc.update,r)},o.prototype.fetch=function(r){if(!this.rpc.read)return t.reject();var i=this,n={journal:this.get("journal")};return r=angular.extend(r||{},{cache:!1}),e.call(this.rpc.read,n,r).then(function(t){return i.filters=t[i.key],i.filters})},o.prototype._isNameUniq=function(t){var r=this.filters.map(function(t){return t.name.toLowerCase()});return t=t.toLowerCase(),-1===r.indexOf(t)},o.prototype.create=function(r){var i;return r=r.trim(),0===r.length?t.reject("filters"===this.key?LJ.ml("api.error.filters.filter_name_not_specified"):LJ.ml("api.error.groups.group_name_not_specified")):this._isNameUniq(r)?(i={id:this.nextId(),name:r,users:[],"public":!1,journal:this.get("journal")},this.filters.push(i),e.call(this.rpc.create,i)):t.reject("filters"===this.key?LJ.ml("api.error.filters.filter_already_exist",{name:r}):LJ.ml("api.error.groups.group_already_exist",{name:r}))},o.prototype.remove=function(t){var r=this,i={};return t=Array.isArray(t)?t:[t],i[this.key]=t.map(LJ.Function.get("id")),i.journal=this.get("journal"),t.forEach(function(t){r.filters.splice(r.filters.indexOf(t),1)}),e.call(this.rpc.remove,i)},o.prototype.getCount=function(){return e.call(this.rpc.count,{journal:this.get("journal")}).then(LJ.Function.get("count"))},o.prototype.by=function(t){var r=n.Cache.get(t);return r?this.filters.filter(function(r){return n.isUserInGroup(t,r.id)}):[]},o}]).factory("Filter",["FilterGroupFactory",function(t){function r(){this.rpc={create:"filters.create",update:"filters.update",remove:"filters.remove",count:"filters.count"},this.key="filters"}return r.prototype=new t,r.prototype._setPrivacy=function(t,r){return t=Array.isArray(t)?t:[t],t.forEach(LJ.Function.set("public","public"===r)),this.sync(t)},r.prototype["private"]=function(t){return this._setPrivacy(t,"private")},r.prototype["public"]=function(t){return this._setPrivacy(t,"public")},new r}]).factory("Group",["FilterGroupFactory",function(t){function r(){this.rpc={create:"groups.create",read:"groups.list",update:"groups.update",remove:"groups.remove",count:"groups.count"},this.key="groups"}return r.prototype=new t,new r}])}();
/* <<< file end: js/settings/services/filters/filters.js */

//# map link was there [filters.js.map]
/* >>> file start: js/settings/directives/filtersFor.js */
//!= require js/core/angular/messages.js
LJ.injectStyle('/* >>> file start: stc/widgets/filter-settings.css */\n.b-filterset{max-width:290px;font:14px/1.4 Arial,sans-serif;color:#000}.b-filterset-addnew-input,.b-filterset-list LABEL{display:block;white-space:nowrap;line-height:1.333}.b-filterset B,.b-filterset CODE,.b-filterset DD,.b-filterset DIV,.b-filterset DT,.b-filterset EM,.b-filterset I,.b-filterset KBD,.b-filterset LABEL,.b-filterset LI,.b-filterset P,.b-filterset PRE,.b-filterset SPAN,.b-filterset STRONG,.b-filterset TD,.b-filterset TH{font-size:100%}.b-filterset .i-ljuser-userhead{vertical-align:top!important;margin:1px 0 0!important;border:none!important}.b-filterset .i-ljuser-username:active,.b-filterset .i-ljuser-username:hover,.b-filterset .i-ljuser-username:link,.b-filterset .i-ljuser-username:visited{color:#0051B7!important;text-decoration:none!important;border:none!important}.b-filterset .b-filterset-subtitle,.b-filterset .b-filterset-title{margin:0 1.142em .5em 0!important;color:#222!important}.b-filterset .b-filterset-title{font-weight:700!important}.b-filterset-list{position:relative;z-index:1;overflow:auto;max-height:14em;min-width:220px;margin:0 0 .3em;padding:0;background-attachment:scroll;background-clip:border-box;background-image:-webkit-radial-gradient(50% 0,farthest-side,rgba(0,0,0,.1),transparent),-webkit-radial-gradient(50% 100%,farthest-side,rgba(0,0,0,.1),transparent);background-image:radial-gradient(farthest-side at 50% 0,rgba(0,0,0,.1),transparent),radial-gradient(farthest-side at 50% 100%,rgba(0,0,0,.1),transparent);background-origin:padding-box;background-position:0 0,0 100%;background-repeat:no-repeat;background-size:100% 7px}.b-filterset-list:after,.b-filterset-list:before{position:relative;z-index:-1;display:block;content:\"\";height:14px;margin:0 0 -14px;background:-webkit-linear-gradient(top,#F4F5F6,#F4F5F6 30%,rgba(244,245,246,0));background:linear-gradient(to bottom,#F4F5F6,#F4F5F6 30%,rgba(244,245,246,0))}.b-filterset-list:after{margin:-14px 0 0;background:-webkit-linear-gradient(top,rgba(228,229,233,0),#E4E5E9 70%,#E4E5E9);background:linear-gradient(to bottom,rgba(228,229,233,0),#E4E5E9 70%,#E4E5E9)}.b-filterset-list LI{margin:0;padding:0;list-style-type:none}.b-filterset-list LI.loading{background:url(/img/preloader/preloader-blue-gray.gif?v=16423) 100% 50% no-repeat}.b-filterset-list LABEL{font-size:.857em}.b-filterset-list LABEL:hover{background:#7292BD;color:#FFF}.b-filterset-addnew-input{margin:0 0 .5em;font-size:.857em}.b-filterset-addnew{margin:.5em 0 0}.b-filterset-pseudo{font-size:.857em;color:#0051B7}.b-filterset-submit{text-align:right}.b-filterset-loader:after,.b-filterset-loader:before{display:inline-block;visibility:hidden;content:\'\';width:21px;height:21px;margin:-2px 0 0 4px;background:url(/img/preloader/preloader-blue-gray.gif?v=16423) 50% 50% no-repeat;vertical-align:middle}.b-filterset-loader-after:before,.b-filterset-loader-before:after{display:none}.b-filterset-loading .b-filterset-loader-after:after,.b-filterset-loading .b-filterset-loader-before:before{visibility:visible}\n/* <<< file end: stc/widgets/filter-settings.css */\n\n/*# sourceMappingURL=filter-settings.css.map */\n');
Site.page.template['angular/controlstrip/filters.ng.tmpl'] = '<div class=\"b-filterset-body\" ng-class=\"{ \'b-filterset-loading\': model.loading }\">\n    <ul class=\"b-filterset-section b-filterset-list\">\n        <li ng-repeat=\"filter in filters | filtersOrder\" ng-class=\"{ \'loading\': loading[filter.id] }\">\n            <label>\n                <input\n                    ng-checked=\"checked = isActive(filter.id)\"\n                    ng-change=\"toggleFilter(filter.id, checked)\"\n                    ng-model=\"checked\"\n                    type=\"checkbox\"\n                    class=\"b-filterset-checkbox\"\n                    >{{filter.name}}\n            </label>\n        </li>\n\n        <li ng-show=\"model.showCreateDialog\">\n            <span class=\"b-filterset-addnew-input\" >\n                <form ng-submit=\"createFilter()\">\n                    <input\n                        ng-model=\"model.newFilter\"\n                        focus-and-select=\"model.showCreateDialog\"\n                        type=\"text\"\n                        />\n                    <input type=\"submit\" lj-ml=\"filterset.button.save\" lj-ml-attr=\"value\" />\n                </form>\n            </span>\n        </li>\n    </ul>\n\n    <div\n        ng-hide=\"model.showCreateDialog || isFiltersCountReached()\"\n        class=\"b-filterset-section b-filterset-addnew\">\n        <span\n            ng-if=\"isFiltersFor\"\n            ng-click=\"model.showCreateDialog = true\"\n            lj-ml=\"filterset.link.addnewfilter\"\n            class=\"b-filterset-pseudo b-pseudo\"\n            ></span>\n        <span\n            ng-if=\"isGroupsFor\"\n            ng-click=\"model.showCreateDialog = true\"\n            lj-ml=\"filterset.link.addnewgroup\"\n            class=\"b-filterset-pseudo b-pseudo\"\n            ></span>\n    </div>\n</div>\n';
!function(e){return e}(),function(){"use strict";function e(e,r,t,n,o,i){function l(){return Array.isArray(e.usernames)?e.usernames:[e.usernames]}e.loading={},e.filters=[],t.fetch({cache:!0}).then(function(r){e.filters=r}),e.model={newFilter:"",showCreateDialog:!1},e.toggleFilter=function(r,t){var o;i.clear(),e.loading[r]=!0,o=t?n.addToGroup(r,l()):n.removeFromGroup(r,l()),o.then(function(){e.loading[r]=!1})},e.isActive=function(e){var r=l().every(function(r){return n.isUserInGroup(r,e)});return r},e.isCountReached=function(){return e.filters.length>=t.MAX_COUNT},e.createFilter=function(){var r=e.model.newFilter.trim();e.resetFilter(),0!==r.length&&(e.model.loading=!0,t.create(r).then(function(r){var t=r.filter;n.addToGroup(t.id,l()).then(function(){e.model.loading=!1})}))},e.resetFilter=function(){e.model.newFilter="",e.model.showCreateDialog=!1},e.$on("bubble:open:controlstrip",e.resetFilter)}angular.module("Filters.List",[]).controller("FiltersForCtrl",["$scope","$q","Filter","Users","Bubble","Messages",e]).controller("GroupsForCtrl",["$scope","$q","Group","Users","Bubble","Messages",e]).directive("filtersFor",[function(){return{controller:"FiltersForCtrl",scope:{usernames:"=filtersFor"},templateUrl:"filters.ng.tmpl",link:function(e){e.isFiltersFor=!0}}}]).directive("groupsFor",[function(){return{controller:"GroupsForCtrl",scope:{usernames:"=groupsFor"},templateUrl:"filters.ng.tmpl",link:function(e){e.isGroupsFor=!0}}}])}();
/* <<< file end: js/settings/directives/filtersFor.js */

//# map link was there [filtersFor.js.map]
/* >>> file start: js/relations/menu.js */
//= require js/core/angular/bubble.js
//= require js/core/angular/ljUser.js
//!= require js/core/angular/messages.js
//= require js/settings/services/filters/filters.js
//= require js/core/angular/users.js
//= require js/settings/directives/filtersFor.js
Site.page.template['angular/controlstrip/controlstrip.ng.tmpl'] = '<div\n  class=\"b-filterset\"\n  ng-class=\"{ \'b-filterset-loading\': loading }\"\n  >\n\n  <!-- subscribe user -->\n  <div class=\"b-filterset-title\" ng-show=\"mode == \'subscribe\'\" lj-ml=\"filterset.title.subscribed.journal\" lj-ml-resolve=\"mlResolve\"></div>\n\n  <!-- add user -->\n  <div class=\"b-filterset-title\" ng-show=\"mode == \'add\'\" lj-ml=\"filterset.title.addfriend.journal\" lj-ml-resolve=\"mlResolve\"></div>\n  <div class=\"b-filterset-subtitle\" ng-show=\"mode == \'add\'\" lj-ml=\"filterset.subtitle.addfriend.journal\" lj-ml-resolve=\"mlResolve\"></div>\n\n  <!-- subscribe community -->\n  <div class=\"b-filterset-title\" ng-show=\"mode == \'watch\'\" lj-ml=\"filterset.title.subscribed.community\" lj-ml-resolve=\"mlResolve\"></div>\n\n  <!-- join community -->\n  <div class=\"b-filterset-title\" ng-show=\"mode == \'join\' || mode == \'joinSubscribed\'\" lj-ml=\"filterset.title.join\"></div>\n  <div class=\"b-filterset-subtitle\" ng-show=\"mode == \'join\'\" lj-ml=\"filterset.subtitle.join\" lj-ml-resolve=\"mlResolve\"></div>\n  <div class=\"b-filterset-section b-filterset-submit\" ng-show=\"mode == \'join\'\">\n      <div class=\"b-ljbutton b-filterset-loader b-filterset-loader-before\">\n          <input type=\"submit\" lj-ml=\"filterset.submit.subscribe\" lj-ml-attr=\"value\" ng-click=\"subscribeAfterJoin()\" />\n      </div>\n  </div>\n\n  <!-- filters section -->\n  <!-- Notice: extra div here is because of bug in AngularJS: https://github.com/angular/angular.js/issues/3981 -->\n\n  <div ng-show=\"mode !== \'join\'\">\n    <div\n      class=\"b-filterset-subtitle b-filterset-loader b-filterset-loader-after\"\n      lj-ml=\"filterset.subtitle.filters\"\n      ></div>\n      <div filters-for=\"username\"></div>\n  </div>\n</div>\n';
!function(e){return e}(),function(e){"use strict";function t(e){LJ.Track.event("Relations","Menu",e)}angular.module("Relations.Menu",["LJ.Templates","LJ.Bubble","LJ.Directives","LJ.User","LJ.Messages","GroupsAndFilters.Services.Filters","Users","Filters.List"]).value("$anchorScroll",null).controller("MenuCtrl",["$scope","Bubble","$timeout","$q","ljUser","Filter","Users","Relations","Messages",function(n,s,r,i,o,u,c,a,l){function b(e,t){var s;switch(t&&d(t),e){case"addFriend":s=a.toggleFriend(h,!0,{wait:!0});break;case"removeFriend":s=a.toggleFriend(h,!1,{wait:!0});break;case"join":s=a.toggleMember(h,!0,{wait:!0});break;case"leave":s=a.toggleMember(h,!1,{wait:!0});break;case"subscribe":s=a.toggleSubscription(h,!0,{wait:!0});break;case"unsubscribe":s=a.toggleSubscription(h,!1,{wait:!0})}return s["finally"](m).then(function(t){return ContextualPopup.currentElement===v.find(".ljuser img").get(0)&&ContextualPopup.hide(),t.error?i.reject(t.error.message):(t.message&&(t.message.body=t.message.content,l.add(t.message)),"undefined"!=typeof t.controlstrip_status&&(n.status=t.controlstrip_status),"subscribe"===e||"addFriend"===e||"join"===e&&t.is_subscribedon?f():void(n.filters=[]))},function(e){l.error({body:e})})}function f(){var e,t=c.Cache.get(h);return t.is_subscribedon?(e=t.filtermask?i.defer().resolve():c.fetchUser(h,{filtermask:1}),i.all({filters:u.fetch({cache:!0}),user:e}).then(function(e){n.filters=e.filters})):i.reject()}function d(e){g&&m(),g=(new Hourglass).setEvent(e).show()}function m(){g&&(g.remove(),g=null)}var g,p,v=e(".w-cs-status"),h=LJ.get("journal.username");c.set({type:"subscriptions"}),n.username=h,n.filters=[],n.status=LJ.get("controlstrip.status"),c.Cache.add(LJ.get("journal")),ContextualPopup.showNote=angular.identity,p=i.defer(),n.mlResolve={promise:p.promise},o.get(h,{noctxpopup:!0}).then(function(e){p.resolve({username:e})}),n.$watch(function(){return c.Cache.get(h)},function(e){n.states=LJ.Object.pick(e,"is_friend","is_member","is_subscribedon","is_invite_sent")},!0),n.toggleLoading=function(e){n.loading=e},LJ.Event.on("relations.change",function(){r(l.clear)}),n.subscribe=function(e){e.preventDefault(),t("subscribe"),b("subscribe",e).then(function(){n.states.is_subscribedon&&(n.mode="subscribe",s.open("controlstrip","unsubscribe"))})},n.unsubscribe=function(e){e.preventDefault(),t("unsubscribe"),b("unsubscribe",e)},n.addFriend=function(e){e.preventDefault(),t("add friend"),b("addFriend",e).then(function(){n.states.is_friend&&(n.mode="add",s.open("controlstrip","removeFriend"))})},n.removeFriend=function(e){e.preventDefault(),t("remove friend"),b("removeFriend",e)},n.watch=function(e){e.preventDefault(),t("subscribe to community"),b("subscribe",e).then(function(){n.states.is_subscribedon&&(n.mode="watch",s.open("controlstrip","unwatch"))})},n.unwatch=function(e){e.preventDefault(),t("unsubscribe from community"),b("unsubscribe",e)},n.join=function(e){e.preventDefault(),t("join community"),b("join",e).then(function(){n.states.is_member&&(n.mode=n.states.is_subscribedon?"joinSubscribed":"join",s.open("controlstrip","leave"))})},n.leave=function(e){e.preventDefault(),t("leave community"),b("leave",e)},n.subscribeAfterJoin=function(){n.toggleLoading(!0),t("subscribe to community (after join)"),b("subscribe").then(function(){n.toggleLoading(!1),n.mode="watch"})}}])}(jQuery);
/* <<< file end: js/relations/menu.js */

//# map link was there [menu.js.map]
/* >>> file start: js/controlstrip.js */
//= require js/jquery/jquery.calendarEvents.js
//= require js/relations/menu.js
!function(e){return e}(),function(e){"use strict";function o(){var o,t,n,l;LJ.get("remoteUser")&&(o=e(".s-header .s-header-extra-filter, #lj_controlstrip_new .w-cs-filter-inner"),0!==o.length&&(t=e("#sortByPoster"),n=t.find("[name=poster]"),l=t.find("[type=image]"),o.bubble({target:".s-header .w-cs-filter-icon, #lj_controlstrip_new .w-cs-filter-icon",showOn:"click",closeControl:!0,classNames:{containerAddClass:"b-bubble-filter"}}),n.input(function(){this.value.length?l.css("opacity",1).prop("disabled",!1):l.css("opacity",0).prop("disabled",!0)}),t.on("submit",function(e){n.val().length||e.preventDefault()})))}function t(){e(".s-header input[placeholder], #lj_controlstrip_new input[placeholder]").labeledPlaceholder()}function n(){o(),t(),LJ.Flags.isEnabled("new_friends_and_subscriptions")&&!l&&angular.bootstrap(e("[data-controlstrip]"),["Relations.Menu"]),function(){function o(e){var o=e.split(",").map(Number);return new Date(o[0],o[1],o[2])}var t=e(".s-header .w-cs-i-calendar a, #lj_controlstrip_new .w-cs-i-calendar a"),n=/^\/friends/.test(location.pathname),l=LJ.get("current_journal.url_journal"),r=LJ.get("controlstrip.calendar.earlyDate"),a=LJ.get("controlstrip.calendar.lastDate");t.length&&(t.calendar({showOn:"click",closeControl:!0,bubbleClass:!0,dayRef:l+"/"+(n?"friends/":"")+"%Y/%M/%D",allRefs:n,startMonth:r?o(LJ.get("controlstrip.calendar.earlyDate")):new Date,endMonth:a?o(LJ.get("controlstrip.calendar.lastDate")):new Date,classNames:{container:"w-cs-calendar"},ml:{caption:LJ.ml("web.controlstrip.view.calendar")}}).on("daySelected",function(e){e.preventDefault()}),n||t.calendarEvents({fetchOnFirstDisplay:!0}))}(),e(".b-loginpopup").bubble({target:".i-auth-control",closeControl:!1,showOn:"click"}),LJ.Flags.isEnabled("move_billboard_to_scheme")&&e("body").on("ljsale-load ljsale-slotRenderEnded",function(){var o=e("body > .s-header").height();o&&e("body").css("padding-top",o)}),e("input.text").labeledPlaceholder(),e("html").trigger("controlstrip-initialized")}var l=Boolean("undefined"!=typeof document.documentMode&&document.documentMode<8);e(function(){return 0!==e(".s-header, #lj_controlstrip_new").length||"xcolibur"===Site.page.scheme?void n():void e.get(LiveJournal.getAjaxUrl("controlstrip"),{user:LJ.get("currentJournal")},function(o){e(".body-content").length?e(o).prependTo(".body-content"):(e("html").removeClass("html-adaptive"),e(o).appendTo(document.body)),n()})}),e(function(){function o(o){var t=e("."+r.showElem+":not("+o+")");e(t).removeClass(r.showElem)}function t(){var o=e("."+r.showElem);o.length>0?e(l.bodyElem).addClass(r.showFader):e(l.bodyElem).removeClass(r.showFader)}function n(){var o=e("."+r.showElem);o.length>0?a.catchBlur=!0:a.catchBlur=!1}var l={bodyElem:e("body"),controls:e(".js--show-elem"),controlsHover:e(".js--show-elem-by-hover"),fader:e(".b-fader")},r={control:"js--show-elem",controlHover:"js--show-elem-by-hover",showElem:"js--is-shown",showFader:"js--show-fader",catchBlur:"js--catch-blur"},a={catchBlur:!1};e(document).on("click",function(){a.catchBlur&&o()}),e(l.controlsHover).hover(function(){var o=e(this).find("."+r.control),t={selector:e(o).data("elem")};e(t.selector).addClass(r.showElem)},function(){var o=e(this).find("."+r.control),t={selector:e(o).data("elem")};e(t.selector).removeClass(r.showElem),e(this).addClass(r.controlHover)}),e(l.controls).on("click",function(l){var a={selector:e(this).data("elem"),isShowFader:e(this).data("fader")||!1,isUseBlur:e(this).data("blur")||!1};o(a.selector),e(a.selector).toggleClass(r.showElem),e(this).parent().hasClass(r.controlHover)&&e(this).parent().removeClass(r.controlHover),a.isShowFader&&t(),a.isUseBlur&&n(),l.stopPropagation(),l.preventDefault()}),e(l.fader).on("click",function(){o(),e(l.bodyElem).removeClass(r.showFader)})})}(jQuery);
/* <<< file end: js/controlstrip.js */

//# map link was there [controlstrip.js.map]
/* >>> file start: js/lib/jquery.selectric.min.js */
!function(e){"use strict";var t="selectric",s="Input Items Open Disabled TempShow HideSelect Wrapper Hover Responsive Above Scroll",o=".sl",i={onChange:function(t){e(t).change()},maxHeight:300,keySearchTimeout:500,arrowButtonMarkup:'<b class="button">&#x25be;</b>',disableOnMobile:!0,openOnHover:!1,expandToItemText:!1,responsive:!1,preventWindowScroll:!0,inheritOriginalWidth:!1,customClass:{prefix:t,postfixes:s,camelCase:!0,overwrite:!0},optionsItemBuilder:"{text}"},n={add:function(e,t,s){this[e]||(this[e]={}),this[e][t]=s},remove:function(e,t){delete this[e][t]}},a={replaceDiacritics:function(e){for(var t="40-46 50-53 54-57 62-70 71-74 61 47 77".replace(/\d+/g,"\\3$&").split(" "),s=t.length;s--;)e=e.toLowerCase().replace(RegExp("["+t[s]+"]","g"),"aeiouncy".charAt(s));return e},format:function(e){var t=arguments;return(""+e).replace(/{(\d+|(\w+))}/g,function(e,s,o){return o&&t[1]?t[1][o]:t[s]})},nextEnabledItem:function(e,t){for(;e[t=(t+1)%e.length].disabled;);return t},previousEnabledItem:function(e,t){for(;e[t=(t>0?t:e.length)-1].disabled;);return t},toDash:function(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},triggerCallback:function(s,o){var i=o.element,l=o.options["on"+s];e.isFunction(l)&&l.call(i,i,o),n[s]&&e.each(n[s],function(){this.call(i,i,o)}),e(i).trigger(t+"-"+a.toDash(s),o)}},l=e(document),r=e(window),c=function(n,c){function d(t){if($.options=e.extend(!0,{},i,$.options,t),$.classes={},$.element=n,a.triggerCallback("BeforeInit",$),$.options.disableOnMobile&&L)return void($.disableOnMobile=!0);C(!0);var o=$.options.customClass,l=o.postfixes.split(" "),r=R.width();e.each(s.split(" "),function(e,t){var s=o.prefix+l[e];$.classes[t.toLowerCase()]=o.camelCase?s:a.toDash(s)}),x=e("<input/>",{"class":$.classes.input,readonly:L}),k=e("<div/>",{"class":$.classes.items,tabindex:-1}),T=e("<div/>",{"class":$.classes.scroll}),D=e("<div/>",{"class":o.prefix,html:$.options.arrowButtonMarkup}),y=e('<p class="label"/>'),I=R.wrap("<div>").parent().append(D.prepend(y),k,x),A={open:v,close:g,destroy:C,refresh:u,init:d},R.on(A).wrap('<div class="'+$.classes.hideselect+'">'),e.extend($,A),$.options.inheritOriginalWidth&&r>0&&I.width(r),p()}function p(){$.items=[];var t=R.children(),s="<ul>",i=t.filter(":selected").index();H=S=~i?i:0,(E=t.length)&&(t.each(function(t){var o=e(this),i=o.html(),n=o.prop("disabled"),l=$.options.optionsItemBuilder;$.items[t]={value:o.val(),text:i,slug:a.replaceDiacritics(i),disabled:n},s+=a.format('<li class="{1}">{2}</li>',e.trim([t==H?"selected":"",t==E-1?"last":"",n?"disabled":""].join(" ")),e.isFunction(l)?l($.items[t],o,t):a.format(l,$.items[t]))}),k.append(T.html(s+"</ul>")),y.html($.items[H].text)),D.add(R).add(I).add(x).off(o),I.prop("class",[$.classes.wrapper,$.options.customClass.overwrite?R.prop("class").replace(/\S+/g,$.options.customClass.prefix+"-$&"):R.prop("class"),$.options.responsive?$.classes.responsive:""].join(" ")),R.prop("disabled")?(I.addClass($.classes.disabled),x.prop("disabled",!0)):(j=!0,I.removeClass($.classes.disabled).on("mouseenter"+o+" mouseleave"+o,function(t){e(this).toggleClass($.classes.hover),$.options.openOnHover&&(clearTimeout($.closeTimer),"mouseleave"==t.type?$.closeTimer=setTimeout(g,500):v())}),D.on("click"+o,function(e){Y?g():v(e)}),x.prop({tabindex:q,disabled:!1}).on("keypress"+o,h).on("keydown"+o,function(e){h(e),clearTimeout($.resetStr),$.resetStr=setTimeout(function(){x.val("")},$.options.keySearchTimeout);var t=e.keyCode||e.which;t>36&&41>t&&b(a[(39>t?"previous":"next")+"EnabledItem"]($.items,S))}).on("focusin"+o,function(e){x.one("blur",function(){x.blur()}),Y||v(e)}).on("oninput"in x[0]?"input":"keyup",function(){x.val().length&&e.each($.items,function(e,t){return RegExp("^"+x.val(),"i").test(t.slug)&&!t.disabled?(b(e),!1):void 0})}),R.prop("tabindex",!1),O=e("li",k.removeAttr("style")).click(function(){return b(e(this).index(),!0),!1})),a.triggerCallback("Init",$)}function u(){a.triggerCallback("Refresh",$),p()}function h(e){var t=e.keyCode||e.which;13==t&&e.preventDefault(),/^(9|13|27)$/.test(t)&&(e.stopPropagation(),b(S,!0))}function f(){var e=k.closest(":visible").children(":hidden"),t=$.options.maxHeight;e.addClass($.classes.tempshow);var s=k.outerWidth(),o=D.outerWidth()-(s-k.width());!$.options.expandToItemText||o>s?W=o:(k.css("overflow","scroll"),I.width(9e4),W=k.width(),k.css("overflow",""),I.width("")),k.width(W).height()>t&&k.height(t),e.removeClass($.classes.tempshow)}function v(s){a.triggerCallback("BeforeOpen",$),s&&(s.preventDefault(),s.stopPropagation()),j&&(f(),e("."+$.classes.hideselect,"."+$.classes.open).children()[t]("close"),Y=!0,B=k.outerHeight(),M=k.height(),x.val("").is(":focus")||x.focus(),l.on("click"+o,g).on("scroll"+o,m),m(),$.options.preventWindowScroll&&l.on("mousewheel"+o+" DOMMouseScroll"+o,"."+$.classes.scroll,function(t){var s=t.originalEvent,o=e(this).scrollTop(),i=0;"detail"in s&&(i=-1*s.detail),"wheelDelta"in s&&(i=s.wheelDelta),"wheelDeltaY"in s&&(i=s.wheelDeltaY),"deltaY"in s&&(i=-1*s.deltaY),(o==this.scrollHeight-M&&0>i||0==o&&i>0)&&t.preventDefault()}),I.addClass($.classes.open),w(S),a.triggerCallback("Open",$))}function m(){f(),I.toggleClass($.classes.above,I.offset().top+I.outerHeight()+B>r.scrollTop()+r.height())}function g(){if(a.triggerCallback("BeforeClose",$),H!=S){a.triggerCallback("BeforeChange",$);var e=$.items[S].text;R.prop("selectedIndex",H=S).data("value",e),y.html(e),a.triggerCallback("Change",$)}l.off(o),I.removeClass($.classes.open),Y=!1,a.triggerCallback("Close",$)}function b(e,t){$.items[e].disabled||(O.removeClass("selected").eq(S=e).addClass("selected"),w(e),t&&g())}function w(e){var t=O.eq(e).outerHeight(),s=O[e].offsetTop,o=T.scrollTop(),i=s+2*t;T.scrollTop(i>o+B?i-B:o>s-t?s-t:o)}function C(e){j&&(k.add(D).add(x).remove(),!e&&R.removeData(t).removeData("value"),R.prop("tabindex",q).off(o).off(A).unwrap().unwrap(),j=!1)}var x,k,T,D,y,I,O,S,H,B,M,W,E,A,$=this,R=e(n),Y=!1,j=!1,L=/android|ip(hone|od|ad)/i.test(navigator.userAgent),q=R.prop("tabindex");d(c)};e.fn[t]=function(s){return this.each(function(){var o=e.data(this,t);o&&!o.disableOnMobile?""+s===s&&o[s]?o[s]():o.init(s):e.data(this,t,new c(this,s))})},e.fn[t].hooks=n}(jQuery);
/* <<< file end: js/lib/jquery.selectric.min.js */

//# map link was there [jquery.selectric.min.js.map]
/* >>> file start: js/captcha.js */
!function(e){return e}(),function(e){function t(){return"undefined"!=typeof d}function n(){var t=e.Deferred();return s?t.resolve(s):LJ.Api.call("captcha.get_public_key",{},function(e){s=e.captcha_public,t.resolve(s)}),t.promise()}function r(){return location.protocol+"//www.google.com/recaptcha/api.js?onload=onRecaptchaLoad&render=explicit"}function a(r,a){var o=e.Deferred();return a=e.extend(C,a||{}),LJ.Captcha.current?e.when(n(),L()).then(function(){return t()?(a.sitekey=s,f(),d.render(r,a)):void console.error("Something went wrong. Captcha object is not defined.")}):(o.resolve(),o.promise())}function o(){}function c(){return t()?(f(),d.reset.apply(null,arguments)):void 0}function i(){return null}function l(e){return t()?d.getResponse(e):void 0}function p(){return h(),(d||grecaptcha).execute.apply(null,arguments)}function u(e){var t=e.attributes.title,n=e.attributes.src;if(t){var r=t.value;if(/испытание|challenge/.test(r)&&/recaptcha/.test(r))return!0}if(n){var a=n.value;if(/google\.com.*recaptcha.*bframe/.test(a))return!0}return!1}LJ.define("LJ.Captcha"),LJ.Captcha={create:a,reload:c,destroy:o,getChallenge:i,getResponse:l,isDefined:t,execute:p,current:["recaptcha"].filter(LJ.Flags.isEnabled).shift()},LJ.Captcha.available=!!LJ.Captcha.current;var s,d,f=void 0,v=void 0,h=void 0,C={lang:"ru"},g=e.Deferred();window.onRecaptchaLoad=function(){g.resolve()};var L=LJ.Function.once(function(){var t=e.Deferred();return LJ.injectScript(r()),g.then(function(){d=grecaptcha,t.resolve()}),t.promise()});LJ.Captcha.getCaptchaApiObject=function(){return d||grecaptcha},LJ.Captcha.setOnSimpleForm=function(e,t){f(),window.onCaptchaPass=function(){var t=Object.getPrototypeOf(e).submit;t.call(e)},t.addEventListener("click",function(e){e.preventDefault(),p()})},LJ.Event.on("reCAPTCHA::popup::created",function(e){var t=e.firstChild,n=e.lastChild,r=n.firstChild;e.classList.add("recaptcha-tiles"),t&&t.classList.add("recaptcha-tiles__fader"),n&&n.classList.add("recaptcha-tiles__iframe-wrapper"),r&&r.classList.add("recaptcha-tiles__iframe")}),LJ.Event.on("reCAPTCHA::popup::shown",function(){document.body.classList.add("body--recaptcha-opened")}),LJ.Event.on("reCAPTCHA::popup::hidden",function(){document.body.classList.remove("body--recaptcha-opened")}),function(){var e=void 0,t=void 0;f=function(){var n=document.body.lastChild;e=setInterval(function(){var r=document.body.lastChild;if(r!==n){n=r;var a=n.querySelector("iframe");a&&u(a)&&(t=n,console.log("reCAPTCHA popup created"),LJ.Event.trigger("reCAPTCHA::popup::created",t),clearInterval(e),e=null)}},100)};var n=void 0,r=void 0;v=function(){n=new Date,r||(r=setInterval(function(){t&&0===+t.style.opacity&&(console.log("reCAPTCHA popup hidden"),LJ.Event.trigger("reCAPTCHA::popup::hidden"),clearInterval(r),r=null)},100))};var a=1e4;h=function(){n=new Date,r||(r=setInterval(function(){t&&1===+t.style.opacity?(console.log("reCAPTCHA popup shown"),LJ.Event.trigger("reCAPTCHA::popup::shown"),clearInterval(r),r=null,v()):new Date>n+a&&(console.log("reCAPTCHA popup taking too long to appear, aborting wait"),clearInterval(r),r=null)},100))}}()}(jQuery);
/* <<< file end: js/captcha.js */

//# map link was there [captcha.js.map]
/* >>> file start: js/scheme/schemius/feedback.js */
!function(e){"use strict";e(function(){function t(){s.addClass("p-feedback"),o=!0,u.val(r),LJ.get("remote")||LJ.Captcha.create("b-captcha",{tabindex:50}),n.bubble("hide")}var a=this,s=e("body"),o=!1,r=e(".js-feedback").attr("data-spcatid"),n=e(".s-welcometo"),c=e(".s-do-item-feedback"),l=e(".s-feedback"),i=l.find(".s-feedback-error"),d=l.find(".b-bubble-success-inner"),u=l.find('.s-feedback-body .s-feedback-form input[name="spcatid"]'),f={inprogress:"s-feedback-creating",done:"s-feedback-successfully",error:"s-feedback-erroneously"};e(".js-feedback").on("click",function(e){e.preventDefault(),t()}),this.setState=function(e){l.toggleClass(f.inprogress,"inprogress"===e),l.toggleClass(f.done,"done"===e),l.toggleClass(f.error,"error"===e)},l.on("click",".s-feedback-submit",function(t){var s={};t.preventDefault(),a.setState("inprogress"),l.find("input, textarea, select").each(function(){s[this.name]=e(this).val()}),LJ.Api.call("support.create_request",s,function(t){return t.error?(i.html(t.error.message),a.setState("error")):(d.html(e("<a>").attr("href",t.request.url).html(t.request.url)),void a.setState("done"))})}).on("click",".s-feedback-another",function(t){t.preventDefault(),l.find("input, textarea").each(function(){e(this).val("")}),LJ.Captcha.reload(),a.setState(null)}),n.bubble({target:c,showOn:"click",alwaysShowUnderTarget:!0,arrowWidth:"auto"}).on("click",".s-welcometo-action .b-flatbutton",function(e){e.preventDefault(),t()}).on("click",".s-welcometo-switcher",function(e){return e.preventDefault(),LJ.get("remote")?void LJ.Api.call("settings.set_old_design",{value:1},function(){location.reload()}):(LJ.Cookie.setGlobal("ljold",1,{expires:7}),void location.reload())}),s.on("click",function(t){var r=e(t.target);o&&(r.hasClass("b-fader")||r.hasClass("s-feedback-close"))&&(s.removeClass("p-feedback"),u.val(""),o=!1,a.setState(null),LJ.get("remote")||LJ.Captcha.destroy())})})}(jQuery);
/* <<< file end: js/scheme/schemius/feedback.js */

//# map link was there [feedback.js.map]
/* >>> file start: js/core/angular/simple-scrollbar.js */
!function(t,e){"use strict";function s(t,s){function i(t){var e=t.pageY-n;n=t.pageY,r(function(){s.el.scrollTop+=e/s.scrollRatio})}function a(){t.classList.remove("ss-grabbed"),e.body.classList.remove("ss-grabbed"),e.removeEventListener("mousemove",i),e.removeEventListener("mouseup",a)}var n;t.addEventListener("mousedown",function(s){return n=s.pageY,t.classList.add("ss-grabbed"),e.body.classList.add("ss-grabbed"),e.addEventListener("mousemove",i),e.addEventListener("mouseup",a),!1})}function i(i){for(this.target=i,this.bar='<div class="ss-scroll">',this.wrapper=e.createElement("div"),this.wrapper.setAttribute("class","ss-wrapper"),this.el=e.createElement("div"),this.el.setAttribute("class","ss-content"),this.wrapper.appendChild(this.el);this.target.firstChild;)this.el.appendChild(this.target.firstChild);this.target.appendChild(this.wrapper),this.target.insertAdjacentHTML("beforeend",this.bar),this.bar=this.target.lastChild,s(this.bar,this),this.moveBar(),this.el.addEventListener("scroll",this.moveBar.bind(this)),this.el.addEventListener("mouseenter",this.moveBar.bind(this)),this.target.classList.add("ss-container");var r=t.getComputedStyle(i);"0px"===r.height&&"0px"!==r["max-height"]&&(i.style.height=r["max-height"])}angular.module("Scrollbar",[]),angular.module("Scrollbar").constant("SimpleScrollbar",i);var r=t.requestAnimationFrame||t.setImmediate||function(t){return setTimeout(t,0)};i.prototype={moveBar:function(){var t=this.el.scrollHeight,e=this.el.clientHeight,s=this;this.scrollRatio=e/t,r(function(){1===s.scrollRatio?s.bar.classList.add("ss-hidden"):(s.bar.classList.remove("ss-hidden"),s.bar.style.cssText="height:"+100*s.scrollRatio+"%; top:"+s.el.scrollTop/t*100+"%;right:-"+(s.target.clientWidth-s.bar.clientWidth)+"px;")})},setElementHeight:function(t){this.el.style.height=t,this.moveBar()}}}(window,document);
/* <<< file end: js/core/angular/simple-scrollbar.js */

//# map link was there [simple-scrollbar.js.map]
/* >>> file start: js/notifications/main.js */
Site.page.template['angular/widgets/notifications/notifications.ng.tmpl'] = '<div class=\"popupus popupus--notices\" ng-class=\"{\'svgpreloader-30 svgpreloader-pseudo svgpreloader\': notifications.loading}\" ng-controller=\"NotificationCtrl as notifications\">\n    <div class=\"popupus__inner\">\n        <div\n            class=\"notices\"\n            ng-class=\"{\'notices__has-notifications\': notifications.counter > 0}\"\n            >\n            <header class=\"notices__header\">\n                <h3\n                    class=\"notices__title\"\n                    lj-ml=\"notification.centre.title\"\n                    lj-ml-resolve=\"{ count: notifications.counter }\"\n                    lj-ml-dynamic=\"notifications.counter\"\n                    >\n                    </h3>\n                <a \n                    href=\"#\"\n                    ng-click=\"notifications.readAll()\"\n                    ng-show=\"notifications.entries.length > 0\"\n                    class=\"notices__read\"\n                    lj-ml=\"notification.centre.read.all\"\n                    >\n                    </a>\n                <span><TMPL_VAR statprefix></span>\n            </header>\n            <div\n                class=\"notices__body\"\n                notifications-content\n                ng-show=\"notifications.entries.length > 0\"\n                >\n                <div class=\"notices__body-wrapper\">\n                <ul class=\"notices__list\">\n                    <li\n                        ng-repeat=\"entry in notifications.entries\"\n                        class=\"notices__item\"\n                        ng-class=\"{\n                            \'notices--{{entry.action}}\': true,\n                            \'notices--unread\': entry.unread\n                            }\"\n                        ng-mouseover=\"notifications.read(entry)\"\n                        >\n                        <a class=\"notices__item__link\" href=\"#\">\n                            <img ng-src=\"{{entry.main_user.img_url || notifications.defaultPic}}\" ng-alt=\"{{entry.main_user.name}}\" class=\"notices__userpic\">\n                            <h5 class=\"notices__item__title\">{{entry.notification_text}}</h5>\n                            <time class=\"notices__date\">{{entry.date}}</time>\n                            <p class=\"notices__publication-content\">{{entry.title}}</p>\n                            <ul class=\"notices__consilient-users-list\">\n                                <li class=\"notices__consilient-user\" ng-repeat=\"user in entry.other_users\">\n                                    <img ng-src=\"{{user.img_url || notifications.defaultPic}}\" ng-alt=\"{{user.name}}\" class=\"notices__consilient-userpic\">\n                                </li>\n                            </ul>\n                        </a>\n                    </li>\n                </ul>\n                </div>\n            </div>\n            <div\n                class=\"notices__body-empty\"\n                ng-show=\"notifications.entries.length === 0\"\n                >\n                You don\'t have any notifications\n            </div>\n\n            <div class=\"notices__footer\" ng-if=\"notifications.shouldShowMore()\">\n                <div class=\"notices__more\">\n                    <button\n                        ng-click=\"notifications.nextPage()\"\n                        class=\"\n                            flatbutton\n                            flatbutton--small\n                            flatbutton--neutral\n                            flatbutton--max\n                            \"\n                        lj-ml=\"notification.centre.previous\"\n                        >\n                        </button>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>';
Site.page.template['angular/widgets/notifications/notificationsIcon.ng.tmpl'] = '<div\n    class=\"\n        s-header-control\n        s-header-notifications\n        \"\n    >\n    <a\n        class=\"\n            s-header-control__icon\n            s-header-control__icon--circle\n            s-header-notifications__icon\n            \"\n        href=\"javascript: void(0)\"\n        notifications-panel\n        ng-if=\"enabled\"\n        lj-svg-icon=\"flaticon--notifications\"\n        ></a>\n    <span\n        class=\"s-header-notifications__counter\"\n        ng-class=\"{\'counter--shown\': count.count > 0}\"\n        ng-if=\"enabled\"\n        ng-controller=\"NotificationsCountCtrl as count\"\n        >{{count.count}}</span>\n</div>\n';
//= require js/core/angular/bubble.js
//= require js/core/angular/api.js
//= require js/core/angular/simple-scrollbar.js
//= require_ml notification.centre.title
//= require_ml notification.centre.read.all
//= require_ml notification.centre.previous
!function(n){return n}(),function(){"use strict";function n(n,t,i,o,e){function c(){var t=void 0;return d.length>0?void(t=n.$on("notifications:readPushed",function(){a(),t()})):void a()}function a(){r().then(function(t){g!==t.notifications&&(g=t.notifications,n.$broadcast("notifications:counterUpdated"))})}function r(){return i.call("notifications.getn",{silent:!0})}function u(n){return i.call("notifications.get",{page:n,silent:!0})}function f(){i.call("notifications.release",{id:d,silent:!0}),d=[],n.$broadcast("notifications:readPushed")}function s(t){d.push(t.id),t.unread=!1,g--,n.$broadcast("notifications:counterUpdated"),$()}function l(){i.call("notifications.release_all",{silent:!0}).then(function(t){"ok"===t&&(g=0,n.$broadcast("notifications:counterUpdated"))})}var d=[],p=[],g=0;c(),t(c,e);var $=LJ.Function.debounce(f,o);return{pushRead:s,entries:function(){return p},counter:function(){return g},getNotifications:u,readAll:l}}function t(n,t,i,o){function e(){(LJ.Support.isMobile()||LJ.Support.touch)&&t(c.readPage,1e3)}var c=this,a=0,r=0;c.entries=[],c.counter=o.counter(),c.loading=!1,c.defaultPic=LJ.get("statprefix")+"/img/userpics/userpic-user.png?v=15821",c.getPage=function(t){c.loading=!0,o.getNotifications(a).then(function(i){c.entries=i.notifications,r=i.pages,c.loading=!1,n.$broadcast("notifications:pageLoad:"+t)})},c.read=function(n){n.unread&&o.pushRead(n)},c.readPage=function(){c.part.forEach(c.read)},c.readAll=o.readAll,c.shouldShowMore=function(){return c.entries&&r-1>a},c.nextPage=function(){a++,c.getPage("next"),e(),n.$emit("notifications:nextPage")},n.$on("notifications:counterUpdated",function(){c.counter=o.counter()}),n.$on("bubble:open:notifications",function(){c.getPage("open"),e()}),n.$on("bubble:close:notifications",function(){a=0,c.entries=[]})}function i(n){function t(n,t){var i=LJ.Flags.isEnabled("notification_center_display");n.enabled=i,i&&t.removeClass("notices--hidden")}return{templateUrl:"notificationsIcon.ng.tmpl",link:t}}function o(n,t,i){var o=this;n.$on("notifications:counterUpdated",function(){t(function(){o.count=i.counter()})})}function e(n){function t(t,i){n.register({name:"notifications",template:"notifications.ng.tmpl"}),i.click(function(){t.$apply(function(){n.open("notifications",{alwaysBottom:!0,closeControl:!1},i)})})}return{link:t}}function c(n,t){function i(i,c){var a=c.find(".notices__body-wrapper")[0],r=new t(a);i.$on("notifications:pageLoad:open",function(){n(function(){return o(r,c)})}),i.$on("bubble:close:notifications",function(){n(function(){return e(r)})}),i.$on("notifications:pageLoad:next",function(){n(function(){e(r),o(r,c)})})}function o(n,t){n.setElementHeight(t.height()+"px")}function e(n){n.setElementHeight("100%")}return{link:i}}angular.module("Notifications",["LJ.Bubble","LJ.Api","Scrollbar"]),angular.module("Notifications").constant("READ_PUSH_DELAY",3e3).constant("CHECK_NEW_DELAY",1e4).factory("notificationService",n).directive("ljNotificationsIcon",i).directive("notificationsPanel",e).directive("notificationsContent",c).controller("NotificationCtrl",t).controller("NotificationsCountCtrl",o),n.$inject=["$rootScope","$interval","Api","READ_PUSH_DELAY","CHECK_NEW_DELAY"],t.$inject=["$scope","$timeout","$interval","notificationService"],i.$inject=["notificationService"],o.$inject=["$scope","$timeout","notificationService"],e.$inject=["Bubble"],c.$inject=["$timeout","SimpleScrollbar"]}();
/* <<< file end: js/notifications/main.js */

//# map link was there [main.js.map]
/* >>> file start: js/facebookMigration/migration.js */
//= require js/core/angular/api.js
//= require js/node_modules/moment/min/moment.min.js
Site.page.template['Widgets/facebook_migration.tmpl'] = '<div\n    class=\"modal-wrapper\"\n    ng-if=\"!migration.hidden\"\n    >\n    <div\n        class=\"\n            modal\n            fbmerge\n            fbmerge--step{{migration.step}}\n            fbmerge--hide-sharing\n        \"\n        ng-class=\"{\n            \'fbmerge--need-action\': migration.step >= 2 && migration.step <= 4,\n            \'fbmerge--loading\': migration.loading,\n            }\"\n        >\n\n        <!-- header -->\n        <header class=\"fbmerge__descr\">\n            <!-- steps: 1 -->\n            <div class=\"fbmerge__elem\n                        fbmerge__elem--step1\">\n                <h1 class=\"fbmerge__title\" lj-ml=\"fbmerging.step1.description.title\"></h1>\n\n                <div class=\"fbmerge__choice-buttons\">\n                    <button\n                        type=\"button\"\n                        class=\"\n                            fbmerge__flatbutton\n                            fbmerge__flatbutton--inverse\n                            fbmerge__choice-button\n                            fbmerge__choice-button--import\n                            flatbutton\n                            flatbutton--small\n                            \"\n                        ng-click=\"migration.importStep()\"\n                        lj-ml=\"fbmerging.step1.description.agreement\"\n                        ></button>\n                    <button\n                        type=\"button\"\n                        class=\"\n                            fbmerge__choice-button\n                            fbmerge__choice-button--no-border\n                            \"\n                        ng-click=\"migration.hide()\"\n                        lj-ml=\"fbmerging.step1.description.refusing\"\n                        ></button>\n                </div>\n            </div>\n\n            <!-- steps: 2 -->\n            <div class=\"fbmerge__elem\n                        fbmerge__elem--step2\">\n                <h1 class=\"fbmerge__title\" lj-ml=\"fbmerging.step2.description.title\"></h1>\n            </div>\n\n            <!-- steps: 3 -->\n            <div class=\"fbmerge__elem\n                        fbmerge__elem--step3\">\n                <h1\n                    class=\"fbmerge__title\"\n                    lj-ml=\"fbmerging.step3.description.title\"\n                    ng-if=\"migration.addr\"></h1>\n                <h1\n                    class=\"fbmerge__title\"\n                    lj-ml=\"fbmerging.step3.description.title2\"\n                    ng-if=\"!migration.addr\"></h1>\n            </div>\n\n            <!-- steps: 4 -->\n            <div class=\"fbmerge__elem\n                        fbmerge__elem--step4\">\n                <h1 class=\"fbmerge__title\" lj-ml=\"fbmerging.step4.description.title\"></h1>\n            </div>\n\n            <!-- steps: 5 -->\n            <div class=\"fbmerge__elem\n                        fbmerge__elem--step5\">\n                <h1\n                    class=\"fbmerge__title\"\n                    lj-ml=\"fbmerging.step5.description.title\"\n                    ></h1>\n                <p\n                    class=\"fbmerge__text fbmerge__text--step5\"\n                    lj-ml=\"fbmerging.step5.description.text\"\n                    ></p>\n                <p\n                    class=\"fbmerge__text fbmerge__text--step5\"\n                    ng-if=\"migration.needEmailConfirm\"\n                    >\n                    Confirm your email <a href=\"/register.bml\" target=\"_blank\">here</a>\n                    </p>\n\n            </div>\n            \n            <!-- steps: 6 -->\n            <div class=\"fbmerge__elem\n                        fbmerge__elem--step6\">\n                <h1 class=\"fbmerge__title\" lj-ml=\"fbmerging.step6.description.title\"></h1>\n            </div>\n            \n            <!-- steps: 7 -->\n            <div class=\"fbmerge__elem\n                        fbmerge__elem--step7\">\n                <h1 class=\"fbmerge__title\" lj-ml=\"fbmerging.step7.description.title\"></h1>\n                <form\n                    class=\"fbmerge__choice-buttons\"\n                    action=\"{{migration.sendMailAction}}\"\n                    method=\"post\"\n                    >\n                    <button\n                        class=\"\n                            fbmerge__flatbutton\n                            fbmerge__flatbutton--inverse\n                            fbmerge__choice-button\n                            fbmerge__choice-button--sendmail\n                            flatbutton \n                            flatbutton--small\n                            \"\n                        name=\"action:send\"\n                        value=\"1\"\n                        type=\"submit\"\n                        lj-ml=\"fbmerging.step7.description.sendmail\"\n                        ></button>\n                    <input type=\"hidden\" name=\"authas\" value=\"{{migration.authAs}}\">\n                    <a\n                        class=\"\n                            fbmerge__choice-button\n                            fbmerge__choice-button--no-border\n                            \"\n                        ng-href=\"{{migration.siteRoot}}/manage/settings/?cat=account\"\n                        lj-ml=\"fbmerging.step7.description.options\"\n                        ></a>\n                </form>\n            </div>\n        </header>\n        <!-- /header -->\n\n        <!-- sharing -->\n        <ul class=\"fbmerge__sharing\">\n            <li class=\"fbmerge__sharing-item\">\n                <span class=\"fbmerge__sharing-text\" lj-ml=\"fbmerging.sharing.title\"></span>\n            </li>\n            <li class=\"fbmerge__sharing-item\">\n                <a href=\"#\" class=\"fbmerge__sharing-link\" ng-click=\"migration.share(\'livejournal\')\">\n                    <svg class=\"fbmerge__sharing-img\" width=\"21px\" height=\"21px\" viewBox=\"0 0 21 21\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                        <path d=\"M12.79894,15.85731 C13.36944,14.53641 14.42504,13.47381 15.74244,12.89701 L16.51314,16.62521 L12.79894,15.85731 Z M11.10284,1.43661 C9.72244,1.43661 8.41064,1.72501 7.21994,2.23881 L5.07164,0.09331 L5.06674,0.09331 C2.79874,1.08661 0.98084,2.91361 0.00014,5.19001 L2.15124,7.33831 C3.13124,5.06191 4.94844,3.23631 7.21784,2.24231 L7.22134,2.24301 L15.17404,10.18451 L15.17264,10.18451 C12.90534,11.17781 11.08604,13.00551 10.10604,15.28051 L2.15054,7.34041 L2.15054,7.34111 C1.63114,8.53461 1.32174,9.83381 1.32174,11.21841 C1.32174,16.62171 5.70024,21.00021 11.10284,21.00021 C16.50334,21.00021 20.88324,16.62031 20.88324,11.21841 C20.88324,5.81651 16.50404,1.43661 11.10284,1.43661 L11.10284,1.43661 Z\" fill=\"#FFFFFF\"></path>\n                    </svg>\n                </a>\n            </li>\n            <li class=\"fbmerge__sharing-item\">\n                <a href=\"#\" class=\"fbmerge__sharing-link\" ng-click=\"migration.share(\'facebook\')\">\n                    <svg class=\"fbmerge__sharing-img\" width=\"11px\" height=\"21px\" viewBox=\"0 0 11 21\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                        <path d=\"M13.3242729,19.6465026 L13.3242729,16.0030329 L16.4703384,16.0030329 L16.4703384,13.3161097 C16.4703384,10.1979039 18.3747478,8.5 21.1563758,8.5 C22.4887569,8.5 23.6339895,8.59922756 23.9677631,8.64354981 L23.9677631,11.90223 L22.038479,11.9031345 C20.5257336,11.9031345 20.2327545,12.621969 20.2327545,13.6768385 L20.2327545,16.0030329 L23.8406759,16.0030329 L23.3708601,19.6465026 L20.2327545,19.6465026 L20.2327545,28.5930839 L16.4703384,28.5930839 L16.4703384,19.6465026 L13.3242729,19.6465026 Z\" fill=\"#FFFFFF\" transform=\"translate(-13.000000, -8.000000)\"></path>\n                    </svg>\n                </a>\n            </li>\n            <li class=\"fbmerge__sharing-item\">\n                <a href=\"#\" class=\"fbmerge__sharing-link\" ng-click=\"migration.share(\'twitter\')\">\n                    <svg class=\"fbmerge__sharing-img\" width=\"18px\" height=\"14px\" viewBox=\"0 0 18 14\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                        <path d=\"M17.9599007,1.70276413 C17.2990905,1.98282691 16.5890102,2.1721722 15.8435869,2.25723946 C16.6043825,1.82148161 17.1886599,1.13133812 17.4637182,0.309104933 C16.7517985,0.712656502 15.9632803,1.00565202 15.1239153,1.16360717 C14.4518058,0.479239462 13.4941927,0.0515802691 12.4344263,0.0515802691 C10.3993752,0.0515802691 8.74961606,1.62824395 8.74961606,3.5728 C8.74961606,3.84884484 8.7822,4.11754439 8.84500292,4.3752574 C5.78270365,4.22841435 3.06765985,2.82653094 1.25031679,0.696145291 C0.933148905,1.21621704 0.751440876,1.82110493 0.751440876,2.46642332 C0.751440876,3.68806457 1.40193723,4.76587623 2.39062336,5.39738296 C1.78663796,5.3791139 1.21845547,5.2206565 0.721681752,4.95691659 C0.721418978,4.97160717 0.721353285,4.98636054 0.721353285,5.00117668 C0.721353285,6.70729327 1.99147007,8.13052197 3.67709781,8.4540287 C3.36787883,8.53445022 3.04236788,8.57745471 2.70634599,8.57745471 C2.46886423,8.57745471 2.23808321,8.55541883 2.01308321,8.51429776 C2.48200292,9.91329327 3.84277664,10.9313381 5.4551562,10.9598404 C4.19403942,11.9042439 2.60530949,12.4671318 0.878951825,12.4671318 C0.581557664,12.4671318 0.288236496,12.4504951 -2.6277372e-05,12.4179749 C1.63068175,13.4170601 3.56745547,13.9999749 5.64829489,13.9999749 C12.4258204,13.9999749 16.131981,8.63439641 16.131981,3.98112287 C16.131981,3.82844126 16.1283679,3.67657578 16.1213387,3.52558924 C16.8412073,3.02912287 17.4658861,2.40891659 17.9599007,1.70276413\"  fill=\"#FFFFFF\"></path>\n                    </svg>\n                </a>\n            </li>\n            <li>\n                <input\n                    type=\"hidden\"\n                    name=\"returnto\"\n                    value=\"{{migration.returnTo}}\"\n                    >\n            </li>\n        </ul>\n        <!-- /sharing -->\n\n        <!-- statuses -->\n        <div class=\"fbmerge__statuses\">\n            <div class=\"fbmerge__status fbmerge__status--fb\">\n                <svg \n                    class=\"fbmerge__status-img fbmerge__status-img--fb\" \n                    width=\"41px\" height=\"77px\" \n                    viewBox=\"0 0 41 77\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                    <path d=\"M501.307329,250.375956 L501.307329,236.589854 L513.189472,236.589854 L513.189472,226.423118 C513.189472,214.624501 520.382096,208.2 530.887822,208.2 C535.919994,208.2 540.245339,208.575456 541.505944,208.743161 L541.505944,221.073303 L534.219373,221.076725 C528.505996,221.076725 527.399465,223.79664 527.399465,227.788038 L527.399465,236.589854 L541.025958,236.589854 L539.251545,250.375956 L527.399465,250.375956 L527.399465,284.227885 L513.189472,284.227885 L513.189472,250.375956 L501.307329,250.375956 Z\" fill=\"#ffffff\" transform=\"translate(-501.000000, -208.000000)\"></path>\n                </svg>\n            </div>\n            <div class=\"fbmerge__status fbmerge__status--lj\">\n                <svg \n                    class=\"fbmerge__status-img fbmerge__status-img--lj\" \n                    width=\"82px\" height=\"84px\" \n                    viewBox=\"0 0 82 84\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\">\n                    <ellipse fill=\"#00B2ED\" cx=\"40.8747045\" cy=\"41.65\" rx=\"36.6824271\" ry=\"36.75\"></ellipse>\n                    <path d=\"M47.640062,58.94042 L61.6681208,61.84612 L58.7572829,47.73902 C53.7817484,49.92162 49.7948926,53.94242 47.640062,58.94042\" fill=\"#981658\"></path>\n                    <path d=\"M47.640062,58.94042 C49.7948926,53.94242 53.7817484,49.92162 58.7572829,47.73902 L61.6681208,61.84612 L47.640062,58.94042 Z\" fill=\"#00344B\"></path>\n                    <path d=\"M27.2679695,8.1179 L19.1545154,0 L19.1356501,0 C10.5701287,3.7583 3.70387707,10.6715 0,19.2843 L8.12463357,27.4134 C11.8257158,18.7999 18.6891726,11.8923 27.2602837,8.1312 L27.2735592,8.134 L27.2679695,8.1179 Z\" fill=\"#00B2ED\"></path>\n                    <path d=\"M7.68584187,26.9927 L7.68584187,26.9899 L37.7325926,57.0339 C41.4336748,48.4253 48.3048174,41.51 56.8682427,37.7517 L56.8731337,37.7517 L26.8375624,7.7028 L26.8242868,7.7 C18.2531757,11.4611 11.3897189,18.3687 7.68863672,26.9822 L7.68584187,26.9927 Z\" fill=\"#00344B\"></path>\n                    <path d=\"M58.9700287,47.5838092 C57.8019856,42.0097299 56.7485289,36.9790123 56.7485289,36.9790123 L56.7374399,36.9827087 C47.8810114,40.8675611 40.7729513,48.0014956 36.9398476,56.8985838 L47.4670214,59.1496543 C49.6996103,54.0043503 53.8358137,49.8311834 58.9700287,47.5838092\" fill=\"#FFFFFF\"></path>\n                </svg>\n            </div>\n        </div>\n        <!-- /statuses -->\n\n        <!-- steps: 2 -->\n        <form\n            class=\"fbmerge__container\n                fbmerge__elem\n                fbmerge__elem--step2\"\n            action=\"{{migration.loginLink}}\"\n            method=\"post\"\n            >\n            <ul class=\"fbmerge__inputs-list\">\n                <li class=\"fbmerge__inputs-item\">\n                    <label\n                        class=\"fbmerge__text-label\"\n                        for=\"fbmerge__login-username\"\n                        lj-ml=\"fbmerging.step2.form.login\"></label>\n                    <div class=\"fbmerge__input-wrapper\">\n                        <input\n                            class=\"fbmerge__text-input\"\n                            id=\"fbmerge__login-username\"\n                            name=\"user\"\n                            type=\"text\"\n                            ng-model=\"migration.step2.login\"\n                            >\n                        <span\n                            class=\"fbmerge__input-tooltip\"\n                            lj_ml=\"createaccount.error.username.inuse\"\n                            ></span>\n                    </div>\n                </li>\n                <li class=\"fbmerge__inputs-item\">\n                    <label\n                        class=\"fbmerge__text-label\"\n                        for=\"fbmerge__login-pass\"\n                        lj-ml=\"fbmerging.step2.form.password\"></label>\n                    <div class=\"fbmerge__input-wrapper\">\n                        <input\n                            class=\"fbmerge__text-input\"\n                            id=\"fbmerge__login-pass\"\n                            name=\"password\"\n                            type=\"password\"\n                            ng-model=\"migration.step2.password\"\n                            >\n                        <span\n                            class=\"fbmerge__input-tooltip\"\n                            lj_ml=\"createaccount.error.password.digits_only\"\n                            ></span>\n                    </div>\n                </li>\n            </ul>\n            \n            <div class=\"fbmerge__flatbutton-wrapper\">\n                <button\n                    class=\"\n                        fbmerge__flatbutton\n                        flatbutton\n                        flatbutton--small\n                        \"\n                    ng-class=\"{\'flatbutton--active\': migration.step2.login && migration.step2.password}\"\n                    lj-ml=\"fbmerging.step2.form.entry\"\n                    ng-disabled=\"!migration.step2.login && !migration.step2.password\"\n                    ></button>\n            </div>\n\n            <small\n                class=\"fbmerge__notice fbmerge__notice--step2\"\n                lj-ml=\"fbmerging.step2.form.notice\"\n                ></small>\n\n            <a\n                class=\"\n                    fbmerge__flatbutton\n                    fbmerge__flatbutton--fb\n                    flatbutton\n                    flatbutton--small\n                    \"\n                ng-attr-title=\"{{migration.fbLoginTitle}}\"\n                ng-href=\"{{migration.facebookLink}}\"\n                >\n                <span\n                    class=\"\n                        fbmerge__flatbutton-icon\n                        fbmerge__flatbutton-icon--fb\n                        \"\n                    lj-svg-icon=\"flaticon--facebook\"></span>\n                <span\n                    class=\"\n                        fbmerge__flatbutton-text\n                        fbmerge__flatbutton-text--fb\">\n                    Facebook\n                </span>\n                </a>\n        </form>\n        <!-- /steps: 2 -->\n\n        <!-- steps: 3 -->\n        <div class=\"fbmerge__container\n                    fbmerge__elem\n                    fbmerge__elem--step3\">\n\n            <div ng-if=\"migration.addr\">\n                <p\n                    class=\"fbmerge__text fbmerge__text--step3\"\n                    lj-ml=\"fbmerging.step3.form.text\"\n                    ></p>\n                <a\n                    class=\"\n                        fbmerge__flatbutton\n                        flatbutton\n                        flatbutton--small\n                        \"\n                    ng-href=\"{{migration.addr}}\"\n                    lj-ml=\"fbmerging.step3.form.allow\"\n                    ></a>\n            </div>\n            <div ng-if=\"!migration.addr\">\n                <ul class=\"fbmerge__inputs-list\">\n                    <li class=\"fbmerge__inputs-item\">\n                        <label\n                            class=\"fbmerge__text-label\"\n                            for=\"fbmerge__create-username\"\n                            lj-ml=\"fbmerging.step2.form.login\"\n                            ></label>\n                        <div class=\"fbmerge__input-wrapper\">\n                            <input\n                                class=\"fbmerge__text-input\"\n                                id=\"fbmerge__create-username\"\n                                name=\"user\"\n                                type=\"text\"\n                                ng-model=\"migration.username\"\n                                ng-class=\"{\'fbmerge__text-input--error\': migration.step3Errors.username.unchecked}\"\n                                >\n                            <span\n                                class=\"fbmerge__input-tooltip\"\n                                ng-style=\"{\'display\': migration.step3Errors.username.text ? \'block\' : \'none\'}\"\n                                ng-bind-html=\"migration.step3Errors.username.text\"\n                                ></span>\n                        </div>\n                        <small\n                            class=\"fbmerge__notice fbmerge__notice--step3\"\n                            lj-ml=\"createaccount.tip.username\"\n                            ></small>\n                    </li>\n                    <li class=\"fbmerge__inputs-item\">\n                        <label\n                            class=\"fbmerge__text-label\"\n                            for=\"fbmerge__create-email\"\n                            lj-ml=\"fbmerging.step3.form.mail\"\n                            ></label>\n                        <div class=\"fbmerge__input-wrapper\">\n                            <input\n                                class=\"fbmerge__text-input\"\n                                id=\"fbmerge__create-email\"\n                                name=\"email\"\n                                type=\"text\"\n                                ng-model=\"migration.email\"\n                                ng-class=\"{\'fbmerge__text-input--error\': migration.step3Errors.email.unchecked}\"\n                                >\n                            <span\n                                class=\"fbmerge__input-tooltip\"\n                                ng-style=\"{\'display\': migration.step3Errors.email.text ? \'block\' : \'none\'}\"\n                                ng-bind-html=\"migration.step3Errors.email.text\"\n                                ></span>\n                            <small\n                                class=\"fbmerge__notice fbmerge__notice--step3\"\n                                lj-ml=\"createaccount.tip.email\"\n                                ></small>\n                        </div>\n                    </li>\n                    <li class=\"fbmerge__inputs-item\">\n                        <label\n                            class=\"fbmerge__text-label\"\n                            for=\"fbmerge__create-pass\"\n                            lj-ml=\"fbmerging.step2.form.password\"\n                            ></label>\n                        <div class=\"fbmerge__input-wrapper\">\n                            <input\n                                class=\"fbmerge__text-input\"\n                                id=\"fbmerge__create-pass\"\n                                name=\"password\"\n                                type=\"password\"\n                                ng-model=\"migration.password\"\n                                ng-class=\"{\'fbmerge__text-input--error\': migration.step3Errors.password.unchecked}\"\n                                >\n                            <span\n                                class=\"fbmerge__input-tooltip\"\n                                ng-style=\"{\'display\': migration.step3Errors.password.text ? \'block\' : \'none\'}\"\n                                ng-bind-html=\"migration.step3Errors.password.text\"\n                                ></span>\n                        </div>\n                        <small\n                            class=\"fbmerge__notice fbmerge__notice--step3\"\n                            lj-ml=\"fbmerging.step3.form.user_password\"\n                            ></small>\n                    </li>\n                </ul>\n\n                <input\n                    name=\"gender\"\n                    type=\"hidden\"\n                    ng-model=\"migration.gender\"\n                    >\n\n                <div class=\"fbmerge__flatbutton-wrapper\">\n                    <a\n                    href=\"/identity/convert.bml\"\n                    target=\"_blank\"\n                    class=\"\n                        fbmerge__flatbutton\n                        flatbutton\n                        flatbutton--small\n                        \"\n                    ng-class=\"{\'flatbutton--active\': migration.convertationEnabled()}\"\n                    ng-click=\"migration.convertIdentity($event)\"\n                    lj-ml=\"fbmerging.step3.form.convert_but\"\n                    ng-disabled=\"!migration.convertationEnabled()\"\n                    ></a>\n                </div>\n                <small\n                    class=\"fbmerge__notice fbmerge__notice--step3\"\n                    lj-ml=\"fbmerging.step2.form.notice\"\n                    ></small>\n            </div>\n        </div>\n        <!-- /steps: 3 -->\n\n        <!-- steps: 4 -->\n        <form class=\"fbmerge__container\n                    fbmerge__elem\n                    fbmerge__elem--step4\">\n            <h3\n                class=\"fbmerge__subtitle\"\n                lj-ml=\"fbmerging.step4.form.title\"></h3>\n            <ul class=\"fbmerge__options\">\n                <li class=\"fbmerge__option\">\n                    <label class=\"fbmerge__option-label\">\n                        <input\n                            class=\"fbmerge__option-input\"\n                            type=\"radio\"\n                            name=\"period\"\n                            ng-model=\"migration.period\"\n                            ng-value=\"migration.week\"\n                            >\n                        <span\n                            class=\"fbmerge__option-text\"\n                            lj-ml=\"fbmerging.step4.form.week\"></span>\n                    </label>\n                </li>\n                <li class=\"fbmerge__option\">\n                    <label class=\"fbmerge__option-label\">\n                        <input\n                            class=\"fbmerge__option-input\"\n                            type=\"radio\"\n                            name=\"period\"\n                            ng-model=\"migration.period\"\n                            ng-value=\"migration.month\"\n                            checked\n                            >\n                        <span\n                            class=\"fbmerge__option-text\"\n                            lj-ml=\"fbmerging.step4.form.mounth\"></span>\n                    </label>\n                </li>\n                <li class=\"fbmerge__option\">\n                    <label class=\"fbmerge__option-label\">\n                        <input\n                            class=\"fbmerge__option-input\"\n                            type=\"radio\"\n                            name=\"period\"\n                            ng-model=\"migration.period\"\n                            ng-value=\"migration.halfYear\"\n                            >\n                        <span\n                            class=\"fbmerge__option-text\"\n                            lj-ml=\"fbmerging.step4.form.halfyear\"></span>\n                    </label>\n                </li>\n                <li class=\"fbmerge__option\">\n                    <label class=\"fbmerge__option-label\">\n                        <input\n                            class=\"fbmerge__option-input\"\n                            type=\"radio\"\n                            name=\"period\"\n                            ng-model=\"migration.period\"\n                            ng-value=\"0\"\n                            >\n                        <span\n                            class=\"fbmerge__option-text\"\n                            lj-ml=\"fbmerging.step4.form.all\"></span>\n                    </label>\n                </li>\n                <li class=\"fbmerge__option\">\n                    <label class=\"fbmerge__option-label\">\n                        <input\n                            class=\"fbmerge__option-input\"\n                            type=\"radio\"\n                            name=\"period\"\n                            ng-model=\"migration.period\"\n                            ng-value=\"1\"\n                            >\n                        <span\n                            class=\"fbmerge__option-text\"\n                            lj-ml=\"fbmerging.step4.form.nothing\"></span>\n                    </label>\n                </li>\n                <li class=\"fbmerge__option fbmerge__option--autoimport\">\n                    <label class=\"fbmerge__option-label\">\n                        <input\n                            class=\"fbmerge__option-input\"\n                            type=\"checkbox\"\n                            ng-model=\"migration.autoImport\"\n                            >\n                        <span\n                            class=\"fbmerge__option-text\"\n                            lj-ml=\"fbmerging.step4.form.autoimport\"></span>\n                    </label>\n                </li>\n            </ul>\n            <div class=\"fbmerge__flatbutton-wrapper\">\n                <button\n                    ng-click=\"migration.setPeriod()\"\n                    class=\"\n                        fbmerge__flatbutton\n                        flatbutton\n                        flatbutton--small\n                        \"\n                    lj-ml=\"fbmerging.step4.form.save\"\n                    ></button>\n            </div>\n        </form>\n        <!-- /steps: 4 -->\n\n        <!-- close button -->\n        <span\n            ng-click=\"migration.hide()\"\n            class=\"fbmerge__close modal__close\">\n            <span\n                class=\"fbmerge__close-icon\"\n                lj-svg-icon=\"flaticon--cross\"></span>\n        </span>\n        <!-- /close button -->\n    </div>\n</div>\n\n';
LJ.injectStyle('/* >>> file start: stc/widgets/facebookmigration.css */\n.fbmerge{width:820px;min-height:410px;text-align:left;font:400 15px/1.4 ProximaNova,Helvetica,sans-serif!important;letter-spacing:.01em;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}.fbmerge__elem--step1,.fbmerge__elem--step2,.fbmerge__elem--step3,.fbmerge__elem--step4,.fbmerge__elem--step5,.fbmerge__elem--step6,.fbmerge__elem--step7{display:none}.fbmerge__title{margin:73px 0 0!important;width:300px;font-size:28px;line-height:31px;font-weight:700;-webkit-font-feature-settings:\"kern\" off;font-feature-settings:\"kern\" off;font-variant:none;letter-spacing:inherit;word-spacing:normal;color:#FFF!important}.fbmerge__descr{position:absolute;box-sizing:border-box;top:0;left:0;padding-left:40px;width:50%;min-height:410px;-webkit-transition:opacity ease 1s;transition:opacity ease 1s;color:#FFF!important;z-index:2}.fbmerge__descr::after,.fbmerge__descr::before{content:\'\';display:table;clear:both}.fbmerge__container{position:relative;box-sizing:border-box;margin:0 0 0 auto;padding:0 50px 0 40px;width:50%;color:#4c4c4c!important}.fbmerge--step2 .fbmerge__container,.fbmerge--step3 .fbmerge__container,.fbmerge--step4 .fbmerge__container{padding-top:40px;padding-bottom:20px}.fbmerge__text{padding:0}.fbmerge__choice-buttons{min-width:174px;display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column}.fbmerge__choice-button{margin-bottom:10px}.fbmerge__choice-button:last-child{margin-bottom:0}.fbmerge__choice-button:hover{-webkit-transform:translateY(-2px);-ms-transform:translateY(-2px);transform:translateY(-2px)}.fbmerge__choice-button--no-border{padding:8px 20px;background-color:transparent;border:0;outline:0;text-align:center;text-transform:uppercase;font-size:11px;line-height:12px;color:#fff!important;cursor:pointer}.fbmerge__choice-button--no-border:hover,.fbmerge__choice-button--no-border:visited{color:#fff!important}.fbmerge__statuses{position:absolute;top:0;bottom:0;left:0;width:100%;border-radius:5px;background-color:#1EB2EA;-webkit-transition:width ease .7s;transition:width ease .7s;z-index:1}.fbmerge__status--fb,.fbmerge__status--lj{box-sizing:border-box;position:absolute;border:3px solid #FFF;width:162px;height:162px;bottom:84px;border-radius:50%;overflow:hidden}.fbmerge__status--lj{left:564px;background-color:#FFF;box-shadow:0 0 0 7px #00B1ED inset;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);-webkit-transition:ease 1s;transition:ease 1s;-webkit-transition-property:border,bottom,left;transition-property:border,bottom,left}.fbmerge__status-img--lj{position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%) rotate(-45deg);-ms-transform:translateX(-50%) translateY(-50%) rotate(-45deg);transform:translateX(-50%) translateY(-50%) rotate(-45deg);-webkit-transition:all ease .7s;transition:all ease .7s}.fbmerge__status--fb{left:441px;-webkit-transition:all ease .7s;transition:all ease .7s}.fbmerge__status-img--fb{position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%);width:40px;height:76px;-webkit-transition:all ease .7s;transition:all ease .7s}.fbmerge--need-action .fbmerge__statuses{width:50%;border-radius:5px 0 0 5px}.fbmerge--need-action .fbmerge__status--lj{left:40px;bottom:48px}.fbmerge--need-action .fbmerge__status--fb{width:0;height:0;border-width:0}.fbmerge--need-action .fbmerge__status-img--fb{width:0;height:0}.fbmerge--need-action.fbmerge--loading .fbmerge__statuses{width:100%;border-radius:5px;-webkit-transition-duration:.5s;transition-duration:.5s}.fbmerge__sharing{position:absolute;left:40px;bottom:56px;margin:0;padding:0;line-height:0;list-style:none;font-size:0;opacity:0;-webkit-transition:opacity ease 1s;transition:opacity ease 1s;z-index:2}.fbmerge__sharing-item{display:inline-block;vertical-align:middle}.fbmerge__sharing-item+.fbmerge__sharing-item{margin-left:22px}.fbmerge__sharing-text{display:inline-block;width:90px;font-size:16px;line-height:18px;color:#FFF!important}.fbmerge__sharing-link{position:relative;display:inline-block;width:35px;height:35px;border:1px solid #FFF;border-radius:50%}.fbmerge__sharing-link:hover{-webkit-transform:translateY(-2px);-ms-transform:translateY(-2px);transform:translateY(-2px)}.fbmerge__sharing-img{position:absolute;top:50%;left:50%;-webkit-transform:translateX(-50%) translateY(-50%);-ms-transform:translateX(-50%) translateY(-50%);transform:translateX(-50%) translateY(-50%)}.fbmerge--step5 .fbmerge__sharing,.fbmerge--step6 .fbmerge__sharing{opacity:1}.fbmerge--hide-sharing .fbmerge__sharing{display:none}.fbmerge__notice{display:block;margin-top:15px;font-size:11px;line-height:12px}.fbmerge__flatbutton-wrapper{margin:25px 0}.fbmerge__flatbutton{min-width:140px;box-sizing:border-box;padding-left:20px;padding-right:20px;border-width:2px;border-color:currentColor}.fbmerge__flatbutton[disabled]{background-color:transparent;color:#AAB7BB!important}.fbmerge__flatbutton:active,.fbmerge__flatbutton:focus,.fbmerge__flatbutton:hover{background-color:transparent;color:#00A2D9!important}.fbmerge__flatbutton--inverse{background-color:transparent;border-color:currentColor;color:#FFF!important}.fbmerge__flatbutton--inverse:active,.fbmerge__flatbutton--inverse:focus,.fbmerge__flatbutton--inverse:hover{color:#FFF!important}.fbmerge__flatbutton--fb{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;margin:37px 0 0;padding:0;font-size:16px}.fbmerge__flatbutton--fb,.fbmerge__flatbutton--fb:hover,.fbmerge__flatbutton--fb:link,.fbmerge__flatbutton--fb:visited{background:0 0;border:0;color:#4c4c4c!important}.fbmerge__flatbutton--fb:focus,.fbmerge__flatbutton--fb:hover{-webkit-transform:translateY(-2px);-ms-transform:translateY(-2px);transform:translateY(-2px)}.fbmerge__flatbutton--fb:focus::before{content:none}.fbmerge__flatbutton-icon--fb{width:30px;height:30px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;vertical-align:middle;margin-right:5px;margin-top:-2px;border:2px solid #00A2D9;border-radius:50%;line-height:32px;box-sizing:border-box}.fbmerge__flatbutton-icon--fb .svgicon{height:16px;fill:#00A2D9}.fbmerge__inputs-list{margin:0;padding:0;list-style:none}.fbmerge__inputs-item{margin-bottom:23px}.fbmerge__inputs-item:last-child{margin-bottom:0}.fbmerge__input-wrapper{position:relative;margin:6px 0}.fbmerge__text-input{display:block;width:100%;box-sizing:border-box;border-width:0;border-bottom:1px solid #979797;outline:0;font-size:14px;line-height:1.4;font-weight:700;background:0 0;color:#00A2D9!important}.fbmerge__text-input--error{color:#d20922!important}.fbmerge__text-input+.fbmerge__text-label{margin-top:25px}.fbmerge__text-label+.fbmerge__text-input{margin-top:5px}.fbmerge__input-tooltip{display:none;margin-top:5px;font-size:11px;line-height:1.2;color:#d0021b!important}.fbmerge__container input:-webkit-autofill,.fbmerge__container input:-webkit-autofill:focus,.fbmerge__container input:-webkit-autofill:hover{-webkit-box-shadow:0 0 0 1000px #fff inset}.fbmerge__subtitle,.fbmerge__text-label{display:block;margin:0;text-transform:uppercase;font-size:16px;line-height:18px;font-weight:600;color:inherit!important}.fbmerge__options{margin:18px 0 0;padding:0;list-style:none}.fbmerge__option{margin-bottom:15px}.fbmerge__option:last-child{margin-bottom:0}.fbmerge__option-input{display:none}.fbmerge__option-text{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;font-size:14px;line-height:1.2;cursor:pointer}.fbmerge__option-text::before{content:\'\';display:inline-block;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;width:27px;height:27px;margin-right:15px;border:2px solid #C3D3D9;border-radius:50%}.fbmerge--step1:not(.fbmerge--loading) .fbmerge__elem--step1,.fbmerge--step2:not(.fbmerge--loading) .fbmerge__elem--step2,.fbmerge--step3:not(.fbmerge--loading) .fbmerge__elem--step3,.fbmerge--step4:not(.fbmerge--loading) .fbmerge__elem--step4,.fbmerge--step5:not(.fbmerge--loading) .fbmerge__elem--step5,.fbmerge--step6:not(.fbmerge--loading) .fbmerge__elem--step6{display:block}.fbmerge--step2 .fbmerge__status--lj,.fbmerge--step3 .fbmerge__status--lj{border-bottom-color:#008CC1;border-left-color:#008CC1}.fbmerge__option-input:checked+.fbmerge__option-text::before{border-color:#00A2D9;background-image:url(\'data:image/svg+xml;charset=UTF-8, %3Csvg%20width%3D%2214px%22%20height%3D%2210px%22%20viewBox%3D%220%200%2014%2010%22%20version%3D%221.1%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cg%20id%3D%22Group-2%22%20transform%3D%22translate%28-469.000000%2C%20-152.000000%29%22%20fill%3D%22none%22%20stroke-width%3D%222%22%3E%3Cpolyline%20points%3D%22471%20156.648053%20474.882762%20160%20480.961931%20154%22%20stroke%3D%22%2300B2ED%22%3E%3C/polyline%3E%3C/g%3E%3C/svg%3E\');background-position:50% 50%;background-repeat:no-repeat}.fbmerge__option-input[disabled]+.fbmerge__option-text{pointer-events:none;cursor:default}.fbmerge__option-input[disabled]:checked+.fbmerge__option-text::before{border-color:#C3D3D9!important;background-image:url(\'data:image/svg+xml;charset=UTF-8, %3Csvg%20width%3D%2214px%22%20height%3D%2210px%22%20viewBox%3D%220%200%2014%2010%22%20version%3D%221.1%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%3E%3Cg%20id%3D%22Group-2%22%20transform%3D%22translate%28-469.000000%2C%20-152.000000%29%22%20fill%3D%22none%22%20stroke-width%3D%222%22%3E%3Cpolyline%20points%3D%22471%20156.648053%20474.882762%20160%20480.961931%20154%22%20stroke%3D%22%23C3D3D9%22%3E%3C/polyline%3E%3C/g%3E%3C/svg%3E\');background-position:50% 50%;background-repeat:no-repeat}.fbmerge__option--autoimport{margin-top:30px}.fbmerge__close::after,.fbmerge__close::before{content:none}.fbmerge .flaticon--cross{width:20px;height:20px;fill:#FFF!important}.fbmerge--need-action .flaticon--cross{fill:#00A2D9!important}.fbmerge--step1 .fbmerge__title{margin-bottom:60px!important}.fbmerge--loading.fbmerge--step1 .fbmerge__status--fb,.fbmerge--loading.fbmerge--step1 .fbmerge__status--lj{width:0;height:0;border-width:0}.fbmerge--step1 .fbmerge__status--lj{-webkit-transition:ease .7s;transition:ease .7s;-webkit-transition-property:border,bottom,left,width,height;transition-property:border,bottom,left,width,height}.fbmerge--step1 .fbmerge__status--fb{-webkit-transition-delay:.3s;transition-delay:.3s}.fbmerge--step2 .fbmerge__status--lj{border-right-color:#008CC1}.fbmerge--step2 .fbmerge__flatbutton{min-width:140px}.fbmerge__text--step3{margin:0 0 30px;font-size:14px;line-height:17px;font-weight:700}.fbmerge--step3 .fbmerge__input-wrapper{margin-bottom:0}.fbmerge--step4 .fbmerge__status--lj{border-left-color:#008CC1}.fbmerge--step5 .fbmerge__status--fb{background-color:#FFF;box-shadow:0 0 0 7px #00B1ED inset}.modal.fbmerge--step5 .fbmerge__status-img--fb path{fill:#00B1ED!important}.fbmerge__text--step5{margin:13px 0 0;font-size:16px;line-height:18px}.fbmerge--step6 .fbmerge__status--fb{display:none}.fbmerge--step6 .fbmerge__status--lj{left:465px;bottom:60px;width:224px;height:224px;box-shadow:0 0 0 8px #00B1ED inset,0 0 0 11px #fff inset,0 0 0 21px #00B1ED inset;-webkit-transition:ease .5s;transition:ease .5s;-webkit-transition-property:left,bottom,width,height;transition-property:left,bottom,width,height}.fbmerge--step6 .fbmerge__status-img--lj{width:100px;height:100px;-webkit-transition:ease .5s;transition:ease .5s;-webkit-transition-property:width,height,top,left;transition-property:width,height,top,left}.fbmerge--step7:not(.fbmerge--loading) .fbmerge__elem--step7{display:block}.fbmerge--step7 .fbmerge__title{margin-bottom:60px!important}@media (max-width:850px){.fbmerge{width:660px}.fbmerge__status--fb{left:320px}.fbmerge__status--lj{left:441px}.fbmerge__title{margin:36px 0 0!important;width:270px}.fbmerge__sharing-item{margin-right:15px}.fbmerge__sharing-item:last-child{margin-right:0}.fbmerge__sharing-item+.fbmerge__sharing-item{margin-left:0}.fbmerge--step6 .fbmerge__status--lj{left:400px}}@media (max-width:680px){.body--fbmerge-opened{overflow:hidden;max-height:100%}.fbmerge{width:90%;height:auto;min-height:0;max-height:95%;overflow:auto}.fbmerge__statuses{display:none}.fbmerge__descr{position:relative;width:100%;min-height:0;padding:0 35px 0 20px;background-color:#00b1ed}.fbmerge__title{width:auto;margin-top:30px!important;margin-bottom:30px!important;padding:15px 0;font-size:25px;line-height:28px;text-align:left}.fbmerge--need-action .fbmerge__title{margin:0!important;font-size:18px;line-height:22px}.fbmerge--need-action .fbmerge__container,.fbmerge__container{width:100%;padding:25px}.fbmerge__notice{margin-top:10px}.fbmerge__close{z-index:100;top:15px;right:10px}.fbmerge--need-action .flaticon--cross{fill:#FFF!important}.fbmerge__choice-buttons{display:block;width:100%;padding-bottom:30px}.fbmerge__choice-button{display:inline-block;width:auto}.fbmerge__inputs-item{margin-bottom:20px}.fbmerge__text-label{margin-bottom:5px;font-size:14px;line-height:1}.fbmerge__input-wrapper{margin:0}.fbmerge__flatbutton-wrapper{margin:20px 0;text-align:center}.fbmerge__flatbutton--fb,.fbmerge__option--autoimport{margin-top:20px}.fbmerge__flatbutton-wrapper:last-child{margin-bottom:0}.fbmerge__option{margin-bottom:8px}.fbmerge__sharing{display:none;position:relative;left:auto;bottom:auto;padding:0 20px}.fbmerge__sharing-text{width:auto}.fbmerge--step6 .fbmerge__sharing{display:block}.fbmerge--hide-sharing .fbmerge__sharing{display:none}.fbmerge__elem--step1{text-align:center}.fbmerge--step5{padding-bottom:30px;background:#00b1ed}.fbmerge__text--step5{margin-bottom:20px}.fbmerge--step6{padding-bottom:50px;background:#00b1ed}}\n/* <<< file end: stc/widgets/facebookmigration.css */\n\n/*# sourceMappingURL=facebookmigration.css.map */\n');
//= require_ml fbmerging.step1.description.title
//= require_ml fbmerging.step1.description.agreement
//= require_ml fbmerging.step1.description.refusing
//= require_ml fbmerging.step2.description.title
//= require_ml fbmerging.step3.description.title
//= require_ml fbmerging.step3.description.title2
//= require_ml fbmerging.step4.description.title
//= require_ml fbmerging.step5.description.title
//= require_ml fbmerging.step5.description.text
//= require_ml fbmerging.step6.description.title
//= require_ml fbmerging.sharing.title
//= require_ml fbmerging.step2.form.login
//= require_ml fbmerging.step2.form.password
//= require_ml fbmerging.step2.form.entry
//= require_ml /login.bml.connect.facebook
//= require_ml fbmerging.step2.form.notice
//= require_ml fbmerging.step3.form.text
//= require_ml fbmerging.step3.form.allow
//= require_ml fbmerging.step2.form.login
//= require_ml fbmerging.step3.form.mail
//= require_ml fbmerging.step3.form.convert_but
//= require_ml fbmerging.step3.form.user_password
//= require_ml fbmerging.step4.form.title
//= require_ml fbmerging.step4.form.week
//= require_ml fbmerging.step4.form.mounth
//= require_ml fbmerging.step4.form.halfyear
//= require_ml fbmerging.step4.form.all
//= require_ml fbmerging.step4.form.nothing
//= require_ml fbmerging.step4.form.autoimport
//= require_ml fbmerging.step4.form.save
//= require_ml fbmerging.step5.sharing.title
//= require_ml fbmerging.step5.sharing.text
//= require_ml createaccount.tip.username
//= require_ml createaccount.tip.email
//= require_ml createaccount.error.username.inuse
//= require_ml createaccount.error.password.digits_only
//= require_ml fbmerging.step7.description.title
//= require_ml fbmerging.step7.description.sendmail
//= require_ml fbmerging.step7.description.options
!function(e){return e}(),function(){"use strict";function e(e,o,t){function r(e,o){var t={facebook:"fbsharing",twitter:"twsharing"};return t[o]?e+"?utm_source="+t[o]+"&utm_medium=social":e}function n(o){var t=LJ.ml("fbmerging.step5.sharing.title"),n=LJ.ml("fbmerging.step5.sharing.text",{journal_url:Site.remote.journal_url}),s=Site.remote.journal_url;if("livejournal"===o)return void e.open("/update.bml?event="+l(n)+"&subject="+l(t));var u=a[o]({title:t,text:n,link:r(s,o)});i(u)}function i(o){var t=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=t.allowScrollbars||!1,n=r?1:0;e.open(o,"","left="+(u.width-630)/2+",top="+(u.height-440)/2+",toolbar=0,status=0,scrollbars="+n+",menubar=0,location=0,width=630,height=440")}var a,s={};moment().format("ZZ");s.share=n;var l=e.encodeURIComponent.bind(e),u=e.screen||{width:1e3,height:1e3};return a={facebook:function(e){var o=e.text,t=e.title,r=e.link;return"https://www.facebook.com/sharer.php?u="+l(r)+"&description="+l(o)+"&title="+l(t)},livejournal:function(e){var o=e.text,t=e.title,r=e.link;return"https://livejournal.com/update.bml?subject="+l(t)+"&event="+l('<a href="'+r+'">'+t+"</a> "+o)},twitter:function(e){var o=e.link,t=e.title;return"https://twitter.com/share?text="+l(t)+"&via=livejournalru&url="+l(o)}},s}function o(e){return""!==e&&angular.isDefined(e)}function t(){var e=LJ.Cookie.get(a);try{return angular.fromJson(e)}catch(o){return null}}function r(e){LJ.Cookie.setGlobal(a,angular.toJson(e),{expires:s})}function n(e,n,i,a,s,l){function u(o){e.$watch(function(){return c[o]},function(e,t){e!==t&&c.step3Errors[o]&&(c.step3Errors[o].unchecked=!1)})}var c=this,d=!1,m=!1,f=!1;c.hidden=!0;var g=t()||{};c.step=g.agreed||e.step>4?e.step:1,e.needEmailConfirm&&6===c.step&&(c.step=7),c.stepAfterSignIn=e.step,c.addr=e.addr,c.username=e.user,c.password,c.email=e.mail,c.gender=e.gender,c.needEmailConfirm=e.needEmailConfirm,c.loginLink=i.trustAsResourceUrl(e.loginLink),c.facebookLink=e.facebookLink,c.step2={},c.share=l.share,c.step3Errors={username:"",email:"",password:""},c.returnTo=e.returnTo,c.siteRoot=LJ.get("siteroot"),c.sendMailAction=i.trustAsResourceUrl(c.siteRoot+"/register.bml"),c.fbLoginTitle=LJ.ml("/login.bml.connect.facebook"),c.autoImport=!0,c.week=604800,c.month=2592e3,c.halfYear=15552e3,c.period=c.month,c.authAs=LJ.get("remoteUser"),u("username"),u("email"),u("password"),c.show=function(t){t&&(c.step=t,m=!0,c.autoImport=!o(e.noMigration)),angular.element("body").addClass("p-fader").addClass("body--fbmerge-opened"),c.hidden=!1},c.hide=function(){var e=t()||{};e.closed=!0,r(e),f&&a.location.reload(),c.hidden=!0,angular.element("body").removeClass("p-fader").removeClass("body--fbmerge-opened")},c.importStep=function(){c.loading=!0,n(function(){r({agreed:!0,closed:!1}),Site.remote?c.step=c.stepAfterSignIn:c.step=2,c.loading=!1},700)},c.setPeriod=function(){c.loading=!0,s.call("settings.set_fb_digest_status",{period:c.period,disable_auto_migration:!c.autoImport,silent:!0}).then(function(o){"ok"===o.status&&(m&&(f=!0),e.needEmailConfirm||d?(c.username&&(c.authAs=c.username),c.step=7):c.step++,c.loading=!1)})},c.convertIdentity=function(e){e.preventDefault(),c.loading=!0,s.call("signup.convert_identity_lite",{create:1,username:c.username,password:c.password,passwordconfirm:c.password,email:c.email,gender:"U",silent:!0}).then(function(e){"ok"===e.status&&(d=!0,c.step++,c.loading=!1),"error"===e.status&&(Object.keys(c.step3Errors).forEach(function(o){return e[o]?void(c.step3Errors[o]={text:i.trustAsHtml(e[o]),unchecked:!0}):void(c.step3Errors[o]="")}),c.loading=!1)})},c.convertationEnabled=function(){return c.username&&c.email&&c.password}}function i(e,r,i){function a(n,a,s,l){var u=o(n.showLater),c=t()||{},d=LiveJournal.parseGetArgs().fbmn,m=i[0].referrer,f=m&&m.match(/^https?:\/\/([^\/]+\.)?facebook\.com(\/|$)/i),g=d||f&&!c.closed&&!u;return g||u?(a.html(e(r.get("facebook_migration.tmpl"))(n)),u&&angular.element(".js-popup-shower").click(function(){l.show(4),n.$apply()}),void(g&&l.show())):void a.remove()}return{scope:{step:"=facebookMigrationStep",addr:"@facebookMigrationAddr",user:"@facebookMigrationUser",mail:"@facebookMigrationMail",gender:"@facebookMigrationGender",needEmailConfirm:"=facebookMigrationNeedEmailConfirm",loginLink:"@facebookMigrationLoginLink",facebookLink:"@facebookMigrationFacebookLink",returnTo:"@facebookMigrationReturnTo",showLater:"@facebookMigrationShowLater",noMigration:"@facebookMigrationDisableAutoMigration"},controllerAs:"migration",controller:n,link:a}}e.$inject=["$window","$location","Api"],i.$inject=["$compile","$templateCache","$document"],n.$inject=["$scope","$timeout","$sce","$window","Api","shareService"],angular.module("Migration.Facebook",["LJ.Api"]),angular.module("Migration.Facebook").config(["$locationProvider",function(e){e.html5Mode({enabled:!0,requireBase:!1})}]).factory("shareService",e).directive("facebookMigration",i).controller("migrationController",n);var a="facebookMigrationStatus",s=14;angular.element(document).ready(function(){var e=angular.element("[facebook-migration]");if(e.length){var o=e.eq(0).scope();o||angular.bootstrap("[facebook-migration]",["Migration.Facebook"])}})}();
/* <<< file end: js/facebookMigration/migration.js */

//# map link was there [migration.js.map]
/* >>> file start: js/ljwidget.js */
LJWidget=new Class(Object,{updateContent:function(t){t||(t={}),this._show_frame=t.showFrame,t.method&&(method=t.method),t._widget_update=1,this.doAjaxRequest(t)&&this.hilightFrame()},getWidget:function(){return $(this.widgetId)},doPost:function(t){t||(t={}),this._show_frame=t.showFrame;var e={},i=this.widgetClass;i="Widget["+i.replace(/::/g,"_")+"]_";for(var a in t){var r=a;a.match(/^Widget\[/)||"lj_form_auth"==a||a.match(/^_widget/)||(r=i+a),e[r]=t[a]}e._widget_post=1,this.doAjaxRequest(e)},doPostAndUpdateContent:function(t){t||(t={}),t._widget_update=1,this.doPost(t)},postForm:function(t){if(!t)return!1;for(var e={},i=0;i<t.elements.length;i++){var a=t.elements[i],r=a.name,o=a.value;e[r]=o}this.doPost(e)},init:function(t,e,i){LJWidget.superClass.init.apply(this,arguments),this.widgetId=t,this.widgetClass=e,this.authToken=i},hilightFrame:function(){if(1==this._show_frame&&!this._frame){var t=this.getWidget();if(t){var e=t.parentNode;if(e){var i=document.createElement("fieldset");i.style.borderColor="red";var a=document.createElement("legend");a.innerHTML="Updating...",i.appendChild(a),e.appendChild(i),i.appendChild(t),this._frame=i}}}},removeHilightFrame:function(){if(1==this._show_frame){var t=this.getWidget();if(t&&this._frame){var e=this._frame.parentNode;e&&(e.appendChild(t),e.removeChild(this._frame),this._frame=null)}}},method:"POST",endpoint:"widget",requestParams:{},doAjaxRequest:function(t){if(t||(t={}),this._ajax_updating)return!1;this._ajax_updating=!0,t._widget_id=this.widgetId,t._widget_class=this.widgetClass,t.auth_token=this.authToken,$("_widget_authas")&&(t.authas=$("_widget_authas").value);var e={method:this.method,data:HTTPReq.formEncoded(t),url:LiveJournal.getAjaxUrl(this.endpoint),onData:this.ajaxDone.bind(this),onError:this.ajaxError.bind(this)};for(var i in t)e[i]=t[i];return HTTPReq.getJSON(e),!0},ajaxDone:function(t){if(this._ajax_updating=!1,this.removeHilightFrame(),t._widget_body&&t._widget_body.match(/ajax:.[^"]+/)&&(this.authToken=t._widget_body.match(/ajax:.[^"]+/)[0]),t.auth_token&&(this.authToken=t.auth_token),t.errors&&""!=t.errors)return this.ajaxError(t.errors);if(t.error)return this.ajaxError(t.error);if(this.onData&&this.onData(t),t._widget_body){var e=this.getWidget();if(!e)return;e.innerHTML=t._widget_body,this.onRefresh&&this.onRefresh()}},ajaxError:function(t){this._ajax_updating=!1,this.skipError||(this.onError?this.onError(t):LiveJournal.ajaxError(t))}}),LJWidget.widgets=[];
/* <<< file end: js/ljwidget.js */

//# map link was there [ljwidget.js.map]
/* >>> file start: js/deprecated/dom.js */
function _textSpan(){return _textElements("span",arguments)}function _textDiv(){return _textElements("div",arguments)}function _textElements(t,e){for(var n=[],r=0;r<e.length;r++){var u=document.createElement(t);u.innerHTML=e[r],n.push(u)}return 1==n.length?n[0]:n}
/* <<< file end: js/deprecated/dom.js */

//# map link was there [dom.js.map]
/* >>> file start: js/ippu.js */
function changeOpac(e,t){var i=$(e);if(i&&i.style){var s=i.style;s&&(IPPU.isSafari()&&t>=100&&(t=99.99),s.filters&&(s.filters.alpha.opacity=100*t),s.opacity=t)}}IPPU=new Class(Object,{setFixedPosition:function(e){IPPU.isIE()||(this.fixedPosition=e,this.updateContent())},clickHandler:function(e){if(this.clickToClose&&this.visible()){e=Event.prep(e);var t=e.target;DOM.getAncestorsByClassName(t,"ippu",!0).length>0||this.cancel()}},setCancelledCallback:function(e){this.cancelledCallback=e},cancel:function(){this.cancelledCallback&&this.cancelledCallback(),this.hide()},setHiddenCallback:function(e){this.hiddenCallback=e},setupClickCapture:function(){if(this.visible()&&!this.clickHandlerSetup&&(this.clickToClose||this.modal)){if(this.clickHandlerFunc=this.clickHandler.bindEventListener(this),this.modal){if(this.overlay)return;this.overlay=document.createElement("div"),this.overlay.style.left="0px",this.overlay.style.top="0px",this.overlay.style.margin="0px",this.overlay.style.padding="0px",this.overlay.style.backgroundColor="#000000",this.overlay.style.zIndex="900",IPPU.isIE()?(this.overlay.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=50)",this.overlay.style.position="absolute",this.overlay.style.width=document.body.scrollWidth,this.overlay.style.height=document.body.scrollHeight):this.overlay.style.position="fixed",this.ele.parentNode.insertBefore(this.overlay,this.ele),this.updateOverlay(),DOM.addEventListener(this.overlay,"click",this.clickHandlerFunc)}else DOM.addEventListener(document,"click",this.clickHandlerFunc);this.clickHandlerSetup=!0}},updateOverlay:function(){if(this.overlay){var e=DOM.getClientDimensions();this.overlay.style.width=e.x-1+"px",IPPU.isIE()||(this.overlay.style.height=e.y-1+"px"),this.visibleOverlay?(this.overlay.backgroundColor="#000000",changeOpac(this.overlay,.5)):(this.overlay.backgroundColor="#FFFFFF",changeOpac(this.overlay,0))}},resizeHandler:function(e){this.updateContent()},removeClickHandlers:function(){if(this.clickHandlerSetup){DOM.removeEventListener(document,"click",this.clickHandlerFunc,!1),this.overlay&&(DOM.removeEventListener(this.overlay,"click",this.clickHandlerFunc,!0),this.overlay.parentNode.removeChild(this.overlay),this.overlay=void 0),this.clickHandlerFunc=void 0,this.clickHandlerSetup=!1}},setClickToClose:function(e){if(this.clickToClose=e,!this.clickHandlerSetup&&e&&this.visible()){var t=this.setupClickCapture.bind(this);window.setTimeout(t,100)}else!e&&this.clickHandlerSetup&&this.removeClickHandlers();this.updateContent()},setModal:function(e){var t=this.modal==e;e&&this.setClickToClose(!1),this.modal=e,t&&(this.removeClickHandlers(),this.updateContent())},setOverlayVisible:function(e){this.visibleOverlay=e,this.updateContent()},updateContent:function(){this.autoCenter(),this.updateTitlebar(),this.updateOverlay(),this.titlebar&&this.setTitlebarClass(this.titlebar.className);var e=this.setupClickCapture.bind(this);window.setTimeout(e,100),this.fixedPosition&&"fixed"!=this.ele.style.position?this.ele.style.position="fixed":this.fixedPosition||"fixed"!=this.ele.style.position||(this.ele.style.position="absolute")},getTitlebarElement:function(){return this.titlebar},setTitlebarClass:function(e){this.titlebar&&(this.titlebar.className=e)},setOverflow:function(e){this.ele&&(this.ele.style.overflow=e)},visible:function(){return this.shown},setTitlebar:function(e){if(this.showTitlebar=e,e){if(!this.titlebar){var t=document.createElement("div");if(!t)return;t.style.width="100%",this.title&&(t.innerHTML=this.title),this.ele.insertBefore(t,this.content),this.titlebar=t}}else this.titlebar&&(this.ele.removeChild(this.titlebar),this.titlebar=!1)},setTitle:function(e){this.title=e,this.updateTitlebar()},updateTitlebar:function(){this.showTitlebar&&this.titlebar&&this.title!=this.titlebar.innerHTML&&(this.titlebar.innerHTML=this.title)},addClass:function(e){DOM.addClassName(this.ele,e)},removeClass:function(e){DOM.removeClassName(this.ele,e)},setAutoCenterCallback:function(e){this.autoCenterCallback=e},autoCenter:function(){if(this.visible&&this.visible()){if(this.autoCenterCallback)return void this.autoCenterCallback(this);this.autoCenterX&&this.centerX(),this.autoCenterY&&this.centerY()}},center:function(){this.centerX(),this.centerY()},centerOnWidget:function(e,t,i){t=t||0,i=i||0,this.setAutoCenter(!1,!1),this.setAutoCenterCallback(null);var s=DOM.getAbsoluteDimensions(e),n=DOM.getAbsoluteDimensions(this.ele),l=s.absoluteRight-s.offsetWidth/2-n.offsetWidth/2+i,o=s.absoluteBottom-s.offsetHeight/2-n.offsetHeight/2+t;l=0>l?0:l,o=0>o?0:o,DOM.setLeft(this.ele,l),DOM.setTop(this.ele,o)},centerX:function(){if(this.visible&&this.visible()){var e=DOM.getClientDimensions(),t=e.x/2-this.ele.offsetWidth/2;if(!this.fixedPosition){var i=DOM.getWindowScroll();t+=i.left}DOM.setLeft(this.ele,t)}},centerY:function(){if(this.visible&&this.visible()){var e=DOM.getClientDimensions(),t=e.y/2-this.ele.offsetHeight/2;if(!this.fixedPosition){var i=DOM.getWindowScroll();t+=i.top}DOM.setTop(this.ele,t)}},setAutoCenter:function(e,t){return this.autoCenterX=e||!1,this.autoCenterY=t||!1,e||t?void this.autoCenter():void this.setAutoCenterCallback(null)},setDimensions:function(e,t){e+="",t+="",e.match(/^\d+$/)&&(e+="px"),t.match(/^\d+$/)&&(t+="px"),this.ele.style.width=e,this.ele.style.height=t},moveForward:function(e){e||(e=1),this.ele&&(this.ele.style.zIndex+=e)},moveBackward:function(e){e||(e=1),this.ele&&(this.ele.style.zIndex-=e)},setLocation:function(e,t){this.setLeft(e),this.setTop(t)},setTop:function(e){"string"!=typeof e&&(e+="px"),this.ele.style.top=e},setLeft:function(e){"string"!=typeof e&&(e+="px"),this.ele.style.left=e},getElement:function(){return this.ele},setContent:function(e){this.content.innerHTML=e},setContentElement:function(e){for(;this.content.firstChild;)this.content.removeChild(this.content.firstChild);!function(e){return e}(),this.content.appendChild(e)},setFadeIn:function(e){this.fadeIn=e},setFadeOut:function(e){this.fadeOut=e},setFadeSpeed:function(e){this.fadeSpeed=e},show:function(){if(this.shown=!0,this.fadeIn){var e=.01;changeOpac(this.ele,e)}document.body.appendChild(this.ele),this.ele.style.position="absolute",(this.autoCenterX||this.autoCenterY)&&this.center(),this.updateContent(),this.resizeHandlerFunc||(this.resizeHandlerFunc=this.resizeHandler.bindEventListener(this),DOM.addEventListener(window,"resize",this.resizeHandlerFunc,!1)),this.fadeIn&&this.fade("in"),this.hideSelects()},fade:function e(t,i){var s,n,l=10;if("in"==t)n=1/l,s=.1;else{if(this.ele.style.opacity){var o=parseFloat(this.ele.style.opacity);s=isFinite(o)?o:0}else s=.99;n=-1/l}var a=this.fadeSpeed;a||(a=1);var h=l/a*5;this.fadeMode=t;var r=this,e=function c(){return s+=n,r.fadeMode&&r.fadeMode!=t?void(i&&i.call(r,[])):.1>=s?(i&&i.call(r,[]),void(r.fadeMode=null)):s>=1?(i&&i.call(r,[]),void(r.fadeMode=null)):(changeOpac(r.ele,s),void window.setTimeout(c,h))};e()},hide:function(){this.visible()&&(this.fadeOut&&this.ele?this.fade("out",this._hide.bind(this)):this._hide())},_hide:function(){this.hiddenCallback&&this.hiddenCallback(),this.shown=!1,this.removeClickHandlers(),this.ele&&document.body.removeChild(this.ele),this.resizeHandlerFunc&&DOM.removeEventListener(window,"resize",this.resizeHandlerFunc),this.showSelects()},setAutoHideSelects:function(e){this.autoHideSelects=e,this.updateContent()},hideSelects:function(){if(this.autoHideSelects&&IPPU.isIE())for(var e,t=document.getElementsByTagName("select"),i=0;i<t.length;i++)e=t[i],e&&(DOM.getAncestorsByClassName(e,"ippu",!0).length>0||"hidden"!=e.style.visibility&&(e.style.visibility="hidden",this.hiddenSelects.push(e)))},showSelects:function(){if(this.autoHideSelects)for(var e;e=this.hiddenSelects.pop();)e.style.visibility=""},init:function(e){var t=document.createElement("div");this.ele=t,this.shown=!1,this.autoCenterX=!1,this.autoCenterY=!1,this.titlebar=null,this.title="",this.showTitlebar=!1,this.clickToClose=!1,this.modal=!1,this.clickHandlerSetup=!1,this.docOverlay=!1,this.visibleOverlay=!1,this.clickHandlerFunc=!1,this.resizeHandlerFunc=!1,this.fixedPosition=!1,this.autoCenterCallback=null,this.cancelledCallback=null,this.autoHideSelects=!1,this.hiddenCallback=null,this.fadeOut=!1,this.fadeIn=!1,this.hiddenSelects=[],this.fadeMode=null,t.style.position="absolute",t.style.top=0,t.style.zIndex="1000",DOM.addClassName(t,"ippu"),this.content=document.createElement("div"),this.content.innerHTML=e,this.ele.appendChild(this.content)}}),IPPU.center=function(e){e.centerX(),e.centerY()},IPPU.centerX=function(e){e.centerX()},IPPU.centerY=function(e){e.centerY()},IPPU.isIE=function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")},IPPU.isSafari=function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("safari")};
/* <<< file end: js/ippu.js */

//# map link was there [ippu.js.map]
/* >>> file start: js/lj_ippu.js */
//= require js/deprecated/dom.js
//= require js/ippu.js
LJ_IPPU=new Class(IPPU,{init:function(e){e||(e=""),LJ_IPPU.superClass.init.apply(this,[]),this.uniqId=this.generateUniqId(),this.cancelThisFunc=this.cancel.bind(this),this.setTitle(e),this.setTitlebar(!0),this.setTitlebarClass("lj_ippu_titlebar"),this.addClass("lj_ippu"),this.setAutoCenterCallback(IPPU.center),this.setDimensions(514,"auto"),this.setFixedPosition(!0),this.setClickToClose(!0),this.setAutoHideSelects(!0)},setTitle:function(e){var t="      <div style='float:right; padding-right: 8px'><img src='"+Site.imgprefix+"/CloseButton.gif?v=7618' width='15' height='15' id='"+this.uniqId+"_cancel' /></div>"+e;LJ_IPPU.superClass.setTitle.apply(this,[t])},generateUniqId:function(){var e=new Date;return"lj_ippu_"+e.getHours()+e.getMinutes()+e.getMilliseconds()},show:function(){LJ_IPPU.superClass.show.apply(this);var e=this.setup_lj_ippu.bind(this);this.timerSetup=window.setTimeout(e,300)},setup_lj_ippu:function(e){var t=this.cancelThisFunc;$(this.uniqId+"_cancel").onclick=function(){t()}},hide:function(){clearInterval(this.timerSetup),LJ_IPPU.superClass.hide.apply(this)}}),LJ_IPPU.showNote=function(e,t,i,s){var n=document.createElement("div");return n.innerHTML=e,LJ_IPPU.showNoteElement(n,t,i,s)},LJ_IPPU.showErrorNote=function(e,t,i){return LJ_IPPU.showNote(e,t,i,"ErrorNote")},LJ_IPPU.showNoteElement=function(e,t,i,s){var n=new IPPU;n.init();var o=document.createElement("div");DOM.addClassName(o,"Inner"),o.appendChild(e),n.setContentElement(o),n.setTitlebar(!1),n.setFadeIn(!0),n.setFadeOut(!0),n.setFadeSpeed(4),n.setDimensions("auto","auto"),s||(s="Note"),n.addClass(s);var a;if(!t||(a=DOM.getAbsoluteDimensions(t))){var l=DOM.getClientDimensions();if(l){if(a){n.setAutoCenter(!1,!1),n.setLocation(a.absoluteLeft,a.absoluteBottom+4),n.show();var u=DOM.getAbsoluteDimensions(n.getElement());u.absoluteRight>l.x&&n.setLocation(l.x-u.offsetWidth-30,a.absoluteBottom+4)}else n.setAutoCenter(!0,!0),n.show();return n.setClickToClose(!0),n.moveForward(),void 0===i&&(i=5e3),i&&window.setTimeout(function(){n&&n.hide()},i),n}}},LJ_IPPU.textPrompt=function(e,t,i,s){s=s||{},e+="";var n=new LJ_IPPU(e),o=document.createElement("div");DOM.addClassName(o,"ljippu_textprompt"),t&&o.appendChild(_textDiv(t));var a=document.createElement("textarea");DOM.addClassName(a,"htmlfield"),a.cols=40,a.rows=5,o.appendChild(a);var l=document.createElement("div");DOM.addClassName(l,"submitbtncontainer");var u=document.createElement("input");DOM.addClassName(u,"submitbtn"),u.type="button",u.value="Insert",l.appendChild(u),o.appendChild(l),n.setContentElement(o),n.setAutoCenter(!0,!0),n.setDimensions(s.width||"60%","auto"),n.show(),a.focus(),DOM.addEventListener(u,"click",function(e){n.hide(),i&&i.apply(null,[a.value])})};
/* <<< file end: js/lj_ippu.js */

//# map link was there [lj_ippu.js.map]
/* >>> file start: js/ljwidget_ippu.js */
//= require js/ljwidget.js
//= require js/lj_ippu.js
LJWidgetIPPU=new Class(LJWidget,{init:function(t,e){var i=t.title,n=t.widgetClass,s=t.authToken,a=t.nearElement,l=t.not_view_close;e||(e={}),this.reqParams=e;var o=new LJ_IPPU(i,a);this.ippu=o;var d=document.createElement("div");d.id="LJWidgetIPPU_"+Unique.id(),o.setContentElement(d),t.width&&t.height&&o.setDimensions(t.width,t.height),t.overlay&&(IPPU.isIE()?(this.ippu.setModal(!0),this.ippu.setOverlayVisible(!0),this.ippu.setClickToClose(!1)):(this.ippu.setModal(!0),this.ippu.setOverlayVisible(!0))),t.center&&o.center(),o.show(),l&&(o.titlebar.getElementsByTagName("img")[0].style.display="none");var h=document.createElement("div");h.style.fontSize="1.5em",h.style.fontWeight="bold",h.style.margin="5px",h.style.textAlign="center",h.innerHTML="Loading...",this.loadingText=h,d.appendChild(h);var u=[d.id,n,s];LJWidgetIPPU.superClass.init.apply(this,u);var r=this;return o.setCancelledCallback(function(){r.cancel&&r.cancel()}),n?(this.widgetClass=n,this.authToken=s,this.title=i,this.nearEle=a,window.setInterval(this.animateLoading.bind(this),20),this.loaded=!1,this.loadContent(),this):null},animateCount:0,animateLoading:function(t){var e=this.loadingText;if(this.loaded||!e)return void window.clearInterval(t);this.animateCount+=.05;var i=(Math.sin(this.animateCount)+1)/2*255,n=Math.round(i).toString(16);1==n.length&&(n="0"+n),n+=n+n,e.style.color="#"+n,this.ippu.center()},doAjaxRequest:function(t){t||(t={}),t._widget_ippu=1,document.getElementById("LJ__Setting__InvisibilityGuests_invisibleguests_self")&&(t["Widget[IPPU_SettingProd]_LJ__Setting__InvisibilityGuests_invisibleguests"]=1==document.getElementById("LJ__Setting__InvisibilityGuests_invisibleguests_self").checked?1:1==document.getElementById("LJ__Setting__InvisibilityGuests_invisibleguests_anon").checked?2:0),LJWidgetIPPU.superClass.doAjaxRequest.apply(this,[t])},close:function(){this.ippu.hide()},loadContent:function(){var t=this.reqParams;this.updateContent(t)},method:"POST",onData:function(t){this.loaded=!0},render:function(t){}});
/* <<< file end: js/ljwidget_ippu.js */

//# map link was there [ljwidget_ippu.js.map]
/* >>> file start: js/jquery/jquery.center.js */
!function(t){return t}(),function(t){t.fn.center=function(){var i=t(window),h=({width:i.width(),height:i.height()},this.first()),e={width:h.outerWidth(),height:h.outerHeight()};return h.css({position:"fixed",left:"50%",top:"50%",marginTop:-(e.height/2),marginLeft:-(e.width/2)}),this}}(jQuery);
/* <<< file end: js/jquery/jquery.center.js */

//# map link was there [jquery.center.js.map]
/* >>> file start: js/jquery/dialogs.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};
//= require js/jquery/jquery.center.js
LJ.UI.registerTemplate('templates-Widgets-dialogs', "<div class=\"b-popup\"> <div class=\"b-popup-outer\"> <div class=\"b-popup-inner\"> <div class=\"b-dialog\"> {{if $data.title}} <div class=\"b-dialog-header\"> {{html $data.title}} </div> {{/if}} {{if ($data.type == \'prompt\' || $data.text)}} <div class=\"b-dialog-body\"> {{if $data.text}} {{html $data.text}} {{/if}} {{if ($data.type == \'prompt\')}} <div class=\"b-dialog-prompt-wrap\"> <input type=\"text\" name=\"dialog-prompt\" class=\"b-dialog-prompt\" value=\"\" {{if $data.placeholder}}placeholder=\"{{html $data.placeholder}}\"{{/if}} /> </div> {{/if}} </div> {{/if}} <div class=\"b-dialog-footer\"> {{if $data.is_mac}} {{if $data.type != \'alert\'}} <button type=\"button\" name=\"dialog-cancel\" class=\" b-dialog-btn b-dialog-cancel b-flatbutton b-flatbutton-neutral \" > {{html $data.no.text}} </button> {{/if}} <button type=\"button\" name=\"dialog-ok\" class=\" b-dialog-btn b-dialog-ok b-flatbutton \" > {{html $data.yes.text}} </button> {{else}} <button type=\"button\" name=\"dialog-ok\" class=\" b-dialog-btn b-dialog-ok b-flatbutton \" > {{html $data.yes.text}} </button> {{if $data.type != \'alert\'}} <button type=\"button\" name=\"dialog-cancel\" class=\" b-dialog-btn b-dialog-cancel b-flatbutton b-flatbutton-neutral \" > {{html $data.no.text}} </button> {{/if}} {{/if}} </div> </div> <i class=\"i-popup-close\"></i> </div> </div> </div> ", 'JQuery.stat');
!function(t){return t}(),function(t){"use strict";LJ.dialogs={defaults:{alert:{title:"",fade:!0,show:t.noop,hide:t.noop,defaultButton:"yes",yes:{text:LJ.ml("dialogs.yes"),action:t.noop}},confirm:{title:"",fade:!0,show:t.noop,hide:t.noop,defaultButton:"yes",yes:{text:LJ.ml("dialogs.yes"),action:t.noop},no:{text:LJ.ml("dialogs.no"),action:t.noop}},prompt:{title:"",fade:!0,show:t.noop,hide:t.noop,defaultButton:"input",value:"",yes:{text:LJ.ml("dialogs.yes"),action:t.noop},no:{text:LJ.ml("dialogs.no"),action:t.noop}}}};var o=function(t){function o(o){var n,e=y.type,i=null;m||(m=[],m.push(d.find(g.yesButton)),"prompt"===e&&m.push(d.find(g.promptInput)),"prompt"!==e&&"confirm"!==e||m.push(d.find(g.noButton)),n=d.find(g.body).find("a,select,input,button").not(g.yesButton).not(g.noButton).not(g.promptInput),n.length&&(m=m.concat(n.toArray().map(t)))),m.some(function(t,o){var n=t.is(":focus");return n&&(i=o),n}),null===i?i=0:(i+=o,i>m.length-1?i=0:0>i&&(i=m.length-1)),m[i].focus()}function n(){s=t("<div />",{"class":"b-fader"}).prependTo(document.body)}function e(o){var e="object"===_typeof(o.text),l=null,u=null;y=o,e&&(l=t('<div class="b-dialog-body" />').append(o.text),o.text=""),d=LJ.UI.template("templates-Widgets-dialogs",o),e&&(u=d.find(g.header),u.length?u.after(l):d.find(g.dialog).prepend(l)),d.prependTo(document.body).center(),o.fade&&(s=t(".b-fader"),s.length?s.show():n()),d.on("click",g.closeButton,i),"no"===o.defaultButton&&"alert"!==o.type?d.find(g.noButton).focus():"prompt"===o.type&&"yes"!==o.defaultButton?d.find(g.promptInput).focus():d.find(g.yesButton).focus(),o.show.call(d,o)}function i(){s&&s.hide(),m=null,y.hide.call(d,y),d.remove(),d=null}function l(t,o){if(!("string"==typeof t&&0!==t.length||"object"===("undefined"==typeof t?"undefined":_typeof(t))&&t.jquery))throw new Error("You should provide text or node as `text` param for the dialog");if(o&&"object"!==("undefined"==typeof o?"undefined":_typeof(o)))throw new Error("Dialog options should be an object");if(d)throw new Error("You are not able to create multiple dialogs at the time");o&&o.yes&&("function"==typeof o.yes?o.yes={action:o.yes}:"string"==typeof o.yes&&(o.yes={text:o.yes})),o&&o.no&&("function"==typeof o.no?o.no={action:o.no}:"string"==typeof o.no&&(o.no={text:o.no}))}function u(){d.find(g.yesButton).trigger("click")}function c(){d.find(g.noButton).trigger("click")}function a(t){return function(){try{return t.apply(this,arguments),{yes:u,no:c}}catch(o){console.error(o.message)}}}var p,r,f,d=null,s=null,y=null,m=null,g={yesButton:".b-dialog-ok",noButton:".b-dialog-cancel",closeButton:".i-popup-close",promptInput:".b-dialog-prompt",header:".b-dialog-header",dialog:".b-dialog",body:".b-dialog-body"};return LJ.Support.isMobile()||t(document).on("keydown",function(t){if(d)switch(t.which){case 27:d.find(g.closeButton).trigger("click");break;case 9:o(t.shiftKey?-1:1),t.preventDefault()}}),p=function(o,n){l(o,n),n=t.extend(!0,{},LJ.dialogs.defaults.alert,{type:"alert",text:o},n||{}),e(n),d.on("click",g.yesButton,function(){void 0===n.yes.action.call(d,i)&&i()})},r=function(o,n){l(o,n),n=t.extend(!0,{},LJ.dialogs.defaults.confirm,{type:"confirm",text:o},n||{}),e(n),d.on("click",g.yesButton,function(){void 0===n.yes.action.call(d,!0,i)&&i()}),d.on("click",g.noButton,function(){n.no.action.call(d,!1),i()})},f=function(o,n){l(o,n),n=t.extend(!0,{},LJ.dialogs.defaults.prompt,{type:"prompt",text:o},n||{}),e(n),n.value&&d.find(g.promptInput).val(n.value),d.on("click",g.yesButton,function(){void 0===n.yes.action.call(d,d.find(g.promptInput).val())&&i()}),d.find(g.noButton).on("click",function(){n.no.action.call(d),i()}),LJ.Support.isMobile()||d.find(g.promptInput).on("keyup",function(t){13===t.which&&d.find(g.yesButton).trigger("click")})},{alert:a(p),confirm:a(r),prompt:a(f)}}(t);t.extend(!0,LJ.dialogs,o)}(jQuery);
/* <<< file end: js/jquery/dialogs.js */

//# map link was there [dialogs.js.map]
/* >>> file start: js/scheme/schemius/controlstrip.js */
//= require js/ljwidget_ippu.js
//= require js/jquery/dialogs.js
!function(e){return e}(),function(){LJ.define("LJ.Schemius.controlstrip"),LJ.Schemius.controlstrip.init=function(e){var i=e.jQuery,n=i(".js--controlstrip");if(n.length){var r=n.find(".js--user_status"),s=n.find(".js--user_status_dash"),t=n.find(".js--item-friending.js--add"),o=n.find(".js--item-friending.js--modify"),a=n.find(".js--item-subscribe.js--add"),d=n.find(".js--item-subscribe.js--modify"),u=n.find(".js--item-subscribe.js--disabled"),l=LJ.get("current_journal.username"),c=LJ.Support.isMobile(),f={subscriptions:{remote:{},journal:{}},friendLists:{remote:{},journal:{}},friendingStatus:r.html(),friendingBlocker:null,subscriptionBlocker:null};f.friendingStatus&&(f.friendingStatus=f.friendingStatus.trim());var m=function(){f.friendLists.remote.journal?(t.hide(),o.show()):(t.show(),f.friendingBlocker&&!c?t.find("a").addClass("js--disabled"):t.find("a").removeClass("js--disabled"),o.hide())},g=function(){return f.friendLists.remote.journal?(a.hide(),d.hide(),void u.show()):(u.hide(),void(f.subscriptions.remote.journal?(a.hide(),d.show()):(a.show(),f.subscriptionBlocker&&!c?a.find("a").addClass("js--disabled"):a.find("a").removeClass("js--disabled"),d.hide())))},b=function(){m(),g(),r.html(f.friendingStatus),r.attr("title",f.friendingStatus),f.friendingStatus?(r.show(),s.show()):(r.hide(),s.hide())},j=function(e){if(e){var i=e.data;i&&(f.friendLists.remote.journal=i.is_friend,f.subscriptions.remote.journal=i.is_subscriber,f.friendingStatus=i.controlstrip_status,b(i))}},h=function(e,i){i&&LJ_IPPU.showNote(i,e)},p=function(e){e&&LJ.dialogs.alert(e,{yes:{text:"OK"}})},L=function(){return LJ.get("remote")?Promise.all([LJ.Api.call("relations.can_add_friends",{target:l}),LJ.Api.call("relations.can_add_subscribers",{target:l})]).then(function(e){e[0]&&e[1]&&(e[0].can_add_friends?f.friendingBlocker=null:f.friendingBlocker={message:e[0].add_friends_error},e[1].can_add_subscribers?f.subscriptionBlocker=null:f.subscriptionBlocker={message:e[1].add_subscribers_error})}):Promise.resolve()};LJ.Event.on("relations.changed",function(e){j(e),L().then(b)}),t.on("click",function(e){if(!f.friendLists.remote.journal){e.preventDefault();var i=f.friendingBlocker;return i?void(c?p(i.message):h(t[0],i.message)):void LJ.Api.call("relations.addfriend",{target:l}).then(function(e){return LJ.Event.trigger("relations.changed",{action:"addFriend",username:l,data:e})})}}),a.on("click",function(e){if(!f.subscriptions.remote.journal){e.preventDefault();var i=f.subscriptionBlocker;return i?void(c?p(i.message):h(a[0],i.message)):void LJ.Api.call("relations.addfriend",{target:l,is_subscriber:1}).then(function(e){return LJ.Event.trigger("relations.changed",{action:"addFriend",username:l,data:e})})}}),n.attr("data-remote-friends-journal")&&(f.friendLists.remote.journal=!0),n.attr("data-remote-subscribed-to-journal")&&(f.subscriptions.remote.journal=!0),L().then(b)}}}();
/* <<< file end: js/scheme/schemius/controlstrip.js */

//# map link was there [controlstrip.js.map]
/* >>> file start: js/scheme/schemius.js */
//= require js/core/angular/api.js
//= require js/lib/jquery.selectric.min.js
//= require js/captcha.js
//= require js/scheme/schemius/feedback.js
//= require js/notifications/main.js
//= require js/facebookMigration/migration.js
//= require js/scheme/schemius/controlstrip.js
!function(e){return e}(),function(e){function o(){function o(e){return!!(e.ctrlKey||e.metaKey&&LJ.Support.isMac)}function s(e){e&&(e.stopPropagation(),e.preventDefault()),x.removeClass(I),x.removeClass(v),d.removeClass(I),d.removeClass(v)}function n(o){o&&(o.preventDefault(),o.stopPropagation()),u(),LJ.Event.trigger("Messages:closeByMenus"),d.addClass(v),x.addClass(I),setTimeout(function(){e("#user").focus()},300)}function t(){d.hasClass(v)?s():n()}function a(e){e&&LJ.Api.call("lang.set",{lang:e},function(){location.reload()})}function i(o){g.toggleClass(y,o),o?e(".b-loginform-click-trap").removeClass("b-loginform-click-trap--show"):(e(".b-loginform-click-trap").addClass("b-loginform-click-trap--show"),e(".b-loginform").removeClass("openid-auth-state"))}var l,r,c,u,d,p,m,h,g,f,v,b,C,k,w,j,L,y,J=LJ.Flags.isEnabled("medius_schemius"),x=e(document.body),S=e(".s-header"),A=e(J?".js-header-search-input":".s-inline-search-input"),T=e(J?".js-header-search-button":".s-do-item-search-btn"),_="p-show-search",D=!1,I="p-loginform",M=e(J?".js-header-nav-lang":".s-nav-item-lang"),E="s-nav-item-lang-open",O=function(e){o(e)||(S.hasClass(_)&&A.val()&&T.prop("type","submit"),S.toggleClass(_),S.hasClass(_)&&(D=!0,setTimeout(function(){A.focus()},500)))},P=e(".s-header-search__form");P.on("submit",function(){var e=A.val(),o=e.split(" ").filter(function(e){return e}),s=o.every(function(e){return e.length>1&&0===e.indexOf("#")});A.attr("name",s?"tags":"q")}),LJ&&LJ.Util&&LJ.Util.Action&&(LJ.Util.Action.login=n),T.on("click",O),T.on("blur",function(){"submit"===T.prop("type")&&(T.prop("type","button"),A.val(""))}),A.on("click",function(){D=!0}),x.on("click",function(){D||(S.removeClass(_),M.removeClass(E)),D=!1}),x.on("gesturestart",function(o){(e("html").hasClass("p-nav-common-menu-open")||e("html").hasClass("p-nav-user-menu-open"))&&o.preventDefault()}),navigator.userAgent.match(/Trident/)&&navigator.userAgent.match(/rv[ :]11/)&&e("html").addClass("html-ie11"),navigator.appVersion.match(/MSIE\s10/)&&e("html").addClass("html-ie10"),d=e("html"),d.addClass(LJ.Support.isMobile()?"html-mobile":"html-desktop"),~navigator.userAgent.toLowerCase().indexOf("android")?d.addClass("html-android"):~navigator.userAgent.toLowerCase().indexOf("iphone")||~navigator.userAgent.toLowerCase().indexOf("ipad")?d.addClass("html-ios"):~navigator.userAgent.toLowerCase().indexOf("windows phone")&&d.addClass("html-wphone"),e("[data-lang]").on("click",function(){a(e(this).data("lang"))}),M.on("click",function(e){o(e)||(e.preventDefault(),M.toggleClass(E),D=M.hasClass(E))}),e(".s-lang-select").selectric({customClass:{prefix:"b-selectus",postfixes:"Input Items Open Disabled TempShow HideSelect Wrapper Hover Responsive Above Scroll",camelCase:!1,overwrite:!1}}).on("change",function(){a(e(this).val())}),e(".selectricus").selectric({customClass:{prefix:"b-selectus",postfixes:"Input Items Open Disabled TempShow HideSelect Wrapper Hover Responsive Above Scroll",camelCase:!1,overwrite:!1},expandToItemText:!0,disableOnMobile:!1}),e(".b-message-mobile-close").one("click",function(){e(".b-message-mobile").hide()}),k=e(J?".js-header-nav-drop-master":".s-drop-master"),w=J?"s-header-nav-drop--open":"s-drop-open",j=LJ.Support.isMobile(),L=!1,j||(C=e(":lj-bubble"),k.on("mouseenter",function(){var o=e(this),s=300;L&&(clearTimeout(b),s=0),b=setTimeout(function(){k.removeClass(w),o.addClass(w),L=!0,C.bubble("hide")},s)}).on("mouseleave",function(){var o=e(this);return L?void(b=setTimeout(function(){o.removeClass(w),L=!1},500)):(clearTimeout(b),void o.removeClass(w))})),j&&(k.on("click",function(o){var s=e(this),n=0!==s.find("li").length,t=e(o.target).closest("span").is(".s-header-extra-menu-item-link-icon");"input"!==o.target.tagName.toLowerCase()&&(s.hasClass(w)||!n||t||o.preventDefault(),s.hasClass(w)||t||(L=!0,k.removeClass(w),o.stopPropagation(),e(":lj-bubble").bubble("hide")),s.toggleClass(w))}),x.on("click",function(o){var s=0===e(o.target).closest(k).length,n=e(o.target).is(".b-popup");n&&(o.stopPropagation(),e(":lj-bubble").bubble("hide")),L&&s&&(L=!1,k.removeClass(w),o.preventDefault())}),LJ.Support.isMobile&&LJ.Support.browser.safari&&x.addClass("iphone"),e(".l-flatslide-menu-active, .l-flatslide-menu-expander").click(function(o){o.preventDefault(),e(this).closest(".l-flatslide-menu").toggleClass("l-flatslide-menu-expanded")}),e(".s-header-search, .s-header-item-search__form").removeAttr("target")),d=e("html"),p=e(".s-body"),m=e(J?".js-header-menu-button":".s-nav-control-common"),h=e(J?".js-header-login":".s-nav-control-user, .s-nav-control-login"),f="p-nav-common-menu-open",v="p-nav-user-menu-open",m.on("click",function(){LJ.Event.trigger("Messages:closeByMenus"),d.toggleClass(f),s()}),h.on("click",t),u=function(){d.removeClass(f),d.removeClass(v)},p.on("click",function(){u(),s()}),e(".s-header-menu-head__drop").click(function(){var o=e(this).closest(".s-header-menu-drop"),s=o.find(".s-header-menu-list-sub"),n="s-header-menu-drop--open";if(o.is("."+n))s.css("max-height","");else{var t=s.children().toArray().reduce(function(o,s){return o+e(s).height()},0);s.css("max-height",t)}o.toggleClass(n)}),e(J?".js-header-login":".s-nav-item-login").on("click",n),e(".js-loginform-close").on("click",s),e(document).on("keyup",function(e){"Escape"!==e.key&&27!==e.keyCode||s(e)}),e(".b-fader").on("click",s),g=e(".b-loginform-body > .b-loginform-field"),y="active",J?e(".lj-openid-auth-button").on("click",function(o){o.preventDefault(),i(!1),e(".b-loginform").addClass("openid-auth-state")}):e(".lj-openid-auth-button").on("click",function(o){o.preventDefault(),e(".b-loginform").toggleClass("openid-auth-state"),e(".b-loginform").hasClass("openid-auth-state")?e("#openid").focus():e("#user").focus()}),J&&(e(".js-login-close").on("click",function(e){i(!1),s(e)}),e(".b-loginform-click-trap").on("click",function(){return i(!0)}),e(".b-loginform-toggle-link").on("click",function(){return i(!1)}),LJ.Flags.isEnabled("notification_center")&&angular.bootstrap(J?".js-header-notifications":".mds-do",["Notifications"])),LJ.Event.on("userpic.changed",function(o){e(".s-userpic").css("backgroundImage","url("+o+")")}),!LJ.Flags.isEnabled("ljwelcomevideo")||j||LJ.get("remote")||LJ.Cookie.get("welcome_ljvideo")||0!==LJ.get("remote_is_sup")||e(".appwidget-login").length||LJ.injectScript("https://www.youtube.com/player_api").then(function(){function o(e){0!==e.data&&2!==e.data||n.addClass("s-ljvideo-end"),1===e.data&&n.removeClass("s-ljvideo-end")}var s,n=e(".s-ljvideo");x.addClass("p-ljvideo"),window.onYouTubePlayerAPIReady=function(){s=new window.YT.Player("s-ljvideo-player",{width:"640",height:"360",videoId:"wq0YmQ4xIeU",playerVars:{rel:0},events:{onStateChange:o}})},e(".b-fader, .s-ljvideo-close").on("click",function(){x.hasClass("p-ljvideo")&&(x.removeClass("p-ljvideo"),s.destroy(),LJ.Cookie.setGlobal("welcome_ljvideo",1,{expires:14}))})}),c=e(".s-header .i-supus-new, .s-header-messages-count"),LJ.Event.on("message:count:change",function(e){e>0?(c.html(e),c.removeClass("s-header-messages-count-empty")):c.addClass("s-header-messages-count-empty")}),r=e(".flatquestion-nojs-friendsgroups"),l=e(".flatquestion-popup-field-showanswer"),e(".flatquestion-popup-select").on("change",function(){"custom"===e(this).val()?r.show():r.hide(),"public"===e(this).val()?l.show():l.hide()}),LJ.Schemius.controlstrip.init({jQuery:e})}e(function(){0===e(".s-header").length?e("html").on("controlstrip-initialized",o):o()})}(jQuery);
/* <<< file end: js/scheme/schemius.js */

//# map link was there [schemius.js.map]
/* >>> file start: js/widgets/angular/login.js */
//= require js/core/angular/api.js
//= require_ml loginform.error.enterpassword
//= require_ml loginform.error.purgeduser
//= require_ml loginform.error.enteruser
//= require_ml loginform.error.ipbanned
//= require_ml loginform.error.ipbanned.sysban
//= require_ml loginform.error.ipbanned.distribution
//= require_ml loginform.error.openid
//= require_ml loginform.error.password
//= require_ml loginform.error.usercreate
//= require_ml error.nocommlogin
//= require_ml error.login.limit.exceeded
//= require_ml error.expiredchal
//= require_ml error.account_locked.text
//= require_ml error.user_is_child.text
!function(r){return r}(),function(){function r(r){r.html5Mode({enabled:!0,requireBase:!1})}function e(){return{controllerAs:"loginForm",controller:n,link:function(r,e){e.find("a:not([target])").attr("target","_self")}}}function o(r){var e=r.type,o=r.url,n=r.$window,t=s("instant_relation_source",o),a=function(r){switch(r){case"instantRelationTry":return"try";case"instantRelationSuccess":return"ok";default:return null}}(e),i=function(r){switch(r){case"before_post":return"username";case"after_post":return"post";case"ctx_popup":return"ctxpopup";default:return null}}(t);return a&&i&&n.yaCounter27737346?n.yaCounter27737346.reachGoal("subscribe-"+i+"__login-"+a):null}function n(r,e,n,s,t,a){var i=this,l=angular.element(".b-fader");i.hasError=!1,i.domain=location.origin,i.isMobile=LJ.Support.isMobile()||!!~navigator.userAgent.toLowerCase().indexOf("android"),i.close=function(r){r.target===r.currentTarget&&(r&&r.preventDefault(),n(function(){l.triggerHandler("click")}))};var u=void 0;i.loginUser=function(e){u=decodeURIComponent(a.absUrl()),o({type:"instantRelationTry",url:u,$window:r}),e.preventDefault(),i.model.username&&i.model.password?t.call("user.login",{user:i.model.username,password:i.model.password,expire:i.model.expire?"never":"remeber me"},{silent:!0}).then(i.sucsessLogin)["catch"](i.onError):i.model.username?i.model.password||i.onError({message:"invalid_password"}):i.onError({message:"invalid_user"})},i.loginOpenID=function(r){i.model.openid||(r.preventDefault(),i.onError({message:"invalid_id"}))},i.sucsessLogin=function(){o({type:"instantRelationSuccess",url:u,$window:r});var e=window.location.pathname;~e.indexOf("logout")?window.location.replace("/login.bml"):window.location.reload()},i.onError=function(r){switch(i.resetError(),i.hasError=!0,r.message){case"unknown_user":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.usercreate",{domain:i.domain,username:i.model.username}));break;case"purged_user":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.purgeduser"));break;case"community_disabled_login":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("error.nocommlogin"));break;case"invalid_user":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.enteruser"));break;case"bad_password":i.errorPassword=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.password"));break;case"invalid_password":i.errorPassword=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.enterpassword"));break;case"banned_ip":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.ipbanned"));break;case"banned_ip_sysban":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.ipbanned.sysban"));break;case"banned_ip_distrib":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.ipbanned.distribution"));break;case"invalid_id":i.errorId=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.openid"));break;case"ratelimit_exceeded":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("loginform.error.openid"));break;case"expired_challenge":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("error.expiredchal"));break;case"account_locked":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("error.account_locked.text"));break;case"is_child":i.errorUsername=!0,i.errorMessage=s.trustAsHtml(LJ.ml("error.user_is_child.text"));break;default:i.errorUsername=!0,i.errorMessage="UnknownError"}},n(function(){document.querySelectorAll("input:-webkit-autofill").length&&angular.element(".b-loginform-btn--auth").removeClass("b-loginform-btn--disabled"),function(r){return r}()},100),i.resetError=function(){i.errorError=i.errorUsername=i.errorPassword=i.errorIp=i.errorId=!1},e.$watch(function(){return i.model},function(){i.hasError&&i.resetError()},!0)}r.$inject=["$locationProvider"],n.$inject=["$window","$scope","$timeout","$sce","Api","$location"],angular.module("Login",["LJ.Api","LJ.Directives"]).config(r).controller("LoginCtrl",n).directive("ljLogin",e),function(r){return r}(),angular.element(window.document).ready(function(){if(!angular.element("body[ng-app]").length>0)try{angular.bootstrap(".b-loginform",["Login"])}catch(r){console.info(r.message,r.stack)}});var s=function(r,e){r=r.replace(/[\[\]]/g,"\\$&");var o=new RegExp("[?&]"+r+"(=([^&#]*)|&|#|$)"),n=o.exec(e);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}}();
/* <<< file end: js/widgets/angular/login.js */

//# map link was there [login.js.map]
/* >>> file start: js/jquery/jquery.lj.journalPromoStrip.js */
!function(o,e){"use strict";o.widget("lj.journalPromoStrip",o.lj.basicWidget,{options:{selectors:{popupInfo:".journalpromo-popup-content-info",popupDelete:".journalpromo-popup-content-delete",button:"#journalpromo-popup-btn",iconClose:".b-journalpromo-actions-close",options:".b-journalpromo-header-options",promoItem:".b-journalpromo-item",iconDelete:".b-journalpromo-actions-delete",info:".journalpromo-popup-info-action",spinner:".journalpromo-popup-spinner",error:".journalpromo-popup-info-error",errorContent:".journalpromo-popup-info-error-content",ban:"#journalpromo-user-ban"},classNames:{iconInfo:".journalpromo-info-icon",iconDelete:".b-journalpromo-actions-delete",noPromo:"b-journalpromo-item-nopromotion"},template:"<dt><a href='{rules_link}'>{subject}</a> {ljuser}</dt><dd>{body}</dd>"},_create:function(){var e=this;o.lj.basicWidget.prototype._create.apply(this),this._el("spinner"),this._el("info"),this._el("button"),this._el("iconClose"),this._el("error"),e._el("promoItem"),this._el("iconDelete"),this._el("popupDelete"),this._el("errorContent"),this._el("iconDelete")[0]&&(this._deleteBubble=this._popupDelete.bubble({target:this._cl("iconDelete"),showOn:"click"})),this._el("popupInfo").bubble({target:this._cl("iconInfo"),showOn:"hover",closeControl:!1,showDelay:500}),this._bindControls()},_toggleSpinner:function(o){this._spinner.toggle(o),this._info.toggle(!o)},_toggleError:function(o,e){this._error.toggle(o),this._info.toggle(!o),e&&this._errorContent.text(e)},_updateBlock:function(o){o.object[0].object_url?this._promoItem.html(this.options.template.supplant({rules_link:o.object[0].object_url,subject:o.object[0].subject,body:o.object[0].body,ljuser:o.object[0].ljuser_display})):this._promoItem.html('<span class="b-journalpromo-item-message">'+o.object[0].body+"</span>").addClass(this._cl("noPromo"))},_closeClick:function(){var o=this;return"#__debug"===location.hash?this._debug():(o._toggleSpinner(!0),void LJ.Api.call("journalpromo.admin_cancel",{object_url:o.options.url,user:Site.currentJournal,get_slot:1,ban_user:document.getElementById("journalpromo-user-ban").checked},function(e){if(o._toggleSpinner(!1),console.dir(e),e.error&&e.error.data&&e.error.data.entry)return o._updated=e.error.data.entry[0],o._toggleError(!0,e.error.message),void console.error(e.error.message);if(!e.error&&e.entry){var t=e.entry[0];if(!t||!t.object||!t.object[0])return void console.error("Wrong data",e);o._updateBlock(t),o._iconDelete.hide()}o._deleteBubble.bubble("hide")}))},_disableClick:function(){var o=this;LJ.Api.call("journalpromo.disable_promo_announce",{journal:LJ.get("currentJournal")},function(e){e.error||o.element.slideUp("fast")})},_bindControls:function(){var e=this;o.lj.basicWidget.prototype._bindControls.apply(this),this._button.on("click",this._closeClick.bind(this)),this._iconClose.on("click",this._disableClick.bind(this)),this._deleteBubble&&this._deleteBubble.bind("bubblehide",function(o){e._toggleError(!1),e._updated&&(e._updateBlock(e._updated),e._iconDelete.hide())})},_debug:function(){var o=this;o._toggleSpinner(!0),setTimeout(function(){o._toggleSpinner(!1),o._toggleError(!0,"Sample error")},1e3)}})}(jQuery,window);
/* <<< file end: js/jquery/jquery.lj.journalPromoStrip.js */

//# map link was there [jquery.lj.journalPromoStrip.js.map]
/* >>> file start: js/jquery/jquery.lj.inlineCalendar.js */
var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){function e(t,e){e=e||!1;var a=t.getDate().toString();1===a.length&&(a="0"+a),e&&(a="");var n=t.getMonth().toString();return 1===n.length&&(n="0"+n),parseInt(t.getFullYear().toString()+n+a,10)}function a(t,a){return e(a,!0)>=e(t[0],!0)&&e(a,!0)<=e(t[1],!0)}function n(a,n,i){this.initialize=function(t){this.tbody=this.catchTableStructure(t)},this.modelChanged=function(e,n,s){var o=i.longMonth?i.ml.monthNamesLong:i.ml.monthNamesShort;this.tbody.detach(),this.fillDates(e,n);for(var r in s)s.hasOwnProperty(r)&&a[r][s[r]?"removeClass":"addClass"](this.disabledStyle(r));var l=i.monthRef?t("<a>",{href:LJ.Util.Date.format(e,i.monthRef),text:o[e.getMonth()]+(i.monthWithYear?" "+e.getFullYear():"")}):o[e.getMonth()],h=i.yearRef?t("<a>",{href:LJ.Util.Date.format(e,i.yearRef),text:e.getFullYear()}):e.getFullYear();a.monthLabel.empty().append(l),a.yearLabel.empty().append(h),this.tbody.appendTo(a.table)},this.catchTableStructure=function(e){var n=a.tbody[0];a.daysCells=[],a.daysSpans=[];for(var i,s,o,r=n.rows.length,l=6-r,h="<tr>",d=0;7>d;++d)h+="<td><span></span></td>";for(h+="</tr>";l-- >0;)t(h).hide().appendTo(a.tbody);for(r=6,a.lastRow=jQuery(n.rows[n.rows.length-1]),e=new Date(e),i=0;r>i;++i)for(s=0,o=n.rows[i].cells.length;o>s;++s){var c=jQuery(n.rows[i].cells[s]),p=c.children(),u=p.text().trim();u&&(e.setDate(u),c.data("isActive",!0),c.data("day",e)),a.daysCells.push(c),a.daysSpans.push(p)}return jQuery(n)},this.fillDates=function(t,e){function n(t){var a=t.getFullYear(),n=t.getMonth(),i=t.getDate();return e&&e[a]&&e[a][n]&&e[a][n][i]}var s=new Date(t);s.setDate(1);var o;o=i.startAtSunday?s.getDay():0===s.getDay()?6:s.getDay()-1,s.setDate(1-o);for(var r=0,l=a.daysCells.length;l>r;++r){var h=a.daysCells[r],d=a.daysSpans[r];this.formDayString(s,h,d,n(s),this.isActiveDate(s,t)),s.setDate(s.getDate()+1)}s.setDate(s.getDate()-1),s.getDate()<7?a.lastRow.css("display",""):a.lastRow.css("display","none")},this.isActiveDate=function(t,a){var n=!0;return n=a.getFullYear()===t.getFullYear()&&a.getMonth()===t.getMonth(),n&&(i.activeFrom||i.activeUntil)&&(n=i.activeFrom&&e(i.activeFrom)<=e(t)||i.activeUntil&&e(i.activeUntil)>=e(t)),n},this.formDayString=function(a,s,o,r,l){a=new Date(a);var h=e(a)===e(i.currentDate);if(s.data("day",a),s.data("isActive",l),s.data("hasEvents",r),s[h?"addClass":"removeClass"](n.current),s.removeClass(n.cellHover),l)if(r||i.allRefs){var d=!0;i.allRefs&&"object"===_typeof(i.allRefs)&&(i.allRefs.from&&a<i.allRefs.from&&(d=!1),i.allRefs.to&&a>i.allRefs.to&&(d=!1)),d?(s.removeClass(n.inactive),o.html(t("<a />",{html:a.getDate(),href:LJ.Util.Date.format(a,i.dayRef),target:"_self"}))):(s.removeClass(n.inactive),o.html(a.getDate()))}else s.removeClass(n.inactive),o.html(a.getDate());else s.addClass(n.inactive),o.html(a.getDate())},this.disabledStyle=function(t){return"prevMonth"===t||"prevYear"===t?n.prevDisabled:n.nextDisabled}}var i={dayRef:"/%Y/%M/%D",monthRef:"",yearRef:"",allRefs:!1,currentDate:new Date,activeUntil:null,activeFrom:null,startMonth:new Date(1900,0,1),endMonth:new Date(2050,0,1),startAtSunday:"0"===LJ.ml("date.format.offset")||!1,dateFormat:"%Y-%M-%D",defaultTitle:"Calendar",longMonth:!1,events:null,displayedMonth:null,dateChange:null,selectors:{table:"table",title:"h5",tbody:"tbody",month:".cal-nav-month",year:".cal-nav-year",monthSelect:".cal-nav-month-select",yearSelect:".cal-nav-year-select",prevMonth:".cal-nav-month .cal-nav-prev",nextMonth:".cal-nav-month .cal-nav-next",prevYear:".cal-nav-year .cal-nav-prev",nextYear:".cal-nav-year .cal-nav-next",monthLabel:".cal-nav-month .cal-month",yearLabel:".cal-nav-year .cal-year"},classNames:{container:"",inactive:"other",future:"other",current:"current",weekend:"weekend",nextDisabled:"cal-nav-next-dis",prevDisabled:"cal-nav-prev-dis",cellHover:"hover",longMonth:"sidebar-cal-longmonth"},mlPrefix:{monthNamesShort:["monthNames","date.month.{name}.short"],monthNamesLong:["monthNames","date.month.{name}.long"],dayNamesShort:["dayNames","date.day.{name}.short"]},ml:{monthNames:["january","february","march","april","may","june","july","august","september","october","november","december"],dayNames:["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],caption:"Calendar"}},s={options:{},_create:function(){this._preInit(),this._initialize(),this._postInit()},_preInit:function(){var e=t[this.namespace][this.widgetName].getDefaults();this.options=jQuery.extend(!0,{},e,this.options),this._prepareMLVars()},_prepareMLVars:function(){var t,e=function(t,e){return LJ.ml(t.supplant({name:e}))};for(var a in this.options.mlPrefix)this.options.mlPrefix.hasOwnProperty(a)&&(t=this.options.mlPrefix[a],this.options.ml[a]=this.options.ml[t[0]].map(e.bind(null,t[1])))},_initialize:function(){this.options.displayedMonth||(this.options.displayedMonth=new Date(this.options.currentDate)),this._events=this.options.events,this._hideTimer=null,this._nodes=this._nodes||{container:this.element,root:this.element},this._invalidateTimer=null,this.element.hasClass(this.options.classNames.longMonth)&&(this.options.longMonth=!0),this._bindNodes(),this.options.startMonth.setDate(1),this._view=new(this._getView())(this._nodes,this.options.classNames,this.options),this._view.initialize(this.options.currentDate),this._nodes.table.hasClass("monday")&&this._setOption("startAtSunday",!1),this._nodes.monthSelect.val(this.options.displayedMonth.getMonth()),this._nodes.yearSelect.val(this.options.displayedMonth.getFullYear()),this._bindEvents()},_postInit:function(){},_getView:function(){return n},_bindNodes:function(){for(var t in this.options.selectors)!this.options.selectors.hasOwnProperty(t)||t in this._nodes||(this._nodes[t]=this._nodes.container.find(this.options.selectors[t]));var e=LJ.Util.Date.parse(this._nodes.table.attr("data-date"),this.options.dateFormat);e&&(this.options.displayedMonth=e)},destroy:function(){t.Widget.prototype.destroy.apply(this,arguments)},_bindEvents:function(){var e=this,a=this._getSwitcherStates(this.options.currentDate),n=function(t){return function(a){a.preventDefault(),a.stopPropagation();var n=e._getSwitcherStates(e.options.currentDate);n[t]&&e["_"+t]()}};for(var i in a)a.hasOwnProperty(i)&&this._nodes[i].click(n(i));this._nodes.monthSelect.change(function(){var t=new Date(e.options.currentDate);t.setMonth(this.value),e._setOption("currentDate",t)}),this._nodes.yearSelect.change(function(){var t=new Date(e.options.currentDate);t.setFullYear(this.value),e._setOption("currentDate",t)}),this._nodes.tbody.delegate("td","click",function(a){e._cellSelectedEvent(t(this),a)})},_switchMonth:function(t){var e=jQuery.Event("dateChange");e.moveForward=t>0,e.switchType=12===Math.abs(t)?"year":1===Math.abs(t)?"month":null,e.date=new Date(this.options.displayedMonth.getFullYear(),this.options.displayedMonth.getMonth()+t,1),this._nodes.root.trigger(e),this._setOption("displayedMonth",e.date)},_prevMonth:function(){this._switchMonth(-1)},_nextMonth:function(){this._switchMonth(1)},_prevYear:function(){this._switchMonth(-12)},_nextYear:function(){this._switchMonth(12)},_cellSelectedEvent:function(t,e){t.data("isActive")&&!this._cellSelected(t.data("day"))||(e.stopPropagation(),e.preventDefault())},_cellSelected:function(t){var e=jQuery.Event("daySelected");return this._nodes.root.trigger(e,[t,LJ.Util.Date.format(t,this.options.dateFormat)]),e.isDefaultPrevented()||this._setOption("currentDate",t),!e.isDefaultPrevented()},_fitDate:function(t){t=new Date(t);var n=[this.options.startMonth,this.options.endMonth];return a(n,t)||(t=e(t,!0)<e(n[0],!0)?new Date(n[0]):new Date(n[1])),t},_getSwitcherStates:function(){var t=this.options.displayedMonth,e=new Date(t.getFullYear(),0,1),a=new Date(t.getFullYear(),11,1);return{prevMonth:this._isActivePrev(t)!==!1,prevYear:this._isActivePrev(e)!==!1,nextMonth:this._isActiveNext(t)!==!1,nextYear:this._isActiveNext(a)!==!1}},_isActiveNext:function(t){return this._isActiveDate(t,1)},_isActivePrev:function(t){return this._isActiveDate(t,-1)},_isActiveDate:function(t,e){var n=new Date(t);return n.setMonth(n.getMonth()+e),n.setDate(1),a([this.options.startMonth,this.options.endMonth],n)},_invalidateDisplay:function(){var t=this;clearTimeout(this._invalidateTimer),setTimeout(function(){t._view.modelChanged(t.options.displayedMonth,t._events,t._getSwitcherStates())},50)},_setOption:function(t,a){switch(t){case"currentDate":this.options.currentDate=this._fitDate(a);var n=jQuery.Event("currentDateChange"),i=new Date(this.options.currentDate);this._nodes.root.trigger(n,[i,LJ.Util.Date.format(i,this.options.dateFormat)]),this._setOption("displayedMonth",a),this._invalidateDisplay();break;case"activeFrom":this.options.activeFrom=new Date(a),this._invalidateDisplay();break;case"activeUntil":this.options.activeUntil=new Date(a),this._invalidateDisplay();break;case"title":this._title=a,this._nodes.title.html(a);break;case"events":this._events=a,this._invalidateDisplay();break;case"displayedMonth":var s=this._fitDate(new Date(a)),o=e(s,!0)===e(this.options.displayedMonth,!0);o||(this.options.displayedMonth=this._fitDate(new Date(a)),this._nodes.monthSelect.val(this.options.displayedMonth.getMonth()),this._nodes.yearSelect.val(this.options.displayedMonth.getFullYear()),this._invalidateDisplay());break;case"startMonth":this.options.startMonth=new Date(a),this._invalidateDisplay();break;case"endMonth":this.options.endMonth=new Date(a),this._invalidateDisplay();break;case"startAtSunday":this.options.startAtSunday=!!a;break;case"monthWithYear":this.options.monthWithYear=Boolean(a);break;case"dayRef":this.options.dayRef=a,this._invalidateDisplay()}},getElement:function(t){return t in this._nodes?this._nodes[t]:null}};t.widget("lj.inlineCalendar",s),jQuery.extend(t.lj.inlineCalendar,{getDefaults:function(){return i},setDefaults:function(t){t&&jQuery.extend(!0,i,t)}})}(jQuery);
/* <<< file end: js/jquery/jquery.lj.inlineCalendar.js */

//# map link was there [jquery.lj.inlineCalendar.js.map]
/* >>> file start: js/jquery/jquery.lj.calendar.js */
//= require js/jquery/jquery.lj.inlineCalendar.js
!function(e,t){var n,s={showOn:"click",closeControl:!0,showCellHovers:!1,hoverDelay:400,align:"center",events:null,displayedMonth:null,bubbleClass:!1,selectors:{tmpl:".appwidget-calendar .calendar"},classNames:{showCellHovers:"all-days",popup:"b-bubble-calendar"},templates:{calendar:'<div class="popup-inner calendar" style="display: none;"> 						<p class="cal-nav"> 							<span class="cal-nav-month"> 								<i class="cal-nav-prev"></i> 								<span class="cal-month"></span> 								<i class="cal-nav-next cal-nav-next-dis"></i> 							</span> 							<span class="cal-nav-year"> 								<i class="cal-nav-prev cal-nav-prev"></i> 								<span class="cal-year"></span> 								<i class="cal-nav-next cal-nav-next-dis"></i> 							</span> 						</p> 						<table class="calendar-table" cellspacing="0" cellpadding="0"> 							<thead> 								<tr> 									{{each days}} 										<th class="calendar-cell calendar-cell--header {{if $index % 7 === weekend1 || $index % 7 === weekend2}} weekend{{/if}}">${day}</th> 									{{/each}} 								</tr> 							</thead> 							<tbody> 								{{each cells}} 								{{if $index % 7 === 0}}<tr>{{/if}} 								<td class="calendar-cell {{if $index % 7 === weekend1 || $index % 7 === weekend2}}weekend{{/if}}"><span></span></td> 								{{if $index % 7 === 6}}</tr>{{/if}} 								{{/each}} 							</tbody> 						</table></div>'}},a={options:{},_initialize:function(){n||(n=this._buildDOM()),this._nodes={container:n.clone(),root:this.element},e.lj.inlineCalendar.prototype._initialize.apply(this),this._invalidateDisplay()},_bindNodes:function(){e.lj.inlineCalendar.prototype._bindNodes.apply(this);var t=this;this._nodes.container.bubble({classNames:{containerAddClass:this.options.bubbleClass?this.options.classNames.popup:""},target:this._nodes.root,align:this.options.align,closeControl:this.options.closeControl,showOn:this.options.showOn,closeOnContentClick:!1}).bind("bubbleshow",function(e){t._nodes.container.bubble("setPreventHide",!0),setTimeout(function(){t._nodes.container.bubble("setPreventHide",!1)},300),t._trigger("show")}).bind("bubblehide",function(e){t._trigger("hide")}).addClass(this.options.classNames.container),this.options.input?this._nodes.input=this.options.input:this._nodes.root.is("[type=text]")?this._nodes.input=this._nodes.root:this._nodes.input=e(),this._nodes.input.mask&&this._nodes.input.mask("?dddd-dd-dd",{placeholder:" "}),this._nodes.input.input(this._parseInputValue.bind(this));var n=LJ.Util.Date.parse(this._nodes.input.val(),this.options.dateFormat);n&&(this.options.currentDate=n),this.options.showCellHovers&&this._nodes.table.addClass(this.options.classNames.showCellHovers)},destroy:function(){this._nodes.container.bubble("destroy"),e.lj.inlineCalendar.prototype.destroy.apply(this)},_buildDOM:function(){var e=this.options.ml.dayNamesShort.map(function(e){return{day:e}}),t=0,n=6,s=function(e,t){for(var n=[];e--;)n.push(t);return n};this.options.startAtSunday||(e[7]=e[0],e.shift(),t=5);for(var a=[],i=[],l=this.options.endMonth.getFullYear(),o=this.options.startMonth.getFullYear();l>=o;)a.push({year:l--});i=this.options.ml.monthNamesLong.map(function(e){return{month:e}});var d={caption:this.options.ml.caption,days:e,months:i,years:a,cells:s(42,{}),weekend1:t,weekend2:n};return-1!==this.options.templates.calendar.indexOf(" ")?jQuery.tmpl(this.options.templates.calendar,d):LJ.UI.template(this.options.templates.calendar,d)},_parseInputValue:function(){var e=LJ.Util.Date.parse(this._nodes.input.val(),this.options.dateFormat);e&&this._cellSelected(e)},_cellSelectedEvent:function(n,s){var a=this;e.lj.inlineCalendar.prototype._cellSelectedEvent.call(this,n,s),a.options.showCellHovers&&n.data("isActive")&&a._nodes.container.bubble("hide"),"a"==s.target.tagName.toLowerCase()&&(t.location.href=s.target.href)},_invalidateDisplay:function(){this._view.modelChanged(this.options.displayedMonth,this._events,this._getSwitcherStates())},_setOption:function(t,n){switch(e.lj.inlineCalendar.prototype._setOption.call(this,t,n),t){case"currentDate":this._nodes.input.val(LJ.Util.Date.format(this.options.currentDate,this.options.dateFormat))}}};e.widget("lj.calendar",e.lj.inlineCalendar,a),jQuery.extend(e.lj.calendar,{getDefaults:function(){return jQuery.extend(!0,{},e.lj.inlineCalendar.getDefaults(),s)},setDefaults:function(e){e&&jQuery.extend(s,e)}})}(jQuery,window);
/* <<< file end: js/jquery/jquery.lj.calendar.js */

//# map link was there [jquery.lj.calendar.js.map]
/* >>> file start: js/jquery/jquery.mask.js */
!function(t){var e=(t.browser.msie?"paste":"input")+".mask",n=void 0!=window.orientation;t.mask={definitions:{d:"[0-9]",w:"[A-Za-z]","*":"[A-Za-z0-9а-яА-Я]"}},t.fn.extend({unmask:function(){return this.trigger("unmask")},mask:function(a,r){if(!a&&this.length>0){var i=t(this[0]),o=i.data("tests");return t.map(i.data("buffer"),function(t,e){return o[e]?t:null}).join("")}r=t.extend({placeholder:"_",completed:null},r);var u=t.mask.definitions,o=[],l=a.length,f=null,s=a.length;return t.each(a.split(""),function(t,e){"?"==e?(s--,l=t):u[e]?(o.push(new RegExp(u[e])),null==f&&(f=o.length-1)):o.push(null)}),this.each(function(){function i(t){for(;++t<=s&&!o[t];);return t}function c(t){for(;!o[t]&&--t>=0;);for(var e=t;s>e;e++)if(o[e]){g[e]=r.placeholder;var n=i(e);if(!(s>n&&o[e].test(g[n])))break;g[e]=g[n]}k(),b.caret(Math.max(f,t))}function d(t){for(var e=t,n=r.placeholder;s>e;e++)if(o[e]){var a=i(e),u=g[e];if(g[e]=n,!(s>a&&o[a].test(u)))break;n=u}}function h(e){var a=t(this).caret(),r=e.keyCode;return y=16>r||r>16&&32>r||r>32&&41>r,a.start-a.end==0||y&&8!=r&&46!=r||m(a.start,a.end),8==r||46==r||n&&127==r?(c(a.start+(46==r?0:-1)),!1):27==r?(b.val(w),b.caret(0,p()),!1):void 0}function v(e){if(y)return y=!1,8==e.keyCode?!1:null;e=e||window.event;var n=e.charCode||e.keyCode||e.which,a=t(this).caret();if(e.ctrlKey||e.altKey||e.metaKey)return!0;if(n>=32&&125>=n||n>186){var u=i(a.start-1);if(s>u){var l=String.fromCharCode(n);if(o[u].test(l)){d(u),g[u]=l,k();var a=i(u);t(this).caret(a),r.completed&&a==s&&r.completed.call(b)}}}return!1}function m(t,e){for(var n=t;e>n&&s>n;n++)o[n]&&(g[n]=r.placeholder)}function k(){return b.val(g.join("")).val()}function p(t){for(var e=b.val(),n=-1,a=0,i=0;s>a;a++)if(o[a]){for(g[a]=r.placeholder;i++<e.length;){var u=e.charAt(i-1);if(o[a].test(u)){g[a]=u,n=a;break}}if(i>e.length)break}else g[a]==e.charAt(i)&&a!=l&&(i++,n=a);return!t&&l>n+1?(b.val(""),m(0,s)):(t||n+1>=l)&&(k(),t||b.val(b.val().substring(0,n+1))),l?a:f}var b=t(this),g=t.map(a.split(""),function(t,e){return"?"!=t?u[t]?r.placeholder:t:void 0}),y=!1,w=b.val();b.data("buffer",g).data("tests",o),b.attr("readonly")||b.one("unmask",function(){b.unbind(".mask").removeData("buffer").removeData("tests")}).bind("focus.mask",function(){w=b.val();var t=p();k(),setTimeout(function(){t==a.length?b.caret(0,t):b.caret(t)},0)}).bind("blur.mask",function(){p(),b.val()!=w&&b.change()}).bind("keydown.mask",h).bind("keypress.mask",v).bind(e,function(){setTimeout(function(){b.caret(p(!0))},0)}),p()})}})}(jQuery);
/* <<< file end: js/jquery/jquery.mask.js */

//# map link was there [jquery.mask.js.map]
/* >>> file start: js/scheme/medius.js */
//= require js/widgets/angular/mediusSubscribe.js
//= require js/core/angular/api.js
!function(){"use strict";angular.element(document).ready(function(){if(0!==angular.element(".mdsfooter").length){var e=angular.element(".mdsfooter").find("[medius-subscribe]");angular.bootstrap(e,["Medius.Subscribe"])}})}();
/* <<< file end: js/scheme/medius.js */

//# map link was there [medius.js.map]
/* >>> file start: js/core/angular/radioGroup.js */
!function(t){return t}(),function(){"use strict";function t(){function t(){this._models={}}function o(o){return e[o]?e[o]:(e[o]=new t,e[o])}var e={};return t.prototype.models=function(){return this._models},t.prototype.reset=function(){var t,o=this._models;for(t in o)o.hasOwnProperty(t)&&o[t]&&(this._models[t]=!1);return this},t.prototype.set=function(t,o){return o?this.reset()._models[t]=!0:this._models[t]=!1,this},t.prototype.on=function(t){return this.set(t,!0)},t.prototype.off=function(t){return"undefined"==typeof t?this.reset():this.set(t,!1),this},t.prototype.toggle=function(t){this._models[t]?this.off(t):this.on(t)},o}angular.module("LJ.RadioGroup",[]),angular.module("LJ.RadioGroup").factory("radioGroup",t)}();
/* <<< file end: js/core/angular/radioGroup.js */

//# map link was there [radioGroup.js.map]
/* >>> file start: js/node_modules/angular-sanitize/angular-sanitize.js */
!function(e,t){"use strict";function n(){function n(e,t){var n,r={},i=e.split(",");for(n=0;n<i.length;n++)r[t?l(i[n]):i[n]]=!0;return r}function r(t,n){null===t||void 0===t?t="":"string"!=typeof t&&(t=""+t),v.innerHTML=t;var r=5;do{if(0===r)throw h("uinput","Failed to sanitize html because the input is unstable");r--,e.document.documentMode&&g(v),t=v.innerHTML,v.innerHTML=t}while(t!==v.innerHTML);for(var i=v.firstChild;i;){switch(i.nodeType){case 1:n.start(i.nodeName.toLowerCase(),p(i.attributes));break;case 3:n.chars(i.textContent)}var a;if(!(a=i.firstChild)&&(1==i.nodeType&&n.end(i.nodeName.toLowerCase()),a=i.nextSibling,!a))for(;null==a&&(i=i.parentNode,i!==v);)a=i.nextSibling,1==i.nodeType&&n.end(i.nodeName.toLowerCase());i=a}for(;i=v.firstChild;)v.removeChild(i)}function p(e){for(var t={},n=0,r=e.length;r>n;n++){var i=e[n];t[i.name]=i.value}return t}function f(e){return e.replace(/&/g,"&amp;").replace(y,function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return"&#"+(1024*(t-55296)+(n-56320)+65536)+";"}).replace(k,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function m(e,t){var n=!1,r=i(e,e.push);return{start:function(e,i){e=l(e),!n&&D[e]&&(n=e),n||$[e]!==!0||(r("<"),r(e),o(i,function(n,i){var a=l(i),o="img"===e&&"src"===a||"background"===a;M[a]!==!0||N[a]===!0&&!t(n,o)||(r(" "),r(i),r('="'),r(f(n)),r('"'))}),r(">"))},end:function(e){e=l(e),n||$[e]!==!0||x[e]===!0||(r("</"),r(e),r(">")),e==n&&(n=!1)},chars:function(e){n||r(f(e))}}}function g(t){if(t.nodeType===e.Node.ELEMENT_NODE)for(var n=t.attributes,r=0,i=n.length;i>r;r++){var a=n[r],o=a.name.toLowerCase();"xmlns:ns1"!==o&&0!==o.lastIndexOf("ns1:",0)||(t.removeAttributeNode(a),r--,i--)}var s=t.firstChild;s&&g(s),s=t.nextSibling,s&&g(s)}var b=!1;this.$get=["$$sanitizeUri",function(e){return b&&a($,T),function(t){var n=[];return u(t,d(n,function(t,n){return!/^unsafe:/.test(e(t,n))})),n.join("")}}],this.enableSvg=function(e){return s(e)?(b=e,this):b},i=t.bind,a=t.extend,o=t.forEach,s=t.isDefined,l=t.lowercase,c=t.noop,u=r,d=m;var v,y=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,k=/([^\#-~ |!])/g,x=n("area,br,col,hr,img,wbr"),w=n("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),C=n("rp,rt"),E=a({},C,w),z=a({},w,n("address,article,aside,blockquote,caption,center,del,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,map,menu,nav,ol,pre,section,table,ul")),L=a({},C,n("a,abbr,acronym,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,q,ruby,rp,rt,s,samp,small,span,strike,strong,sub,sup,time,tt,u,var")),T=n("circle,defs,desc,ellipse,font-face,font-face-name,font-face-src,g,glyph,hkern,image,linearGradient,line,marker,metadata,missing-glyph,mpath,path,polygon,polyline,radialGradient,rect,stop,svg,switch,text,title,tspan"),D=n("script,style"),$=a({},x,z,L,E),N=n("background,cite,href,longdesc,src,xlink:href"),S=n("abbr,align,alt,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,coords,dir,face,headers,height,hreflang,hspace,ismap,lang,language,nohref,nowrap,rel,rev,rows,rowspan,rules,scope,scrolling,shape,size,span,start,summary,tabindex,target,title,type,valign,value,vspace,width"),F=n("accent-height,accumulate,additive,alphabetic,arabic-form,ascent,baseProfile,bbox,begin,by,calcMode,cap-height,class,color,color-rendering,content,cx,cy,d,dx,dy,descent,display,dur,end,fill,fill-rule,font-family,font-size,font-stretch,font-style,font-variant,font-weight,from,fx,fy,g1,g2,glyph-name,gradientUnits,hanging,height,horiz-adv-x,horiz-origin-x,ideographic,k,keyPoints,keySplines,keyTimes,lang,marker-end,marker-mid,marker-start,markerHeight,markerUnits,markerWidth,mathematical,max,min,offset,opacity,orient,origin,overline-position,overline-thickness,panose-1,path,pathLength,points,preserveAspectRatio,r,refX,refY,repeatCount,repeatDur,requiredExtensions,requiredFeatures,restart,rotate,rx,ry,slope,stemh,stemv,stop-color,stop-opacity,strikethrough-position,strikethrough-thickness,stroke,stroke-dasharray,stroke-dashoffset,stroke-linecap,stroke-linejoin,stroke-miterlimit,stroke-opacity,stroke-width,systemLanguage,target,text-anchor,to,transform,type,u1,u2,underline-position,underline-thickness,unicode,unicode-range,units-per-em,values,version,viewBox,visibility,width,widths,x,x-height,x1,x2,xlink:actuate,xlink:arcrole,xlink:role,xlink:show,xlink:title,xlink:type,xml:base,xml:lang,xml:space,xmlns,xmlns:xlink,y,y1,y2,zoomAndPan",!0),M=a({},N,F,S);!function(e){var t;if(!e.document||!e.document.implementation)throw h("noinert","Can't create an inert html document");t=e.document.implementation.createHTMLDocument("inert");var n=t.documentElement||t.getDocumentElement(),r=n.getElementsByTagName("body");if(1===r.length)v=r[0];else{var i=t.createElement("html");v=t.createElement("body"),i.appendChild(v),t.appendChild(i)}}(e)}function r(e){var t=[],n=d(t,c);return n.chars(e),t.join("")}var i,a,o,s,l,c,u,d,h=t.$$minErr("$sanitize");t.module("ngSanitize",[]).provider("$sanitize",n),t.module("ngSanitize").filter("linky",["$sanitize",function(e){var n=/((ftp|https?):\/\/|(www\.)|(mailto:)?[A-Za-z0-9._%+-]+@)\S*[^\s.;,(){}<>"\u201d\u2019]/i,i=/^mailto:/i,a=t.$$minErr("linky"),o=t.isDefined,s=t.isFunction,l=t.isObject,c=t.isString;return function(t,u,d){function h(e){e&&y.push(r(e))}function p(e,t){var n,r=b(e);y.push("<a ");for(n in r)y.push(n+'="'+r[n]+'" ');!o(u)||"target"in r||y.push('target="',u,'" '),y.push('href="',e.replace(/"/g,"&quot;"),'">'),h(t),y.push("</a>")}if(null==t||""===t)return t;if(!c(t))throw a("notstring","Expected string but received: {0}",t);for(var f,m,g,b=s(d)?d:l(d)?function(){return d}:function(){return{}},v=t,y=[];f=v.match(n);)m=f[0],f[2]||f[4]||(m=(f[3]?"http://":"mailto:")+m),g=f.index,h(v.substr(0,g)),p(m,f[0].replace(i,"")),v=v.substring(g+f[0].length);return h(v),e(y.join(""))}}])}(window,window.angular);
/* <<< file end: js/node_modules/angular-sanitize/angular-sanitize.js */

//# map link was there [angular-sanitize.js.map]
/* >>> file start: js/widgets/discoverytimes.js */
//= require js/core/angular/radioGroup.js
//= require js/node_modules/angular-sanitize/angular-sanitize.js
//= require js/core/angular/api.js
//= require js/core/angular/users.js
//= require js/core/angular/ljUser.js
!function(){"use strict";function e(){var e=angular.element(".b-discoverytimes-wrapper[lj-discovery-times]");e.injector()||angular.bootstrap(e,["LJ.DiscoveryTimes"])}function i(){function e(e,i){i.removeAttr("lj-discovery-times")}return{scope:!0,link:e,controller:n,controllerAs:"times"}}function n(e,i,n,t,o,m){function r(){f+=1,f>=d.items.length&&(f=0),l.on(d.items[f].itemid)}function s(){0!==d.items.length&&(r(),c=i(r,a),e.$on("$destroy",i.cancel.bind(i,c)))}var c,d=this,u=LJ.Flags.isEnabled("medius_ui")?m:o,l=n("active"),a=5e3,f=-1;d.items=[],d.active=l.reset().models(),d.isRecommend=!1,d.showRecommend=!1,d.showRandom=!1,d.close=function(){},d.recommend=function(){u.setRecommend().then(function(){d.isRecommend=u.isRecommend})},u.getRecommend().then(function(){d.showRecommend=u.showRecommend,d.showRandom=!d.showRecommend,d.isRecommend=u.isRecommend}),u.getFeed().then(function(e){d.items=e.items.filter(Boolean),t.Cache.add(d.items.map(LJ.Function.get("user")))}).then(s)}function t(e){function i(){return m.limit=m.itemshow,m.is_published=!0,e.call("medius.get_public_items",m).then(n)}function n(e){return e.items=e.items.filter(function(e){return e.author}).map(function(e){return e.itemid=e.jitem_id,e.url=e.link,e.subject=e.title,e}),e}function t(){return s.showRecommend?e.call("discovery.is_recommend",r).then(function(e){"ok"===e.status&&(s.isRecommend=e.is_recommend)}):Promise.resolve()}function o(){return s.showRecommend?e.call("discovery.recommend",r).then(function(e){"ok"===e.status&&(s.isRecommend=!0)}):Promise.resolve()}var m={itemshow:10},r={entry:Boolean(LJ.get("entry")),remoteid:LJ.get("remote.id"),journalid:LJ.get("journal.id"),publicEntry:LJ.get("entry.is_public"),ditemid:LJ.get("entry.ditemid")},s={getFeed:i,isRecomend:!1,getRecommend:t,setRecommend:o,showRecommend:!1};return s}function o(e){function i(){return e.call("discovery.get_feed",o)}function n(){return r.showRecommend?e.call("discovery.is_recommend",m).then(function(e){"ok"===e.status&&(r.isRecommend=e.is_recommend)}):Promise.resolve()}function t(){return r.showRecommend?e.call("discovery.recommend",m).then(function(e){"ok"===e.status&&(r.isRecommend=!0)}):Promise.resolve()}var o={itemshow:10},m={entry:Boolean(LJ.get("entry")),remoteid:LJ.get("remote.id"),journalid:LJ.get("journal.id"),publicEntry:LJ.get("entry.is_public"),ditemid:LJ.get("entry.ditemid")},r={getFeed:i,isRecomend:!1,getRecommend:n,setRecommend:t,showRecommend:m.entry&&m.journalid&&m.remoteid&&m.publicEntry&&m.journalid!==m.remoteid};return r}t.$inject=["Api"],o.$inject=["Api"],n.$inject=["$scope","$interval","radioGroup","Users","DiscoveryTimesService","MediusTimesService"],angular.element("body").ready(e),angular.module("LJ.DiscoveryTimes",["ngSanitize","LJ.Directives","LJ.RadioGroup","LJ.Api","LJ.User","Users"]),angular.module("LJ.DiscoveryTimes").directive("ljDiscoveryTimes",i).factory("MediusTimesService",t).factory("DiscoveryTimesService",o)}();
/* <<< file end: js/widgets/discoverytimes.js */

//# map link was there [discoverytimes.js.map]
